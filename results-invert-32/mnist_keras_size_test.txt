Start of new run
Iteration: 1
Using TensorFlow backend.
Downloading data from https://s3.amazonaws.com/img-datasets/mnist.npz
11493376/11490434 [==============================] - 13s 1us/step
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/keras/backend/tensorflow_backend.py:3445: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /usr/local/lib/python3.5/dist-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
2019-05-09 14:02:58.614885: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2019-05-09 14:02:58.616404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1531] Found device 0 with properties: 
name: Device 67df
AMDGPU ISA: gfx803
memoryClockRate (GHz) 1.411
pciBusID 0000:1c:00.0
Total memory: 8.00GiB
Free memory: 7.75GiB
2019-05-09 14:02:58.616426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1642] Adding visible gpu devices: 0
2019-05-09 14:02:58.616491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Device interconnect StreamExecutor with strength 1 edge matrix:
2019-05-09 14:02:58.616501: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1059]      0 
2019-05-09 14:02:58.616510: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1072] 0:   N 
2019-05-09 14:02:58.616549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1189] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7539 MB memory) -> physical GPU (device: 0, name: Device 67df, pci bus id: 0000:1c:00.0)
60000/60000 [==============================] - 6s 105us/step - loss: 0.9754 - acc: 0.6890 - val_loss: 0.8531 - val_acc: 0.7266
Epoch 2/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.4667 - acc: 0.8502 - val_loss: 0.2598 - val_acc: 0.9146
Epoch 3/20
60000/60000 [==============================] - 3s 47us/step - loss: 0.3477 - acc: 0.8907 - val_loss: 0.4701 - val_acc: 0.8315
Epoch 4/20
60000/60000 [==============================] - 3s 47us/step - loss: 0.2933 - acc: 0.9074 - val_loss: 0.2847 - val_acc: 0.9132
Epoch 5/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2593 - acc: 0.9200 - val_loss: 0.2046 - val_acc: 0.9383
Epoch 6/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2412 - acc: 0.9251 - val_loss: 0.1638 - val_acc: 0.9469
Epoch 7/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2236 - acc: 0.9307 - val_loss: 0.1351 - val_acc: 0.9594
Epoch 8/20
60000/60000 [==============================] - 3s 51us/step - loss: 0.2149 - acc: 0.9347 - val_loss: 0.1702 - val_acc: 0.9469
Epoch 9/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2090 - acc: 0.9367 - val_loss: 0.1292 - val_acc: 0.9604
Epoch 10/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2053 - acc: 0.9383 - val_loss: 0.1179 - val_acc: 0.9654
Epoch 11/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2042 - acc: 0.9401 - val_loss: 0.1265 - val_acc: 0.9629
Epoch 12/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2019 - acc: 0.9410 - val_loss: 0.1305 - val_acc: 0.9621
Epoch 13/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1981 - acc: 0.9420 - val_loss: 0.1380 - val_acc: 0.9585
Epoch 14/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1960 - acc: 0.9432 - val_loss: 0.1540 - val_acc: 0.9597
Epoch 15/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1942 - acc: 0.9441 - val_loss: 0.1475 - val_acc: 0.9555
Epoch 16/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1967 - acc: 0.9439 - val_loss: 0.1660 - val_acc: 0.9476
Epoch 17/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1949 - acc: 0.9456 - val_loss: 0.1176 - val_acc: 0.9641
Epoch 18/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1934 - acc: 0.9457 - val_loss: 0.1399 - val_acc: 0.9600
Epoch 19/20
60000/60000 [==============================] - 3s 47us/step - loss: 0.1967 - acc: 0.9438 - val_loss: 0.1165 - val_acc: 0.9663
Epoch 20/20
60000/60000 [==============================] - 3s 45us/step - loss: 0.1970 - acc: 0.9459 - val_loss: 0.1509 - val_acc: 0.9572
10000/10000 [==============================] - 1s 67us/step
Test loss: 0.15331496448446996
Test accuracy: 0.9589
Iteration: 2
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 3s 52us/step - loss: 0.9503 - acc: 0.6930 - val_loss: 0.3827 - val_acc: 0.8738
Epoch 2/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.4501 - acc: 0.8544 - val_loss: 0.3150 - val_acc: 0.8939
Epoch 3/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.3361 - acc: 0.8931 - val_loss: 0.4265 - val_acc: 0.8579
Epoch 4/20
60000/60000 [==============================] - 3s 49us/step - loss: 0.2783 - acc: 0.9130 - val_loss: 0.1868 - val_acc: 0.9405
Epoch 5/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2512 - acc: 0.9223 - val_loss: 0.2222 - val_acc: 0.9317
Epoch 6/20
60000/60000 [==============================] - 3s 49us/step - loss: 0.2273 - acc: 0.9305 - val_loss: 0.1515 - val_acc: 0.9505
Epoch 7/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2145 - acc: 0.9337 - val_loss: 0.1525 - val_acc: 0.9545
Epoch 8/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.2090 - acc: 0.9365 - val_loss: 0.1414 - val_acc: 0.9572
Epoch 9/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1998 - acc: 0.9397 - val_loss: 0.1475 - val_acc: 0.9531
Epoch 10/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1933 - acc: 0.9418 - val_loss: 0.1263 - val_acc: 0.9636
Epoch 11/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1908 - acc: 0.9435 - val_loss: 0.1204 - val_acc: 0.9636
Epoch 12/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1947 - acc: 0.9424 - val_loss: 0.1500 - val_acc: 0.9542
Epoch 13/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1912 - acc: 0.9445 - val_loss: 0.1265 - val_acc: 0.9613
Epoch 14/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1865 - acc: 0.9469 - val_loss: 0.1520 - val_acc: 0.9550
Epoch 15/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1849 - acc: 0.9468 - val_loss: 0.1209 - val_acc: 0.9636
Epoch 16/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1824 - acc: 0.9482 - val_loss: 0.1193 - val_acc: 0.9641
Epoch 17/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1824 - acc: 0.9478 - val_loss: 0.1241 - val_acc: 0.9638
Epoch 18/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1839 - acc: 0.9482 - val_loss: 0.1268 - val_acc: 0.9640
Epoch 19/20
60000/60000 [==============================] - 3s 48us/step - loss: 0.1836 - acc: 0.9488 - val_loss: 0.1320 - val_acc: 0.9605
Epoch 20/20
60000/60000 [==============================] - 3s 49us/step - loss: 0.1830 - acc: 0.9483 - val_loss: 0.1650 - val_acc: 0.9540
10000/10000 [==============================] - 1s 75us/step
Test loss: 0.16264603954907506
Test accuracy: 0.956
Iteration: 3
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.9290 - acc: 0.6977 - val_loss: 0.3827 - val_acc: 0.8793
Epoch 2/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.4381 - acc: 0.8584 - val_loss: 0.2578 - val_acc: 0.9123
Epoch 3/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.3277 - acc: 0.8974 - val_loss: 0.3078 - val_acc: 0.9055
Epoch 4/20
60000/60000 [==============================] - 3s 49us/step - loss: 0.2744 - acc: 0.9152 - val_loss: 0.1566 - val_acc: 0.9503
Epoch 5/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.2416 - acc: 0.9251 - val_loss: 0.1537 - val_acc: 0.9533
Epoch 6/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.2209 - acc: 0.9307 - val_loss: 0.1285 - val_acc: 0.9608
Epoch 7/20
60000/60000 [==============================] - 3s 52us/step - loss: 0.2089 - acc: 0.9362 - val_loss: 0.1418 - val_acc: 0.9549
Epoch 8/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1992 - acc: 0.9401 - val_loss: 0.1755 - val_acc: 0.9431
Epoch 9/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1924 - acc: 0.9421 - val_loss: 0.1171 - val_acc: 0.9639
Epoch 10/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1862 - acc: 0.9435 - val_loss: 0.1324 - val_acc: 0.9603
Epoch 11/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1791 - acc: 0.9462 - val_loss: 0.1130 - val_acc: 0.9672
Epoch 12/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1761 - acc: 0.9479 - val_loss: 0.1142 - val_acc: 0.9680
Epoch 13/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1772 - acc: 0.9489 - val_loss: 0.1889 - val_acc: 0.9410
Epoch 14/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1743 - acc: 0.9482 - val_loss: 0.1213 - val_acc: 0.9645
Epoch 15/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1739 - acc: 0.9487 - val_loss: 0.1279 - val_acc: 0.9586
Epoch 16/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1751 - acc: 0.9498 - val_loss: 0.1116 - val_acc: 0.9663
Epoch 17/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.1744 - acc: 0.9515 - val_loss: 0.1007 - val_acc: 0.9699
Epoch 18/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.1726 - acc: 0.9499 - val_loss: 0.1383 - val_acc: 0.9615
Epoch 19/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.1728 - acc: 0.9510 - val_loss: 0.1188 - val_acc: 0.9664
Epoch 20/20
60000/60000 [==============================] - 3s 50us/step - loss: 0.1760 - acc: 0.9518 - val_loss: 0.1226 - val_acc: 0.9664
10000/10000 [==============================] - 1s 71us/step
Test loss: 0.12168949283369439
Test accuracy: 0.966
Iteration: 4
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 3s 58us/step - loss: 0.9359 - acc: 0.6961 - val_loss: 0.6334 - val_acc: 0.7878
Epoch 2/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.4355 - acc: 0.8608 - val_loss: 0.2576 - val_acc: 0.9193
Epoch 3/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.3163 - acc: 0.9006 - val_loss: 0.2439 - val_acc: 0.9221
Epoch 4/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.2665 - acc: 0.9165 - val_loss: 0.1694 - val_acc: 0.9481
Epoch 5/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.2381 - acc: 0.9264 - val_loss: 0.2030 - val_acc: 0.9350
Epoch 6/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.2186 - acc: 0.9346 - val_loss: 0.1602 - val_acc: 0.9505
Epoch 7/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.2050 - acc: 0.9379 - val_loss: 0.2141 - val_acc: 0.9325
Epoch 8/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.1952 - acc: 0.9425 - val_loss: 0.1527 - val_acc: 0.9512
Epoch 9/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1879 - acc: 0.9431 - val_loss: 0.1270 - val_acc: 0.9619
Epoch 10/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.1808 - acc: 0.9458 - val_loss: 0.1663 - val_acc: 0.9486
Epoch 11/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.1785 - acc: 0.9477 - val_loss: 0.1645 - val_acc: 0.9546
Epoch 12/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1765 - acc: 0.9477 - val_loss: 0.1254 - val_acc: 0.9641
Epoch 13/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1732 - acc: 0.9496 - val_loss: 0.1275 - val_acc: 0.9655
Epoch 14/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1693 - acc: 0.9515 - val_loss: 0.1233 - val_acc: 0.9663
Epoch 15/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.1750 - acc: 0.9510 - val_loss: 0.1189 - val_acc: 0.9686
Epoch 16/20
60000/60000 [==============================] - 3s 53us/step - loss: 0.1696 - acc: 0.9525 - val_loss: 0.1127 - val_acc: 0.9693
Epoch 17/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1706 - acc: 0.9521 - val_loss: 0.1460 - val_acc: 0.9643
Epoch 18/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1702 - acc: 0.9514 - val_loss: 0.1164 - val_acc: 0.9682
Epoch 19/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1733 - acc: 0.9520 - val_loss: 0.1443 - val_acc: 0.9608
Epoch 20/20
60000/60000 [==============================] - 3s 54us/step - loss: 0.1730 - acc: 0.9525 - val_loss: 0.1052 - val_acc: 0.9701
10000/10000 [==============================] - 1s 74us/step
Test loss: 0.10613922583324602
Test accuracy: 0.969
Iteration: 5
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 4s 65us/step - loss: 0.9207 - acc: 0.6978 - val_loss: 0.5306 - val_acc: 0.8341
Epoch 2/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.4277 - acc: 0.8634 - val_loss: 0.2180 - val_acc: 0.9310
Epoch 3/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.3228 - acc: 0.8977 - val_loss: 0.1962 - val_acc: 0.9371
Epoch 4/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.2696 - acc: 0.9158 - val_loss: 0.1711 - val_acc: 0.9467
Epoch 5/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.2400 - acc: 0.9268 - val_loss: 0.1520 - val_acc: 0.9514
Epoch 6/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.2188 - acc: 0.9333 - val_loss: 0.1761 - val_acc: 0.9458
Epoch 7/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.2030 - acc: 0.9379 - val_loss: 0.1521 - val_acc: 0.9524
Epoch 8/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1928 - acc: 0.9413 - val_loss: 0.1589 - val_acc: 0.9487
Epoch 9/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1867 - acc: 0.9442 - val_loss: 0.1193 - val_acc: 0.9629
Epoch 10/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1777 - acc: 0.9469 - val_loss: 0.1119 - val_acc: 0.9642
Epoch 11/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1749 - acc: 0.9483 - val_loss: 0.1122 - val_acc: 0.9676
Epoch 12/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1728 - acc: 0.9494 - val_loss: 0.1265 - val_acc: 0.9592
Epoch 13/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1710 - acc: 0.9508 - val_loss: 0.1797 - val_acc: 0.9458
Epoch 14/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1675 - acc: 0.9506 - val_loss: 0.1128 - val_acc: 0.9659
Epoch 15/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1656 - acc: 0.9529 - val_loss: 0.0913 - val_acc: 0.9740
Epoch 16/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1680 - acc: 0.9518 - val_loss: 0.1716 - val_acc: 0.9581
Epoch 17/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1645 - acc: 0.9526 - val_loss: 0.1036 - val_acc: 0.9713
Epoch 18/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1618 - acc: 0.9548 - val_loss: 0.1251 - val_acc: 0.9645
Epoch 19/20
60000/60000 [==============================] - 4s 60us/step - loss: 0.1661 - acc: 0.9544 - val_loss: 0.1095 - val_acc: 0.9713
Epoch 20/20
60000/60000 [==============================] - 4s 61us/step - loss: 0.1666 - acc: 0.9540 - val_loss: 0.1295 - val_acc: 0.9587
10000/10000 [==============================] - 1s 81us/step
Test loss: 0.12865202470498624
Test accuracy: 0.9586
Iteration: 6
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 5s 81us/step - loss: 0.9238 - acc: 0.7019 - val_loss: 0.3465 - val_acc: 0.8952
Epoch 2/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.4325 - acc: 0.8622 - val_loss: 0.3220 - val_acc: 0.8913
Epoch 3/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.3226 - acc: 0.8994 - val_loss: 0.2278 - val_acc: 0.9248
Epoch 4/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.2721 - acc: 0.9148 - val_loss: 0.2363 - val_acc: 0.9274
Epoch 5/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.2400 - acc: 0.9253 - val_loss: 0.1424 - val_acc: 0.9556
Epoch 6/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.2185 - acc: 0.9332 - val_loss: 0.1506 - val_acc: 0.9535
Epoch 7/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.2045 - acc: 0.9377 - val_loss: 0.1880 - val_acc: 0.9425
Epoch 8/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1938 - acc: 0.9418 - val_loss: 0.1246 - val_acc: 0.9603
Epoch 9/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.1886 - acc: 0.9437 - val_loss: 0.1205 - val_acc: 0.9622
Epoch 10/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1793 - acc: 0.9460 - val_loss: 0.1113 - val_acc: 0.9663
Epoch 11/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.1770 - acc: 0.9475 - val_loss: 0.1456 - val_acc: 0.9555
Epoch 12/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.1675 - acc: 0.9504 - val_loss: 0.1144 - val_acc: 0.9680
Epoch 13/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.1708 - acc: 0.9507 - val_loss: 0.1647 - val_acc: 0.9553
Epoch 14/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.1689 - acc: 0.9502 - val_loss: 0.2017 - val_acc: 0.9367
Epoch 15/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1642 - acc: 0.9522 - val_loss: 0.1007 - val_acc: 0.9693
Epoch 16/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1626 - acc: 0.9523 - val_loss: 0.1057 - val_acc: 0.9679
Epoch 17/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1649 - acc: 0.9530 - val_loss: 0.1321 - val_acc: 0.9625
Epoch 18/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1661 - acc: 0.9525 - val_loss: 0.1214 - val_acc: 0.9678
Epoch 19/20
60000/60000 [==============================] - 4s 75us/step - loss: 0.1626 - acc: 0.9549 - val_loss: 0.1753 - val_acc: 0.9489
Epoch 20/20
60000/60000 [==============================] - 5s 75us/step - loss: 0.1619 - acc: 0.9545 - val_loss: 0.1291 - val_acc: 0.9655
10000/10000 [==============================] - 1s 93us/step
Test loss: 0.12983553195041606
Test accuracy: 0.9662
Iteration: 7
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 7s 109us/step - loss: 0.9060 - acc: 0.7048 - val_loss: 0.5587 - val_acc: 0.8210
Epoch 2/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.4271 - acc: 0.8634 - val_loss: 0.2504 - val_acc: 0.9177
Epoch 3/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.3161 - acc: 0.8998 - val_loss: 0.1861 - val_acc: 0.9404
Epoch 4/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.2683 - acc: 0.9166 - val_loss: 0.1761 - val_acc: 0.9443
Epoch 5/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.2364 - acc: 0.9269 - val_loss: 0.1852 - val_acc: 0.9444
Epoch 6/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.2090 - acc: 0.9355 - val_loss: 0.1601 - val_acc: 0.9502
Epoch 7/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1950 - acc: 0.9402 - val_loss: 0.1850 - val_acc: 0.9412
Epoch 8/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1891 - acc: 0.9423 - val_loss: 0.1611 - val_acc: 0.9526
Epoch 9/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1833 - acc: 0.9451 - val_loss: 0.1660 - val_acc: 0.9523
Epoch 10/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1792 - acc: 0.9470 - val_loss: 0.1586 - val_acc: 0.9504
Epoch 11/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1722 - acc: 0.9483 - val_loss: 0.1200 - val_acc: 0.9650
Epoch 12/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1674 - acc: 0.9519 - val_loss: 0.1194 - val_acc: 0.9626
Epoch 13/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1688 - acc: 0.9509 - val_loss: 0.1152 - val_acc: 0.9674
Epoch 14/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1663 - acc: 0.9513 - val_loss: 0.2033 - val_acc: 0.9409
Epoch 15/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1650 - acc: 0.9526 - val_loss: 0.0894 - val_acc: 0.9746
Epoch 16/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1638 - acc: 0.9538 - val_loss: 0.1296 - val_acc: 0.9606
Epoch 17/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1639 - acc: 0.9533 - val_loss: 0.1018 - val_acc: 0.9683
Epoch 18/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1648 - acc: 0.9536 - val_loss: 0.1006 - val_acc: 0.9702
Epoch 19/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1645 - acc: 0.9541 - val_loss: 0.2029 - val_acc: 0.9356
Epoch 20/20
60000/60000 [==============================] - 6s 103us/step - loss: 0.1641 - acc: 0.9551 - val_loss: 0.1012 - val_acc: 0.9699
10000/10000 [==============================] - 1s 116us/step
Test loss: 0.10228100982488249
Test accuracy: 0.9693
Iteration: 8
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 10s 162us/step - loss: 0.9176 - acc: 0.7023 - val_loss: 0.5980 - val_acc: 0.8018
Epoch 2/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.4365 - acc: 0.8602 - val_loss: 0.2641 - val_acc: 0.9153
Epoch 3/20
60000/60000 [==============================] - 9s 156us/step - loss: 0.3274 - acc: 0.8966 - val_loss: 0.2486 - val_acc: 0.9209
Epoch 4/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.2696 - acc: 0.9158 - val_loss: 0.2543 - val_acc: 0.9216
Epoch 5/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.2376 - acc: 0.9258 - val_loss: 0.1791 - val_acc: 0.9439
Epoch 6/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.2158 - acc: 0.9329 - val_loss: 0.1653 - val_acc: 0.9491
Epoch 7/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.2003 - acc: 0.9388 - val_loss: 0.1568 - val_acc: 0.9529
Epoch 8/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1919 - acc: 0.9405 - val_loss: 0.1774 - val_acc: 0.9452
Epoch 9/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1855 - acc: 0.9440 - val_loss: 0.1128 - val_acc: 0.9651
Epoch 10/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1764 - acc: 0.9469 - val_loss: 0.1347 - val_acc: 0.9577
Epoch 11/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1714 - acc: 0.9485 - val_loss: 0.1522 - val_acc: 0.9542
Epoch 12/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1681 - acc: 0.9504 - val_loss: 0.1325 - val_acc: 0.9608
Epoch 13/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1662 - acc: 0.9513 - val_loss: 0.1423 - val_acc: 0.9543
Epoch 14/20
60000/60000 [==============================] - 9s 156us/step - loss: 0.1638 - acc: 0.9527 - val_loss: 0.1134 - val_acc: 0.9664
Epoch 15/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1645 - acc: 0.9519 - val_loss: 0.0984 - val_acc: 0.9688
Epoch 16/20
60000/60000 [==============================] - 9s 156us/step - loss: 0.1654 - acc: 0.9519 - val_loss: 0.1172 - val_acc: 0.9687
Epoch 17/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1625 - acc: 0.9532 - val_loss: 0.1655 - val_acc: 0.9535
Epoch 18/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1595 - acc: 0.9553 - val_loss: 0.1494 - val_acc: 0.9594
Epoch 19/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1603 - acc: 0.9548 - val_loss: 0.1094 - val_acc: 0.9680
Epoch 20/20
60000/60000 [==============================] - 9s 155us/step - loss: 0.1602 - acc: 0.9552 - val_loss: 0.0974 - val_acc: 0.9730
10000/10000 [==============================] - 2s 165us/step
Test loss: 0.09657279967218638
Test accuracy: 0.9732
Iteration: 9
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 15s 253us/step - loss: 0.9305 - acc: 0.6996 - val_loss: 0.5512 - val_acc: 0.8147
Epoch 2/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.4348 - acc: 0.8628 - val_loss: 0.3988 - val_acc: 0.8737
Epoch 3/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.3212 - acc: 0.8988 - val_loss: 0.2121 - val_acc: 0.9346
Epoch 4/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.2652 - acc: 0.9165 - val_loss: 0.2656 - val_acc: 0.9207
Epoch 5/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.2355 - acc: 0.9257 - val_loss: 0.1760 - val_acc: 0.9355
Epoch 6/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.2186 - acc: 0.9336 - val_loss: 0.1672 - val_acc: 0.9469
Epoch 7/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.2023 - acc: 0.9381 - val_loss: 0.1149 - val_acc: 0.9645
Epoch 8/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.1912 - acc: 0.9420 - val_loss: 0.1155 - val_acc: 0.9630
Epoch 9/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.1822 - acc: 0.9447 - val_loss: 0.1432 - val_acc: 0.9538
Epoch 10/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.1758 - acc: 0.9473 - val_loss: 0.1147 - val_acc: 0.9632
Epoch 11/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1742 - acc: 0.9473 - val_loss: 0.1513 - val_acc: 0.9538
Epoch 12/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1727 - acc: 0.9488 - val_loss: 0.1095 - val_acc: 0.9675
Epoch 13/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1663 - acc: 0.9511 - val_loss: 0.0974 - val_acc: 0.9697
Epoch 14/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1671 - acc: 0.9507 - val_loss: 0.1112 - val_acc: 0.9657
Epoch 15/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1688 - acc: 0.9516 - val_loss: 0.1660 - val_acc: 0.9511
Epoch 16/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.1638 - acc: 0.9517 - val_loss: 0.1652 - val_acc: 0.9486
Epoch 17/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1643 - acc: 0.9529 - val_loss: 0.1202 - val_acc: 0.9649
Epoch 18/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1628 - acc: 0.9537 - val_loss: 0.1188 - val_acc: 0.9648
Epoch 19/20
60000/60000 [==============================] - 15s 245us/step - loss: 0.1598 - acc: 0.9545 - val_loss: 0.1302 - val_acc: 0.9654
Epoch 20/20
60000/60000 [==============================] - 15s 244us/step - loss: 0.1651 - acc: 0.9535 - val_loss: 0.0891 - val_acc: 0.9748
10000/10000 [==============================] - 3s 262us/step
Test loss: 0.0890346237821097
Test accuracy: 0.9751
Iteration: 10
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
60000/60000 [==============================] - 26s 440us/step - loss: 0.9278 - acc: 0.7014 - val_loss: 0.4834 - val_acc: 0.8512
Epoch 2/20
60000/60000 [==============================] - 26s 432us/step - loss: 0.4286 - acc: 0.8621 - val_loss: 0.2666 - val_acc: 0.9144
Epoch 3/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.3197 - acc: 0.8988 - val_loss: 0.2668 - val_acc: 0.9167
Epoch 4/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.2679 - acc: 0.9165 - val_loss: 0.1701 - val_acc: 0.9485
Epoch 5/20
60000/60000 [==============================] - 26s 430us/step - loss: 0.2338 - acc: 0.9274 - val_loss: 0.1719 - val_acc: 0.9454
Epoch 6/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.2181 - acc: 0.9327 - val_loss: 0.1862 - val_acc: 0.9404
Epoch 7/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1971 - acc: 0.9398 - val_loss: 0.1786 - val_acc: 0.9421
Epoch 8/20
60000/60000 [==============================] - 26s 432us/step - loss: 0.1866 - acc: 0.9420 - val_loss: 0.1104 - val_acc: 0.9661
Epoch 9/20
60000/60000 [==============================] - 26s 432us/step - loss: 0.1802 - acc: 0.9451 - val_loss: 0.1843 - val_acc: 0.9453
Epoch 10/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1763 - acc: 0.9477 - val_loss: 0.1228 - val_acc: 0.9625
Epoch 11/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1705 - acc: 0.9492 - val_loss: 0.1032 - val_acc: 0.9673
Epoch 12/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1687 - acc: 0.9496 - val_loss: 0.1079 - val_acc: 0.9669
Epoch 13/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1674 - acc: 0.9501 - val_loss: 0.1075 - val_acc: 0.9686
Epoch 14/20
60000/60000 [==============================] - 26s 432us/step - loss: 0.1639 - acc: 0.9531 - val_loss: 0.1378 - val_acc: 0.9594
Epoch 15/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1583 - acc: 0.9543 - val_loss: 0.1205 - val_acc: 0.9640
Epoch 16/20
60000/60000 [==============================] - 26s 432us/step - loss: 0.1575 - acc: 0.9549 - val_loss: 0.1093 - val_acc: 0.9680
Epoch 17/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1613 - acc: 0.9542 - val_loss: 0.2051 - val_acc: 0.9453
Epoch 18/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1586 - acc: 0.9551 - val_loss: 0.1422 - val_acc: 0.9566
Epoch 19/20
60000/60000 [==============================] - 26s 432us/step - loss: 0.1582 - acc: 0.9552 - val_loss: 0.1459 - val_acc: 0.9556
Epoch 20/20
60000/60000 [==============================] - 26s 431us/step - loss: 0.1615 - acc: 0.9563 - val_loss: 0.0901 - val_acc: 0.9748
10000/10000 [==============================] - 4s 441us/step
Test loss: 0.09042469613276771
Test accuracy: 0.9741
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9601 - acc: 0.6898 - val_loss: 0.4192 - val_acc: 0.8630
Epoch 2/20
 - 3s - loss: 0.4597 - acc: 0.8534 - val_loss: 0.6665 - val_acc: 0.7842
Epoch 3/20
 - 3s - loss: 0.3547 - acc: 0.8869 - val_loss: 0.2697 - val_acc: 0.9174
Epoch 4/20
 - 3s - loss: 0.2961 - acc: 0.9073 - val_loss: 0.3048 - val_acc: 0.9020
Epoch 5/20
 - 3s - loss: 0.2621 - acc: 0.9175 - val_loss: 0.1900 - val_acc: 0.9389
Epoch 6/20
 - 3s - loss: 0.2449 - acc: 0.9242 - val_loss: 0.2002 - val_acc: 0.9365
Epoch 7/20
 - 3s - loss: 0.2301 - acc: 0.9296 - val_loss: 0.1754 - val_acc: 0.9462
Epoch 8/20
 - 3s - loss: 0.2205 - acc: 0.9325 - val_loss: 0.1728 - val_acc: 0.9430
Epoch 9/20
 - 3s - loss: 0.2123 - acc: 0.9351 - val_loss: 0.1333 - val_acc: 0.9589
Epoch 10/20
 - 3s - loss: 0.2101 - acc: 0.9371 - val_loss: 0.1489 - val_acc: 0.9523
Epoch 11/20
 - 3s - loss: 0.2043 - acc: 0.9384 - val_loss: 0.1652 - val_acc: 0.9478
Epoch 12/20
 - 3s - loss: 0.2013 - acc: 0.9393 - val_loss: 0.1296 - val_acc: 0.9580
Epoch 13/20
 - 3s - loss: 0.1967 - acc: 0.9407 - val_loss: 0.1538 - val_acc: 0.9553
Epoch 14/20
 - 3s - loss: 0.1986 - acc: 0.9422 - val_loss: 0.2010 - val_acc: 0.9452
Epoch 15/20
 - 3s - loss: 0.1946 - acc: 0.9430 - val_loss: 0.1635 - val_acc: 0.9562
Epoch 16/20
 - 3s - loss: 0.1973 - acc: 0.9425 - val_loss: 0.1379 - val_acc: 0.9575
Epoch 17/20
 - 3s - loss: 0.1966 - acc: 0.9438 - val_loss: 0.1462 - val_acc: 0.9558
Epoch 18/20
 - 3s - loss: 0.1994 - acc: 0.9434 - val_loss: 0.1305 - val_acc: 0.9627
Epoch 19/20
 - 3s - loss: 0.2001 - acc: 0.9437 - val_loss: 0.1434 - val_acc: 0.9567
Epoch 20/20
 - 3s - loss: 0.1968 - acc: 0.9456 - val_loss: 0.1581 - val_acc: 0.9576
Test loss: 0.15827259680436692
Test accuracy: 0.956
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9511 - acc: 0.6982 - val_loss: 0.3387 - val_acc: 0.8979
Epoch 2/20
 - 3s - loss: 0.4433 - acc: 0.8584 - val_loss: 0.2783 - val_acc: 0.9071
Epoch 3/20
 - 3s - loss: 0.3334 - acc: 0.8938 - val_loss: 0.1996 - val_acc: 0.9407
Epoch 4/20
 - 3s - loss: 0.2808 - acc: 0.9127 - val_loss: 0.2004 - val_acc: 0.9351
Epoch 5/20
 - 3s - loss: 0.2483 - acc: 0.9221 - val_loss: 0.1707 - val_acc: 0.9463
Epoch 6/20
 - 3s - loss: 0.2311 - acc: 0.9290 - val_loss: 0.1933 - val_acc: 0.9386
Epoch 7/20
 - 3s - loss: 0.2169 - acc: 0.9346 - val_loss: 0.1520 - val_acc: 0.9546
Epoch 8/20
 - 3s - loss: 0.2041 - acc: 0.9378 - val_loss: 0.1402 - val_acc: 0.9573
Epoch 9/20
 - 3s - loss: 0.1988 - acc: 0.9396 - val_loss: 0.1258 - val_acc: 0.9592
Epoch 10/20
 - 3s - loss: 0.1935 - acc: 0.9416 - val_loss: 0.1139 - val_acc: 0.9657
Epoch 11/20
 - 3s - loss: 0.1874 - acc: 0.9448 - val_loss: 0.1304 - val_acc: 0.9627
Epoch 12/20
 - 3s - loss: 0.1881 - acc: 0.9452 - val_loss: 0.1195 - val_acc: 0.9647
Epoch 13/20
 - 3s - loss: 0.1806 - acc: 0.9456 - val_loss: 0.1195 - val_acc: 0.9650
Epoch 14/20
 - 3s - loss: 0.1822 - acc: 0.9468 - val_loss: 0.1120 - val_acc: 0.9676
Epoch 15/20
 - 3s - loss: 0.1792 - acc: 0.9481 - val_loss: 0.1403 - val_acc: 0.9593
Epoch 16/20
 - 3s - loss: 0.1850 - acc: 0.9486 - val_loss: 0.1277 - val_acc: 0.9612
Epoch 17/20
 - 3s - loss: 0.1767 - acc: 0.9499 - val_loss: 0.1569 - val_acc: 0.9597
Epoch 18/20
 - 3s - loss: 0.1816 - acc: 0.9494 - val_loss: 0.1081 - val_acc: 0.9677
Epoch 19/20
 - 3s - loss: 0.1790 - acc: 0.9503 - val_loss: 0.1308 - val_acc: 0.9637
Epoch 20/20
 - 3s - loss: 0.1823 - acc: 0.9486 - val_loss: 0.1237 - val_acc: 0.9639
Test loss: 0.12565233369964407
Test accuracy: 0.9617
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9525 - acc: 0.6969 - val_loss: 0.3750 - val_acc: 0.8775
Epoch 2/20
 - 3s - loss: 0.4348 - acc: 0.8608 - val_loss: 0.3401 - val_acc: 0.8897
Epoch 3/20
 - 3s - loss: 0.3204 - acc: 0.8991 - val_loss: 0.2643 - val_acc: 0.9114
Epoch 4/20
 - 3s - loss: 0.2703 - acc: 0.9148 - val_loss: 0.1944 - val_acc: 0.9403
Epoch 5/20
 - 3s - loss: 0.2367 - acc: 0.9279 - val_loss: 0.2346 - val_acc: 0.9230
Epoch 6/20
 - 3s - loss: 0.2199 - acc: 0.9336 - val_loss: 0.3795 - val_acc: 0.8851
Epoch 7/20
 - 3s - loss: 0.2031 - acc: 0.9366 - val_loss: 0.1777 - val_acc: 0.9445
Epoch 8/20
 - 3s - loss: 0.1927 - acc: 0.9413 - val_loss: 0.2278 - val_acc: 0.9278
Epoch 9/20
 - 3s - loss: 0.1875 - acc: 0.9436 - val_loss: 0.1368 - val_acc: 0.9575
Epoch 10/20
 - 3s - loss: 0.1855 - acc: 0.9456 - val_loss: 0.1474 - val_acc: 0.9546
Epoch 11/20
 - 3s - loss: 0.1805 - acc: 0.9482 - val_loss: 0.1911 - val_acc: 0.9411
Epoch 12/20
 - 3s - loss: 0.1759 - acc: 0.9484 - val_loss: 0.1225 - val_acc: 0.9636
Epoch 13/20
 - 3s - loss: 0.1773 - acc: 0.9485 - val_loss: 0.1230 - val_acc: 0.9622
Epoch 14/20
 - 3s - loss: 0.1725 - acc: 0.9512 - val_loss: 0.1077 - val_acc: 0.9674
Epoch 15/20
 - 3s - loss: 0.1737 - acc: 0.9494 - val_loss: 0.1122 - val_acc: 0.9674
Epoch 16/20
 - 3s - loss: 0.1726 - acc: 0.9522 - val_loss: 0.0972 - val_acc: 0.9726
Epoch 17/20
 - 3s - loss: 0.1718 - acc: 0.9516 - val_loss: 0.1525 - val_acc: 0.9582
Epoch 18/20
 - 3s - loss: 0.1739 - acc: 0.9518 - val_loss: 0.1089 - val_acc: 0.9684
Epoch 19/20
 - 3s - loss: 0.1746 - acc: 0.9515 - val_loss: 0.1321 - val_acc: 0.9668
Epoch 20/20
 - 3s - loss: 0.1720 - acc: 0.9526 - val_loss: 0.1032 - val_acc: 0.9701
Test loss: 0.10244375236032648
Test accuracy: 0.9713
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9353 - acc: 0.6999 - val_loss: 0.3882 - val_acc: 0.8754
Epoch 2/20
 - 3s - loss: 0.4392 - acc: 0.8601 - val_loss: 0.2602 - val_acc: 0.9148
Epoch 3/20
 - 3s - loss: 0.3288 - acc: 0.8946 - val_loss: 0.2533 - val_acc: 0.9218
Epoch 4/20
 - 3s - loss: 0.2742 - acc: 0.9137 - val_loss: 0.2062 - val_acc: 0.9329
Epoch 5/20
 - 3s - loss: 0.2444 - acc: 0.9248 - val_loss: 0.1701 - val_acc: 0.9461
Epoch 6/20
 - 3s - loss: 0.2175 - acc: 0.9317 - val_loss: 0.2028 - val_acc: 0.9379
Epoch 7/20
 - 3s - loss: 0.2036 - acc: 0.9383 - val_loss: 0.1350 - val_acc: 0.9584
Epoch 8/20
 - 3s - loss: 0.1924 - acc: 0.9417 - val_loss: 0.1321 - val_acc: 0.9598
Epoch 9/20
 - 3s - loss: 0.1882 - acc: 0.9426 - val_loss: 0.1502 - val_acc: 0.9584
Epoch 10/20
 - 3s - loss: 0.1829 - acc: 0.9456 - val_loss: 0.1335 - val_acc: 0.9597
Epoch 11/20
 - 3s - loss: 0.1737 - acc: 0.9478 - val_loss: 0.1536 - val_acc: 0.9541
Epoch 12/20
 - 3s - loss: 0.1727 - acc: 0.9489 - val_loss: 0.1060 - val_acc: 0.9697
Epoch 13/20
 - 3s - loss: 0.1689 - acc: 0.9497 - val_loss: 0.1072 - val_acc: 0.9676
Epoch 14/20
 - 3s - loss: 0.1676 - acc: 0.9508 - val_loss: 0.1066 - val_acc: 0.9672
Epoch 15/20
 - 3s - loss: 0.1689 - acc: 0.9513 - val_loss: 0.1005 - val_acc: 0.9690
Epoch 16/20
 - 3s - loss: 0.1683 - acc: 0.9518 - val_loss: 0.1229 - val_acc: 0.9619
Epoch 17/20
 - 3s - loss: 0.1697 - acc: 0.9526 - val_loss: 0.1468 - val_acc: 0.9515
Epoch 18/20
 - 3s - loss: 0.1680 - acc: 0.9521 - val_loss: 0.0976 - val_acc: 0.9721
Epoch 19/20
 - 3s - loss: 0.1610 - acc: 0.9545 - val_loss: 0.1106 - val_acc: 0.9676
Epoch 20/20
 - 3s - loss: 0.1653 - acc: 0.9541 - val_loss: 0.1367 - val_acc: 0.9604
Test loss: 0.1338853458228754
Test accuracy: 0.9609
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9262 - acc: 0.6999 - val_loss: 0.7130 - val_acc: 0.7544
Epoch 2/20
 - 4s - loss: 0.4228 - acc: 0.8643 - val_loss: 0.2888 - val_acc: 0.9074
Epoch 3/20
 - 4s - loss: 0.3177 - acc: 0.8990 - val_loss: 0.2284 - val_acc: 0.9293
Epoch 4/20
 - 4s - loss: 0.2644 - acc: 0.9185 - val_loss: 0.3136 - val_acc: 0.9007
Epoch 5/20
 - 4s - loss: 0.2341 - acc: 0.9277 - val_loss: 0.1650 - val_acc: 0.9509
Epoch 6/20
 - 4s - loss: 0.2186 - acc: 0.9322 - val_loss: 0.1803 - val_acc: 0.9437
Epoch 7/20
 - 4s - loss: 0.2001 - acc: 0.9392 - val_loss: 0.1270 - val_acc: 0.9590
Epoch 8/20
 - 4s - loss: 0.1882 - acc: 0.9432 - val_loss: 0.1099 - val_acc: 0.9652
Epoch 9/20
 - 4s - loss: 0.1819 - acc: 0.9451 - val_loss: 0.1287 - val_acc: 0.9635
Epoch 10/20
 - 4s - loss: 0.1791 - acc: 0.9471 - val_loss: 0.1422 - val_acc: 0.9581
Epoch 11/20
 - 4s - loss: 0.1731 - acc: 0.9486 - val_loss: 0.1083 - val_acc: 0.9667
Epoch 12/20
 - 4s - loss: 0.1721 - acc: 0.9507 - val_loss: 0.1098 - val_acc: 0.9662
Epoch 13/20
 - 4s - loss: 0.1708 - acc: 0.9508 - val_loss: 0.1385 - val_acc: 0.9604
Epoch 14/20
 - 4s - loss: 0.1665 - acc: 0.9522 - val_loss: 0.1271 - val_acc: 0.9626
Epoch 15/20
 - 4s - loss: 0.1683 - acc: 0.9521 - val_loss: 0.1014 - val_acc: 0.9708
Epoch 16/20
 - 4s - loss: 0.1670 - acc: 0.9532 - val_loss: 0.1492 - val_acc: 0.9598
Epoch 17/20
 - 4s - loss: 0.1649 - acc: 0.9539 - val_loss: 0.1059 - val_acc: 0.9724
Epoch 18/20
 - 4s - loss: 0.1657 - acc: 0.9544 - val_loss: 0.0948 - val_acc: 0.9730
Epoch 19/20
 - 4s - loss: 0.1695 - acc: 0.9526 - val_loss: 0.1088 - val_acc: 0.9697
Epoch 20/20
 - 4s - loss: 0.1650 - acc: 0.9554 - val_loss: 0.1095 - val_acc: 0.9704
Test loss: 0.11050219150100456
Test accuracy: 0.9701
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9365 - acc: 0.6950 - val_loss: 0.3758 - val_acc: 0.8800
Epoch 2/20
 - 4s - loss: 0.4214 - acc: 0.8645 - val_loss: 0.4905 - val_acc: 0.8505
Epoch 3/20
 - 4s - loss: 0.3159 - acc: 0.9005 - val_loss: 0.2363 - val_acc: 0.9263
Epoch 4/20
 - 4s - loss: 0.2653 - acc: 0.9173 - val_loss: 0.1751 - val_acc: 0.9475
Epoch 5/20
 - 4s - loss: 0.2371 - acc: 0.9276 - val_loss: 0.2356 - val_acc: 0.9218
Epoch 6/20
 - 4s - loss: 0.2167 - acc: 0.9329 - val_loss: 0.1712 - val_acc: 0.9511
Epoch 7/20
 - 4s - loss: 0.1994 - acc: 0.9383 - val_loss: 0.1510 - val_acc: 0.9533
Epoch 8/20
 - 4s - loss: 0.1924 - acc: 0.9414 - val_loss: 0.1656 - val_acc: 0.9461
Epoch 9/20
 - 4s - loss: 0.1859 - acc: 0.9436 - val_loss: 0.1354 - val_acc: 0.9604
Epoch 10/20
 - 4s - loss: 0.1791 - acc: 0.9466 - val_loss: 0.1177 - val_acc: 0.9662
Epoch 11/20
 - 4s - loss: 0.1739 - acc: 0.9476 - val_loss: 0.1175 - val_acc: 0.9667
Epoch 12/20
 - 4s - loss: 0.1708 - acc: 0.9496 - val_loss: 0.1148 - val_acc: 0.9665
Epoch 13/20
 - 4s - loss: 0.1678 - acc: 0.9518 - val_loss: 0.1399 - val_acc: 0.9586
Epoch 14/20
 - 4s - loss: 0.1630 - acc: 0.9533 - val_loss: 0.1232 - val_acc: 0.9622
Epoch 15/20
 - 4s - loss: 0.1661 - acc: 0.9521 - val_loss: 0.0992 - val_acc: 0.9707
Epoch 16/20
 - 4s - loss: 0.1653 - acc: 0.9529 - val_loss: 0.1202 - val_acc: 0.9683
Epoch 17/20
 - 4s - loss: 0.1658 - acc: 0.9538 - val_loss: 0.2081 - val_acc: 0.9442
Epoch 18/20
 - 4s - loss: 0.1670 - acc: 0.9530 - val_loss: 0.1070 - val_acc: 0.9709
Epoch 19/20
 - 4s - loss: 0.1616 - acc: 0.9553 - val_loss: 0.1166 - val_acc: 0.9714
Epoch 20/20
 - 4s - loss: 0.1726 - acc: 0.9524 - val_loss: 0.1634 - val_acc: 0.9568
Test loss: 0.16372077407138422
Test accuracy: 0.9579
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9241 - acc: 0.7012 - val_loss: 0.3030 - val_acc: 0.9123
Epoch 2/20
 - 6s - loss: 0.4310 - acc: 0.8624 - val_loss: 0.2816 - val_acc: 0.9085
Epoch 3/20
 - 6s - loss: 0.3197 - acc: 0.8995 - val_loss: 0.2495 - val_acc: 0.9207
Epoch 4/20
 - 6s - loss: 0.2632 - acc: 0.9171 - val_loss: 0.2374 - val_acc: 0.9240
Epoch 5/20
 - 6s - loss: 0.2353 - acc: 0.9264 - val_loss: 0.1859 - val_acc: 0.9391
Epoch 6/20
 - 6s - loss: 0.2155 - acc: 0.9333 - val_loss: 0.1798 - val_acc: 0.9410
Epoch 7/20
 - 6s - loss: 0.2020 - acc: 0.9375 - val_loss: 0.1330 - val_acc: 0.9596
Epoch 8/20
 - 6s - loss: 0.1872 - acc: 0.9421 - val_loss: 0.1486 - val_acc: 0.9515
Epoch 9/20
 - 6s - loss: 0.1824 - acc: 0.9445 - val_loss: 0.0955 - val_acc: 0.9702
Epoch 10/20
 - 6s - loss: 0.1785 - acc: 0.9456 - val_loss: 0.0984 - val_acc: 0.9689
Epoch 11/20
 - 6s - loss: 0.1714 - acc: 0.9482 - val_loss: 0.1255 - val_acc: 0.9595
Epoch 12/20
 - 6s - loss: 0.1704 - acc: 0.9500 - val_loss: 0.0997 - val_acc: 0.9690
Epoch 13/20
 - 6s - loss: 0.1654 - acc: 0.9517 - val_loss: 0.2136 - val_acc: 0.9426
Epoch 14/20
 - 6s - loss: 0.1632 - acc: 0.9521 - val_loss: 0.1041 - val_acc: 0.9706
Epoch 15/20
 - 6s - loss: 0.1631 - acc: 0.9519 - val_loss: 0.1216 - val_acc: 0.9667
Epoch 16/20
 - 6s - loss: 0.1656 - acc: 0.9532 - val_loss: 0.1044 - val_acc: 0.9682
Epoch 17/20
 - 6s - loss: 0.1643 - acc: 0.9529 - val_loss: 0.1158 - val_acc: 0.9669
Epoch 18/20
 - 6s - loss: 0.1637 - acc: 0.9531 - val_loss: 0.1022 - val_acc: 0.9714
Epoch 19/20
 - 6s - loss: 0.1588 - acc: 0.9543 - val_loss: 0.1041 - val_acc: 0.9712
Epoch 20/20
 - 6s - loss: 0.1599 - acc: 0.9548 - val_loss: 0.1932 - val_acc: 0.9429
Test loss: 0.19279321130104363
Test accuracy: 0.9433
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9570 - acc: 0.6945 - val_loss: 0.4420 - val_acc: 0.8518
Epoch 2/20
 - 9s - loss: 0.4447 - acc: 0.8576 - val_loss: 0.4931 - val_acc: 0.8423
Epoch 3/20
 - 9s - loss: 0.3256 - acc: 0.8962 - val_loss: 0.2358 - val_acc: 0.9248
Epoch 4/20
 - 9s - loss: 0.2769 - acc: 0.9130 - val_loss: 0.1934 - val_acc: 0.9376
Epoch 5/20
 - 9s - loss: 0.2405 - acc: 0.9249 - val_loss: 0.2025 - val_acc: 0.9297
Epoch 6/20
 - 9s - loss: 0.2179 - acc: 0.9323 - val_loss: 0.3504 - val_acc: 0.8925
Epoch 7/20
 - 9s - loss: 0.2051 - acc: 0.9371 - val_loss: 0.1404 - val_acc: 0.9556
Epoch 8/20
 - 9s - loss: 0.1908 - acc: 0.9413 - val_loss: 0.1240 - val_acc: 0.9590
Epoch 9/20
 - 9s - loss: 0.1832 - acc: 0.9441 - val_loss: 0.1308 - val_acc: 0.9591
Epoch 10/20
 - 9s - loss: 0.1790 - acc: 0.9452 - val_loss: 0.1197 - val_acc: 0.9616
Epoch 11/20
 - 9s - loss: 0.1725 - acc: 0.9490 - val_loss: 0.0992 - val_acc: 0.9696
Epoch 12/20
 - 9s - loss: 0.1706 - acc: 0.9494 - val_loss: 0.1154 - val_acc: 0.9672
Epoch 13/20
 - 9s - loss: 0.1662 - acc: 0.9513 - val_loss: 0.1075 - val_acc: 0.9676
Epoch 14/20
 - 9s - loss: 0.1659 - acc: 0.9520 - val_loss: 0.0976 - val_acc: 0.9720
Epoch 15/20
 - 9s - loss: 0.1623 - acc: 0.9516 - val_loss: 0.1440 - val_acc: 0.9630
Epoch 16/20
 - 9s - loss: 0.1622 - acc: 0.9534 - val_loss: 0.1092 - val_acc: 0.9672
Epoch 17/20
 - 9s - loss: 0.1620 - acc: 0.9530 - val_loss: 0.1052 - val_acc: 0.9717
Epoch 18/20
 - 9s - loss: 0.1609 - acc: 0.9552 - val_loss: 0.0995 - val_acc: 0.9695
Epoch 19/20
 - 9s - loss: 0.1654 - acc: 0.9540 - val_loss: 0.1159 - val_acc: 0.9681
Epoch 20/20
 - 9s - loss: 0.1653 - acc: 0.9539 - val_loss: 0.1089 - val_acc: 0.9708
Test loss: 0.1088128426135343
Test accuracy: 0.9711
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9441 - acc: 0.6997 - val_loss: 0.5896 - val_acc: 0.8044
Epoch 2/20
 - 14s - loss: 0.4374 - acc: 0.8612 - val_loss: 0.2371 - val_acc: 0.9239
Epoch 3/20
 - 14s - loss: 0.3217 - acc: 0.8980 - val_loss: 0.1837 - val_acc: 0.9430
Epoch 4/20
 - 14s - loss: 0.2673 - acc: 0.9143 - val_loss: 0.1519 - val_acc: 0.9526
Epoch 5/20
 - 14s - loss: 0.2331 - acc: 0.9284 - val_loss: 0.1881 - val_acc: 0.9406
Epoch 6/20
 - 14s - loss: 0.2134 - acc: 0.9330 - val_loss: 0.1766 - val_acc: 0.9427
Epoch 7/20
 - 14s - loss: 0.2027 - acc: 0.9389 - val_loss: 0.1665 - val_acc: 0.9505
Epoch 8/20
 - 14s - loss: 0.1897 - acc: 0.9423 - val_loss: 0.1387 - val_acc: 0.9567
Epoch 9/20
 - 14s - loss: 0.1848 - acc: 0.9443 - val_loss: 0.2480 - val_acc: 0.9306
Epoch 10/20
 - 14s - loss: 0.1756 - acc: 0.9477 - val_loss: 0.1185 - val_acc: 0.9632
Epoch 11/20
 - 15s - loss: 0.1727 - acc: 0.9486 - val_loss: 0.1108 - val_acc: 0.9687
Epoch 12/20
 - 14s - loss: 0.1678 - acc: 0.9496 - val_loss: 0.1392 - val_acc: 0.9620
Epoch 13/20
 - 14s - loss: 0.1678 - acc: 0.9507 - val_loss: 0.0990 - val_acc: 0.9711
Epoch 14/20
 - 14s - loss: 0.1618 - acc: 0.9527 - val_loss: 0.0909 - val_acc: 0.9738
Epoch 15/20
 - 14s - loss: 0.1625 - acc: 0.9533 - val_loss: 0.1351 - val_acc: 0.9604
Epoch 16/20
 - 14s - loss: 0.1642 - acc: 0.9519 - val_loss: 0.1362 - val_acc: 0.9610
Epoch 17/20
 - 15s - loss: 0.1635 - acc: 0.9545 - val_loss: 0.1107 - val_acc: 0.9690
Epoch 18/20
 - 15s - loss: 0.1629 - acc: 0.9536 - val_loss: 0.1306 - val_acc: 0.9631
Epoch 19/20
 - 14s - loss: 0.1593 - acc: 0.9549 - val_loss: 0.1134 - val_acc: 0.9670
Epoch 20/20
 - 14s - loss: 0.1613 - acc: 0.9559 - val_loss: 0.1722 - val_acc: 0.9571
Test loss: 0.17251976943319897
Test accuracy: 0.9574
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9205 - acc: 0.7030 - val_loss: 0.2908 - val_acc: 0.9104
Epoch 2/20
 - 26s - loss: 0.4322 - acc: 0.8611 - val_loss: 0.2319 - val_acc: 0.9282
Epoch 3/20
 - 26s - loss: 0.3199 - acc: 0.8988 - val_loss: 0.2176 - val_acc: 0.9273
Epoch 4/20
 - 26s - loss: 0.2668 - acc: 0.9167 - val_loss: 0.1788 - val_acc: 0.9440
Epoch 5/20
 - 26s - loss: 0.2377 - acc: 0.9260 - val_loss: 0.1634 - val_acc: 0.9461
Epoch 6/20
 - 26s - loss: 0.2154 - acc: 0.9343 - val_loss: 0.1481 - val_acc: 0.9545
Epoch 7/20
 - 26s - loss: 0.1993 - acc: 0.9390 - val_loss: 0.1347 - val_acc: 0.9586
Epoch 8/20
 - 26s - loss: 0.1932 - acc: 0.9418 - val_loss: 0.1424 - val_acc: 0.9558
Epoch 9/20
 - 26s - loss: 0.1826 - acc: 0.9448 - val_loss: 0.2510 - val_acc: 0.9268
Epoch 10/20
 - 26s - loss: 0.1789 - acc: 0.9464 - val_loss: 0.1122 - val_acc: 0.9656
Epoch 11/20
 - 26s - loss: 0.1703 - acc: 0.9506 - val_loss: 0.1200 - val_acc: 0.9647
Epoch 12/20
 - 26s - loss: 0.1705 - acc: 0.9494 - val_loss: 0.2072 - val_acc: 0.9382
Epoch 13/20
 - 26s - loss: 0.1664 - acc: 0.9517 - val_loss: 0.1816 - val_acc: 0.9483
Epoch 14/20
 - 26s - loss: 0.1652 - acc: 0.9512 - val_loss: 0.1108 - val_acc: 0.9685
Epoch 15/20
 - 26s - loss: 0.1681 - acc: 0.9514 - val_loss: 0.1316 - val_acc: 0.9635
Epoch 16/20
 - 26s - loss: 0.1637 - acc: 0.9538 - val_loss: 0.0876 - val_acc: 0.9746
Epoch 17/20
 - 26s - loss: 0.1631 - acc: 0.9526 - val_loss: 0.1469 - val_acc: 0.9581
Epoch 18/20
 - 26s - loss: 0.1636 - acc: 0.9538 - val_loss: 0.1012 - val_acc: 0.9693
Epoch 19/20
 - 26s - loss: 0.1646 - acc: 0.9534 - val_loss: 0.1311 - val_acc: 0.9615
Epoch 20/20
 - 26s - loss: 0.1642 - acc: 0.9550 - val_loss: 0.1011 - val_acc: 0.9690
Test loss: 0.10081087387917796
Test accuracy: 0.9688
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9647 - acc: 0.6867 - val_loss: 0.8519 - val_acc: 0.7291
Epoch 2/20
 - 3s - loss: 0.4591 - acc: 0.8542 - val_loss: 0.2892 - val_acc: 0.9059
Epoch 3/20
 - 3s - loss: 0.3453 - acc: 0.8924 - val_loss: 0.2804 - val_acc: 0.9110
Epoch 4/20
 - 3s - loss: 0.2933 - acc: 0.9068 - val_loss: 0.2203 - val_acc: 0.9294
Epoch 5/20
 - 3s - loss: 0.2656 - acc: 0.9175 - val_loss: 0.2064 - val_acc: 0.9365
Epoch 6/20
 - 3s - loss: 0.2420 - acc: 0.9244 - val_loss: 0.2048 - val_acc: 0.9347
Epoch 7/20
 - 3s - loss: 0.2281 - acc: 0.9288 - val_loss: 0.2896 - val_acc: 0.9045
Epoch 8/20
 - 3s - loss: 0.2199 - acc: 0.9323 - val_loss: 0.1487 - val_acc: 0.9551
Epoch 9/20
 - 3s - loss: 0.2104 - acc: 0.9362 - val_loss: 0.1796 - val_acc: 0.9442
Epoch 10/20
 - 3s - loss: 0.2101 - acc: 0.9382 - val_loss: 0.1429 - val_acc: 0.9579
Epoch 11/20
 - 3s - loss: 0.2034 - acc: 0.9390 - val_loss: 0.1682 - val_acc: 0.9491
Epoch 12/20
 - 3s - loss: 0.2004 - acc: 0.9404 - val_loss: 0.1601 - val_acc: 0.9546
Epoch 13/20
 - 3s - loss: 0.1991 - acc: 0.9417 - val_loss: 0.1453 - val_acc: 0.9575
Epoch 14/20
 - 3s - loss: 0.1995 - acc: 0.9431 - val_loss: 0.1346 - val_acc: 0.9607
Epoch 15/20
 - 3s - loss: 0.2004 - acc: 0.9422 - val_loss: 0.1525 - val_acc: 0.9592
Epoch 16/20
 - 3s - loss: 0.1954 - acc: 0.9442 - val_loss: 0.1184 - val_acc: 0.9636
Epoch 17/20
 - 3s - loss: 0.1988 - acc: 0.9443 - val_loss: 0.1377 - val_acc: 0.9597
Epoch 18/20
 - 3s - loss: 0.1980 - acc: 0.9430 - val_loss: 0.1203 - val_acc: 0.9644
Epoch 19/20
 - 3s - loss: 0.1958 - acc: 0.9457 - val_loss: 0.1400 - val_acc: 0.9583
Epoch 20/20
 - 3s - loss: 0.2013 - acc: 0.9447 - val_loss: 0.1238 - val_acc: 0.9644
Test loss: 0.12524235132215544
Test accuracy: 0.9651
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9520 - acc: 0.6900 - val_loss: 0.4934 - val_acc: 0.8379
Epoch 2/20
 - 3s - loss: 0.4543 - acc: 0.8544 - val_loss: 0.5803 - val_acc: 0.8097
Epoch 3/20
 - 3s - loss: 0.3425 - acc: 0.8920 - val_loss: 0.2116 - val_acc: 0.9322
Epoch 4/20
 - 3s - loss: 0.2776 - acc: 0.9120 - val_loss: 0.2122 - val_acc: 0.9291
Epoch 5/20
 - 3s - loss: 0.2514 - acc: 0.9215 - val_loss: 0.1854 - val_acc: 0.9431
Epoch 6/20
 - 3s - loss: 0.2291 - acc: 0.9282 - val_loss: 0.1882 - val_acc: 0.9430
Epoch 7/20
 - 3s - loss: 0.2106 - acc: 0.9349 - val_loss: 0.2149 - val_acc: 0.9309
Epoch 8/20
 - 3s - loss: 0.2011 - acc: 0.9387 - val_loss: 0.1737 - val_acc: 0.9451
Epoch 9/20
 - 3s - loss: 0.1940 - acc: 0.9410 - val_loss: 0.1698 - val_acc: 0.9497
Epoch 10/20
 - 3s - loss: 0.1911 - acc: 0.9417 - val_loss: 0.1406 - val_acc: 0.9596
Epoch 11/20
 - 3s - loss: 0.1809 - acc: 0.9450 - val_loss: 0.1555 - val_acc: 0.9513
Epoch 12/20
 - 3s - loss: 0.1841 - acc: 0.9460 - val_loss: 0.1200 - val_acc: 0.9644
Epoch 13/20
 - 3s - loss: 0.1798 - acc: 0.9478 - val_loss: 0.1105 - val_acc: 0.9660
Epoch 14/20
 - 3s - loss: 0.1801 - acc: 0.9476 - val_loss: 0.1456 - val_acc: 0.9545
Epoch 15/20
 - 3s - loss: 0.1797 - acc: 0.9486 - val_loss: 0.1385 - val_acc: 0.9610
Epoch 16/20
 - 3s - loss: 0.1801 - acc: 0.9485 - val_loss: 0.1286 - val_acc: 0.9617
Epoch 17/20
 - 3s - loss: 0.1775 - acc: 0.9493 - val_loss: 0.1513 - val_acc: 0.9543
Epoch 18/20
 - 3s - loss: 0.1802 - acc: 0.9501 - val_loss: 0.1532 - val_acc: 0.9581
Epoch 19/20
 - 3s - loss: 0.1852 - acc: 0.9481 - val_loss: 0.1540 - val_acc: 0.9548
Epoch 20/20
 - 3s - loss: 0.1779 - acc: 0.9501 - val_loss: 0.1030 - val_acc: 0.9706
Test loss: 0.10311995477927849
Test accuracy: 0.9701
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9444 - acc: 0.6936 - val_loss: 0.6188 - val_acc: 0.8176
Epoch 2/20
 - 3s - loss: 0.4359 - acc: 0.8620 - val_loss: 0.2485 - val_acc: 0.9193
Epoch 3/20
 - 3s - loss: 0.3243 - acc: 0.8981 - val_loss: 0.2000 - val_acc: 0.9346
Epoch 4/20
 - 3s - loss: 0.2735 - acc: 0.9140 - val_loss: 0.2211 - val_acc: 0.9272
Epoch 5/20
 - 3s - loss: 0.2388 - acc: 0.9260 - val_loss: 0.1714 - val_acc: 0.9447
Epoch 6/20
 - 3s - loss: 0.2224 - acc: 0.9312 - val_loss: 0.2098 - val_acc: 0.9308
Epoch 7/20
 - 3s - loss: 0.2048 - acc: 0.9381 - val_loss: 0.1343 - val_acc: 0.9576
Epoch 8/20
 - 3s - loss: 0.1961 - acc: 0.9409 - val_loss: 0.1652 - val_acc: 0.9473
Epoch 9/20
 - 3s - loss: 0.1887 - acc: 0.9429 - val_loss: 0.1021 - val_acc: 0.9695
Epoch 10/20
 - 3s - loss: 0.1789 - acc: 0.9456 - val_loss: 0.1338 - val_acc: 0.9557
Epoch 11/20
 - 3s - loss: 0.1777 - acc: 0.9471 - val_loss: 0.1081 - val_acc: 0.9689
Epoch 12/20
 - 3s - loss: 0.1744 - acc: 0.9470 - val_loss: 0.1062 - val_acc: 0.9673
Epoch 13/20
 - 3s - loss: 0.1713 - acc: 0.9502 - val_loss: 0.1064 - val_acc: 0.9664
Epoch 14/20
 - 3s - loss: 0.1692 - acc: 0.9503 - val_loss: 0.1123 - val_acc: 0.9659
Epoch 15/20
 - 3s - loss: 0.1674 - acc: 0.9523 - val_loss: 0.1391 - val_acc: 0.9614
Epoch 16/20
 - 3s - loss: 0.1673 - acc: 0.9526 - val_loss: 0.1062 - val_acc: 0.9704
Epoch 17/20
 - 3s - loss: 0.1672 - acc: 0.9519 - val_loss: 0.0945 - val_acc: 0.9728
Epoch 18/20
 - 3s - loss: 0.1649 - acc: 0.9528 - val_loss: 0.1011 - val_acc: 0.9719
Epoch 19/20
 - 3s - loss: 0.1660 - acc: 0.9538 - val_loss: 0.1034 - val_acc: 0.9698
Epoch 20/20
 - 3s - loss: 0.1719 - acc: 0.9520 - val_loss: 0.1097 - val_acc: 0.9704
Test loss: 0.1109027185298648
Test accuracy: 0.9703
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9278 - acc: 0.7017 - val_loss: 0.3459 - val_acc: 0.8905
Epoch 2/20
 - 3s - loss: 0.4396 - acc: 0.8608 - val_loss: 0.2803 - val_acc: 0.9175
Epoch 3/20
 - 3s - loss: 0.3280 - acc: 0.8965 - val_loss: 0.1778 - val_acc: 0.9452
Epoch 4/20
 - 3s - loss: 0.2785 - acc: 0.9129 - val_loss: 0.2485 - val_acc: 0.9154
Epoch 5/20
 - 3s - loss: 0.2435 - acc: 0.9242 - val_loss: 0.1363 - val_acc: 0.9573
Epoch 6/20
 - 3s - loss: 0.2214 - acc: 0.9308 - val_loss: 0.1613 - val_acc: 0.9479
Epoch 7/20
 - 3s - loss: 0.2063 - acc: 0.9362 - val_loss: 0.1273 - val_acc: 0.9599
Epoch 8/20
 - 3s - loss: 0.1967 - acc: 0.9405 - val_loss: 0.1402 - val_acc: 0.9581
Epoch 9/20
 - 3s - loss: 0.1870 - acc: 0.9431 - val_loss: 0.1110 - val_acc: 0.9666
Epoch 10/20
 - 3s - loss: 0.1810 - acc: 0.9449 - val_loss: 0.1200 - val_acc: 0.9642
Epoch 11/20
 - 3s - loss: 0.1771 - acc: 0.9467 - val_loss: 0.1226 - val_acc: 0.9613
Epoch 12/20
 - 3s - loss: 0.1732 - acc: 0.9486 - val_loss: 0.1063 - val_acc: 0.9694
Epoch 13/20
 - 3s - loss: 0.1694 - acc: 0.9492 - val_loss: 0.1135 - val_acc: 0.9677
Epoch 14/20
 - 3s - loss: 0.1643 - acc: 0.9513 - val_loss: 0.1125 - val_acc: 0.9675
Epoch 15/20
 - 3s - loss: 0.1667 - acc: 0.9508 - val_loss: 0.1160 - val_acc: 0.9651
Epoch 16/20
 - 3s - loss: 0.1635 - acc: 0.9524 - val_loss: 0.0914 - val_acc: 0.9714
Epoch 17/20
 - 3s - loss: 0.1644 - acc: 0.9521 - val_loss: 0.0953 - val_acc: 0.9705
Epoch 18/20
 - 3s - loss: 0.1657 - acc: 0.9527 - val_loss: 0.1117 - val_acc: 0.9682
Epoch 19/20
 - 3s - loss: 0.1613 - acc: 0.9546 - val_loss: 0.1105 - val_acc: 0.9654
Epoch 20/20
 - 3s - loss: 0.1647 - acc: 0.9532 - val_loss: 0.1537 - val_acc: 0.9618
Test loss: 0.15371082120407373
Test accuracy: 0.9626
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9502 - acc: 0.6959 - val_loss: 0.4160 - val_acc: 0.8592
Epoch 2/20
 - 4s - loss: 0.4305 - acc: 0.8625 - val_loss: 0.2689 - val_acc: 0.9108
Epoch 3/20
 - 4s - loss: 0.3246 - acc: 0.8979 - val_loss: 0.2197 - val_acc: 0.9302
Epoch 4/20
 - 4s - loss: 0.2681 - acc: 0.9169 - val_loss: 0.1902 - val_acc: 0.9394
Epoch 5/20
 - 4s - loss: 0.2389 - acc: 0.9250 - val_loss: 0.1730 - val_acc: 0.9459
Epoch 6/20
 - 4s - loss: 0.2176 - acc: 0.9335 - val_loss: 0.1412 - val_acc: 0.9577
Epoch 7/20
 - 4s - loss: 0.2019 - acc: 0.9381 - val_loss: 0.2232 - val_acc: 0.9321
Epoch 8/20
 - 4s - loss: 0.1933 - acc: 0.9404 - val_loss: 0.1156 - val_acc: 0.9655
Epoch 9/20
 - 4s - loss: 0.1831 - acc: 0.9449 - val_loss: 0.1474 - val_acc: 0.9551
Epoch 10/20
 - 4s - loss: 0.1765 - acc: 0.9462 - val_loss: 0.1099 - val_acc: 0.9673
Epoch 11/20
 - 4s - loss: 0.1734 - acc: 0.9482 - val_loss: 0.1268 - val_acc: 0.9618
Epoch 12/20
 - 4s - loss: 0.1677 - acc: 0.9492 - val_loss: 0.1462 - val_acc: 0.9592
Epoch 13/20
 - 4s - loss: 0.1683 - acc: 0.9504 - val_loss: 0.1338 - val_acc: 0.9608
Epoch 14/20
 - 4s - loss: 0.1683 - acc: 0.9509 - val_loss: 0.1200 - val_acc: 0.9659
Epoch 15/20
 - 4s - loss: 0.1642 - acc: 0.9523 - val_loss: 0.1059 - val_acc: 0.9696
Epoch 16/20
 - 4s - loss: 0.1646 - acc: 0.9529 - val_loss: 0.1452 - val_acc: 0.9627
Epoch 17/20
 - 4s - loss: 0.1632 - acc: 0.9530 - val_loss: 0.1199 - val_acc: 0.9610
Epoch 18/20
 - 4s - loss: 0.1626 - acc: 0.9539 - val_loss: 0.1095 - val_acc: 0.9673
Epoch 19/20
 - 4s - loss: 0.1673 - acc: 0.9539 - val_loss: 0.1021 - val_acc: 0.9708
Epoch 20/20
 - 4s - loss: 0.1606 - acc: 0.9542 - val_loss: 0.1182 - val_acc: 0.9655
Test loss: 0.1169587549381191
Test accuracy: 0.9641
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9356 - acc: 0.6956 - val_loss: 0.5741 - val_acc: 0.8018
Epoch 2/20
 - 4s - loss: 0.4312 - acc: 0.8617 - val_loss: 0.4282 - val_acc: 0.8517
Epoch 3/20
 - 4s - loss: 0.3180 - acc: 0.9002 - val_loss: 0.2000 - val_acc: 0.9376
Epoch 4/20
 - 4s - loss: 0.2670 - acc: 0.9163 - val_loss: 0.1693 - val_acc: 0.9460
Epoch 5/20
 - 4s - loss: 0.2368 - acc: 0.9271 - val_loss: 0.1380 - val_acc: 0.9566
Epoch 6/20
 - 4s - loss: 0.2167 - acc: 0.9338 - val_loss: 0.1630 - val_acc: 0.9475
Epoch 7/20
 - 4s - loss: 0.2021 - acc: 0.9383 - val_loss: 0.1096 - val_acc: 0.9653
Epoch 8/20
 - 4s - loss: 0.1936 - acc: 0.9419 - val_loss: 0.1138 - val_acc: 0.9674
Epoch 9/20
 - 4s - loss: 0.1873 - acc: 0.9431 - val_loss: 0.1085 - val_acc: 0.9653
Epoch 10/20
 - 4s - loss: 0.1763 - acc: 0.9472 - val_loss: 0.1193 - val_acc: 0.9622
Epoch 11/20
 - 4s - loss: 0.1765 - acc: 0.9476 - val_loss: 0.1392 - val_acc: 0.9594
Epoch 12/20
 - 4s - loss: 0.1754 - acc: 0.9476 - val_loss: 0.2074 - val_acc: 0.9366
Epoch 13/20
 - 4s - loss: 0.1715 - acc: 0.9493 - val_loss: 0.1369 - val_acc: 0.9586
Epoch 14/20
 - 4s - loss: 0.1689 - acc: 0.9520 - val_loss: 0.1190 - val_acc: 0.9645
Epoch 15/20
 - 4s - loss: 0.1681 - acc: 0.9513 - val_loss: 0.1072 - val_acc: 0.9670
Epoch 16/20
 - 4s - loss: 0.1680 - acc: 0.9510 - val_loss: 0.1173 - val_acc: 0.9630
Epoch 17/20
 - 4s - loss: 0.1654 - acc: 0.9529 - val_loss: 0.1156 - val_acc: 0.9655
Epoch 18/20
 - 4s - loss: 0.1636 - acc: 0.9538 - val_loss: 0.1158 - val_acc: 0.9698
Epoch 19/20
 - 4s - loss: 0.1651 - acc: 0.9536 - val_loss: 0.1451 - val_acc: 0.9605
Epoch 20/20
 - 4s - loss: 0.1656 - acc: 0.9549 - val_loss: 0.1444 - val_acc: 0.9589
Test loss: 0.14582557153467351
Test accuracy: 0.9575
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9290 - acc: 0.6983 - val_loss: 0.8772 - val_acc: 0.7172
Epoch 2/20
 - 6s - loss: 0.4286 - acc: 0.8622 - val_loss: 0.3513 - val_acc: 0.8830
Epoch 3/20
 - 6s - loss: 0.3165 - acc: 0.9002 - val_loss: 0.2339 - val_acc: 0.9281
Epoch 4/20
 - 6s - loss: 0.2652 - acc: 0.9179 - val_loss: 0.1665 - val_acc: 0.9447
Epoch 5/20
 - 6s - loss: 0.2323 - acc: 0.9286 - val_loss: 0.1745 - val_acc: 0.9438
Epoch 6/20
 - 6s - loss: 0.2126 - acc: 0.9343 - val_loss: 0.1295 - val_acc: 0.9615
Epoch 7/20
 - 6s - loss: 0.2042 - acc: 0.9378 - val_loss: 0.1347 - val_acc: 0.9597
Epoch 8/20
 - 6s - loss: 0.1886 - acc: 0.9423 - val_loss: 0.1312 - val_acc: 0.9614
Epoch 9/20
 - 6s - loss: 0.1832 - acc: 0.9446 - val_loss: 0.1677 - val_acc: 0.9484
Epoch 10/20
 - 6s - loss: 0.1773 - acc: 0.9471 - val_loss: 0.1317 - val_acc: 0.9569
Epoch 11/20
 - 6s - loss: 0.1764 - acc: 0.9481 - val_loss: 0.1094 - val_acc: 0.9673
Epoch 12/20
 - 6s - loss: 0.1706 - acc: 0.9495 - val_loss: 0.1601 - val_acc: 0.9525
Epoch 13/20
 - 6s - loss: 0.1661 - acc: 0.9518 - val_loss: 0.1596 - val_acc: 0.9491
Epoch 14/20
 - 6s - loss: 0.1673 - acc: 0.9513 - val_loss: 0.0963 - val_acc: 0.9711
Epoch 15/20
 - 6s - loss: 0.1698 - acc: 0.9515 - val_loss: 0.1333 - val_acc: 0.9636
Epoch 16/20
 - 6s - loss: 0.1668 - acc: 0.9523 - val_loss: 0.1061 - val_acc: 0.9695
Epoch 17/20
 - 6s - loss: 0.1684 - acc: 0.9533 - val_loss: 0.0991 - val_acc: 0.9702
Epoch 18/20
 - 6s - loss: 0.1629 - acc: 0.9545 - val_loss: 0.1073 - val_acc: 0.9674
Epoch 19/20
 - 6s - loss: 0.1678 - acc: 0.9536 - val_loss: 0.1252 - val_acc: 0.9671
Epoch 20/20
 - 6s - loss: 0.1681 - acc: 0.9528 - val_loss: 0.1776 - val_acc: 0.9573
Test loss: 0.17723438498149627
Test accuracy: 0.9565
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9537 - acc: 0.6926 - val_loss: 0.7238 - val_acc: 0.7683
Epoch 2/20
 - 9s - loss: 0.4389 - acc: 0.8598 - val_loss: 0.4047 - val_acc: 0.8763
Epoch 3/20
 - 9s - loss: 0.3260 - acc: 0.8975 - val_loss: 0.2446 - val_acc: 0.9200
Epoch 4/20
 - 9s - loss: 0.2695 - acc: 0.9154 - val_loss: 0.1672 - val_acc: 0.9475
Epoch 5/20
 - 9s - loss: 0.2368 - acc: 0.9268 - val_loss: 0.1596 - val_acc: 0.9484
Epoch 6/20
 - 9s - loss: 0.2178 - acc: 0.9330 - val_loss: 0.2470 - val_acc: 0.9185
Epoch 7/20
 - 9s - loss: 0.2043 - acc: 0.9380 - val_loss: 0.1857 - val_acc: 0.9442
Epoch 8/20
 - 9s - loss: 0.1937 - acc: 0.9408 - val_loss: 0.2226 - val_acc: 0.9296
Epoch 9/20
 - 9s - loss: 0.1866 - acc: 0.9456 - val_loss: 0.1244 - val_acc: 0.9653
Epoch 10/20
 - 9s - loss: 0.1825 - acc: 0.9451 - val_loss: 0.1131 - val_acc: 0.9653
Epoch 11/20
 - 9s - loss: 0.1724 - acc: 0.9484 - val_loss: 0.1104 - val_acc: 0.9640
Epoch 12/20
 - 9s - loss: 0.1761 - acc: 0.9478 - val_loss: 0.1035 - val_acc: 0.9699
Epoch 13/20
 - 9s - loss: 0.1669 - acc: 0.9500 - val_loss: 0.1161 - val_acc: 0.9662
Epoch 14/20
 - 9s - loss: 0.1705 - acc: 0.9509 - val_loss: 0.1258 - val_acc: 0.9630
Epoch 15/20
 - 9s - loss: 0.1671 - acc: 0.9515 - val_loss: 0.1143 - val_acc: 0.9648
Epoch 16/20
 - 9s - loss: 0.1678 - acc: 0.9519 - val_loss: 0.1089 - val_acc: 0.9679
Epoch 17/20
 - 9s - loss: 0.1661 - acc: 0.9526 - val_loss: 0.1070 - val_acc: 0.9673
Epoch 18/20
 - 9s - loss: 0.1678 - acc: 0.9518 - val_loss: 0.2351 - val_acc: 0.9344
Epoch 19/20
 - 9s - loss: 0.1663 - acc: 0.9545 - val_loss: 0.1052 - val_acc: 0.9715
Epoch 20/20
 - 9s - loss: 0.1661 - acc: 0.9539 - val_loss: 0.1053 - val_acc: 0.9700
Test loss: 0.1051678788319492
Test accuracy: 0.9695
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9287 - acc: 0.6971 - val_loss: 0.3328 - val_acc: 0.8959
Epoch 2/20
 - 14s - loss: 0.4354 - acc: 0.8623 - val_loss: 0.3450 - val_acc: 0.8912
Epoch 3/20
 - 14s - loss: 0.3202 - acc: 0.8995 - val_loss: 0.2113 - val_acc: 0.9331
Epoch 4/20
 - 14s - loss: 0.2687 - acc: 0.9163 - val_loss: 0.2273 - val_acc: 0.9266
Epoch 5/20
 - 14s - loss: 0.2338 - acc: 0.9272 - val_loss: 0.2381 - val_acc: 0.9293
Epoch 6/20
 - 14s - loss: 0.2127 - acc: 0.9338 - val_loss: 0.1890 - val_acc: 0.9388
Epoch 7/20
 - 14s - loss: 0.2014 - acc: 0.9389 - val_loss: 0.1149 - val_acc: 0.9648
Epoch 8/20
 - 14s - loss: 0.1910 - acc: 0.9431 - val_loss: 0.1365 - val_acc: 0.9578
Epoch 9/20
 - 14s - loss: 0.1845 - acc: 0.9443 - val_loss: 0.1369 - val_acc: 0.9587
Epoch 10/20
 - 14s - loss: 0.1762 - acc: 0.9464 - val_loss: 0.1572 - val_acc: 0.9532
Epoch 11/20
 - 14s - loss: 0.1758 - acc: 0.9482 - val_loss: 0.1304 - val_acc: 0.9641
Epoch 12/20
 - 14s - loss: 0.1718 - acc: 0.9489 - val_loss: 0.1054 - val_acc: 0.9699
Epoch 13/20
 - 14s - loss: 0.1660 - acc: 0.9498 - val_loss: 0.1048 - val_acc: 0.9679
Epoch 14/20
 - 14s - loss: 0.1662 - acc: 0.9521 - val_loss: 0.1106 - val_acc: 0.9704
Epoch 15/20
 - 14s - loss: 0.1645 - acc: 0.9525 - val_loss: 0.1035 - val_acc: 0.9699
Epoch 16/20
 - 14s - loss: 0.1659 - acc: 0.9522 - val_loss: 0.1015 - val_acc: 0.9706
Epoch 17/20
 - 14s - loss: 0.1661 - acc: 0.9530 - val_loss: 0.1070 - val_acc: 0.9692
Epoch 18/20
 - 14s - loss: 0.1607 - acc: 0.9534 - val_loss: 0.1203 - val_acc: 0.9660
Epoch 19/20
 - 14s - loss: 0.1571 - acc: 0.9550 - val_loss: 0.1771 - val_acc: 0.9573
Epoch 20/20
 - 14s - loss: 0.1593 - acc: 0.9547 - val_loss: 0.0955 - val_acc: 0.9734
Test loss: 0.09545583658291726
Test accuracy: 0.9735
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9419 - acc: 0.6963 - val_loss: 0.4393 - val_acc: 0.8562
Epoch 2/20
 - 26s - loss: 0.4225 - acc: 0.8643 - val_loss: 0.2519 - val_acc: 0.9187
Epoch 3/20
 - 26s - loss: 0.3161 - acc: 0.9004 - val_loss: 0.3477 - val_acc: 0.8908
Epoch 4/20
 - 26s - loss: 0.2642 - acc: 0.9174 - val_loss: 0.1408 - val_acc: 0.9567
Epoch 5/20
 - 26s - loss: 0.2318 - acc: 0.9282 - val_loss: 0.1766 - val_acc: 0.9416
Epoch 6/20
 - 26s - loss: 0.2125 - acc: 0.9345 - val_loss: 0.2064 - val_acc: 0.9351
Epoch 7/20
 - 26s - loss: 0.1977 - acc: 0.9403 - val_loss: 0.1231 - val_acc: 0.9621
Epoch 8/20
 - 26s - loss: 0.1869 - acc: 0.9427 - val_loss: 0.1064 - val_acc: 0.9667
Epoch 9/20
 - 26s - loss: 0.1777 - acc: 0.9465 - val_loss: 0.1487 - val_acc: 0.9521
Epoch 10/20
 - 26s - loss: 0.1735 - acc: 0.9477 - val_loss: 0.1405 - val_acc: 0.9598
Epoch 11/20
 - 26s - loss: 0.1686 - acc: 0.9512 - val_loss: 0.1073 - val_acc: 0.9694
Epoch 12/20
 - 26s - loss: 0.1644 - acc: 0.9513 - val_loss: 0.1031 - val_acc: 0.9693
Epoch 13/20
 - 26s - loss: 0.1638 - acc: 0.9520 - val_loss: 0.1085 - val_acc: 0.9676
Epoch 14/20
 - 26s - loss: 0.1615 - acc: 0.9531 - val_loss: 0.1200 - val_acc: 0.9668
Epoch 15/20
 - 26s - loss: 0.1555 - acc: 0.9542 - val_loss: 0.1104 - val_acc: 0.9683
Epoch 16/20
 - 26s - loss: 0.1590 - acc: 0.9547 - val_loss: 0.1236 - val_acc: 0.9649
Epoch 17/20
 - 26s - loss: 0.1555 - acc: 0.9553 - val_loss: 0.1618 - val_acc: 0.9528
Epoch 18/20
 - 26s - loss: 0.1567 - acc: 0.9563 - val_loss: 0.0972 - val_acc: 0.9734
Epoch 19/20
 - 26s - loss: 0.1541 - acc: 0.9551 - val_loss: 0.1253 - val_acc: 0.9636
Epoch 20/20
 - 26s - loss: 0.1531 - acc: 0.9575 - val_loss: 0.1324 - val_acc: 0.9603
Test loss: 0.13198012538569165
Test accuracy: 0.9604
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9565 - acc: 0.6945 - val_loss: 0.3860 - val_acc: 0.8837
Epoch 2/20
 - 3s - loss: 0.4566 - acc: 0.8533 - val_loss: 0.5285 - val_acc: 0.8316
Epoch 3/20
 - 3s - loss: 0.3464 - acc: 0.8899 - val_loss: 0.3359 - val_acc: 0.8908
Epoch 4/20
 - 3s - loss: 0.2938 - acc: 0.9081 - val_loss: 0.2905 - val_acc: 0.9059
Epoch 5/20
 - 3s - loss: 0.2642 - acc: 0.9183 - val_loss: 0.1976 - val_acc: 0.9388
Epoch 6/20
 - 3s - loss: 0.2437 - acc: 0.9240 - val_loss: 0.1666 - val_acc: 0.9466
Epoch 7/20
 - 3s - loss: 0.2312 - acc: 0.9291 - val_loss: 0.1599 - val_acc: 0.9519
Epoch 8/20
 - 3s - loss: 0.2232 - acc: 0.9313 - val_loss: 0.1395 - val_acc: 0.9539
Epoch 9/20
 - 3s - loss: 0.2098 - acc: 0.9358 - val_loss: 0.1268 - val_acc: 0.9610
Epoch 10/20
 - 3s - loss: 0.2063 - acc: 0.9381 - val_loss: 0.1406 - val_acc: 0.9588
Epoch 11/20
 - 3s - loss: 0.2042 - acc: 0.9388 - val_loss: 0.1427 - val_acc: 0.9555
Epoch 12/20
 - 3s - loss: 0.2003 - acc: 0.9403 - val_loss: 0.1405 - val_acc: 0.9556
Epoch 13/20
 - 3s - loss: 0.1957 - acc: 0.9412 - val_loss: 0.1238 - val_acc: 0.9626
Epoch 14/20
 - 3s - loss: 0.1969 - acc: 0.9431 - val_loss: 0.1292 - val_acc: 0.9598
Epoch 15/20
 - 3s - loss: 0.1983 - acc: 0.9429 - val_loss: 0.1905 - val_acc: 0.9478
Epoch 16/20
 - 3s - loss: 0.1971 - acc: 0.9435 - val_loss: 0.1195 - val_acc: 0.9635
Epoch 17/20
 - 3s - loss: 0.1961 - acc: 0.9440 - val_loss: 0.1631 - val_acc: 0.9488
Epoch 18/20
 - 3s - loss: 0.1968 - acc: 0.9442 - val_loss: 0.1549 - val_acc: 0.9608
Epoch 19/20
 - 3s - loss: 0.1990 - acc: 0.9435 - val_loss: 0.1647 - val_acc: 0.9565
Epoch 20/20
 - 3s - loss: 0.1953 - acc: 0.9455 - val_loss: 0.1416 - val_acc: 0.9611
Test loss: 0.14152023803568445
Test accuracy: 0.9594
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9528 - acc: 0.6923 - val_loss: 0.7185 - val_acc: 0.7657
Epoch 2/20
 - 3s - loss: 0.4434 - acc: 0.8591 - val_loss: 0.4507 - val_acc: 0.8545
Epoch 3/20
 - 3s - loss: 0.3337 - acc: 0.8954 - val_loss: 0.4560 - val_acc: 0.8649
Epoch 4/20
 - 3s - loss: 0.2799 - acc: 0.9121 - val_loss: 0.1772 - val_acc: 0.9420
Epoch 5/20
 - 3s - loss: 0.2492 - acc: 0.9226 - val_loss: 0.1719 - val_acc: 0.9448
Epoch 6/20
 - 3s - loss: 0.2275 - acc: 0.9286 - val_loss: 0.1566 - val_acc: 0.9505
Epoch 7/20
 - 3s - loss: 0.2137 - acc: 0.9354 - val_loss: 0.1311 - val_acc: 0.9595
Epoch 8/20
 - 3s - loss: 0.2045 - acc: 0.9382 - val_loss: 0.1893 - val_acc: 0.9415
Epoch 9/20
 - 3s - loss: 0.1998 - acc: 0.9400 - val_loss: 0.1115 - val_acc: 0.9662
Epoch 10/20
 - 3s - loss: 0.1958 - acc: 0.9416 - val_loss: 0.1588 - val_acc: 0.9508
Epoch 11/20
 - 3s - loss: 0.1916 - acc: 0.9430 - val_loss: 0.1197 - val_acc: 0.9641
Epoch 12/20
 - 3s - loss: 0.1862 - acc: 0.9451 - val_loss: 0.1223 - val_acc: 0.9646
Epoch 13/20
 - 3s - loss: 0.1846 - acc: 0.9458 - val_loss: 0.1427 - val_acc: 0.9594
Epoch 14/20
 - 3s - loss: 0.1816 - acc: 0.9479 - val_loss: 0.1462 - val_acc: 0.9563
Epoch 15/20
 - 3s - loss: 0.1805 - acc: 0.9483 - val_loss: 0.1630 - val_acc: 0.9590
Epoch 16/20
 - 3s - loss: 0.1794 - acc: 0.9495 - val_loss: 0.1554 - val_acc: 0.9622
Epoch 17/20
 - 3s - loss: 0.1835 - acc: 0.9490 - val_loss: 0.1039 - val_acc: 0.9690
Epoch 18/20
 - 3s - loss: 0.1819 - acc: 0.9493 - val_loss: 0.1470 - val_acc: 0.9661
Epoch 19/20
 - 3s - loss: 0.1841 - acc: 0.9489 - val_loss: 0.1370 - val_acc: 0.9613
Epoch 20/20
 - 3s - loss: 0.1863 - acc: 0.9475 - val_loss: 0.1191 - val_acc: 0.9652
Test loss: 0.11805803695096984
Test accuracy: 0.9665
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9457 - acc: 0.6952 - val_loss: 0.4373 - val_acc: 0.8495
Epoch 2/20
 - 3s - loss: 0.4347 - acc: 0.8604 - val_loss: 0.3187 - val_acc: 0.8953
Epoch 3/20
 - 3s - loss: 0.3236 - acc: 0.8978 - val_loss: 0.2797 - val_acc: 0.9003
Epoch 4/20
 - 3s - loss: 0.2702 - acc: 0.9162 - val_loss: 0.1964 - val_acc: 0.9374
Epoch 5/20
 - 3s - loss: 0.2376 - acc: 0.9257 - val_loss: 0.2495 - val_acc: 0.9255
Epoch 6/20
 - 3s - loss: 0.2197 - acc: 0.9320 - val_loss: 0.1942 - val_acc: 0.9354
Epoch 7/20
 - 3s - loss: 0.2076 - acc: 0.9364 - val_loss: 0.2274 - val_acc: 0.9264
Epoch 8/20
 - 3s - loss: 0.1957 - acc: 0.9407 - val_loss: 0.1635 - val_acc: 0.9511
Epoch 9/20
 - 3s - loss: 0.1880 - acc: 0.9426 - val_loss: 0.1209 - val_acc: 0.9637
Epoch 10/20
 - 3s - loss: 0.1828 - acc: 0.9456 - val_loss: 0.1285 - val_acc: 0.9609
Epoch 11/20
 - 3s - loss: 0.1835 - acc: 0.9458 - val_loss: 0.1484 - val_acc: 0.9506
Epoch 12/20
 - 3s - loss: 0.1774 - acc: 0.9478 - val_loss: 0.1501 - val_acc: 0.9554
Epoch 13/20
 - 3s - loss: 0.1735 - acc: 0.9485 - val_loss: 0.1339 - val_acc: 0.9595
Epoch 14/20
 - 3s - loss: 0.1750 - acc: 0.9482 - val_loss: 0.1294 - val_acc: 0.9663
Epoch 15/20
 - 3s - loss: 0.1749 - acc: 0.9495 - val_loss: 0.1039 - val_acc: 0.9686
Epoch 16/20
 - 3s - loss: 0.1696 - acc: 0.9522 - val_loss: 0.1536 - val_acc: 0.9646
Epoch 17/20
 - 3s - loss: 0.1773 - acc: 0.9502 - val_loss: 0.0984 - val_acc: 0.9724
Epoch 18/20
 - 3s - loss: 0.1749 - acc: 0.9515 - val_loss: 0.1086 - val_acc: 0.9684
Epoch 19/20
 - 3s - loss: 0.1693 - acc: 0.9528 - val_loss: 0.1120 - val_acc: 0.9661
Epoch 20/20
 - 3s - loss: 0.1709 - acc: 0.9527 - val_loss: 0.1255 - val_acc: 0.9647
Test loss: 0.12877015977902337
Test accuracy: 0.9631
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9394 - acc: 0.6957 - val_loss: 0.4284 - val_acc: 0.8659
Epoch 2/20
 - 3s - loss: 0.4423 - acc: 0.8579 - val_loss: 0.2402 - val_acc: 0.9234
Epoch 3/20
 - 3s - loss: 0.3284 - acc: 0.8953 - val_loss: 0.3280 - val_acc: 0.8890
Epoch 4/20
 - 3s - loss: 0.2739 - acc: 0.9141 - val_loss: 0.2048 - val_acc: 0.9346
Epoch 5/20
 - 3s - loss: 0.2422 - acc: 0.9240 - val_loss: 0.1507 - val_acc: 0.9557
Epoch 6/20
 - 3s - loss: 0.2163 - acc: 0.9329 - val_loss: 0.1522 - val_acc: 0.9524
Epoch 7/20
 - 3s - loss: 0.2071 - acc: 0.9357 - val_loss: 0.1422 - val_acc: 0.9562
Epoch 8/20
 - 3s - loss: 0.1918 - acc: 0.9415 - val_loss: 0.1391 - val_acc: 0.9577
Epoch 9/20
 - 3s - loss: 0.1835 - acc: 0.9450 - val_loss: 0.1483 - val_acc: 0.9529
Epoch 10/20
 - 3s - loss: 0.1789 - acc: 0.9456 - val_loss: 0.2162 - val_acc: 0.9376
Epoch 11/20
 - 3s - loss: 0.1720 - acc: 0.9481 - val_loss: 0.1196 - val_acc: 0.9634
Epoch 12/20
 - 3s - loss: 0.1727 - acc: 0.9488 - val_loss: 0.1636 - val_acc: 0.9484
Epoch 13/20
 - 3s - loss: 0.1692 - acc: 0.9499 - val_loss: 0.1677 - val_acc: 0.9527
Epoch 14/20
 - 3s - loss: 0.1667 - acc: 0.9516 - val_loss: 0.1190 - val_acc: 0.9659
Epoch 15/20
 - 3s - loss: 0.1642 - acc: 0.9518 - val_loss: 0.0990 - val_acc: 0.9681
Epoch 16/20
 - 3s - loss: 0.1587 - acc: 0.9532 - val_loss: 0.1176 - val_acc: 0.9644
Epoch 17/20
 - 3s - loss: 0.1635 - acc: 0.9529 - val_loss: 0.1184 - val_acc: 0.9659
Epoch 18/20
 - 3s - loss: 0.1604 - acc: 0.9537 - val_loss: 0.1057 - val_acc: 0.9681
Epoch 19/20
 - 3s - loss: 0.1600 - acc: 0.9548 - val_loss: 0.1474 - val_acc: 0.9584
Epoch 20/20
 - 3s - loss: 0.1633 - acc: 0.9545 - val_loss: 0.1217 - val_acc: 0.9667
Test loss: 0.12020114233756904
Test accuracy: 0.9666
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9524 - acc: 0.6953 - val_loss: 0.6156 - val_acc: 0.7958
Epoch 2/20
 - 4s - loss: 0.4308 - acc: 0.8632 - val_loss: 0.2343 - val_acc: 0.9252
Epoch 3/20
 - 4s - loss: 0.3284 - acc: 0.8974 - val_loss: 0.2965 - val_acc: 0.9040
Epoch 4/20
 - 4s - loss: 0.2706 - acc: 0.9160 - val_loss: 0.1576 - val_acc: 0.9525
Epoch 5/20
 - 4s - loss: 0.2363 - acc: 0.9258 - val_loss: 0.1369 - val_acc: 0.9591
Epoch 6/20
 - 4s - loss: 0.2154 - acc: 0.9342 - val_loss: 0.1421 - val_acc: 0.9580
Epoch 7/20
 - 4s - loss: 0.2097 - acc: 0.9366 - val_loss: 0.1892 - val_acc: 0.9381
Epoch 8/20
 - 4s - loss: 0.1949 - acc: 0.9404 - val_loss: 0.1185 - val_acc: 0.9648
Epoch 9/20
 - 4s - loss: 0.1866 - acc: 0.9435 - val_loss: 0.1390 - val_acc: 0.9600
Epoch 10/20
 - 4s - loss: 0.1824 - acc: 0.9455 - val_loss: 0.1614 - val_acc: 0.9512
Epoch 11/20
 - 4s - loss: 0.1752 - acc: 0.9484 - val_loss: 0.1146 - val_acc: 0.9668
Epoch 12/20
 - 4s - loss: 0.1736 - acc: 0.9482 - val_loss: 0.1437 - val_acc: 0.9595
Epoch 13/20
 - 4s - loss: 0.1694 - acc: 0.9511 - val_loss: 0.1092 - val_acc: 0.9649
Epoch 14/20
 - 4s - loss: 0.1641 - acc: 0.9518 - val_loss: 0.1189 - val_acc: 0.9659
Epoch 15/20
 - 4s - loss: 0.1727 - acc: 0.9504 - val_loss: 0.1126 - val_acc: 0.9684
Epoch 16/20
 - 4s - loss: 0.1649 - acc: 0.9528 - val_loss: 0.1039 - val_acc: 0.9705
Epoch 17/20
 - 4s - loss: 0.1656 - acc: 0.9529 - val_loss: 0.1067 - val_acc: 0.9707
Epoch 18/20
 - 4s - loss: 0.1651 - acc: 0.9539 - val_loss: 0.1190 - val_acc: 0.9654
Epoch 19/20
 - 4s - loss: 0.1675 - acc: 0.9533 - val_loss: 0.1137 - val_acc: 0.9684
Epoch 20/20
 - 4s - loss: 0.1673 - acc: 0.9541 - val_loss: 0.1123 - val_acc: 0.9664
Test loss: 0.11193964852331846
Test accuracy: 0.9684
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9225 - acc: 0.7013 - val_loss: 0.6850 - val_acc: 0.7823
Epoch 2/20
 - 4s - loss: 0.4401 - acc: 0.8596 - val_loss: 0.3142 - val_acc: 0.8987
Epoch 3/20
 - 4s - loss: 0.3259 - acc: 0.8977 - val_loss: 0.1948 - val_acc: 0.9399
Epoch 4/20
 - 4s - loss: 0.2648 - acc: 0.9167 - val_loss: 0.2085 - val_acc: 0.9395
Epoch 5/20
 - 4s - loss: 0.2359 - acc: 0.9272 - val_loss: 0.1353 - val_acc: 0.9590
Epoch 6/20
 - 4s - loss: 0.2147 - acc: 0.9342 - val_loss: 0.1394 - val_acc: 0.9551
Epoch 7/20
 - 4s - loss: 0.1987 - acc: 0.9392 - val_loss: 0.1462 - val_acc: 0.9538
Epoch 8/20
 - 4s - loss: 0.1878 - acc: 0.9428 - val_loss: 0.1182 - val_acc: 0.9628
Epoch 9/20
 - 4s - loss: 0.1844 - acc: 0.9443 - val_loss: 0.1388 - val_acc: 0.9582
Epoch 10/20
 - 4s - loss: 0.1767 - acc: 0.9476 - val_loss: 0.1192 - val_acc: 0.9631
Epoch 11/20
 - 4s - loss: 0.1763 - acc: 0.9479 - val_loss: 0.1306 - val_acc: 0.9631
Epoch 12/20
 - 4s - loss: 0.1691 - acc: 0.9501 - val_loss: 0.1028 - val_acc: 0.9681
Epoch 13/20
 - 4s - loss: 0.1645 - acc: 0.9515 - val_loss: 0.1485 - val_acc: 0.9556
Epoch 14/20
 - 4s - loss: 0.1631 - acc: 0.9520 - val_loss: 0.1223 - val_acc: 0.9627
Epoch 15/20
 - 4s - loss: 0.1614 - acc: 0.9529 - val_loss: 0.0963 - val_acc: 0.9715
Epoch 16/20
 - 4s - loss: 0.1661 - acc: 0.9524 - val_loss: 0.1696 - val_acc: 0.9613
Epoch 17/20
 - 4s - loss: 0.1647 - acc: 0.9524 - val_loss: 0.1135 - val_acc: 0.9686
Epoch 18/20
 - 4s - loss: 0.1654 - acc: 0.9531 - val_loss: 0.0995 - val_acc: 0.9718
Epoch 19/20
 - 4s - loss: 0.1653 - acc: 0.9533 - val_loss: 0.1133 - val_acc: 0.9690
Epoch 20/20
 - 4s - loss: 0.1658 - acc: 0.9551 - val_loss: 0.1161 - val_acc: 0.9694
Test loss: 0.11575365286864107
Test accuracy: 0.9688
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9580 - acc: 0.6990 - val_loss: 0.3998 - val_acc: 0.8704
Epoch 2/20
 - 6s - loss: 0.4229 - acc: 0.8645 - val_loss: 0.4306 - val_acc: 0.8603
Epoch 3/20
 - 6s - loss: 0.3206 - acc: 0.8995 - val_loss: 0.2085 - val_acc: 0.9321
Epoch 4/20
 - 6s - loss: 0.2635 - acc: 0.9178 - val_loss: 0.2175 - val_acc: 0.9321
Epoch 5/20
 - 6s - loss: 0.2360 - acc: 0.9268 - val_loss: 0.1641 - val_acc: 0.9485
Epoch 6/20
 - 6s - loss: 0.2147 - acc: 0.9341 - val_loss: 0.2735 - val_acc: 0.9095
Epoch 7/20
 - 6s - loss: 0.2060 - acc: 0.9374 - val_loss: 0.1802 - val_acc: 0.9446
Epoch 8/20
 - 6s - loss: 0.1925 - acc: 0.9421 - val_loss: 0.1350 - val_acc: 0.9577
Epoch 9/20
 - 6s - loss: 0.1801 - acc: 0.9453 - val_loss: 0.1632 - val_acc: 0.9489
Epoch 10/20
 - 6s - loss: 0.1787 - acc: 0.9469 - val_loss: 0.2124 - val_acc: 0.9391
Epoch 11/20
 - 6s - loss: 0.1763 - acc: 0.9479 - val_loss: 0.1494 - val_acc: 0.9559
Epoch 12/20
 - 6s - loss: 0.1746 - acc: 0.9491 - val_loss: 0.1150 - val_acc: 0.9649
Epoch 13/20
 - 6s - loss: 0.1704 - acc: 0.9496 - val_loss: 0.1801 - val_acc: 0.9466
Epoch 14/20
 - 6s - loss: 0.1625 - acc: 0.9524 - val_loss: 0.1169 - val_acc: 0.9645
Epoch 15/20
 - 6s - loss: 0.1644 - acc: 0.9521 - val_loss: 0.1388 - val_acc: 0.9573
Epoch 16/20
 - 6s - loss: 0.1657 - acc: 0.9522 - val_loss: 0.1404 - val_acc: 0.9590
Epoch 17/20
 - 6s - loss: 0.1688 - acc: 0.9524 - val_loss: 0.2074 - val_acc: 0.9406
Epoch 18/20
 - 6s - loss: 0.1633 - acc: 0.9534 - val_loss: 0.1288 - val_acc: 0.9670
Epoch 19/20
 - 6s - loss: 0.1651 - acc: 0.9539 - val_loss: 0.1078 - val_acc: 0.9669
Epoch 20/20
 - 6s - loss: 0.1654 - acc: 0.9544 - val_loss: 0.1517 - val_acc: 0.9560
Test loss: 0.1511005811459385
Test accuracy: 0.955
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9296 - acc: 0.7001 - val_loss: 0.3348 - val_acc: 0.9004
Epoch 2/20
 - 9s - loss: 0.4271 - acc: 0.8646 - val_loss: 0.3194 - val_acc: 0.8998
Epoch 3/20
 - 9s - loss: 0.3168 - acc: 0.9005 - val_loss: 0.2344 - val_acc: 0.9264
Epoch 4/20
 - 9s - loss: 0.2616 - acc: 0.9178 - val_loss: 0.2163 - val_acc: 0.9294
Epoch 5/20
 - 9s - loss: 0.2320 - acc: 0.9282 - val_loss: 0.2715 - val_acc: 0.9116
Epoch 6/20
 - 9s - loss: 0.2130 - acc: 0.9339 - val_loss: 0.1460 - val_acc: 0.9528
Epoch 7/20
 - 9s - loss: 0.1952 - acc: 0.9396 - val_loss: 0.1564 - val_acc: 0.9520
Epoch 8/20
 - 9s - loss: 0.1884 - acc: 0.9425 - val_loss: 0.1612 - val_acc: 0.9513
Epoch 9/20
 - 9s - loss: 0.1815 - acc: 0.9459 - val_loss: 0.1453 - val_acc: 0.9549
Epoch 10/20
 - 9s - loss: 0.1739 - acc: 0.9475 - val_loss: 0.1265 - val_acc: 0.9612
Epoch 11/20
 - 9s - loss: 0.1662 - acc: 0.9511 - val_loss: 0.1354 - val_acc: 0.9609
Epoch 12/20
 - 9s - loss: 0.1676 - acc: 0.9515 - val_loss: 0.1260 - val_acc: 0.9624
Epoch 13/20
 - 9s - loss: 0.1643 - acc: 0.9517 - val_loss: 0.1047 - val_acc: 0.9685
Epoch 14/20
 - 9s - loss: 0.1625 - acc: 0.9520 - val_loss: 0.1125 - val_acc: 0.9675
Epoch 15/20
 - 9s - loss: 0.1658 - acc: 0.9525 - val_loss: 0.1251 - val_acc: 0.9635
Epoch 16/20
 - 9s - loss: 0.1583 - acc: 0.9544 - val_loss: 0.1177 - val_acc: 0.9633
Epoch 17/20
 - 9s - loss: 0.1632 - acc: 0.9546 - val_loss: 0.1156 - val_acc: 0.9663
Epoch 18/20
 - 9s - loss: 0.1610 - acc: 0.9536 - val_loss: 0.0921 - val_acc: 0.9726
Epoch 19/20
 - 9s - loss: 0.1587 - acc: 0.9556 - val_loss: 0.0966 - val_acc: 0.9736
Epoch 20/20
 - 9s - loss: 0.1613 - acc: 0.9552 - val_loss: 0.0986 - val_acc: 0.9732
Test loss: 0.09845275991871022
Test accuracy: 0.9736
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9424 - acc: 0.6966 - val_loss: 0.5708 - val_acc: 0.8208
Epoch 2/20
 - 15s - loss: 0.4410 - acc: 0.8597 - val_loss: 0.2300 - val_acc: 0.9308
Epoch 3/20
 - 14s - loss: 0.3287 - acc: 0.8972 - val_loss: 0.1941 - val_acc: 0.9415
Epoch 4/20
 - 14s - loss: 0.2705 - acc: 0.9174 - val_loss: 0.1785 - val_acc: 0.9429
Epoch 5/20
 - 14s - loss: 0.2395 - acc: 0.9256 - val_loss: 0.2416 - val_acc: 0.9232
Epoch 6/20
 - 14s - loss: 0.2165 - acc: 0.9329 - val_loss: 0.1331 - val_acc: 0.9579
Epoch 7/20
 - 14s - loss: 0.2009 - acc: 0.9387 - val_loss: 0.1500 - val_acc: 0.9525
Epoch 8/20
 - 14s - loss: 0.1938 - acc: 0.9410 - val_loss: 0.1339 - val_acc: 0.9588
Epoch 9/20
 - 14s - loss: 0.1814 - acc: 0.9462 - val_loss: 0.1227 - val_acc: 0.9597
Epoch 10/20
 - 14s - loss: 0.1778 - acc: 0.9457 - val_loss: 0.1418 - val_acc: 0.9542
Epoch 11/20
 - 14s - loss: 0.1702 - acc: 0.9491 - val_loss: 0.1038 - val_acc: 0.9699
Epoch 12/20
 - 14s - loss: 0.1691 - acc: 0.9496 - val_loss: 0.0997 - val_acc: 0.9697
Epoch 13/20
 - 14s - loss: 0.1663 - acc: 0.9507 - val_loss: 0.1194 - val_acc: 0.9666
Epoch 14/20
 - 14s - loss: 0.1635 - acc: 0.9525 - val_loss: 0.2622 - val_acc: 0.9289
Epoch 15/20
 - 15s - loss: 0.1587 - acc: 0.9534 - val_loss: 0.1695 - val_acc: 0.9571
Epoch 16/20
 - 14s - loss: 0.1616 - acc: 0.9532 - val_loss: 0.2235 - val_acc: 0.9447
Epoch 17/20
 - 14s - loss: 0.1555 - acc: 0.9548 - val_loss: 0.1113 - val_acc: 0.9696
Epoch 18/20
 - 14s - loss: 0.1544 - acc: 0.9554 - val_loss: 0.1043 - val_acc: 0.9692
Epoch 19/20
 - 14s - loss: 0.1605 - acc: 0.9547 - val_loss: 0.1211 - val_acc: 0.9705
Epoch 20/20
 - 15s - loss: 0.1579 - acc: 0.9561 - val_loss: 0.0941 - val_acc: 0.9735
Test loss: 0.09373346467497322
Test accuracy: 0.9737
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9497 - acc: 0.6987 - val_loss: 0.4072 - val_acc: 0.8765
Epoch 2/20
 - 26s - loss: 0.4284 - acc: 0.8628 - val_loss: 0.2304 - val_acc: 0.9267
Epoch 3/20
 - 26s - loss: 0.3158 - acc: 0.8995 - val_loss: 0.2529 - val_acc: 0.9215
Epoch 4/20
 - 26s - loss: 0.2664 - acc: 0.9169 - val_loss: 0.2555 - val_acc: 0.9209
Epoch 5/20
 - 26s - loss: 0.2344 - acc: 0.9274 - val_loss: 0.1621 - val_acc: 0.9499
Epoch 6/20
 - 26s - loss: 0.2144 - acc: 0.9346 - val_loss: 0.1276 - val_acc: 0.9589
Epoch 7/20
 - 26s - loss: 0.1995 - acc: 0.9388 - val_loss: 0.1275 - val_acc: 0.9609
Epoch 8/20
 - 26s - loss: 0.1879 - acc: 0.9431 - val_loss: 0.1109 - val_acc: 0.9665
Epoch 9/20
 - 26s - loss: 0.1820 - acc: 0.9448 - val_loss: 0.1147 - val_acc: 0.9653
Epoch 10/20
 - 26s - loss: 0.1787 - acc: 0.9479 - val_loss: 0.1286 - val_acc: 0.9656
Epoch 11/20
 - 26s - loss: 0.1735 - acc: 0.9493 - val_loss: 0.1242 - val_acc: 0.9616
Epoch 12/20
 - 26s - loss: 0.1702 - acc: 0.9494 - val_loss: 0.1528 - val_acc: 0.9558
Epoch 13/20
 - 26s - loss: 0.1685 - acc: 0.9508 - val_loss: 0.1243 - val_acc: 0.9656
Epoch 14/20
 - 26s - loss: 0.1668 - acc: 0.9522 - val_loss: 0.1576 - val_acc: 0.9532
Epoch 15/20
 - 26s - loss: 0.1667 - acc: 0.9523 - val_loss: 0.1245 - val_acc: 0.9650
Epoch 16/20
 - 26s - loss: 0.1639 - acc: 0.9535 - val_loss: 0.1151 - val_acc: 0.9680
Epoch 17/20
 - 26s - loss: 0.1681 - acc: 0.9524 - val_loss: 0.1733 - val_acc: 0.9470
Epoch 18/20
 - 26s - loss: 0.1640 - acc: 0.9544 - val_loss: 0.1838 - val_acc: 0.9486
Epoch 19/20
 - 26s - loss: 0.1669 - acc: 0.9544 - val_loss: 0.1002 - val_acc: 0.9703
Epoch 20/20
 - 26s - loss: 0.1601 - acc: 0.9558 - val_loss: 0.1258 - val_acc: 0.9694
Test loss: 0.12559895609417582
Test accuracy: 0.9699
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9375 - acc: 0.6962 - val_loss: 0.4047 - val_acc: 0.8730
Epoch 2/20
 - 3s - loss: 0.4574 - acc: 0.8535 - val_loss: 0.3308 - val_acc: 0.8931
Epoch 3/20
 - 3s - loss: 0.3429 - acc: 0.8913 - val_loss: 0.1839 - val_acc: 0.9402
Epoch 4/20
 - 3s - loss: 0.2881 - acc: 0.9096 - val_loss: 0.2230 - val_acc: 0.9275
Epoch 5/20
 - 3s - loss: 0.2579 - acc: 0.9201 - val_loss: 0.2129 - val_acc: 0.9303
Epoch 6/20
 - 3s - loss: 0.2378 - acc: 0.9252 - val_loss: 0.1702 - val_acc: 0.9427
Epoch 7/20
 - 3s - loss: 0.2242 - acc: 0.9313 - val_loss: 0.1711 - val_acc: 0.9480
Epoch 8/20
 - 3s - loss: 0.2168 - acc: 0.9338 - val_loss: 0.1578 - val_acc: 0.9526
Epoch 9/20
 - 3s - loss: 0.2096 - acc: 0.9356 - val_loss: 0.1390 - val_acc: 0.9555
Epoch 10/20
 - 3s - loss: 0.2013 - acc: 0.9406 - val_loss: 0.1552 - val_acc: 0.9517
Epoch 11/20
 - 3s - loss: 0.2001 - acc: 0.9409 - val_loss: 0.2348 - val_acc: 0.9332
Epoch 12/20
 - 3s - loss: 0.1926 - acc: 0.9438 - val_loss: 0.1743 - val_acc: 0.9481
Epoch 13/20
 - 3s - loss: 0.1953 - acc: 0.9425 - val_loss: 0.1464 - val_acc: 0.9544
Epoch 14/20
 - 3s - loss: 0.1938 - acc: 0.9437 - val_loss: 0.1266 - val_acc: 0.9628
Epoch 15/20
 - 3s - loss: 0.1889 - acc: 0.9454 - val_loss: 0.1155 - val_acc: 0.9659
Epoch 16/20
 - 3s - loss: 0.1950 - acc: 0.9446 - val_loss: 0.1443 - val_acc: 0.9562
Epoch 17/20
 - 3s - loss: 0.1947 - acc: 0.9450 - val_loss: 0.1480 - val_acc: 0.9597
Epoch 18/20
 - 3s - loss: 0.1926 - acc: 0.9449 - val_loss: 0.1162 - val_acc: 0.9680
Epoch 19/20
 - 3s - loss: 0.1929 - acc: 0.9455 - val_loss: 0.1263 - val_acc: 0.9635
Epoch 20/20
 - 3s - loss: 0.1923 - acc: 0.9453 - val_loss: 0.2088 - val_acc: 0.9498
Test loss: 0.20498732107811374
Test accuracy: 0.947
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9591 - acc: 0.6919 - val_loss: 0.4097 - val_acc: 0.8671
Epoch 2/20
 - 3s - loss: 0.4514 - acc: 0.8554 - val_loss: 0.2798 - val_acc: 0.9147
Epoch 3/20
 - 3s - loss: 0.3387 - acc: 0.8934 - val_loss: 0.2760 - val_acc: 0.9093
Epoch 4/20
 - 3s - loss: 0.2864 - acc: 0.9108 - val_loss: 0.2146 - val_acc: 0.9334
Epoch 5/20
 - 3s - loss: 0.2497 - acc: 0.9236 - val_loss: 0.2529 - val_acc: 0.9145
Epoch 6/20
 - 3s - loss: 0.2277 - acc: 0.9299 - val_loss: 0.1621 - val_acc: 0.9498
Epoch 7/20
 - 3s - loss: 0.2160 - acc: 0.9337 - val_loss: 0.1314 - val_acc: 0.9572
Epoch 8/20
 - 3s - loss: 0.2055 - acc: 0.9364 - val_loss: 0.1135 - val_acc: 0.9632
Epoch 9/20
 - 3s - loss: 0.1959 - acc: 0.9404 - val_loss: 0.1835 - val_acc: 0.9489
Epoch 10/20
 - 3s - loss: 0.1950 - acc: 0.9413 - val_loss: 0.1465 - val_acc: 0.9542
Epoch 11/20
 - 3s - loss: 0.1878 - acc: 0.9433 - val_loss: 0.1281 - val_acc: 0.9613
Epoch 12/20
 - 3s - loss: 0.1868 - acc: 0.9456 - val_loss: 0.1505 - val_acc: 0.9529
Epoch 13/20
 - 3s - loss: 0.1825 - acc: 0.9465 - val_loss: 0.1392 - val_acc: 0.9598
Epoch 14/20
 - 3s - loss: 0.1790 - acc: 0.9481 - val_loss: 0.1589 - val_acc: 0.9521
Epoch 15/20
 - 3s - loss: 0.1787 - acc: 0.9473 - val_loss: 0.1383 - val_acc: 0.9627
Epoch 16/20
 - 3s - loss: 0.1796 - acc: 0.9497 - val_loss: 0.1203 - val_acc: 0.9639
Epoch 17/20
 - 3s - loss: 0.1758 - acc: 0.9486 - val_loss: 0.1201 - val_acc: 0.9669
Epoch 18/20
 - 3s - loss: 0.1766 - acc: 0.9498 - val_loss: 0.1116 - val_acc: 0.9678
Epoch 19/20
 - 3s - loss: 0.1808 - acc: 0.9497 - val_loss: 0.1219 - val_acc: 0.9623
Epoch 20/20
 - 3s - loss: 0.1820 - acc: 0.9491 - val_loss: 0.1336 - val_acc: 0.9627
Test loss: 0.13326327422975737
Test accuracy: 0.9627
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9521 - acc: 0.6903 - val_loss: 0.4292 - val_acc: 0.8651
Epoch 2/20
 - 3s - loss: 0.4411 - acc: 0.8584 - val_loss: 0.2087 - val_acc: 0.9342
Epoch 3/20
 - 3s - loss: 0.3293 - acc: 0.8971 - val_loss: 0.1961 - val_acc: 0.9399
Epoch 4/20
 - 3s - loss: 0.2764 - acc: 0.9132 - val_loss: 0.1706 - val_acc: 0.9454
Epoch 5/20
 - 3s - loss: 0.2449 - acc: 0.9233 - val_loss: 0.1468 - val_acc: 0.9555
Epoch 6/20
 - 3s - loss: 0.2231 - acc: 0.9308 - val_loss: 0.1386 - val_acc: 0.9575
Epoch 7/20
 - 3s - loss: 0.2089 - acc: 0.9365 - val_loss: 0.1606 - val_acc: 0.9487
Epoch 8/20
 - 3s - loss: 0.2031 - acc: 0.9388 - val_loss: 0.1402 - val_acc: 0.9560
Epoch 9/20
 - 3s - loss: 0.1930 - acc: 0.9414 - val_loss: 0.1263 - val_acc: 0.9617
Epoch 10/20
 - 3s - loss: 0.1898 - acc: 0.9437 - val_loss: 0.1008 - val_acc: 0.9686
Epoch 11/20
 - 3s - loss: 0.1838 - acc: 0.9465 - val_loss: 0.2530 - val_acc: 0.9235
Epoch 12/20
 - 3s - loss: 0.1797 - acc: 0.9476 - val_loss: 0.1496 - val_acc: 0.9579
Epoch 13/20
 - 3s - loss: 0.1786 - acc: 0.9490 - val_loss: 0.1185 - val_acc: 0.9651
Epoch 14/20
 - 3s - loss: 0.1744 - acc: 0.9499 - val_loss: 0.1466 - val_acc: 0.9533
Epoch 15/20
 - 3s - loss: 0.1757 - acc: 0.9497 - val_loss: 0.1298 - val_acc: 0.9634
Epoch 16/20
 - 3s - loss: 0.1775 - acc: 0.9500 - val_loss: 0.1478 - val_acc: 0.9603
Epoch 17/20
 - 3s - loss: 0.1725 - acc: 0.9513 - val_loss: 0.1055 - val_acc: 0.9723
Epoch 18/20
 - 3s - loss: 0.1790 - acc: 0.9503 - val_loss: 0.1327 - val_acc: 0.9569
Epoch 19/20
 - 3s - loss: 0.1765 - acc: 0.9516 - val_loss: 0.1176 - val_acc: 0.9671
Epoch 20/20
 - 3s - loss: 0.1738 - acc: 0.9507 - val_loss: 0.1034 - val_acc: 0.9699
Test loss: 0.10221741442133207
Test accuracy: 0.9704
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9403 - acc: 0.6989 - val_loss: 0.4747 - val_acc: 0.8312
Epoch 2/20
 - 3s - loss: 0.4365 - acc: 0.8617 - val_loss: 0.3151 - val_acc: 0.8959
Epoch 3/20
 - 3s - loss: 0.3291 - acc: 0.8962 - val_loss: 0.1843 - val_acc: 0.9424
Epoch 4/20
 - 3s - loss: 0.2764 - acc: 0.9137 - val_loss: 0.2450 - val_acc: 0.9227
Epoch 5/20
 - 3s - loss: 0.2409 - acc: 0.9261 - val_loss: 0.2027 - val_acc: 0.9383
Epoch 6/20
 - 3s - loss: 0.2221 - acc: 0.9308 - val_loss: 0.1672 - val_acc: 0.9476
Epoch 7/20
 - 3s - loss: 0.2056 - acc: 0.9366 - val_loss: 0.1895 - val_acc: 0.9442
Epoch 8/20
 - 3s - loss: 0.1946 - acc: 0.9408 - val_loss: 0.1687 - val_acc: 0.9489
Epoch 9/20
 - 3s - loss: 0.1831 - acc: 0.9442 - val_loss: 0.1555 - val_acc: 0.9499
Epoch 10/20
 - 3s - loss: 0.1803 - acc: 0.9453 - val_loss: 0.1248 - val_acc: 0.9621
Epoch 11/20
 - 3s - loss: 0.1727 - acc: 0.9483 - val_loss: 0.1377 - val_acc: 0.9561
Epoch 12/20
 - 3s - loss: 0.1660 - acc: 0.9508 - val_loss: 0.1462 - val_acc: 0.9543
Epoch 13/20
 - 3s - loss: 0.1665 - acc: 0.9507 - val_loss: 0.1323 - val_acc: 0.9600
Epoch 14/20
 - 3s - loss: 0.1664 - acc: 0.9514 - val_loss: 0.1422 - val_acc: 0.9585
Epoch 15/20
 - 3s - loss: 0.1616 - acc: 0.9522 - val_loss: 0.0958 - val_acc: 0.9723
Epoch 16/20
 - 3s - loss: 0.1587 - acc: 0.9537 - val_loss: 0.1644 - val_acc: 0.9621
Epoch 17/20
 - 3s - loss: 0.1614 - acc: 0.9536 - val_loss: 0.1350 - val_acc: 0.9677
Epoch 18/20
 - 3s - loss: 0.1635 - acc: 0.9528 - val_loss: 0.1192 - val_acc: 0.9659
Epoch 19/20
 - 3s - loss: 0.1580 - acc: 0.9551 - val_loss: 0.1107 - val_acc: 0.9691
Epoch 20/20
 - 3s - loss: 0.1603 - acc: 0.9548 - val_loss: 0.1054 - val_acc: 0.9718
Test loss: 0.1062460550511707
Test accuracy: 0.9708
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9273 - acc: 0.6985 - val_loss: 0.3773 - val_acc: 0.8771
Epoch 2/20
 - 4s - loss: 0.4300 - acc: 0.8625 - val_loss: 0.2579 - val_acc: 0.9181
Epoch 3/20
 - 4s - loss: 0.3183 - acc: 0.9005 - val_loss: 0.3003 - val_acc: 0.9022
Epoch 4/20
 - 4s - loss: 0.2687 - acc: 0.9163 - val_loss: 0.1577 - val_acc: 0.9510
Epoch 5/20
 - 4s - loss: 0.2425 - acc: 0.9253 - val_loss: 0.1374 - val_acc: 0.9552
Epoch 6/20
 - 4s - loss: 0.2150 - acc: 0.9333 - val_loss: 0.1722 - val_acc: 0.9453
Epoch 7/20
 - 4s - loss: 0.2027 - acc: 0.9375 - val_loss: 0.1402 - val_acc: 0.9551
Epoch 8/20
 - 4s - loss: 0.1927 - acc: 0.9429 - val_loss: 0.1824 - val_acc: 0.9453
Epoch 9/20
 - 4s - loss: 0.1901 - acc: 0.9437 - val_loss: 0.1926 - val_acc: 0.9422
Epoch 10/20
 - 4s - loss: 0.1796 - acc: 0.9467 - val_loss: 0.1503 - val_acc: 0.9523
Epoch 11/20
 - 4s - loss: 0.1763 - acc: 0.9483 - val_loss: 0.1207 - val_acc: 0.9621
Epoch 12/20
 - 4s - loss: 0.1707 - acc: 0.9497 - val_loss: 0.1240 - val_acc: 0.9649
Epoch 13/20
 - 4s - loss: 0.1694 - acc: 0.9501 - val_loss: 0.1028 - val_acc: 0.9682
Epoch 14/20
 - 4s - loss: 0.1681 - acc: 0.9519 - val_loss: 0.1109 - val_acc: 0.9667
Epoch 15/20
 - 4s - loss: 0.1683 - acc: 0.9517 - val_loss: 0.1103 - val_acc: 0.9691
Epoch 16/20
 - 4s - loss: 0.1659 - acc: 0.9524 - val_loss: 0.1308 - val_acc: 0.9615
Epoch 17/20
 - 4s - loss: 0.1679 - acc: 0.9528 - val_loss: 0.1094 - val_acc: 0.9685
Epoch 18/20
 - 4s - loss: 0.1657 - acc: 0.9527 - val_loss: 0.1191 - val_acc: 0.9684
Epoch 19/20
 - 4s - loss: 0.1668 - acc: 0.9536 - val_loss: 0.1088 - val_acc: 0.9712
Epoch 20/20
 - 4s - loss: 0.1648 - acc: 0.9536 - val_loss: 0.1282 - val_acc: 0.9676
Test loss: 0.12888553667123234
Test accuracy: 0.967
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9145 - acc: 0.7028 - val_loss: 0.7289 - val_acc: 0.7481
Epoch 2/20
 - 4s - loss: 0.4280 - acc: 0.8633 - val_loss: 0.3399 - val_acc: 0.8883
Epoch 3/20
 - 4s - loss: 0.3222 - acc: 0.8977 - val_loss: 0.2092 - val_acc: 0.9350
Epoch 4/20
 - 4s - loss: 0.2719 - acc: 0.9150 - val_loss: 0.3283 - val_acc: 0.8950
Epoch 5/20
 - 4s - loss: 0.2390 - acc: 0.9260 - val_loss: 0.3594 - val_acc: 0.8822
Epoch 6/20
 - 4s - loss: 0.2221 - acc: 0.9322 - val_loss: 0.1451 - val_acc: 0.9535
Epoch 7/20
 - 4s - loss: 0.2002 - acc: 0.9382 - val_loss: 0.1420 - val_acc: 0.9555
Epoch 8/20
 - 4s - loss: 0.1950 - acc: 0.9405 - val_loss: 0.1381 - val_acc: 0.9544
Epoch 9/20
 - 4s - loss: 0.1840 - acc: 0.9443 - val_loss: 0.1137 - val_acc: 0.9638
Epoch 10/20
 - 4s - loss: 0.1807 - acc: 0.9455 - val_loss: 0.1046 - val_acc: 0.9688
Epoch 11/20
 - 4s - loss: 0.1762 - acc: 0.9464 - val_loss: 0.1235 - val_acc: 0.9634
Epoch 12/20
 - 4s - loss: 0.1727 - acc: 0.9488 - val_loss: 0.1038 - val_acc: 0.9674
Epoch 13/20
 - 4s - loss: 0.1744 - acc: 0.9495 - val_loss: 0.1850 - val_acc: 0.9511
Epoch 14/20
 - 4s - loss: 0.1673 - acc: 0.9511 - val_loss: 0.1109 - val_acc: 0.9659
Epoch 15/20
 - 4s - loss: 0.1639 - acc: 0.9517 - val_loss: 0.1862 - val_acc: 0.9508
Epoch 16/20
 - 4s - loss: 0.1640 - acc: 0.9520 - val_loss: 0.1519 - val_acc: 0.9571
Epoch 17/20
 - 4s - loss: 0.1667 - acc: 0.9521 - val_loss: 0.1022 - val_acc: 0.9731
Epoch 18/20
 - 4s - loss: 0.1653 - acc: 0.9543 - val_loss: 0.1083 - val_acc: 0.9689
Epoch 19/20
 - 4s - loss: 0.1643 - acc: 0.9536 - val_loss: 0.1015 - val_acc: 0.9698
Epoch 20/20
 - 4s - loss: 0.1653 - acc: 0.9538 - val_loss: 0.1295 - val_acc: 0.9651
Test loss: 0.13155756439304678
Test accuracy: 0.9643
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9379 - acc: 0.6960 - val_loss: 0.3891 - val_acc: 0.8825
Epoch 2/20
 - 6s - loss: 0.4280 - acc: 0.8638 - val_loss: 0.3337 - val_acc: 0.8905
Epoch 3/20
 - 6s - loss: 0.3267 - acc: 0.8964 - val_loss: 0.2038 - val_acc: 0.9395
Epoch 4/20
 - 6s - loss: 0.2704 - acc: 0.9167 - val_loss: 0.2333 - val_acc: 0.9288
Epoch 5/20
 - 6s - loss: 0.2367 - acc: 0.9264 - val_loss: 0.1415 - val_acc: 0.9556
Epoch 6/20
 - 6s - loss: 0.2160 - acc: 0.9332 - val_loss: 0.1580 - val_acc: 0.9525
Epoch 7/20
 - 6s - loss: 0.2005 - acc: 0.9386 - val_loss: 0.1398 - val_acc: 0.9597
Epoch 8/20
 - 6s - loss: 0.1882 - acc: 0.9429 - val_loss: 0.1340 - val_acc: 0.9589
Epoch 9/20
 - 6s - loss: 0.1810 - acc: 0.9440 - val_loss: 0.1283 - val_acc: 0.9626
Epoch 10/20
 - 6s - loss: 0.1761 - acc: 0.9468 - val_loss: 0.1410 - val_acc: 0.9582
Epoch 11/20
 - 6s - loss: 0.1728 - acc: 0.9489 - val_loss: 0.1124 - val_acc: 0.9650
Epoch 12/20
 - 6s - loss: 0.1738 - acc: 0.9495 - val_loss: 0.1060 - val_acc: 0.9686
Epoch 13/20
 - 6s - loss: 0.1665 - acc: 0.9507 - val_loss: 0.1205 - val_acc: 0.9658
Epoch 14/20
 - 6s - loss: 0.1691 - acc: 0.9512 - val_loss: 0.1203 - val_acc: 0.9611
Epoch 15/20
 - 6s - loss: 0.1629 - acc: 0.9531 - val_loss: 0.1110 - val_acc: 0.9699
Epoch 16/20
 - 6s - loss: 0.1667 - acc: 0.9526 - val_loss: 0.1015 - val_acc: 0.9701
Epoch 17/20
 - 6s - loss: 0.1639 - acc: 0.9537 - val_loss: 0.1496 - val_acc: 0.9576
Epoch 18/20
 - 6s - loss: 0.1713 - acc: 0.9530 - val_loss: 0.1178 - val_acc: 0.9664
Epoch 19/20
 - 6s - loss: 0.1641 - acc: 0.9548 - val_loss: 0.2083 - val_acc: 0.9368
Epoch 20/20
 - 6s - loss: 0.1651 - acc: 0.9541 - val_loss: 0.0933 - val_acc: 0.9761
Test loss: 0.09329342001529876
Test accuracy: 0.9758
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9326 - acc: 0.6970 - val_loss: 0.5494 - val_acc: 0.8218
Epoch 2/20
 - 9s - loss: 0.4382 - acc: 0.8618 - val_loss: 0.3049 - val_acc: 0.8974
Epoch 3/20
 - 9s - loss: 0.3260 - acc: 0.8985 - val_loss: 0.2190 - val_acc: 0.9283
Epoch 4/20
 - 9s - loss: 0.2711 - acc: 0.9160 - val_loss: 0.2936 - val_acc: 0.9011
Epoch 5/20
 - 9s - loss: 0.2392 - acc: 0.9269 - val_loss: 0.1855 - val_acc: 0.9396
Epoch 6/20
 - 9s - loss: 0.2185 - acc: 0.9322 - val_loss: 0.1391 - val_acc: 0.9536
Epoch 7/20
 - 9s - loss: 0.2034 - acc: 0.9372 - val_loss: 0.2712 - val_acc: 0.9178
Epoch 8/20
 - 9s - loss: 0.1937 - acc: 0.9414 - val_loss: 0.1287 - val_acc: 0.9603
Epoch 9/20
 - 9s - loss: 0.1858 - acc: 0.9454 - val_loss: 0.1161 - val_acc: 0.9652
Epoch 10/20
 - 9s - loss: 0.1789 - acc: 0.9464 - val_loss: 0.1089 - val_acc: 0.9670
Epoch 11/20
 - 9s - loss: 0.1791 - acc: 0.9480 - val_loss: 0.0937 - val_acc: 0.9713
Epoch 12/20
 - 9s - loss: 0.1740 - acc: 0.9493 - val_loss: 0.2175 - val_acc: 0.9321
Epoch 13/20
 - 9s - loss: 0.1682 - acc: 0.9512 - val_loss: 0.1875 - val_acc: 0.9409
Epoch 14/20
 - 9s - loss: 0.1673 - acc: 0.9517 - val_loss: 0.1162 - val_acc: 0.9641
Epoch 15/20
 - 9s - loss: 0.1667 - acc: 0.9526 - val_loss: 0.1214 - val_acc: 0.9624
Epoch 16/20
 - 9s - loss: 0.1620 - acc: 0.9544 - val_loss: 0.2350 - val_acc: 0.9384
Epoch 17/20
 - 9s - loss: 0.1692 - acc: 0.9533 - val_loss: 0.1139 - val_acc: 0.9663
Epoch 18/20
 - 9s - loss: 0.1695 - acc: 0.9524 - val_loss: 0.1590 - val_acc: 0.9490
Epoch 19/20
 - 9s - loss: 0.1676 - acc: 0.9542 - val_loss: 0.1185 - val_acc: 0.9688
Epoch 20/20
 - 9s - loss: 0.1676 - acc: 0.9533 - val_loss: 0.0943 - val_acc: 0.9703
Test loss: 0.09441878169177653
Test accuracy: 0.9701
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9384 - acc: 0.6987 - val_loss: 0.4340 - val_acc: 0.8617
Epoch 2/20
 - 14s - loss: 0.4275 - acc: 0.8641 - val_loss: 0.7860 - val_acc: 0.7800
Epoch 3/20
 - 14s - loss: 0.3202 - acc: 0.9009 - val_loss: 0.3128 - val_acc: 0.8813
Epoch 4/20
 - 14s - loss: 0.2665 - acc: 0.9164 - val_loss: 0.2651 - val_acc: 0.9206
Epoch 5/20
 - 14s - loss: 0.2390 - acc: 0.9258 - val_loss: 0.1680 - val_acc: 0.9478
Epoch 6/20
 - 14s - loss: 0.2145 - acc: 0.9338 - val_loss: 0.1512 - val_acc: 0.9531
Epoch 7/20
 - 14s - loss: 0.2008 - acc: 0.9377 - val_loss: 0.1668 - val_acc: 0.9513
Epoch 8/20
 - 14s - loss: 0.1903 - acc: 0.9423 - val_loss: 0.1103 - val_acc: 0.9683
Epoch 9/20
 - 14s - loss: 0.1789 - acc: 0.9458 - val_loss: 0.1430 - val_acc: 0.9594
Epoch 10/20
 - 14s - loss: 0.1732 - acc: 0.9466 - val_loss: 0.1194 - val_acc: 0.9644
Epoch 11/20
 - 14s - loss: 0.1703 - acc: 0.9497 - val_loss: 0.1134 - val_acc: 0.9635
Epoch 12/20
 - 14s - loss: 0.1647 - acc: 0.9508 - val_loss: 0.0995 - val_acc: 0.9711
Epoch 13/20
 - 14s - loss: 0.1640 - acc: 0.9521 - val_loss: 0.1117 - val_acc: 0.9697
Epoch 14/20
 - 14s - loss: 0.1633 - acc: 0.9520 - val_loss: 0.1023 - val_acc: 0.9711
Epoch 15/20
 - 14s - loss: 0.1656 - acc: 0.9528 - val_loss: 0.1383 - val_acc: 0.9612
Epoch 16/20
 - 14s - loss: 0.1655 - acc: 0.9519 - val_loss: 0.1267 - val_acc: 0.9635
Epoch 17/20
 - 14s - loss: 0.1610 - acc: 0.9534 - val_loss: 0.0924 - val_acc: 0.9708
Epoch 18/20
 - 14s - loss: 0.1597 - acc: 0.9553 - val_loss: 0.1646 - val_acc: 0.9622
Epoch 19/20
 - 14s - loss: 0.1644 - acc: 0.9540 - val_loss: 0.1034 - val_acc: 0.9700
Epoch 20/20
 - 14s - loss: 0.1597 - acc: 0.9550 - val_loss: 0.1112 - val_acc: 0.9686
Test loss: 0.11106359819286736
Test accuracy: 0.9684
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9331 - acc: 0.6997 - val_loss: 0.5034 - val_acc: 0.8317
Epoch 2/20
 - 26s - loss: 0.4350 - acc: 0.8627 - val_loss: 0.2773 - val_acc: 0.9129
Epoch 3/20
 - 26s - loss: 0.3255 - acc: 0.8972 - val_loss: 0.2969 - val_acc: 0.9042
Epoch 4/20
 - 26s - loss: 0.2690 - acc: 0.9175 - val_loss: 0.2260 - val_acc: 0.9263
Epoch 5/20
 - 26s - loss: 0.2371 - acc: 0.9276 - val_loss: 0.1746 - val_acc: 0.9474
Epoch 6/20
 - 26s - loss: 0.2177 - acc: 0.9322 - val_loss: 0.1654 - val_acc: 0.9483
Epoch 7/20
 - 26s - loss: 0.2024 - acc: 0.9384 - val_loss: 0.1518 - val_acc: 0.9477
Epoch 8/20
 - 26s - loss: 0.1917 - acc: 0.9411 - val_loss: 0.1378 - val_acc: 0.9571
Epoch 9/20
 - 26s - loss: 0.1834 - acc: 0.9446 - val_loss: 0.2393 - val_acc: 0.9387
Epoch 10/20
 - 26s - loss: 0.1780 - acc: 0.9462 - val_loss: 0.1360 - val_acc: 0.9587
Epoch 11/20
 - 26s - loss: 0.1766 - acc: 0.9474 - val_loss: 0.1080 - val_acc: 0.9671
Epoch 12/20
 - 26s - loss: 0.1666 - acc: 0.9504 - val_loss: 0.1420 - val_acc: 0.9547
Epoch 13/20
 - 26s - loss: 0.1689 - acc: 0.9502 - val_loss: 0.1107 - val_acc: 0.9677
Epoch 14/20
 - 26s - loss: 0.1700 - acc: 0.9501 - val_loss: 0.1138 - val_acc: 0.9675
Epoch 15/20
 - 26s - loss: 0.1678 - acc: 0.9514 - val_loss: 0.0912 - val_acc: 0.9733
Epoch 16/20
 - 26s - loss: 0.1654 - acc: 0.9526 - val_loss: 0.1300 - val_acc: 0.9653
Epoch 17/20
 - 26s - loss: 0.1588 - acc: 0.9543 - val_loss: 0.1258 - val_acc: 0.9645
Epoch 18/20
 - 26s - loss: 0.1636 - acc: 0.9537 - val_loss: 0.1298 - val_acc: 0.9660
Epoch 19/20
 - 26s - loss: 0.1637 - acc: 0.9547 - val_loss: 0.1143 - val_acc: 0.9672
Epoch 20/20
 - 26s - loss: 0.1594 - acc: 0.9547 - val_loss: 0.0986 - val_acc: 0.9713
Test loss: 0.09864563588597812
Test accuracy: 0.9711
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9631 - acc: 0.6880 - val_loss: 0.5081 - val_acc: 0.8198
Epoch 2/20
 - 3s - loss: 0.4550 - acc: 0.8543 - val_loss: 0.2886 - val_acc: 0.9060
Epoch 3/20
 - 3s - loss: 0.3496 - acc: 0.8899 - val_loss: 0.1948 - val_acc: 0.9373
Epoch 4/20
 - 3s - loss: 0.2945 - acc: 0.9065 - val_loss: 0.2603 - val_acc: 0.9138
Epoch 5/20
 - 3s - loss: 0.2599 - acc: 0.9190 - val_loss: 0.2250 - val_acc: 0.9293
Epoch 6/20
 - 3s - loss: 0.2401 - acc: 0.9250 - val_loss: 0.1484 - val_acc: 0.9533
Epoch 7/20
 - 3s - loss: 0.2290 - acc: 0.9298 - val_loss: 0.1894 - val_acc: 0.9456
Epoch 8/20
 - 3s - loss: 0.2201 - acc: 0.9330 - val_loss: 0.1594 - val_acc: 0.9503
Epoch 9/20
 - 3s - loss: 0.2127 - acc: 0.9356 - val_loss: 0.1651 - val_acc: 0.9486
Epoch 10/20
 - 3s - loss: 0.2062 - acc: 0.9386 - val_loss: 0.1822 - val_acc: 0.9454
Epoch 11/20
 - 3s - loss: 0.2003 - acc: 0.9405 - val_loss: 0.1859 - val_acc: 0.9426
Epoch 12/20
 - 3s - loss: 0.2034 - acc: 0.9404 - val_loss: 0.2312 - val_acc: 0.9197
Epoch 13/20
 - 3s - loss: 0.1967 - acc: 0.9428 - val_loss: 0.1364 - val_acc: 0.9592
Epoch 14/20
 - 3s - loss: 0.2008 - acc: 0.9413 - val_loss: 0.1542 - val_acc: 0.9536
Epoch 15/20
 - 3s - loss: 0.2023 - acc: 0.9414 - val_loss: 0.1461 - val_acc: 0.9573
Epoch 16/20
 - 3s - loss: 0.1992 - acc: 0.9428 - val_loss: 0.1219 - val_acc: 0.9640
Epoch 17/20
 - 3s - loss: 0.1974 - acc: 0.9440 - val_loss: 0.1277 - val_acc: 0.9605
Epoch 18/20
 - 3s - loss: 0.2003 - acc: 0.9438 - val_loss: 0.1484 - val_acc: 0.9602
Epoch 19/20
 - 3s - loss: 0.1998 - acc: 0.9435 - val_loss: 0.1388 - val_acc: 0.9616
Epoch 20/20
 - 3s - loss: 0.2011 - acc: 0.9444 - val_loss: 0.1191 - val_acc: 0.9642
Test loss: 0.12114396994095296
Test accuracy: 0.9635
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9342 - acc: 0.6950 - val_loss: 0.4124 - val_acc: 0.8732
Epoch 2/20
 - 3s - loss: 0.4443 - acc: 0.8575 - val_loss: 0.2911 - val_acc: 0.9076
Epoch 3/20
 - 3s - loss: 0.3326 - acc: 0.8934 - val_loss: 0.2066 - val_acc: 0.9352
Epoch 4/20
 - 3s - loss: 0.2758 - acc: 0.9139 - val_loss: 0.1617 - val_acc: 0.9464
Epoch 5/20
 - 3s - loss: 0.2436 - acc: 0.9245 - val_loss: 0.1375 - val_acc: 0.9566
Epoch 6/20
 - 3s - loss: 0.2242 - acc: 0.9315 - val_loss: 0.1327 - val_acc: 0.9578
Epoch 7/20
 - 3s - loss: 0.2112 - acc: 0.9357 - val_loss: 0.1622 - val_acc: 0.9493
Epoch 8/20
 - 3s - loss: 0.2059 - acc: 0.9370 - val_loss: 0.1403 - val_acc: 0.9571
Epoch 9/20
 - 3s - loss: 0.1950 - acc: 0.9409 - val_loss: 0.1814 - val_acc: 0.9481
Epoch 10/20
 - 3s - loss: 0.1920 - acc: 0.9432 - val_loss: 0.1291 - val_acc: 0.9616
Epoch 11/20
 - 3s - loss: 0.1876 - acc: 0.9437 - val_loss: 0.1939 - val_acc: 0.9474
Epoch 12/20
 - 3s - loss: 0.1804 - acc: 0.9469 - val_loss: 0.1232 - val_acc: 0.9652
Epoch 13/20
 - 3s - loss: 0.1833 - acc: 0.9475 - val_loss: 0.1193 - val_acc: 0.9654
Epoch 14/20
 - 3s - loss: 0.1798 - acc: 0.9471 - val_loss: 0.1237 - val_acc: 0.9650
Epoch 15/20
 - 3s - loss: 0.1802 - acc: 0.9479 - val_loss: 0.1398 - val_acc: 0.9598
Epoch 16/20
 - 3s - loss: 0.1790 - acc: 0.9487 - val_loss: 0.1355 - val_acc: 0.9573
Epoch 17/20
 - 3s - loss: 0.1808 - acc: 0.9485 - val_loss: 0.1218 - val_acc: 0.9651
Epoch 18/20
 - 3s - loss: 0.1783 - acc: 0.9493 - val_loss: 0.1002 - val_acc: 0.9699
Epoch 19/20
 - 3s - loss: 0.1822 - acc: 0.9487 - val_loss: 0.1226 - val_acc: 0.9686
Epoch 20/20
 - 3s - loss: 0.1766 - acc: 0.9500 - val_loss: 0.1014 - val_acc: 0.9705
Test loss: 0.10103789272336289
Test accuracy: 0.9689
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9300 - acc: 0.6978 - val_loss: 0.4033 - val_acc: 0.8714
Epoch 2/20
 - 3s - loss: 0.4338 - acc: 0.8625 - val_loss: 0.3535 - val_acc: 0.8835
Epoch 3/20
 - 3s - loss: 0.3304 - acc: 0.8963 - val_loss: 0.3446 - val_acc: 0.8891
Epoch 4/20
 - 3s - loss: 0.2804 - acc: 0.9119 - val_loss: 0.2042 - val_acc: 0.9372
Epoch 5/20
 - 3s - loss: 0.2407 - acc: 0.9249 - val_loss: 0.2278 - val_acc: 0.9244
Epoch 6/20
 - 3s - loss: 0.2232 - acc: 0.9310 - val_loss: 0.1538 - val_acc: 0.9518
Epoch 7/20
 - 3s - loss: 0.2051 - acc: 0.9358 - val_loss: 0.1399 - val_acc: 0.9570
Epoch 8/20
 - 3s - loss: 0.1965 - acc: 0.9403 - val_loss: 0.2457 - val_acc: 0.9260
Epoch 9/20
 - 3s - loss: 0.1863 - acc: 0.9438 - val_loss: 0.1172 - val_acc: 0.9647
Epoch 10/20
 - 3s - loss: 0.1848 - acc: 0.9447 - val_loss: 0.1665 - val_acc: 0.9497
Epoch 11/20
 - 3s - loss: 0.1800 - acc: 0.9459 - val_loss: 0.1569 - val_acc: 0.9523
Epoch 12/20
 - 3s - loss: 0.1772 - acc: 0.9470 - val_loss: 0.1093 - val_acc: 0.9682
Epoch 13/20
 - 3s - loss: 0.1741 - acc: 0.9486 - val_loss: 0.1500 - val_acc: 0.9554
Epoch 14/20
 - 3s - loss: 0.1763 - acc: 0.9485 - val_loss: 0.1440 - val_acc: 0.9540
Epoch 15/20
 - 3s - loss: 0.1714 - acc: 0.9502 - val_loss: 0.1085 - val_acc: 0.9676
Epoch 16/20
 - 3s - loss: 0.1718 - acc: 0.9508 - val_loss: 0.1263 - val_acc: 0.9653
Epoch 17/20
 - 3s - loss: 0.1678 - acc: 0.9517 - val_loss: 0.1058 - val_acc: 0.9679
Epoch 18/20
 - 3s - loss: 0.1684 - acc: 0.9519 - val_loss: 0.1043 - val_acc: 0.9698
Epoch 19/20
 - 3s - loss: 0.1659 - acc: 0.9529 - val_loss: 0.1282 - val_acc: 0.9645
Epoch 20/20
 - 3s - loss: 0.1696 - acc: 0.9528 - val_loss: 0.1079 - val_acc: 0.9689
Test loss: 0.10579215823273408
Test accuracy: 0.9701
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9411 - acc: 0.6983 - val_loss: 0.4382 - val_acc: 0.8515
Epoch 2/20
 - 3s - loss: 0.4351 - acc: 0.8601 - val_loss: 0.3038 - val_acc: 0.8958
Epoch 3/20
 - 3s - loss: 0.3209 - acc: 0.8983 - val_loss: 0.1875 - val_acc: 0.9397
Epoch 4/20
 - 3s - loss: 0.2684 - acc: 0.9146 - val_loss: 0.2240 - val_acc: 0.9274
Epoch 5/20
 - 3s - loss: 0.2386 - acc: 0.9261 - val_loss: 0.1372 - val_acc: 0.9574
Epoch 6/20
 - 3s - loss: 0.2172 - acc: 0.9338 - val_loss: 0.2710 - val_acc: 0.9129
Epoch 7/20
 - 3s - loss: 0.2044 - acc: 0.9371 - val_loss: 0.1575 - val_acc: 0.9556
Epoch 8/20
 - 3s - loss: 0.1912 - acc: 0.9426 - val_loss: 0.1680 - val_acc: 0.9452
Epoch 9/20
 - 3s - loss: 0.1870 - acc: 0.9440 - val_loss: 0.1789 - val_acc: 0.9449
Epoch 10/20
 - 3s - loss: 0.1792 - acc: 0.9464 - val_loss: 0.1195 - val_acc: 0.9632
Epoch 11/20
 - 3s - loss: 0.1749 - acc: 0.9486 - val_loss: 0.1214 - val_acc: 0.9617
Epoch 12/20
 - 3s - loss: 0.1714 - acc: 0.9491 - val_loss: 0.1472 - val_acc: 0.9548
Epoch 13/20
 - 3s - loss: 0.1678 - acc: 0.9515 - val_loss: 0.1154 - val_acc: 0.9689
Epoch 14/20
 - 3s - loss: 0.1696 - acc: 0.9515 - val_loss: 0.1199 - val_acc: 0.9679
Epoch 15/20
 - 3s - loss: 0.1729 - acc: 0.9509 - val_loss: 0.1003 - val_acc: 0.9715
Epoch 16/20
 - 3s - loss: 0.1690 - acc: 0.9516 - val_loss: 0.1291 - val_acc: 0.9646
Epoch 17/20
 - 3s - loss: 0.1668 - acc: 0.9547 - val_loss: 0.1246 - val_acc: 0.9645
Epoch 18/20
 - 3s - loss: 0.1662 - acc: 0.9527 - val_loss: 0.1423 - val_acc: 0.9596
Epoch 19/20
 - 3s - loss: 0.1674 - acc: 0.9541 - val_loss: 0.1091 - val_acc: 0.9695
Epoch 20/20
 - 3s - loss: 0.1714 - acc: 0.9534 - val_loss: 0.1443 - val_acc: 0.9601
Test loss: 0.14525368994390592
Test accuracy: 0.9592
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9606 - acc: 0.6945 - val_loss: 0.5065 - val_acc: 0.8349
Epoch 2/20
 - 4s - loss: 0.4302 - acc: 0.8621 - val_loss: 0.2646 - val_acc: 0.9170
Epoch 3/20
 - 4s - loss: 0.3279 - acc: 0.8978 - val_loss: 0.2530 - val_acc: 0.9162
Epoch 4/20
 - 4s - loss: 0.2674 - acc: 0.9159 - val_loss: 0.1706 - val_acc: 0.9477
Epoch 5/20
 - 4s - loss: 0.2444 - acc: 0.9240 - val_loss: 0.1464 - val_acc: 0.9539
Epoch 6/20
 - 4s - loss: 0.2195 - acc: 0.9328 - val_loss: 0.1640 - val_acc: 0.9493
Epoch 7/20
 - 4s - loss: 0.2045 - acc: 0.9380 - val_loss: 0.1244 - val_acc: 0.9607
Epoch 8/20
 - 4s - loss: 0.1946 - acc: 0.9406 - val_loss: 0.1554 - val_acc: 0.9505
Epoch 9/20
 - 4s - loss: 0.1866 - acc: 0.9443 - val_loss: 0.1683 - val_acc: 0.9500
Epoch 10/20
 - 4s - loss: 0.1787 - acc: 0.9464 - val_loss: 0.1533 - val_acc: 0.9548
Epoch 11/20
 - 4s - loss: 0.1775 - acc: 0.9470 - val_loss: 0.1101 - val_acc: 0.9666
Epoch 12/20
 - 4s - loss: 0.1699 - acc: 0.9495 - val_loss: 0.1130 - val_acc: 0.9659
Epoch 13/20
 - 4s - loss: 0.1742 - acc: 0.9504 - val_loss: 0.1757 - val_acc: 0.9456
Epoch 14/20
 - 4s - loss: 0.1695 - acc: 0.9514 - val_loss: 0.1016 - val_acc: 0.9708
Epoch 15/20
 - 4s - loss: 0.1647 - acc: 0.9528 - val_loss: 0.1159 - val_acc: 0.9662
Epoch 16/20
 - 4s - loss: 0.1612 - acc: 0.9540 - val_loss: 0.1036 - val_acc: 0.9724
Epoch 17/20
 - 4s - loss: 0.1641 - acc: 0.9533 - val_loss: 0.1162 - val_acc: 0.9670
Epoch 18/20
 - 4s - loss: 0.1660 - acc: 0.9532 - val_loss: 0.1261 - val_acc: 0.9673
Epoch 19/20
 - 4s - loss: 0.1689 - acc: 0.9539 - val_loss: 0.1315 - val_acc: 0.9664
Epoch 20/20
 - 4s - loss: 0.1652 - acc: 0.9544 - val_loss: 0.1523 - val_acc: 0.9568
Test loss: 0.15350336981769652
Test accuracy: 0.9563
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9305 - acc: 0.6962 - val_loss: 0.4552 - val_acc: 0.8526
Epoch 2/20
 - 4s - loss: 0.4315 - acc: 0.8618 - val_loss: 0.3321 - val_acc: 0.8915
Epoch 3/20
 - 4s - loss: 0.3200 - acc: 0.8984 - val_loss: 0.2364 - val_acc: 0.9244
Epoch 4/20
 - 4s - loss: 0.2682 - acc: 0.9154 - val_loss: 0.1664 - val_acc: 0.9463
Epoch 5/20
 - 4s - loss: 0.2382 - acc: 0.9266 - val_loss: 0.1297 - val_acc: 0.9608
Epoch 6/20
 - 4s - loss: 0.2195 - acc: 0.9333 - val_loss: 0.1269 - val_acc: 0.9609
Epoch 7/20
 - 4s - loss: 0.2020 - acc: 0.9380 - val_loss: 0.1352 - val_acc: 0.9602
Epoch 8/20
 - 4s - loss: 0.1919 - acc: 0.9412 - val_loss: 0.1137 - val_acc: 0.9643
Epoch 9/20
 - 4s - loss: 0.1842 - acc: 0.9446 - val_loss: 0.1250 - val_acc: 0.9627
Epoch 10/20
 - 4s - loss: 0.1815 - acc: 0.9463 - val_loss: 0.1184 - val_acc: 0.9644
Epoch 11/20
 - 4s - loss: 0.1727 - acc: 0.9486 - val_loss: 0.1193 - val_acc: 0.9660
Epoch 12/20
 - 4s - loss: 0.1706 - acc: 0.9501 - val_loss: 0.1254 - val_acc: 0.9596
Epoch 13/20
 - 4s - loss: 0.1678 - acc: 0.9499 - val_loss: 0.1182 - val_acc: 0.9681
Epoch 14/20
 - 4s - loss: 0.1702 - acc: 0.9503 - val_loss: 0.1724 - val_acc: 0.9537
Epoch 15/20
 - 4s - loss: 0.1645 - acc: 0.9533 - val_loss: 0.0972 - val_acc: 0.9702
Epoch 16/20
 - 4s - loss: 0.1624 - acc: 0.9529 - val_loss: 0.1232 - val_acc: 0.9635
Epoch 17/20
 - 4s - loss: 0.1654 - acc: 0.9533 - val_loss: 0.1164 - val_acc: 0.9643
Epoch 18/20
 - 4s - loss: 0.1634 - acc: 0.9531 - val_loss: 0.1508 - val_acc: 0.9532
Epoch 19/20
 - 4s - loss: 0.1630 - acc: 0.9556 - val_loss: 0.1197 - val_acc: 0.9655
Epoch 20/20
 - 4s - loss: 0.1622 - acc: 0.9550 - val_loss: 0.1145 - val_acc: 0.9683
Test loss: 0.11369682923860092
Test accuracy: 0.9681
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9354 - acc: 0.6954 - val_loss: 0.3969 - val_acc: 0.8700
Epoch 2/20
 - 6s - loss: 0.4314 - acc: 0.8631 - val_loss: 0.6484 - val_acc: 0.7882
Epoch 3/20
 - 6s - loss: 0.3198 - acc: 0.9000 - val_loss: 0.2336 - val_acc: 0.9240
Epoch 4/20
 - 6s - loss: 0.2635 - acc: 0.9196 - val_loss: 0.2043 - val_acc: 0.9360
Epoch 5/20
 - 6s - loss: 0.2350 - acc: 0.9280 - val_loss: 0.1533 - val_acc: 0.9516
Epoch 6/20
 - 6s - loss: 0.2133 - acc: 0.9352 - val_loss: 0.1459 - val_acc: 0.9567
Epoch 7/20
 - 6s - loss: 0.2020 - acc: 0.9387 - val_loss: 0.1203 - val_acc: 0.9624
Epoch 8/20
 - 6s - loss: 0.1953 - acc: 0.9412 - val_loss: 0.1051 - val_acc: 0.9701
Epoch 9/20
 - 6s - loss: 0.1832 - acc: 0.9452 - val_loss: 0.1334 - val_acc: 0.9591
Epoch 10/20
 - 6s - loss: 0.1841 - acc: 0.9465 - val_loss: 0.1512 - val_acc: 0.9525
Epoch 11/20
 - 6s - loss: 0.1782 - acc: 0.9482 - val_loss: 0.1362 - val_acc: 0.9588
Epoch 12/20
 - 6s - loss: 0.1730 - acc: 0.9483 - val_loss: 0.1229 - val_acc: 0.9646
Epoch 13/20
 - 6s - loss: 0.1711 - acc: 0.9500 - val_loss: 0.1252 - val_acc: 0.9637
Epoch 14/20
 - 6s - loss: 0.1742 - acc: 0.9508 - val_loss: 0.1169 - val_acc: 0.9646
Epoch 15/20
 - 6s - loss: 0.1707 - acc: 0.9510 - val_loss: 0.1047 - val_acc: 0.9724
Epoch 16/20
 - 6s - loss: 0.1671 - acc: 0.9527 - val_loss: 0.0991 - val_acc: 0.9695
Epoch 17/20
 - 6s - loss: 0.1701 - acc: 0.9524 - val_loss: 0.1322 - val_acc: 0.9579
Epoch 18/20
 - 6s - loss: 0.1679 - acc: 0.9531 - val_loss: 0.1236 - val_acc: 0.9661
Epoch 19/20
 - 6s - loss: 0.1674 - acc: 0.9542 - val_loss: 0.0986 - val_acc: 0.9723
Epoch 20/20
 - 6s - loss: 0.1718 - acc: 0.9536 - val_loss: 0.1098 - val_acc: 0.9690
Test loss: 0.10921799591709859
Test accuracy: 0.9692
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9319 - acc: 0.6999 - val_loss: 0.6802 - val_acc: 0.7950
Epoch 2/20
 - 9s - loss: 0.4246 - acc: 0.8645 - val_loss: 0.3179 - val_acc: 0.8979
Epoch 3/20
 - 9s - loss: 0.3169 - acc: 0.9013 - val_loss: 0.2302 - val_acc: 0.9237
Epoch 4/20
 - 9s - loss: 0.2647 - acc: 0.9173 - val_loss: 0.1707 - val_acc: 0.9425
Epoch 5/20
 - 9s - loss: 0.2315 - acc: 0.9288 - val_loss: 0.1489 - val_acc: 0.9556
Epoch 6/20
 - 9s - loss: 0.2136 - acc: 0.9348 - val_loss: 0.1404 - val_acc: 0.9572
Epoch 7/20
 - 9s - loss: 0.1996 - acc: 0.9388 - val_loss: 0.1274 - val_acc: 0.9590
Epoch 8/20
 - 9s - loss: 0.1908 - acc: 0.9416 - val_loss: 0.1870 - val_acc: 0.9433
Epoch 9/20
 - 9s - loss: 0.1830 - acc: 0.9448 - val_loss: 0.1511 - val_acc: 0.9556
Epoch 10/20
 - 9s - loss: 0.1778 - acc: 0.9466 - val_loss: 0.1121 - val_acc: 0.9661
Epoch 11/20
 - 9s - loss: 0.1718 - acc: 0.9492 - val_loss: 0.1158 - val_acc: 0.9663
Epoch 12/20
 - 9s - loss: 0.1692 - acc: 0.9501 - val_loss: 0.1061 - val_acc: 0.9684
Epoch 13/20
 - 9s - loss: 0.1683 - acc: 0.9516 - val_loss: 0.1018 - val_acc: 0.9705
Epoch 14/20
 - 9s - loss: 0.1694 - acc: 0.9515 - val_loss: 0.1135 - val_acc: 0.9679
Epoch 15/20
 - 9s - loss: 0.1662 - acc: 0.9525 - val_loss: 0.1006 - val_acc: 0.9690
Epoch 16/20
 - 9s - loss: 0.1663 - acc: 0.9536 - val_loss: 0.1034 - val_acc: 0.9701
Epoch 17/20
 - 9s - loss: 0.1644 - acc: 0.9540 - val_loss: 0.1354 - val_acc: 0.9661
Epoch 18/20
 - 9s - loss: 0.1664 - acc: 0.9535 - val_loss: 0.1051 - val_acc: 0.9708
Epoch 19/20
 - 9s - loss: 0.1634 - acc: 0.9551 - val_loss: 0.1123 - val_acc: 0.9692
Epoch 20/20
 - 9s - loss: 0.1729 - acc: 0.9523 - val_loss: 0.1002 - val_acc: 0.9720
Test loss: 0.09945707420502149
Test accuracy: 0.9726
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9518 - acc: 0.6991 - val_loss: 0.4072 - val_acc: 0.8728
Epoch 2/20
 - 14s - loss: 0.4306 - acc: 0.8630 - val_loss: 0.2483 - val_acc: 0.9194
Epoch 3/20
 - 14s - loss: 0.3187 - acc: 0.9010 - val_loss: 0.2331 - val_acc: 0.9245
Epoch 4/20
 - 14s - loss: 0.2652 - acc: 0.9180 - val_loss: 0.2781 - val_acc: 0.9129
Epoch 5/20
 - 14s - loss: 0.2352 - acc: 0.9284 - val_loss: 0.1889 - val_acc: 0.9424
Epoch 6/20
 - 14s - loss: 0.2157 - acc: 0.9343 - val_loss: 0.1442 - val_acc: 0.9535
Epoch 7/20
 - 14s - loss: 0.1988 - acc: 0.9391 - val_loss: 0.1425 - val_acc: 0.9560
Epoch 8/20
 - 14s - loss: 0.1904 - acc: 0.9424 - val_loss: 0.1525 - val_acc: 0.9498
Epoch 9/20
 - 14s - loss: 0.1807 - acc: 0.9452 - val_loss: 0.1432 - val_acc: 0.9588
Epoch 10/20
 - 14s - loss: 0.1770 - acc: 0.9474 - val_loss: 0.1699 - val_acc: 0.9457
Epoch 11/20
 - 14s - loss: 0.1727 - acc: 0.9495 - val_loss: 0.1298 - val_acc: 0.9581
Epoch 12/20
 - 14s - loss: 0.1705 - acc: 0.9501 - val_loss: 0.1070 - val_acc: 0.9684
Epoch 13/20
 - 14s - loss: 0.1637 - acc: 0.9509 - val_loss: 0.1024 - val_acc: 0.9688
Epoch 14/20
 - 14s - loss: 0.1647 - acc: 0.9527 - val_loss: 0.1032 - val_acc: 0.9703
Epoch 15/20
 - 14s - loss: 0.1617 - acc: 0.9542 - val_loss: 0.1043 - val_acc: 0.9693
Epoch 16/20
 - 14s - loss: 0.1630 - acc: 0.9540 - val_loss: 0.1206 - val_acc: 0.9683
Epoch 17/20
 - 14s - loss: 0.1605 - acc: 0.9537 - val_loss: 0.1523 - val_acc: 0.9528
Epoch 18/20
 - 14s - loss: 0.1580 - acc: 0.9544 - val_loss: 0.0993 - val_acc: 0.9686
Epoch 19/20
 - 14s - loss: 0.1584 - acc: 0.9548 - val_loss: 0.1114 - val_acc: 0.9635
Epoch 20/20
 - 14s - loss: 0.1623 - acc: 0.9561 - val_loss: 0.1167 - val_acc: 0.9666
Test loss: 0.11628904628238525
Test accuracy: 0.9666
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9344 - acc: 0.6970 - val_loss: 0.4227 - val_acc: 0.8507
Epoch 2/20
 - 26s - loss: 0.4327 - acc: 0.8629 - val_loss: 0.4696 - val_acc: 0.8541
Epoch 3/20
 - 26s - loss: 0.3174 - acc: 0.8999 - val_loss: 0.1948 - val_acc: 0.9390
Epoch 4/20
 - 26s - loss: 0.2709 - acc: 0.9151 - val_loss: 0.1744 - val_acc: 0.9453
Epoch 5/20
 - 26s - loss: 0.2370 - acc: 0.9271 - val_loss: 0.1657 - val_acc: 0.9486
Epoch 6/20
 - 26s - loss: 0.2146 - acc: 0.9346 - val_loss: 0.2025 - val_acc: 0.9391
Epoch 7/20
 - 26s - loss: 0.2044 - acc: 0.9382 - val_loss: 0.1622 - val_acc: 0.9485
Epoch 8/20
 - 26s - loss: 0.1941 - acc: 0.9406 - val_loss: 0.1591 - val_acc: 0.9505
Epoch 9/20
 - 26s - loss: 0.1836 - acc: 0.9442 - val_loss: 0.1294 - val_acc: 0.9570
Epoch 10/20
 - 26s - loss: 0.1786 - acc: 0.9469 - val_loss: 0.1167 - val_acc: 0.9642
Epoch 11/20
 - 26s - loss: 0.1747 - acc: 0.9493 - val_loss: 0.1157 - val_acc: 0.9673
Epoch 12/20
 - 26s - loss: 0.1698 - acc: 0.9508 - val_loss: 0.1162 - val_acc: 0.9676
Epoch 13/20
 - 25s - loss: 0.1738 - acc: 0.9510 - val_loss: 0.1269 - val_acc: 0.9624
Epoch 14/20
 - 26s - loss: 0.1669 - acc: 0.9518 - val_loss: 0.1719 - val_acc: 0.9477
Epoch 15/20
 - 26s - loss: 0.1714 - acc: 0.9517 - val_loss: 0.1282 - val_acc: 0.9643
Epoch 16/20
 - 26s - loss: 0.1695 - acc: 0.9524 - val_loss: 0.1001 - val_acc: 0.9715
Epoch 17/20
 - 26s - loss: 0.1650 - acc: 0.9531 - val_loss: 0.1153 - val_acc: 0.9674
Epoch 18/20
 - 26s - loss: 0.1690 - acc: 0.9527 - val_loss: 0.0989 - val_acc: 0.9700
Epoch 19/20
 - 26s - loss: 0.1686 - acc: 0.9537 - val_loss: 0.1196 - val_acc: 0.9663
Epoch 20/20
 - 26s - loss: 0.1689 - acc: 0.9550 - val_loss: 0.1265 - val_acc: 0.9679
Test loss: 0.12659157408720492
Test accuracy: 0.9675
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9519 - acc: 0.6919 - val_loss: 0.4831 - val_acc: 0.8353
Epoch 2/20
 - 3s - loss: 0.4582 - acc: 0.8530 - val_loss: 0.3388 - val_acc: 0.8905
Epoch 3/20
 - 3s - loss: 0.3468 - acc: 0.8904 - val_loss: 0.2429 - val_acc: 0.9218
Epoch 4/20
 - 3s - loss: 0.2928 - acc: 0.9081 - val_loss: 0.1871 - val_acc: 0.9419
Epoch 5/20
 - 3s - loss: 0.2596 - acc: 0.9200 - val_loss: 0.2203 - val_acc: 0.9288
Epoch 6/20
 - 3s - loss: 0.2367 - acc: 0.9270 - val_loss: 0.2610 - val_acc: 0.9184
Epoch 7/20
 - 3s - loss: 0.2287 - acc: 0.9295 - val_loss: 0.2502 - val_acc: 0.9262
Epoch 8/20
 - 3s - loss: 0.2193 - acc: 0.9345 - val_loss: 0.1349 - val_acc: 0.9571
Epoch 9/20
 - 3s - loss: 0.2123 - acc: 0.9359 - val_loss: 0.1541 - val_acc: 0.9529
Epoch 10/20
 - 3s - loss: 0.2074 - acc: 0.9372 - val_loss: 0.2233 - val_acc: 0.9283
Epoch 11/20
 - 3s - loss: 0.2066 - acc: 0.9383 - val_loss: 0.1394 - val_acc: 0.9567
Epoch 12/20
 - 3s - loss: 0.2011 - acc: 0.9397 - val_loss: 0.1393 - val_acc: 0.9591
Epoch 13/20
 - 3s - loss: 0.1978 - acc: 0.9418 - val_loss: 0.1442 - val_acc: 0.9555
Epoch 14/20
 - 3s - loss: 0.1991 - acc: 0.9414 - val_loss: 0.1458 - val_acc: 0.9583
Epoch 15/20
 - 3s - loss: 0.2047 - acc: 0.9419 - val_loss: 0.1305 - val_acc: 0.9613
Epoch 16/20
 - 3s - loss: 0.1980 - acc: 0.9444 - val_loss: 0.1909 - val_acc: 0.9497
Epoch 17/20
 - 3s - loss: 0.1996 - acc: 0.9434 - val_loss: 0.1560 - val_acc: 0.9513
Epoch 18/20
 - 3s - loss: 0.2026 - acc: 0.9441 - val_loss: 0.1375 - val_acc: 0.9571
Epoch 19/20
 - 3s - loss: 0.2036 - acc: 0.9429 - val_loss: 0.1282 - val_acc: 0.9616
Epoch 20/20
 - 3s - loss: 0.2014 - acc: 0.9442 - val_loss: 0.1319 - val_acc: 0.9626
Test loss: 0.13008561084277462
Test accuracy: 0.9627
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9215 - acc: 0.6985 - val_loss: 0.4149 - val_acc: 0.8632
Epoch 2/20
 - 3s - loss: 0.4401 - acc: 0.8598 - val_loss: 0.2294 - val_acc: 0.9287
Epoch 3/20
 - 3s - loss: 0.3321 - acc: 0.8964 - val_loss: 0.2388 - val_acc: 0.9223
Epoch 4/20
 - 3s - loss: 0.2791 - acc: 0.9131 - val_loss: 0.1610 - val_acc: 0.9488
Epoch 5/20
 - 3s - loss: 0.2473 - acc: 0.9225 - val_loss: 0.1846 - val_acc: 0.9405
Epoch 6/20
 - 3s - loss: 0.2245 - acc: 0.9316 - val_loss: 0.1738 - val_acc: 0.9455
Epoch 7/20
 - 3s - loss: 0.2120 - acc: 0.9346 - val_loss: 0.1534 - val_acc: 0.9544
Epoch 8/20
 - 3s - loss: 0.1999 - acc: 0.9390 - val_loss: 0.1449 - val_acc: 0.9563
Epoch 9/20
 - 3s - loss: 0.1950 - acc: 0.9415 - val_loss: 0.1511 - val_acc: 0.9542
Epoch 10/20
 - 3s - loss: 0.1903 - acc: 0.9426 - val_loss: 0.1487 - val_acc: 0.9549
Epoch 11/20
 - 3s - loss: 0.1864 - acc: 0.9443 - val_loss: 0.1287 - val_acc: 0.9610
Epoch 12/20
 - 3s - loss: 0.1823 - acc: 0.9463 - val_loss: 0.1299 - val_acc: 0.9578
Epoch 13/20
 - 3s - loss: 0.1794 - acc: 0.9476 - val_loss: 0.1323 - val_acc: 0.9607
Epoch 14/20
 - 3s - loss: 0.1789 - acc: 0.9479 - val_loss: 0.1296 - val_acc: 0.9600
Epoch 15/20
 - 3s - loss: 0.1787 - acc: 0.9490 - val_loss: 0.1644 - val_acc: 0.9566
Epoch 16/20
 - 3s - loss: 0.1760 - acc: 0.9501 - val_loss: 0.1243 - val_acc: 0.9644
Epoch 17/20
 - 3s - loss: 0.1788 - acc: 0.9496 - val_loss: 0.1401 - val_acc: 0.9581
Epoch 18/20
 - 3s - loss: 0.1770 - acc: 0.9490 - val_loss: 0.1224 - val_acc: 0.9632
Epoch 19/20
 - 3s - loss: 0.1769 - acc: 0.9498 - val_loss: 0.1278 - val_acc: 0.9676
Epoch 20/20
 - 3s - loss: 0.1817 - acc: 0.9509 - val_loss: 0.1624 - val_acc: 0.9609
Test loss: 0.1677592432041536
Test accuracy: 0.9603
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9212 - acc: 0.7008 - val_loss: 0.5284 - val_acc: 0.8229
Epoch 2/20
 - 3s - loss: 0.4321 - acc: 0.8617 - val_loss: 0.3322 - val_acc: 0.8824
Epoch 3/20
 - 3s - loss: 0.3220 - acc: 0.8976 - val_loss: 0.2602 - val_acc: 0.9146
Epoch 4/20
 - 3s - loss: 0.2744 - acc: 0.9143 - val_loss: 0.2037 - val_acc: 0.9370
Epoch 5/20
 - 3s - loss: 0.2417 - acc: 0.9251 - val_loss: 0.1349 - val_acc: 0.9563
Epoch 6/20
 - 3s - loss: 0.2231 - acc: 0.9322 - val_loss: 0.1470 - val_acc: 0.9527
Epoch 7/20
 - 3s - loss: 0.2121 - acc: 0.9354 - val_loss: 0.1286 - val_acc: 0.9592
Epoch 8/20
 - 3s - loss: 0.1991 - acc: 0.9390 - val_loss: 0.1660 - val_acc: 0.9510
Epoch 9/20
 - 3s - loss: 0.1907 - acc: 0.9419 - val_loss: 0.1473 - val_acc: 0.9550
Epoch 10/20
 - 3s - loss: 0.1862 - acc: 0.9436 - val_loss: 0.1378 - val_acc: 0.9609
Epoch 11/20
 - 3s - loss: 0.1825 - acc: 0.9462 - val_loss: 0.1704 - val_acc: 0.9491
Epoch 12/20
 - 3s - loss: 0.1783 - acc: 0.9466 - val_loss: 0.1251 - val_acc: 0.9661
Epoch 13/20
 - 3s - loss: 0.1734 - acc: 0.9488 - val_loss: 0.1161 - val_acc: 0.9667
Epoch 14/20
 - 3s - loss: 0.1737 - acc: 0.9490 - val_loss: 0.1257 - val_acc: 0.9681
Epoch 15/20
 - 3s - loss: 0.1751 - acc: 0.9499 - val_loss: 0.1544 - val_acc: 0.9585
Epoch 16/20
 - 3s - loss: 0.1738 - acc: 0.9510 - val_loss: 0.1280 - val_acc: 0.9631
Epoch 17/20
 - 3s - loss: 0.1740 - acc: 0.9504 - val_loss: 0.1693 - val_acc: 0.9549
Epoch 18/20
 - 3s - loss: 0.1705 - acc: 0.9505 - val_loss: 0.1423 - val_acc: 0.9570
Epoch 19/20
 - 3s - loss: 0.1774 - acc: 0.9501 - val_loss: 0.1572 - val_acc: 0.9576
Epoch 20/20
 - 3s - loss: 0.1728 - acc: 0.9524 - val_loss: 0.1029 - val_acc: 0.9730
Test loss: 0.10267492256370024
Test accuracy: 0.9717
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9532 - acc: 0.6949 - val_loss: 0.4376 - val_acc: 0.8507
Epoch 2/20
 - 3s - loss: 0.4358 - acc: 0.8614 - val_loss: 0.2862 - val_acc: 0.9136
Epoch 3/20
 - 3s - loss: 0.3251 - acc: 0.8981 - val_loss: 0.1892 - val_acc: 0.9422
Epoch 4/20
 - 3s - loss: 0.2715 - acc: 0.9151 - val_loss: 0.1698 - val_acc: 0.9484
Epoch 5/20
 - 3s - loss: 0.2415 - acc: 0.9254 - val_loss: 0.1544 - val_acc: 0.9501
Epoch 6/20
 - 3s - loss: 0.2211 - acc: 0.9319 - val_loss: 0.1809 - val_acc: 0.9468
Epoch 7/20
 - 3s - loss: 0.2072 - acc: 0.9363 - val_loss: 0.2608 - val_acc: 0.9271
Epoch 8/20
 - 3s - loss: 0.1942 - acc: 0.9410 - val_loss: 0.2154 - val_acc: 0.9378
Epoch 9/20
 - 3s - loss: 0.1848 - acc: 0.9444 - val_loss: 0.1341 - val_acc: 0.9589
Epoch 10/20
 - 3s - loss: 0.1805 - acc: 0.9463 - val_loss: 0.1250 - val_acc: 0.9625
Epoch 11/20
 - 3s - loss: 0.1771 - acc: 0.9475 - val_loss: 0.1191 - val_acc: 0.9637
Epoch 12/20
 - 3s - loss: 0.1788 - acc: 0.9477 - val_loss: 0.1061 - val_acc: 0.9691
Epoch 13/20
 - 3s - loss: 0.1719 - acc: 0.9501 - val_loss: 0.1047 - val_acc: 0.9705
Epoch 14/20
 - 3s - loss: 0.1696 - acc: 0.9503 - val_loss: 0.1047 - val_acc: 0.9689
Epoch 15/20
 - 3s - loss: 0.1709 - acc: 0.9497 - val_loss: 0.1139 - val_acc: 0.9678
Epoch 16/20
 - 3s - loss: 0.1719 - acc: 0.9511 - val_loss: 0.1264 - val_acc: 0.9652
Epoch 17/20
 - 3s - loss: 0.1689 - acc: 0.9521 - val_loss: 0.1090 - val_acc: 0.9677
Epoch 18/20
 - 3s - loss: 0.1653 - acc: 0.9529 - val_loss: 0.1312 - val_acc: 0.9637
Epoch 19/20
 - 3s - loss: 0.1676 - acc: 0.9534 - val_loss: 0.1230 - val_acc: 0.9682
Epoch 20/20
 - 3s - loss: 0.1724 - acc: 0.9523 - val_loss: 0.1199 - val_acc: 0.9669
Test loss: 0.12081879585229326
Test accuracy: 0.9671
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9377 - acc: 0.6988 - val_loss: 0.5241 - val_acc: 0.8268
Epoch 2/20
 - 4s - loss: 0.4421 - acc: 0.8586 - val_loss: 0.2305 - val_acc: 0.9298
Epoch 3/20
 - 4s - loss: 0.3242 - acc: 0.8991 - val_loss: 0.1901 - val_acc: 0.9374
Epoch 4/20
 - 4s - loss: 0.2653 - acc: 0.9172 - val_loss: 0.1438 - val_acc: 0.9543
Epoch 5/20
 - 4s - loss: 0.2413 - acc: 0.9267 - val_loss: 0.1638 - val_acc: 0.9477
Epoch 6/20
 - 4s - loss: 0.2166 - acc: 0.9332 - val_loss: 0.1827 - val_acc: 0.9432
Epoch 7/20
 - 4s - loss: 0.1987 - acc: 0.9378 - val_loss: 0.1254 - val_acc: 0.9591
Epoch 8/20
 - 4s - loss: 0.1921 - acc: 0.9415 - val_loss: 0.1327 - val_acc: 0.9581
Epoch 9/20
 - 4s - loss: 0.1802 - acc: 0.9460 - val_loss: 0.1681 - val_acc: 0.9543
Epoch 10/20
 - 4s - loss: 0.1808 - acc: 0.9465 - val_loss: 0.1376 - val_acc: 0.9606
Epoch 11/20
 - 4s - loss: 0.1715 - acc: 0.9481 - val_loss: 0.1573 - val_acc: 0.9537
Epoch 12/20
 - 4s - loss: 0.1675 - acc: 0.9490 - val_loss: 0.1612 - val_acc: 0.9557
Epoch 13/20
 - 4s - loss: 0.1665 - acc: 0.9505 - val_loss: 0.1049 - val_acc: 0.9662
Epoch 14/20
 - 4s - loss: 0.1692 - acc: 0.9498 - val_loss: 0.1569 - val_acc: 0.9567
Epoch 15/20
 - 4s - loss: 0.1620 - acc: 0.9527 - val_loss: 0.1011 - val_acc: 0.9685
Epoch 16/20
 - 4s - loss: 0.1661 - acc: 0.9529 - val_loss: 0.1219 - val_acc: 0.9661
Epoch 17/20
 - 4s - loss: 0.1595 - acc: 0.9527 - val_loss: 0.1242 - val_acc: 0.9634
Epoch 18/20
 - 4s - loss: 0.1700 - acc: 0.9526 - val_loss: 0.1386 - val_acc: 0.9601
Epoch 19/20
 - 4s - loss: 0.1640 - acc: 0.9531 - val_loss: 0.1246 - val_acc: 0.9663
Epoch 20/20
 - 4s - loss: 0.1668 - acc: 0.9538 - val_loss: 0.1501 - val_acc: 0.9610
Test loss: 0.15241950317476877
Test accuracy: 0.96
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9396 - acc: 0.6959 - val_loss: 0.5097 - val_acc: 0.8293
Epoch 2/20
 - 4s - loss: 0.4375 - acc: 0.8611 - val_loss: 0.2777 - val_acc: 0.9166
Epoch 3/20
 - 4s - loss: 0.3207 - acc: 0.9001 - val_loss: 0.3053 - val_acc: 0.8963
Epoch 4/20
 - 4s - loss: 0.2681 - acc: 0.9152 - val_loss: 0.1649 - val_acc: 0.9466
Epoch 5/20
 - 4s - loss: 0.2376 - acc: 0.9266 - val_loss: 0.1482 - val_acc: 0.9547
Epoch 6/20
 - 4s - loss: 0.2188 - acc: 0.9333 - val_loss: 0.1526 - val_acc: 0.9497
Epoch 7/20
 - 4s - loss: 0.2018 - acc: 0.9395 - val_loss: 0.1369 - val_acc: 0.9571
Epoch 8/20
 - 4s - loss: 0.1949 - acc: 0.9410 - val_loss: 0.1137 - val_acc: 0.9631
Epoch 9/20
 - 4s - loss: 0.1844 - acc: 0.9446 - val_loss: 0.1231 - val_acc: 0.9621
Epoch 10/20
 - 4s - loss: 0.1758 - acc: 0.9469 - val_loss: 0.1380 - val_acc: 0.9627
Epoch 11/20
 - 4s - loss: 0.1743 - acc: 0.9483 - val_loss: 0.1466 - val_acc: 0.9565
Epoch 12/20
 - 4s - loss: 0.1672 - acc: 0.9497 - val_loss: 0.1215 - val_acc: 0.9603
Epoch 13/20
 - 4s - loss: 0.1675 - acc: 0.9510 - val_loss: 0.1364 - val_acc: 0.9591
Epoch 14/20
 - 4s - loss: 0.1655 - acc: 0.9512 - val_loss: 0.1120 - val_acc: 0.9663
Epoch 15/20
 - 4s - loss: 0.1638 - acc: 0.9529 - val_loss: 0.1130 - val_acc: 0.9678
Epoch 16/20
 - 4s - loss: 0.1650 - acc: 0.9533 - val_loss: 0.1078 - val_acc: 0.9674
Epoch 17/20
 - 4s - loss: 0.1590 - acc: 0.9545 - val_loss: 0.1146 - val_acc: 0.9682
Epoch 18/20
 - 4s - loss: 0.1615 - acc: 0.9539 - val_loss: 0.1012 - val_acc: 0.9697
Epoch 19/20
 - 4s - loss: 0.1621 - acc: 0.9538 - val_loss: 0.1351 - val_acc: 0.9646
Epoch 20/20
 - 4s - loss: 0.1650 - acc: 0.9544 - val_loss: 0.1116 - val_acc: 0.9664
Test loss: 0.11135438569611869
Test accuracy: 0.9661
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9239 - acc: 0.6972 - val_loss: 0.6279 - val_acc: 0.7885
Epoch 2/20
 - 6s - loss: 0.4388 - acc: 0.8609 - val_loss: 0.3178 - val_acc: 0.8980
Epoch 3/20
 - 6s - loss: 0.3202 - acc: 0.8996 - val_loss: 0.2639 - val_acc: 0.9161
Epoch 4/20
 - 6s - loss: 0.2674 - acc: 0.9159 - val_loss: 0.2271 - val_acc: 0.9291
Epoch 5/20
 - 6s - loss: 0.2340 - acc: 0.9275 - val_loss: 0.1658 - val_acc: 0.9464
Epoch 6/20
 - 6s - loss: 0.2162 - acc: 0.9332 - val_loss: 0.2452 - val_acc: 0.9297
Epoch 7/20
 - 6s - loss: 0.2013 - acc: 0.9388 - val_loss: 0.1152 - val_acc: 0.9649
Epoch 8/20
 - 6s - loss: 0.1925 - acc: 0.9414 - val_loss: 0.1293 - val_acc: 0.9576
Epoch 9/20
 - 6s - loss: 0.1831 - acc: 0.9451 - val_loss: 0.1278 - val_acc: 0.9610
Epoch 10/20
 - 6s - loss: 0.1841 - acc: 0.9452 - val_loss: 0.1082 - val_acc: 0.9671
Epoch 11/20
 - 6s - loss: 0.1779 - acc: 0.9472 - val_loss: 0.1055 - val_acc: 0.9682
Epoch 12/20
 - 6s - loss: 0.1727 - acc: 0.9479 - val_loss: 0.1612 - val_acc: 0.9528
Epoch 13/20
 - 6s - loss: 0.1767 - acc: 0.9486 - val_loss: 0.1036 - val_acc: 0.9713
Epoch 14/20
 - 6s - loss: 0.1700 - acc: 0.9505 - val_loss: 0.0993 - val_acc: 0.9706
Epoch 15/20
 - 6s - loss: 0.1673 - acc: 0.9517 - val_loss: 0.1124 - val_acc: 0.9689
Epoch 16/20
 - 6s - loss: 0.1672 - acc: 0.9521 - val_loss: 0.1443 - val_acc: 0.9652
Epoch 17/20
 - 6s - loss: 0.1639 - acc: 0.9539 - val_loss: 0.1257 - val_acc: 0.9660
Epoch 18/20
 - 6s - loss: 0.1630 - acc: 0.9541 - val_loss: 0.1258 - val_acc: 0.9649
Epoch 19/20
 - 6s - loss: 0.1645 - acc: 0.9539 - val_loss: 0.1156 - val_acc: 0.9672
Epoch 20/20
 - 6s - loss: 0.1714 - acc: 0.9519 - val_loss: 0.1189 - val_acc: 0.9674
Test loss: 0.11908694060589187
Test accuracy: 0.9672
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9283 - acc: 0.6969 - val_loss: 0.4845 - val_acc: 0.8316
Epoch 2/20
 - 9s - loss: 0.4334 - acc: 0.8626 - val_loss: 0.2369 - val_acc: 0.9254
Epoch 3/20
 - 9s - loss: 0.3269 - acc: 0.8971 - val_loss: 0.1810 - val_acc: 0.9452
Epoch 4/20
 - 9s - loss: 0.2640 - acc: 0.9188 - val_loss: 0.1915 - val_acc: 0.9414
Epoch 5/20
 - 9s - loss: 0.2397 - acc: 0.9254 - val_loss: 0.1386 - val_acc: 0.9550
Epoch 6/20
 - 9s - loss: 0.2172 - acc: 0.9328 - val_loss: 0.2247 - val_acc: 0.9286
Epoch 7/20
 - 9s - loss: 0.2004 - acc: 0.9378 - val_loss: 0.1365 - val_acc: 0.9591
Epoch 8/20
 - 9s - loss: 0.1916 - acc: 0.9422 - val_loss: 0.1515 - val_acc: 0.9538
Epoch 9/20
 - 9s - loss: 0.1861 - acc: 0.9445 - val_loss: 0.1606 - val_acc: 0.9519
Epoch 10/20
 - 9s - loss: 0.1763 - acc: 0.9474 - val_loss: 0.1580 - val_acc: 0.9538
Epoch 11/20
 - 9s - loss: 0.1688 - acc: 0.9500 - val_loss: 0.1444 - val_acc: 0.9535
Epoch 12/20
 - 9s - loss: 0.1688 - acc: 0.9509 - val_loss: 0.0906 - val_acc: 0.9714
Epoch 13/20
 - 9s - loss: 0.1635 - acc: 0.9511 - val_loss: 0.1148 - val_acc: 0.9662
Epoch 14/20
 - 9s - loss: 0.1672 - acc: 0.9516 - val_loss: 0.1102 - val_acc: 0.9666
Epoch 15/20
 - 9s - loss: 0.1626 - acc: 0.9523 - val_loss: 0.1372 - val_acc: 0.9598
Epoch 16/20
 - 9s - loss: 0.1599 - acc: 0.9540 - val_loss: 0.1148 - val_acc: 0.9666
Epoch 17/20
 - 9s - loss: 0.1624 - acc: 0.9541 - val_loss: 0.1288 - val_acc: 0.9602
Epoch 18/20
 - 9s - loss: 0.1638 - acc: 0.9543 - val_loss: 0.1143 - val_acc: 0.9675
Epoch 19/20
 - 9s - loss: 0.1632 - acc: 0.9540 - val_loss: 0.2264 - val_acc: 0.9483
Epoch 20/20
 - 9s - loss: 0.1634 - acc: 0.9542 - val_loss: 0.1024 - val_acc: 0.9712
Test loss: 0.10260006262834649
Test accuracy: 0.9708
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9440 - acc: 0.6977 - val_loss: 0.3110 - val_acc: 0.9035
Epoch 2/20
 - 14s - loss: 0.4349 - acc: 0.8613 - val_loss: 0.3200 - val_acc: 0.8951
Epoch 3/20
 - 14s - loss: 0.3251 - acc: 0.8983 - val_loss: 0.2424 - val_acc: 0.9230
Epoch 4/20
 - 14s - loss: 0.2733 - acc: 0.9150 - val_loss: 0.1550 - val_acc: 0.9514
Epoch 5/20
 - 14s - loss: 0.2408 - acc: 0.9257 - val_loss: 0.1687 - val_acc: 0.9481
Epoch 6/20
 - 14s - loss: 0.2222 - acc: 0.9308 - val_loss: 0.1173 - val_acc: 0.9638
Epoch 7/20
 - 14s - loss: 0.2028 - acc: 0.9382 - val_loss: 0.1734 - val_acc: 0.9401
Epoch 8/20
 - 14s - loss: 0.1915 - acc: 0.9432 - val_loss: 0.1709 - val_acc: 0.9477
Epoch 9/20
 - 14s - loss: 0.1825 - acc: 0.9448 - val_loss: 0.1490 - val_acc: 0.9517
Epoch 10/20
 - 14s - loss: 0.1761 - acc: 0.9469 - val_loss: 0.1078 - val_acc: 0.9670
Epoch 11/20
 - 14s - loss: 0.1706 - acc: 0.9482 - val_loss: 0.1088 - val_acc: 0.9667
Epoch 12/20
 - 14s - loss: 0.1699 - acc: 0.9501 - val_loss: 0.1072 - val_acc: 0.9673
Epoch 13/20
 - 14s - loss: 0.1653 - acc: 0.9506 - val_loss: 0.1180 - val_acc: 0.9655
Epoch 14/20
 - 14s - loss: 0.1630 - acc: 0.9516 - val_loss: 0.1275 - val_acc: 0.9652
Epoch 15/20
 - 14s - loss: 0.1601 - acc: 0.9522 - val_loss: 0.1224 - val_acc: 0.9620
Epoch 16/20
 - 14s - loss: 0.1607 - acc: 0.9531 - val_loss: 0.1493 - val_acc: 0.9543
Epoch 17/20
 - 14s - loss: 0.1621 - acc: 0.9546 - val_loss: 0.1276 - val_acc: 0.9632
Epoch 18/20
 - 14s - loss: 0.1566 - acc: 0.9554 - val_loss: 0.1136 - val_acc: 0.9674
Epoch 19/20
 - 14s - loss: 0.1575 - acc: 0.9549 - val_loss: 0.1112 - val_acc: 0.9683
Epoch 20/20
 - 14s - loss: 0.1575 - acc: 0.9560 - val_loss: 0.1247 - val_acc: 0.9671
Test loss: 0.12479260575241642
Test accuracy: 0.9675
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9367 - acc: 0.6962 - val_loss: 0.3896 - val_acc: 0.8774
Epoch 2/20
 - 26s - loss: 0.4392 - acc: 0.8603 - val_loss: 0.3819 - val_acc: 0.8801
Epoch 3/20
 - 26s - loss: 0.3265 - acc: 0.8970 - val_loss: 0.3111 - val_acc: 0.9001
Epoch 4/20
 - 26s - loss: 0.2720 - acc: 0.9147 - val_loss: 0.1818 - val_acc: 0.9431
Epoch 5/20
 - 26s - loss: 0.2375 - acc: 0.9261 - val_loss: 0.1333 - val_acc: 0.9560
Epoch 6/20
 - 26s - loss: 0.2175 - acc: 0.9332 - val_loss: 0.2421 - val_acc: 0.9182
Epoch 7/20
 - 26s - loss: 0.2035 - acc: 0.9373 - val_loss: 0.1347 - val_acc: 0.9601
Epoch 8/20
 - 26s - loss: 0.1906 - acc: 0.9425 - val_loss: 0.1424 - val_acc: 0.9541
Epoch 9/20
 - 26s - loss: 0.1823 - acc: 0.9443 - val_loss: 0.1085 - val_acc: 0.9666
Epoch 10/20
 - 26s - loss: 0.1750 - acc: 0.9477 - val_loss: 0.1140 - val_acc: 0.9658
Epoch 11/20
 - 26s - loss: 0.1724 - acc: 0.9492 - val_loss: 0.1510 - val_acc: 0.9529
Epoch 12/20
 - 26s - loss: 0.1675 - acc: 0.9500 - val_loss: 0.1491 - val_acc: 0.9507
Epoch 13/20
 - 26s - loss: 0.1652 - acc: 0.9511 - val_loss: 0.1078 - val_acc: 0.9673
Epoch 14/20
 - 26s - loss: 0.1653 - acc: 0.9512 - val_loss: 0.0904 - val_acc: 0.9737
Epoch 15/20
 - 26s - loss: 0.1596 - acc: 0.9528 - val_loss: 0.1367 - val_acc: 0.9568
Epoch 16/20
 - 26s - loss: 0.1617 - acc: 0.9532 - val_loss: 0.0970 - val_acc: 0.9703
Epoch 17/20
 - 26s - loss: 0.1564 - acc: 0.9543 - val_loss: 0.0867 - val_acc: 0.9749
Epoch 18/20
 - 26s - loss: 0.1554 - acc: 0.9554 - val_loss: 0.1111 - val_acc: 0.9655
Epoch 19/20
 - 26s - loss: 0.1601 - acc: 0.9543 - val_loss: 0.1133 - val_acc: 0.9687
Epoch 20/20
 - 26s - loss: 0.1574 - acc: 0.9558 - val_loss: 0.0880 - val_acc: 0.9745
Test loss: 0.08812422687579528
Test accuracy: 0.9749
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9685 - acc: 0.6856 - val_loss: 0.4075 - val_acc: 0.8611
Epoch 2/20
 - 3s - loss: 0.4563 - acc: 0.8519 - val_loss: 0.3132 - val_acc: 0.8983
Epoch 3/20
 - 3s - loss: 0.3455 - acc: 0.8912 - val_loss: 0.2594 - val_acc: 0.9137
Epoch 4/20
 - 3s - loss: 0.2935 - acc: 0.9071 - val_loss: 0.1879 - val_acc: 0.9398
Epoch 5/20
 - 3s - loss: 0.2631 - acc: 0.9177 - val_loss: 0.3024 - val_acc: 0.9063
Epoch 6/20
 - 3s - loss: 0.2437 - acc: 0.9242 - val_loss: 0.1827 - val_acc: 0.9423
Epoch 7/20
 - 3s - loss: 0.2303 - acc: 0.9288 - val_loss: 0.1915 - val_acc: 0.9399
Epoch 8/20
 - 3s - loss: 0.2168 - acc: 0.9340 - val_loss: 0.2296 - val_acc: 0.9324
Epoch 9/20
 - 3s - loss: 0.2133 - acc: 0.9362 - val_loss: 0.1358 - val_acc: 0.9556
Epoch 10/20
 - 3s - loss: 0.2064 - acc: 0.9391 - val_loss: 0.1625 - val_acc: 0.9511
Epoch 11/20
 - 3s - loss: 0.2031 - acc: 0.9393 - val_loss: 0.1574 - val_acc: 0.9523
Epoch 12/20
 - 3s - loss: 0.2072 - acc: 0.9388 - val_loss: 0.1255 - val_acc: 0.9605
Epoch 13/20
 - 3s - loss: 0.1997 - acc: 0.9422 - val_loss: 0.1324 - val_acc: 0.9578
Epoch 14/20
 - 3s - loss: 0.2009 - acc: 0.9422 - val_loss: 0.1680 - val_acc: 0.9530
Epoch 15/20
 - 3s - loss: 0.2011 - acc: 0.9429 - val_loss: 0.1402 - val_acc: 0.9613
Epoch 16/20
 - 3s - loss: 0.2007 - acc: 0.9430 - val_loss: 0.1304 - val_acc: 0.9614
Epoch 17/20
 - 3s - loss: 0.1991 - acc: 0.9426 - val_loss: 0.1278 - val_acc: 0.9641
Epoch 18/20
 - 3s - loss: 0.1971 - acc: 0.9437 - val_loss: 0.1493 - val_acc: 0.9642
Epoch 19/20
 - 3s - loss: 0.2012 - acc: 0.9435 - val_loss: 0.1329 - val_acc: 0.9598
Epoch 20/20
 - 3s - loss: 0.2021 - acc: 0.9433 - val_loss: 0.1179 - val_acc: 0.9660
Test loss: 0.12117866727700458
Test accuracy: 0.9646
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9614 - acc: 0.6869 - val_loss: 0.3509 - val_acc: 0.8887
Epoch 2/20
 - 3s - loss: 0.4529 - acc: 0.8541 - val_loss: 0.2839 - val_acc: 0.9156
Epoch 3/20
 - 3s - loss: 0.3418 - acc: 0.8919 - val_loss: 0.2428 - val_acc: 0.9219
Epoch 4/20
 - 3s - loss: 0.2841 - acc: 0.9114 - val_loss: 0.1938 - val_acc: 0.9428
Epoch 5/20
 - 3s - loss: 0.2509 - acc: 0.9234 - val_loss: 0.1873 - val_acc: 0.9427
Epoch 6/20
 - 3s - loss: 0.2320 - acc: 0.9284 - val_loss: 0.1413 - val_acc: 0.9554
Epoch 7/20
 - 3s - loss: 0.2141 - acc: 0.9343 - val_loss: 0.1417 - val_acc: 0.9529
Epoch 8/20
 - 3s - loss: 0.2061 - acc: 0.9376 - val_loss: 0.3493 - val_acc: 0.8965
Epoch 9/20
 - 3s - loss: 0.1959 - acc: 0.9404 - val_loss: 0.1740 - val_acc: 0.9489
Epoch 10/20
 - 3s - loss: 0.1909 - acc: 0.9425 - val_loss: 0.1275 - val_acc: 0.9623
Epoch 11/20
 - 3s - loss: 0.1902 - acc: 0.9437 - val_loss: 0.1361 - val_acc: 0.9592
Epoch 12/20
 - 3s - loss: 0.1845 - acc: 0.9460 - val_loss: 0.1092 - val_acc: 0.9675
Epoch 13/20
 - 3s - loss: 0.1815 - acc: 0.9466 - val_loss: 0.1699 - val_acc: 0.9508
Epoch 14/20
 - 3s - loss: 0.1835 - acc: 0.9460 - val_loss: 0.1261 - val_acc: 0.9655
Epoch 15/20
 - 3s - loss: 0.1849 - acc: 0.9473 - val_loss: 0.1214 - val_acc: 0.9631
Epoch 16/20
 - 3s - loss: 0.1782 - acc: 0.9491 - val_loss: 0.1501 - val_acc: 0.9500
Epoch 17/20
 - 3s - loss: 0.1778 - acc: 0.9496 - val_loss: 0.1266 - val_acc: 0.9617
Epoch 18/20
 - 3s - loss: 0.1795 - acc: 0.9484 - val_loss: 0.1657 - val_acc: 0.9574
Epoch 19/20
 - 3s - loss: 0.1770 - acc: 0.9498 - val_loss: 0.1096 - val_acc: 0.9660
Epoch 20/20
 - 3s - loss: 0.1801 - acc: 0.9499 - val_loss: 0.1080 - val_acc: 0.9692
Test loss: 0.10880005376686458
Test accuracy: 0.9686
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9247 - acc: 0.6974 - val_loss: 0.5210 - val_acc: 0.8279
Epoch 2/20
 - 3s - loss: 0.4382 - acc: 0.8600 - val_loss: 0.4110 - val_acc: 0.8722
Epoch 3/20
 - 3s - loss: 0.3281 - acc: 0.8974 - val_loss: 0.1885 - val_acc: 0.9396
Epoch 4/20
 - 3s - loss: 0.2770 - acc: 0.9135 - val_loss: 0.2036 - val_acc: 0.9329
Epoch 5/20
 - 3s - loss: 0.2466 - acc: 0.9226 - val_loss: 0.1585 - val_acc: 0.9483
Epoch 6/20
 - 3s - loss: 0.2249 - acc: 0.9302 - val_loss: 0.1495 - val_acc: 0.9525
Epoch 7/20
 - 3s - loss: 0.2117 - acc: 0.9354 - val_loss: 0.1719 - val_acc: 0.9458
Epoch 8/20
 - 3s - loss: 0.2027 - acc: 0.9395 - val_loss: 0.1298 - val_acc: 0.9611
Epoch 9/20
 - 3s - loss: 0.1889 - acc: 0.9415 - val_loss: 0.1576 - val_acc: 0.9514
Epoch 10/20
 - 3s - loss: 0.1921 - acc: 0.9438 - val_loss: 0.2357 - val_acc: 0.9284
Epoch 11/20
 - 3s - loss: 0.1850 - acc: 0.9452 - val_loss: 0.1729 - val_acc: 0.9423
Epoch 12/20
 - 3s - loss: 0.1793 - acc: 0.9472 - val_loss: 0.1125 - val_acc: 0.9642
Epoch 13/20
 - 3s - loss: 0.1812 - acc: 0.9473 - val_loss: 0.2372 - val_acc: 0.9324
Epoch 14/20
 - 3s - loss: 0.1749 - acc: 0.9496 - val_loss: 0.1172 - val_acc: 0.9661
Epoch 15/20
 - 3s - loss: 0.1791 - acc: 0.9489 - val_loss: 0.1280 - val_acc: 0.9658
Epoch 16/20
 - 3s - loss: 0.1750 - acc: 0.9503 - val_loss: 0.1117 - val_acc: 0.9689
Epoch 17/20
 - 3s - loss: 0.1760 - acc: 0.9503 - val_loss: 0.1836 - val_acc: 0.9549
Epoch 18/20
 - 3s - loss: 0.1772 - acc: 0.9502 - val_loss: 0.1441 - val_acc: 0.9595
Epoch 19/20
 - 3s - loss: 0.1746 - acc: 0.9510 - val_loss: 0.1006 - val_acc: 0.9696
Epoch 20/20
 - 3s - loss: 0.1770 - acc: 0.9506 - val_loss: 0.1345 - val_acc: 0.9593
Test loss: 0.1359667522437405
Test accuracy: 0.9608
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9453 - acc: 0.6949 - val_loss: 0.3932 - val_acc: 0.8719
Epoch 2/20
 - 3s - loss: 0.4308 - acc: 0.8621 - val_loss: 0.2203 - val_acc: 0.9341
Epoch 3/20
 - 3s - loss: 0.3208 - acc: 0.8983 - val_loss: 0.1901 - val_acc: 0.9408
Epoch 4/20
 - 3s - loss: 0.2661 - acc: 0.9165 - val_loss: 0.2615 - val_acc: 0.9182
Epoch 5/20
 - 3s - loss: 0.2381 - acc: 0.9266 - val_loss: 0.1541 - val_acc: 0.9542
Epoch 6/20
 - 3s - loss: 0.2182 - acc: 0.9323 - val_loss: 0.1340 - val_acc: 0.9577
Epoch 7/20
 - 3s - loss: 0.2055 - acc: 0.9368 - val_loss: 0.1237 - val_acc: 0.9628
Epoch 8/20
 - 3s - loss: 0.1947 - acc: 0.9414 - val_loss: 0.1411 - val_acc: 0.9559
Epoch 9/20
 - 3s - loss: 0.1833 - acc: 0.9435 - val_loss: 0.1275 - val_acc: 0.9625
Epoch 10/20
 - 3s - loss: 0.1804 - acc: 0.9456 - val_loss: 0.1333 - val_acc: 0.9627
Epoch 11/20
 - 3s - loss: 0.1764 - acc: 0.9470 - val_loss: 0.1151 - val_acc: 0.9643
Epoch 12/20
 - 3s - loss: 0.1782 - acc: 0.9481 - val_loss: 0.1261 - val_acc: 0.9609
Epoch 13/20
 - 3s - loss: 0.1701 - acc: 0.9494 - val_loss: 0.1632 - val_acc: 0.9520
Epoch 14/20
 - 3s - loss: 0.1741 - acc: 0.9498 - val_loss: 0.1110 - val_acc: 0.9674
Epoch 15/20
 - 3s - loss: 0.1726 - acc: 0.9500 - val_loss: 0.1155 - val_acc: 0.9675
Epoch 16/20
 - 3s - loss: 0.1715 - acc: 0.9513 - val_loss: 0.1246 - val_acc: 0.9646
Epoch 17/20
 - 3s - loss: 0.1673 - acc: 0.9519 - val_loss: 0.1240 - val_acc: 0.9631
Epoch 18/20
 - 3s - loss: 0.1682 - acc: 0.9524 - val_loss: 0.1718 - val_acc: 0.9501
Epoch 19/20
 - 3s - loss: 0.1701 - acc: 0.9522 - val_loss: 0.1131 - val_acc: 0.9691
Epoch 20/20
 - 3s - loss: 0.1709 - acc: 0.9533 - val_loss: 0.1110 - val_acc: 0.9689
Test loss: 0.11055496095181443
Test accuracy: 0.969
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9295 - acc: 0.6993 - val_loss: 0.3960 - val_acc: 0.8683
Epoch 2/20
 - 4s - loss: 0.4355 - acc: 0.8599 - val_loss: 0.2726 - val_acc: 0.9098
Epoch 3/20
 - 4s - loss: 0.3275 - acc: 0.8958 - val_loss: 0.2621 - val_acc: 0.9188
Epoch 4/20
 - 4s - loss: 0.2750 - acc: 0.9142 - val_loss: 0.2287 - val_acc: 0.9266
Epoch 5/20
 - 4s - loss: 0.2390 - acc: 0.9260 - val_loss: 0.2026 - val_acc: 0.9364
Epoch 6/20
 - 4s - loss: 0.2236 - acc: 0.9312 - val_loss: 0.1827 - val_acc: 0.9433
Epoch 7/20
 - 4s - loss: 0.2031 - acc: 0.9368 - val_loss: 0.1223 - val_acc: 0.9619
Epoch 8/20
 - 4s - loss: 0.1960 - acc: 0.9396 - val_loss: 0.1458 - val_acc: 0.9573
Epoch 9/20
 - 4s - loss: 0.1833 - acc: 0.9443 - val_loss: 0.1577 - val_acc: 0.9526
Epoch 10/20
 - 4s - loss: 0.1778 - acc: 0.9459 - val_loss: 0.1744 - val_acc: 0.9469
Epoch 11/20
 - 4s - loss: 0.1729 - acc: 0.9484 - val_loss: 0.2642 - val_acc: 0.9153
Epoch 12/20
 - 4s - loss: 0.1713 - acc: 0.9488 - val_loss: 0.1110 - val_acc: 0.9682
Epoch 13/20
 - 4s - loss: 0.1680 - acc: 0.9494 - val_loss: 0.1072 - val_acc: 0.9695
Epoch 14/20
 - 4s - loss: 0.1683 - acc: 0.9496 - val_loss: 0.1421 - val_acc: 0.9583
Epoch 15/20
 - 4s - loss: 0.1675 - acc: 0.9506 - val_loss: 0.1316 - val_acc: 0.9638
Epoch 16/20
 - 4s - loss: 0.1627 - acc: 0.9532 - val_loss: 0.1277 - val_acc: 0.9647
Epoch 17/20
 - 4s - loss: 0.1646 - acc: 0.9524 - val_loss: 0.1050 - val_acc: 0.9710
Epoch 18/20
 - 4s - loss: 0.1628 - acc: 0.9541 - val_loss: 0.1072 - val_acc: 0.9656
Epoch 19/20
 - 4s - loss: 0.1634 - acc: 0.9529 - val_loss: 0.1372 - val_acc: 0.9621
Epoch 20/20
 - 4s - loss: 0.1644 - acc: 0.9545 - val_loss: 0.1297 - val_acc: 0.9641
Test loss: 0.1256238357071299
Test accuracy: 0.9644
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9069 - acc: 0.7003 - val_loss: 0.4070 - val_acc: 0.8641
Epoch 2/20
 - 4s - loss: 0.4303 - acc: 0.8623 - val_loss: 0.2374 - val_acc: 0.9247
Epoch 3/20
 - 4s - loss: 0.3203 - acc: 0.8996 - val_loss: 0.4280 - val_acc: 0.8470
Epoch 4/20
 - 4s - loss: 0.2703 - acc: 0.9158 - val_loss: 0.1902 - val_acc: 0.9394
Epoch 5/20
 - 4s - loss: 0.2382 - acc: 0.9249 - val_loss: 0.1403 - val_acc: 0.9524
Epoch 6/20
 - 4s - loss: 0.2149 - acc: 0.9334 - val_loss: 0.1347 - val_acc: 0.9573
Epoch 7/20
 - 4s - loss: 0.2050 - acc: 0.9370 - val_loss: 0.1752 - val_acc: 0.9448
Epoch 8/20
 - 4s - loss: 0.1933 - acc: 0.9417 - val_loss: 0.1792 - val_acc: 0.9446
Epoch 9/20
 - 4s - loss: 0.1883 - acc: 0.9429 - val_loss: 0.1492 - val_acc: 0.9515
Epoch 10/20
 - 4s - loss: 0.1797 - acc: 0.9466 - val_loss: 0.1425 - val_acc: 0.9548
Epoch 11/20
 - 4s - loss: 0.1761 - acc: 0.9473 - val_loss: 0.1003 - val_acc: 0.9697
Epoch 12/20
 - 4s - loss: 0.1728 - acc: 0.9489 - val_loss: 0.1159 - val_acc: 0.9655
Epoch 13/20
 - 4s - loss: 0.1690 - acc: 0.9507 - val_loss: 0.1052 - val_acc: 0.9670
Epoch 14/20
 - 4s - loss: 0.1698 - acc: 0.9512 - val_loss: 0.1014 - val_acc: 0.9706
Epoch 15/20
 - 4s - loss: 0.1685 - acc: 0.9509 - val_loss: 0.1098 - val_acc: 0.9661
Epoch 16/20
 - 4s - loss: 0.1625 - acc: 0.9528 - val_loss: 0.1155 - val_acc: 0.9694
Epoch 17/20
 - 4s - loss: 0.1679 - acc: 0.9518 - val_loss: 0.0979 - val_acc: 0.9711
Epoch 18/20
 - 4s - loss: 0.1612 - acc: 0.9542 - val_loss: 0.1258 - val_acc: 0.9656
Epoch 19/20
 - 4s - loss: 0.1635 - acc: 0.9543 - val_loss: 0.1032 - val_acc: 0.9709
Epoch 20/20
 - 4s - loss: 0.1679 - acc: 0.9544 - val_loss: 0.1026 - val_acc: 0.9710
Test loss: 0.10216059490739716
Test accuracy: 0.9706
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9244 - acc: 0.7048 - val_loss: 0.4466 - val_acc: 0.8467
Epoch 2/20
 - 6s - loss: 0.4274 - acc: 0.8647 - val_loss: 0.3181 - val_acc: 0.8982
Epoch 3/20
 - 6s - loss: 0.3158 - acc: 0.9014 - val_loss: 0.1970 - val_acc: 0.9375
Epoch 4/20
 - 6s - loss: 0.2672 - acc: 0.9177 - val_loss: 0.1830 - val_acc: 0.9428
Epoch 5/20
 - 6s - loss: 0.2338 - acc: 0.9279 - val_loss: 0.1593 - val_acc: 0.9503
Epoch 6/20
 - 6s - loss: 0.2133 - acc: 0.9337 - val_loss: 0.2154 - val_acc: 0.9317
Epoch 7/20
 - 6s - loss: 0.2026 - acc: 0.9382 - val_loss: 0.1457 - val_acc: 0.9564
Epoch 8/20
 - 6s - loss: 0.1945 - acc: 0.9418 - val_loss: 0.1079 - val_acc: 0.9670
Epoch 9/20
 - 6s - loss: 0.1835 - acc: 0.9443 - val_loss: 0.1066 - val_acc: 0.9679
Epoch 10/20
 - 6s - loss: 0.1802 - acc: 0.9459 - val_loss: 0.1261 - val_acc: 0.9619
Epoch 11/20
 - 6s - loss: 0.1737 - acc: 0.9486 - val_loss: 0.1427 - val_acc: 0.9558
Epoch 12/20
 - 6s - loss: 0.1744 - acc: 0.9484 - val_loss: 0.1267 - val_acc: 0.9624
Epoch 13/20
 - 6s - loss: 0.1662 - acc: 0.9512 - val_loss: 0.1503 - val_acc: 0.9592
Epoch 14/20
 - 6s - loss: 0.1673 - acc: 0.9526 - val_loss: 0.1243 - val_acc: 0.9624
Epoch 15/20
 - 6s - loss: 0.1671 - acc: 0.9525 - val_loss: 0.1244 - val_acc: 0.9626
Epoch 16/20
 - 6s - loss: 0.1639 - acc: 0.9524 - val_loss: 0.1158 - val_acc: 0.9662
Epoch 17/20
 - 6s - loss: 0.1602 - acc: 0.9538 - val_loss: 0.1206 - val_acc: 0.9648
Epoch 18/20
 - 6s - loss: 0.1615 - acc: 0.9540 - val_loss: 0.0883 - val_acc: 0.9766
Epoch 19/20
 - 6s - loss: 0.1612 - acc: 0.9548 - val_loss: 0.1009 - val_acc: 0.9700
Epoch 20/20
 - 6s - loss: 0.1636 - acc: 0.9549 - val_loss: 0.1240 - val_acc: 0.9678
Test loss: 0.12430474097779952
Test accuracy: 0.968
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9211 - acc: 0.6994 - val_loss: 0.3576 - val_acc: 0.8933
Epoch 2/20
 - 9s - loss: 0.4310 - acc: 0.8615 - val_loss: 0.2500 - val_acc: 0.9198
Epoch 3/20
 - 9s - loss: 0.3251 - acc: 0.8977 - val_loss: 0.2048 - val_acc: 0.9356
Epoch 4/20
 - 9s - loss: 0.2705 - acc: 0.9145 - val_loss: 0.1460 - val_acc: 0.9554
Epoch 5/20
 - 9s - loss: 0.2387 - acc: 0.9264 - val_loss: 0.1596 - val_acc: 0.9461
Epoch 6/20
 - 9s - loss: 0.2153 - acc: 0.9338 - val_loss: 0.1805 - val_acc: 0.9448
Epoch 7/20
 - 9s - loss: 0.2006 - acc: 0.9387 - val_loss: 0.2337 - val_acc: 0.9251
Epoch 8/20
 - 9s - loss: 0.1898 - acc: 0.9415 - val_loss: 0.1226 - val_acc: 0.9603
Epoch 9/20
 - 9s - loss: 0.1835 - acc: 0.9448 - val_loss: 0.1196 - val_acc: 0.9643
Epoch 10/20
 - 9s - loss: 0.1795 - acc: 0.9470 - val_loss: 0.1101 - val_acc: 0.9681
Epoch 11/20
 - 9s - loss: 0.1708 - acc: 0.9491 - val_loss: 0.1193 - val_acc: 0.9646
Epoch 12/20
 - 9s - loss: 0.1702 - acc: 0.9501 - val_loss: 0.1188 - val_acc: 0.9646
Epoch 13/20
 - 9s - loss: 0.1635 - acc: 0.9519 - val_loss: 0.1198 - val_acc: 0.9669
Epoch 14/20
 - 9s - loss: 0.1657 - acc: 0.9516 - val_loss: 0.1065 - val_acc: 0.9705
Epoch 15/20
 - 9s - loss: 0.1638 - acc: 0.9521 - val_loss: 0.1644 - val_acc: 0.9506
Epoch 16/20
 - 9s - loss: 0.1646 - acc: 0.9521 - val_loss: 0.1179 - val_acc: 0.9674
Epoch 17/20
 - 9s - loss: 0.1629 - acc: 0.9531 - val_loss: 0.1002 - val_acc: 0.9719
Epoch 18/20
 - 9s - loss: 0.1590 - acc: 0.9538 - val_loss: 0.1537 - val_acc: 0.9578
Epoch 19/20
 - 9s - loss: 0.1647 - acc: 0.9546 - val_loss: 0.1080 - val_acc: 0.9705
Epoch 20/20
 - 9s - loss: 0.1636 - acc: 0.9544 - val_loss: 0.1270 - val_acc: 0.9676
Test loss: 0.12598973904003505
Test accuracy: 0.9681
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9440 - acc: 0.6951 - val_loss: 0.3642 - val_acc: 0.8811
Epoch 2/20
 - 14s - loss: 0.4282 - acc: 0.8648 - val_loss: 0.2311 - val_acc: 0.9259
Epoch 3/20
 - 14s - loss: 0.3158 - acc: 0.8995 - val_loss: 0.2414 - val_acc: 0.9190
Epoch 4/20
 - 14s - loss: 0.2678 - acc: 0.9161 - val_loss: 0.1613 - val_acc: 0.9488
Epoch 5/20
 - 14s - loss: 0.2310 - acc: 0.9281 - val_loss: 0.1685 - val_acc: 0.9466
Epoch 6/20
 - 14s - loss: 0.2148 - acc: 0.9342 - val_loss: 0.1700 - val_acc: 0.9475
Epoch 7/20
 - 14s - loss: 0.2008 - acc: 0.9386 - val_loss: 0.1557 - val_acc: 0.9504
Epoch 8/20
 - 14s - loss: 0.1900 - acc: 0.9422 - val_loss: 0.1676 - val_acc: 0.9504
Epoch 9/20
 - 14s - loss: 0.1793 - acc: 0.9459 - val_loss: 0.1329 - val_acc: 0.9619
Epoch 10/20
 - 14s - loss: 0.1779 - acc: 0.9472 - val_loss: 0.1439 - val_acc: 0.9551
Epoch 11/20
 - 14s - loss: 0.1730 - acc: 0.9490 - val_loss: 0.1409 - val_acc: 0.9584
Epoch 12/20
 - 14s - loss: 0.1694 - acc: 0.9506 - val_loss: 0.0986 - val_acc: 0.9719
Epoch 13/20
 - 14s - loss: 0.1680 - acc: 0.9517 - val_loss: 0.1368 - val_acc: 0.9574
Epoch 14/20
 - 14s - loss: 0.1688 - acc: 0.9514 - val_loss: 0.1725 - val_acc: 0.9476
Epoch 15/20
 - 14s - loss: 0.1669 - acc: 0.9511 - val_loss: 0.1194 - val_acc: 0.9627
Epoch 16/20
 - 14s - loss: 0.1646 - acc: 0.9535 - val_loss: 0.1100 - val_acc: 0.9680
Epoch 17/20
 - 14s - loss: 0.1657 - acc: 0.9540 - val_loss: 0.1427 - val_acc: 0.9619
Epoch 18/20
 - 14s - loss: 0.1661 - acc: 0.9541 - val_loss: 0.1039 - val_acc: 0.9696
Epoch 19/20
 - 14s - loss: 0.1659 - acc: 0.9546 - val_loss: 0.1218 - val_acc: 0.9619
Epoch 20/20
 - 14s - loss: 0.1684 - acc: 0.9531 - val_loss: 0.1303 - val_acc: 0.9641
Test loss: 0.13067255761094274
Test accuracy: 0.9649
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9255 - acc: 0.6985 - val_loss: 0.5208 - val_acc: 0.8210
Epoch 2/20
 - 26s - loss: 0.4310 - acc: 0.8619 - val_loss: 0.2981 - val_acc: 0.9027
Epoch 3/20
 - 26s - loss: 0.3204 - acc: 0.8992 - val_loss: 0.2213 - val_acc: 0.9319
Epoch 4/20
 - 26s - loss: 0.2689 - acc: 0.9150 - val_loss: 0.1872 - val_acc: 0.9421
Epoch 5/20
 - 26s - loss: 0.2395 - acc: 0.9263 - val_loss: 0.2219 - val_acc: 0.9287
Epoch 6/20
 - 26s - loss: 0.2172 - acc: 0.9340 - val_loss: 0.2403 - val_acc: 0.9210
Epoch 7/20
 - 26s - loss: 0.2020 - acc: 0.9382 - val_loss: 0.1587 - val_acc: 0.9503
Epoch 8/20
 - 26s - loss: 0.1943 - acc: 0.9413 - val_loss: 0.2273 - val_acc: 0.9283
Epoch 9/20
 - 26s - loss: 0.1875 - acc: 0.9442 - val_loss: 0.1759 - val_acc: 0.9436
Epoch 10/20
 - 26s - loss: 0.1759 - acc: 0.9470 - val_loss: 0.1290 - val_acc: 0.9614
Epoch 11/20
 - 26s - loss: 0.1789 - acc: 0.9475 - val_loss: 0.1266 - val_acc: 0.9623
Epoch 12/20
 - 26s - loss: 0.1735 - acc: 0.9496 - val_loss: 0.1054 - val_acc: 0.9685
Epoch 13/20
 - 26s - loss: 0.1723 - acc: 0.9492 - val_loss: 0.1565 - val_acc: 0.9517
Epoch 14/20
 - 26s - loss: 0.1680 - acc: 0.9516 - val_loss: 0.1087 - val_acc: 0.9681
Epoch 15/20
 - 26s - loss: 0.1630 - acc: 0.9517 - val_loss: 0.1442 - val_acc: 0.9606
Epoch 16/20
 - 26s - loss: 0.1675 - acc: 0.9516 - val_loss: 0.1001 - val_acc: 0.9690
Epoch 17/20
 - 26s - loss: 0.1639 - acc: 0.9525 - val_loss: 0.1010 - val_acc: 0.9696
Epoch 18/20
 - 26s - loss: 0.1646 - acc: 0.9531 - val_loss: 0.1229 - val_acc: 0.9656
Epoch 19/20
 - 26s - loss: 0.1621 - acc: 0.9541 - val_loss: 0.1070 - val_acc: 0.9660
Epoch 20/20
 - 26s - loss: 0.1651 - acc: 0.9533 - val_loss: 0.1145 - val_acc: 0.9639
Test loss: 0.11470449327405076
Test accuracy: 0.9639
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9586 - acc: 0.6931 - val_loss: 0.4605 - val_acc: 0.8499
Epoch 2/20
 - 3s - loss: 0.4584 - acc: 0.8534 - val_loss: 0.7740 - val_acc: 0.7638
Epoch 3/20
 - 3s - loss: 0.3519 - acc: 0.8893 - val_loss: 0.2521 - val_acc: 0.9221
Epoch 4/20
 - 3s - loss: 0.2926 - acc: 0.9077 - val_loss: 0.2098 - val_acc: 0.9331
Epoch 5/20
 - 3s - loss: 0.2605 - acc: 0.9190 - val_loss: 0.2005 - val_acc: 0.9375
Epoch 6/20
 - 3s - loss: 0.2422 - acc: 0.9258 - val_loss: 0.1648 - val_acc: 0.9477
Epoch 7/20
 - 3s - loss: 0.2274 - acc: 0.9301 - val_loss: 0.1390 - val_acc: 0.9560
Epoch 8/20
 - 3s - loss: 0.2162 - acc: 0.9342 - val_loss: 0.2715 - val_acc: 0.9245
Epoch 9/20
 - 3s - loss: 0.2117 - acc: 0.9364 - val_loss: 0.1403 - val_acc: 0.9529
Epoch 10/20
 - 3s - loss: 0.2076 - acc: 0.9374 - val_loss: 0.1269 - val_acc: 0.9610
Epoch 11/20
 - 3s - loss: 0.2074 - acc: 0.9386 - val_loss: 0.1332 - val_acc: 0.9589
Epoch 12/20
 - 3s - loss: 0.1999 - acc: 0.9404 - val_loss: 0.1505 - val_acc: 0.9566
Epoch 13/20
 - 3s - loss: 0.1980 - acc: 0.9428 - val_loss: 0.2141 - val_acc: 0.9365
Epoch 14/20
 - 3s - loss: 0.1967 - acc: 0.9426 - val_loss: 0.1342 - val_acc: 0.9592
Epoch 15/20
 - 3s - loss: 0.2013 - acc: 0.9430 - val_loss: 0.1518 - val_acc: 0.9580
Epoch 16/20
 - 3s - loss: 0.1974 - acc: 0.9437 - val_loss: 0.1363 - val_acc: 0.9584
Epoch 17/20
 - 3s - loss: 0.1984 - acc: 0.9444 - val_loss: 0.1314 - val_acc: 0.9590
Epoch 18/20
 - 3s - loss: 0.1980 - acc: 0.9445 - val_loss: 0.1257 - val_acc: 0.9623
Epoch 19/20
 - 3s - loss: 0.1994 - acc: 0.9444 - val_loss: 0.1173 - val_acc: 0.9671
Epoch 20/20
 - 3s - loss: 0.1979 - acc: 0.9442 - val_loss: 0.1408 - val_acc: 0.9594
Test loss: 0.1441966280749475
Test accuracy: 0.9594
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9415 - acc: 0.6952 - val_loss: 0.4208 - val_acc: 0.8701
Epoch 2/20
 - 3s - loss: 0.4478 - acc: 0.8562 - val_loss: 0.2665 - val_acc: 0.9100
Epoch 3/20
 - 3s - loss: 0.3335 - acc: 0.8957 - val_loss: 0.1999 - val_acc: 0.9353
Epoch 4/20
 - 3s - loss: 0.2824 - acc: 0.9130 - val_loss: 0.2486 - val_acc: 0.9155
Epoch 5/20
 - 3s - loss: 0.2479 - acc: 0.9225 - val_loss: 0.1559 - val_acc: 0.9504
Epoch 6/20
 - 3s - loss: 0.2284 - acc: 0.9294 - val_loss: 0.1825 - val_acc: 0.9398
Epoch 7/20
 - 3s - loss: 0.2140 - acc: 0.9346 - val_loss: 0.1577 - val_acc: 0.9519
Epoch 8/20
 - 3s - loss: 0.2038 - acc: 0.9381 - val_loss: 0.1292 - val_acc: 0.9594
Epoch 9/20
 - 3s - loss: 0.1962 - acc: 0.9401 - val_loss: 0.1173 - val_acc: 0.9645
Epoch 10/20
 - 3s - loss: 0.1895 - acc: 0.9430 - val_loss: 0.1199 - val_acc: 0.9638
Epoch 11/20
 - 3s - loss: 0.1886 - acc: 0.9435 - val_loss: 0.2117 - val_acc: 0.9324
Epoch 12/20
 - 3s - loss: 0.1811 - acc: 0.9457 - val_loss: 0.1185 - val_acc: 0.9652
Epoch 13/20
 - 3s - loss: 0.1864 - acc: 0.9450 - val_loss: 0.1574 - val_acc: 0.9558
Epoch 14/20
 - 3s - loss: 0.1780 - acc: 0.9468 - val_loss: 0.1123 - val_acc: 0.9643
Epoch 15/20
 - 3s - loss: 0.1850 - acc: 0.9477 - val_loss: 0.1389 - val_acc: 0.9613
Epoch 16/20
 - 3s - loss: 0.1821 - acc: 0.9468 - val_loss: 0.1563 - val_acc: 0.9580
Epoch 17/20
 - 3s - loss: 0.1798 - acc: 0.9481 - val_loss: 0.1088 - val_acc: 0.9662
Epoch 18/20
 - 3s - loss: 0.1783 - acc: 0.9495 - val_loss: 0.1332 - val_acc: 0.9634
Epoch 19/20
 - 3s - loss: 0.1773 - acc: 0.9506 - val_loss: 0.1260 - val_acc: 0.9642
Epoch 20/20
 - 3s - loss: 0.1807 - acc: 0.9501 - val_loss: 0.1148 - val_acc: 0.9667
Test loss: 0.11459193182573654
Test accuracy: 0.9671
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9406 - acc: 0.6947 - val_loss: 0.4384 - val_acc: 0.8541
Epoch 2/20
 - 3s - loss: 0.4421 - acc: 0.8597 - val_loss: 0.3596 - val_acc: 0.8888
Epoch 3/20
 - 3s - loss: 0.3355 - acc: 0.8935 - val_loss: 0.2684 - val_acc: 0.9118
Epoch 4/20
 - 3s - loss: 0.2782 - acc: 0.9127 - val_loss: 0.1917 - val_acc: 0.9358
Epoch 5/20
 - 3s - loss: 0.2455 - acc: 0.9238 - val_loss: 0.2712 - val_acc: 0.9151
Epoch 6/20
 - 3s - loss: 0.2255 - acc: 0.9303 - val_loss: 0.1487 - val_acc: 0.9527
Epoch 7/20
 - 3s - loss: 0.2111 - acc: 0.9352 - val_loss: 0.1449 - val_acc: 0.9546
Epoch 8/20
 - 3s - loss: 0.1990 - acc: 0.9392 - val_loss: 0.1173 - val_acc: 0.9645
Epoch 9/20
 - 3s - loss: 0.1903 - acc: 0.9420 - val_loss: 0.1769 - val_acc: 0.9483
Epoch 10/20
 - 3s - loss: 0.1829 - acc: 0.9451 - val_loss: 0.1316 - val_acc: 0.9610
Epoch 11/20
 - 3s - loss: 0.1815 - acc: 0.9464 - val_loss: 0.1376 - val_acc: 0.9595
Epoch 12/20
 - 3s - loss: 0.1765 - acc: 0.9477 - val_loss: 0.1253 - val_acc: 0.9647
Epoch 13/20
 - 3s - loss: 0.1779 - acc: 0.9489 - val_loss: 0.1147 - val_acc: 0.9648
Epoch 14/20
 - 3s - loss: 0.1752 - acc: 0.9487 - val_loss: 0.1032 - val_acc: 0.9701
Epoch 15/20
 - 3s - loss: 0.1752 - acc: 0.9498 - val_loss: 0.1167 - val_acc: 0.9678
Epoch 16/20
 - 3s - loss: 0.1748 - acc: 0.9503 - val_loss: 0.1239 - val_acc: 0.9630
Epoch 17/20
 - 3s - loss: 0.1728 - acc: 0.9506 - val_loss: 0.2440 - val_acc: 0.9218
Epoch 18/20
 - 3s - loss: 0.1758 - acc: 0.9518 - val_loss: 0.1022 - val_acc: 0.9694
Epoch 19/20
 - 3s - loss: 0.1748 - acc: 0.9522 - val_loss: 0.2479 - val_acc: 0.9321
Epoch 20/20
 - 3s - loss: 0.1732 - acc: 0.9517 - val_loss: 0.1258 - val_acc: 0.9675
Test loss: 0.12344732193975651
Test accuracy: 0.9674
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9326 - acc: 0.7011 - val_loss: 0.3443 - val_acc: 0.8863
Epoch 2/20
 - 3s - loss: 0.4338 - acc: 0.8615 - val_loss: 0.2848 - val_acc: 0.9100
Epoch 3/20
 - 3s - loss: 0.3260 - acc: 0.8976 - val_loss: 0.3031 - val_acc: 0.9078
Epoch 4/20
 - 3s - loss: 0.2739 - acc: 0.9147 - val_loss: 0.1662 - val_acc: 0.9474
Epoch 5/20
 - 3s - loss: 0.2426 - acc: 0.9250 - val_loss: 0.1610 - val_acc: 0.9498
Epoch 6/20
 - 3s - loss: 0.2205 - acc: 0.9319 - val_loss: 0.2205 - val_acc: 0.9298
Epoch 7/20
 - 3s - loss: 0.2091 - acc: 0.9360 - val_loss: 0.1363 - val_acc: 0.9595
Epoch 8/20
 - 3s - loss: 0.1970 - acc: 0.9393 - val_loss: 0.1471 - val_acc: 0.9540
Epoch 9/20
 - 3s - loss: 0.1891 - acc: 0.9422 - val_loss: 0.1238 - val_acc: 0.9621
Epoch 10/20
 - 3s - loss: 0.1853 - acc: 0.9448 - val_loss: 0.1398 - val_acc: 0.9602
Epoch 11/20
 - 3s - loss: 0.1817 - acc: 0.9452 - val_loss: 0.1212 - val_acc: 0.9610
Epoch 12/20
 - 3s - loss: 0.1763 - acc: 0.9475 - val_loss: 0.1174 - val_acc: 0.9654
Epoch 13/20
 - 3s - loss: 0.1734 - acc: 0.9500 - val_loss: 0.1686 - val_acc: 0.9479
Epoch 14/20
 - 3s - loss: 0.1704 - acc: 0.9502 - val_loss: 0.1340 - val_acc: 0.9572
Epoch 15/20
 - 3s - loss: 0.1739 - acc: 0.9500 - val_loss: 0.1135 - val_acc: 0.9670
Epoch 16/20
 - 3s - loss: 0.1681 - acc: 0.9507 - val_loss: 0.1516 - val_acc: 0.9580
Epoch 17/20
 - 3s - loss: 0.1673 - acc: 0.9529 - val_loss: 0.1345 - val_acc: 0.9627
Epoch 18/20
 - 3s - loss: 0.1693 - acc: 0.9526 - val_loss: 0.1082 - val_acc: 0.9683
Epoch 19/20
 - 3s - loss: 0.1686 - acc: 0.9523 - val_loss: 0.1402 - val_acc: 0.9592
Epoch 20/20
 - 3s - loss: 0.1699 - acc: 0.9524 - val_loss: 0.1359 - val_acc: 0.9622
Test loss: 0.13472942524984247
Test accuracy: 0.9638
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9282 - acc: 0.6981 - val_loss: 0.5191 - val_acc: 0.8275
Epoch 2/20
 - 4s - loss: 0.4376 - acc: 0.8605 - val_loss: 0.3822 - val_acc: 0.8796
Epoch 3/20
 - 4s - loss: 0.3265 - acc: 0.8972 - val_loss: 0.2004 - val_acc: 0.9357
Epoch 4/20
 - 4s - loss: 0.2676 - acc: 0.9157 - val_loss: 0.2031 - val_acc: 0.9367
Epoch 5/20
 - 4s - loss: 0.2387 - acc: 0.9257 - val_loss: 0.1826 - val_acc: 0.9439
Epoch 6/20
 - 4s - loss: 0.2201 - acc: 0.9319 - val_loss: 0.1557 - val_acc: 0.9509
Epoch 7/20
 - 4s - loss: 0.2050 - acc: 0.9361 - val_loss: 0.1999 - val_acc: 0.9378
Epoch 8/20
 - 4s - loss: 0.1961 - acc: 0.9410 - val_loss: 0.1350 - val_acc: 0.9570
Epoch 9/20
 - 4s - loss: 0.1841 - acc: 0.9444 - val_loss: 0.1297 - val_acc: 0.9622
Epoch 10/20
 - 4s - loss: 0.1795 - acc: 0.9459 - val_loss: 0.1355 - val_acc: 0.9602
Epoch 11/20
 - 4s - loss: 0.1725 - acc: 0.9474 - val_loss: 0.1188 - val_acc: 0.9636
Epoch 12/20
 - 4s - loss: 0.1739 - acc: 0.9480 - val_loss: 0.1183 - val_acc: 0.9631
Epoch 13/20
 - 4s - loss: 0.1747 - acc: 0.9488 - val_loss: 0.1119 - val_acc: 0.9681
Epoch 14/20
 - 4s - loss: 0.1686 - acc: 0.9504 - val_loss: 0.1142 - val_acc: 0.9657
Epoch 15/20
 - 4s - loss: 0.1648 - acc: 0.9520 - val_loss: 0.1489 - val_acc: 0.9571
Epoch 16/20
 - 4s - loss: 0.1678 - acc: 0.9522 - val_loss: 0.1282 - val_acc: 0.9611
Epoch 17/20
 - 4s - loss: 0.1598 - acc: 0.9536 - val_loss: 0.1527 - val_acc: 0.9550
Epoch 18/20
 - 4s - loss: 0.1686 - acc: 0.9531 - val_loss: 0.1587 - val_acc: 0.9527
Epoch 19/20
 - 4s - loss: 0.1663 - acc: 0.9545 - val_loss: 0.1101 - val_acc: 0.9671
Epoch 20/20
 - 4s - loss: 0.1657 - acc: 0.9538 - val_loss: 0.1037 - val_acc: 0.9706
Test loss: 0.10315008140038699
Test accuracy: 0.971
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9286 - acc: 0.6986 - val_loss: 0.6532 - val_acc: 0.7738
Epoch 2/20
 - 4s - loss: 0.4231 - acc: 0.8665 - val_loss: 0.3718 - val_acc: 0.8745
Epoch 3/20
 - 4s - loss: 0.3226 - acc: 0.8982 - val_loss: 0.2119 - val_acc: 0.9350
Epoch 4/20
 - 4s - loss: 0.2717 - acc: 0.9139 - val_loss: 0.1428 - val_acc: 0.9539
Epoch 5/20
 - 4s - loss: 0.2407 - acc: 0.9252 - val_loss: 0.3067 - val_acc: 0.9095
Epoch 6/20
 - 4s - loss: 0.2190 - acc: 0.9326 - val_loss: 0.1338 - val_acc: 0.9590
Epoch 7/20
 - 4s - loss: 0.2045 - acc: 0.9376 - val_loss: 0.2215 - val_acc: 0.9260
Epoch 8/20
 - 4s - loss: 0.1962 - acc: 0.9406 - val_loss: 0.1771 - val_acc: 0.9467
Epoch 9/20
 - 4s - loss: 0.1885 - acc: 0.9433 - val_loss: 0.1367 - val_acc: 0.9591
Epoch 10/20
 - 4s - loss: 0.1797 - acc: 0.9449 - val_loss: 0.2134 - val_acc: 0.9320
Epoch 11/20
 - 4s - loss: 0.1775 - acc: 0.9472 - val_loss: 0.1358 - val_acc: 0.9623
Epoch 12/20
 - 4s - loss: 0.1768 - acc: 0.9479 - val_loss: 0.1384 - val_acc: 0.9614
Epoch 13/20
 - 4s - loss: 0.1708 - acc: 0.9507 - val_loss: 0.1301 - val_acc: 0.9608
Epoch 14/20
 - 4s - loss: 0.1678 - acc: 0.9513 - val_loss: 0.1740 - val_acc: 0.9546
Epoch 15/20
 - 4s - loss: 0.1651 - acc: 0.9529 - val_loss: 0.1234 - val_acc: 0.9663
Epoch 16/20
 - 4s - loss: 0.1685 - acc: 0.9519 - val_loss: 0.1108 - val_acc: 0.9657
Epoch 17/20
 - 4s - loss: 0.1646 - acc: 0.9532 - val_loss: 0.0992 - val_acc: 0.9700
Epoch 18/20
 - 4s - loss: 0.1688 - acc: 0.9517 - val_loss: 0.1298 - val_acc: 0.9595
Epoch 19/20
 - 4s - loss: 0.1688 - acc: 0.9523 - val_loss: 0.1150 - val_acc: 0.9672
Epoch 20/20
 - 4s - loss: 0.1651 - acc: 0.9546 - val_loss: 0.1400 - val_acc: 0.9580
Test loss: 0.14053852206652517
Test accuracy: 0.9581
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9348 - acc: 0.7005 - val_loss: 0.3302 - val_acc: 0.9036
Epoch 2/20
 - 6s - loss: 0.4332 - acc: 0.8616 - val_loss: 0.3269 - val_acc: 0.9009
Epoch 3/20
 - 6s - loss: 0.3250 - acc: 0.8977 - val_loss: 0.2434 - val_acc: 0.9193
Epoch 4/20
 - 6s - loss: 0.2704 - acc: 0.9155 - val_loss: 0.1809 - val_acc: 0.9428
Epoch 5/20
 - 6s - loss: 0.2394 - acc: 0.9262 - val_loss: 0.1478 - val_acc: 0.9538
Epoch 6/20
 - 6s - loss: 0.2144 - acc: 0.9338 - val_loss: 0.1562 - val_acc: 0.9495
Epoch 7/20
 - 6s - loss: 0.1996 - acc: 0.9383 - val_loss: 0.1120 - val_acc: 0.9644
Epoch 8/20
 - 6s - loss: 0.1909 - acc: 0.9421 - val_loss: 0.1424 - val_acc: 0.9566
Epoch 9/20
 - 6s - loss: 0.1821 - acc: 0.9448 - val_loss: 0.1347 - val_acc: 0.9611
Epoch 10/20
 - 6s - loss: 0.1786 - acc: 0.9460 - val_loss: 0.1213 - val_acc: 0.9643
Epoch 11/20
 - 6s - loss: 0.1700 - acc: 0.9486 - val_loss: 0.1483 - val_acc: 0.9545
Epoch 12/20
 - 6s - loss: 0.1658 - acc: 0.9507 - val_loss: 0.1269 - val_acc: 0.9575
Epoch 13/20
 - 6s - loss: 0.1647 - acc: 0.9506 - val_loss: 0.1061 - val_acc: 0.9690
Epoch 14/20
 - 6s - loss: 0.1615 - acc: 0.9519 - val_loss: 0.1127 - val_acc: 0.9668
Epoch 15/20
 - 6s - loss: 0.1595 - acc: 0.9531 - val_loss: 0.1063 - val_acc: 0.9679
Epoch 16/20
 - 6s - loss: 0.1611 - acc: 0.9528 - val_loss: 0.1294 - val_acc: 0.9644
Epoch 17/20
 - 6s - loss: 0.1616 - acc: 0.9540 - val_loss: 0.1994 - val_acc: 0.9440
Epoch 18/20
 - 6s - loss: 0.1621 - acc: 0.9540 - val_loss: 0.1135 - val_acc: 0.9647
Epoch 19/20
 - 6s - loss: 0.1593 - acc: 0.9544 - val_loss: 0.1129 - val_acc: 0.9692
Epoch 20/20
 - 6s - loss: 0.1609 - acc: 0.9544 - val_loss: 0.0991 - val_acc: 0.9718
Test loss: 0.09959861645917117
Test accuracy: 0.9713
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9317 - acc: 0.6987 - val_loss: 0.3430 - val_acc: 0.8978
Epoch 2/20
 - 9s - loss: 0.4291 - acc: 0.8645 - val_loss: 0.2853 - val_acc: 0.9090
Epoch 3/20
 - 9s - loss: 0.3247 - acc: 0.8973 - val_loss: 0.2112 - val_acc: 0.9310
Epoch 4/20
 - 9s - loss: 0.2709 - acc: 0.9154 - val_loss: 0.1769 - val_acc: 0.9419
Epoch 5/20
 - 9s - loss: 0.2375 - acc: 0.9270 - val_loss: 0.1558 - val_acc: 0.9498
Epoch 6/20
 - 9s - loss: 0.2171 - acc: 0.9322 - val_loss: 0.1890 - val_acc: 0.9417
Epoch 7/20
 - 9s - loss: 0.2020 - acc: 0.9370 - val_loss: 0.1485 - val_acc: 0.9575
Epoch 8/20
 - 9s - loss: 0.1948 - acc: 0.9412 - val_loss: 0.1095 - val_acc: 0.9677
Epoch 9/20
 - 9s - loss: 0.1851 - acc: 0.9434 - val_loss: 0.1128 - val_acc: 0.9657
Epoch 10/20
 - 9s - loss: 0.1796 - acc: 0.9462 - val_loss: 0.1671 - val_acc: 0.9459
Epoch 11/20
 - 9s - loss: 0.1766 - acc: 0.9471 - val_loss: 0.1418 - val_acc: 0.9555
Epoch 12/20
 - 9s - loss: 0.1701 - acc: 0.9498 - val_loss: 0.1108 - val_acc: 0.9652
Epoch 13/20
 - 9s - loss: 0.1672 - acc: 0.9501 - val_loss: 0.1087 - val_acc: 0.9673
Epoch 14/20
 - 9s - loss: 0.1673 - acc: 0.9508 - val_loss: 0.1043 - val_acc: 0.9694
Epoch 15/20
 - 9s - loss: 0.1662 - acc: 0.9532 - val_loss: 0.1098 - val_acc: 0.9690
Epoch 16/20
 - 9s - loss: 0.1700 - acc: 0.9510 - val_loss: 0.2367 - val_acc: 0.9273
Epoch 17/20
 - 9s - loss: 0.1641 - acc: 0.9537 - val_loss: 0.1047 - val_acc: 0.9688
Epoch 18/20
 - 9s - loss: 0.1627 - acc: 0.9536 - val_loss: 0.1675 - val_acc: 0.9556
Epoch 19/20
 - 9s - loss: 0.1634 - acc: 0.9539 - val_loss: 0.1132 - val_acc: 0.9678
Epoch 20/20
 - 9s - loss: 0.1662 - acc: 0.9539 - val_loss: 0.1229 - val_acc: 0.9657
Test loss: 0.1222915103055595
Test accuracy: 0.9655
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9416 - acc: 0.6972 - val_loss: 0.3452 - val_acc: 0.8902
Epoch 2/20
 - 14s - loss: 0.4333 - acc: 0.8616 - val_loss: 0.2494 - val_acc: 0.9232
Epoch 3/20
 - 14s - loss: 0.3227 - acc: 0.8989 - val_loss: 0.1964 - val_acc: 0.9401
Epoch 4/20
 - 14s - loss: 0.2710 - acc: 0.9147 - val_loss: 0.1577 - val_acc: 0.9499
Epoch 5/20
 - 14s - loss: 0.2356 - acc: 0.9265 - val_loss: 0.1774 - val_acc: 0.9462
Epoch 6/20
 - 14s - loss: 0.2177 - acc: 0.9329 - val_loss: 0.2230 - val_acc: 0.9289
Epoch 7/20
 - 14s - loss: 0.2034 - acc: 0.9385 - val_loss: 0.1436 - val_acc: 0.9544
Epoch 8/20
 - 14s - loss: 0.1932 - acc: 0.9413 - val_loss: 0.2034 - val_acc: 0.9352
Epoch 9/20
 - 14s - loss: 0.1819 - acc: 0.9438 - val_loss: 0.1330 - val_acc: 0.9586
Epoch 10/20
 - 14s - loss: 0.1802 - acc: 0.9455 - val_loss: 0.1847 - val_acc: 0.9474
Epoch 11/20
 - 14s - loss: 0.1724 - acc: 0.9489 - val_loss: 0.1370 - val_acc: 0.9623
Epoch 12/20
 - 14s - loss: 0.1695 - acc: 0.9505 - val_loss: 0.1831 - val_acc: 0.9503
Epoch 13/20
 - 14s - loss: 0.1677 - acc: 0.9505 - val_loss: 0.1252 - val_acc: 0.9622
Epoch 14/20
 - 14s - loss: 0.1671 - acc: 0.9513 - val_loss: 0.1289 - val_acc: 0.9634
Epoch 15/20
 - 14s - loss: 0.1650 - acc: 0.9512 - val_loss: 0.1793 - val_acc: 0.9538
Epoch 16/20
 - 14s - loss: 0.1639 - acc: 0.9527 - val_loss: 0.1174 - val_acc: 0.9683
Epoch 17/20
 - 14s - loss: 0.1618 - acc: 0.9550 - val_loss: 0.1101 - val_acc: 0.9682
Epoch 18/20
 - 14s - loss: 0.1587 - acc: 0.9548 - val_loss: 0.1112 - val_acc: 0.9677
Epoch 19/20
 - 14s - loss: 0.1646 - acc: 0.9542 - val_loss: 0.1840 - val_acc: 0.9463
Epoch 20/20
 - 14s - loss: 0.1718 - acc: 0.9527 - val_loss: 0.1637 - val_acc: 0.9535
Test loss: 0.16410941339898855
Test accuracy: 0.9541
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9234 - acc: 0.6992 - val_loss: 0.4480 - val_acc: 0.8613
Epoch 2/20
 - 26s - loss: 0.4261 - acc: 0.8641 - val_loss: 0.3656 - val_acc: 0.8817
Epoch 3/20
 - 26s - loss: 0.3208 - acc: 0.8984 - val_loss: 0.1687 - val_acc: 0.9477
Epoch 4/20
 - 26s - loss: 0.2677 - acc: 0.9164 - val_loss: 0.2017 - val_acc: 0.9377
Epoch 5/20
 - 26s - loss: 0.2354 - acc: 0.9263 - val_loss: 0.1496 - val_acc: 0.9517
Epoch 6/20
 - 26s - loss: 0.2161 - acc: 0.9337 - val_loss: 0.1553 - val_acc: 0.9511
Epoch 7/20
 - 25s - loss: 0.2003 - acc: 0.9388 - val_loss: 0.2041 - val_acc: 0.9368
Epoch 8/20
 - 26s - loss: 0.1922 - acc: 0.9421 - val_loss: 0.1227 - val_acc: 0.9614
Epoch 9/20
 - 26s - loss: 0.1854 - acc: 0.9437 - val_loss: 0.1295 - val_acc: 0.9596
Epoch 10/20
 - 26s - loss: 0.1778 - acc: 0.9457 - val_loss: 0.1169 - val_acc: 0.9641
Epoch 11/20
 - 26s - loss: 0.1745 - acc: 0.9480 - val_loss: 0.1148 - val_acc: 0.9668
Epoch 12/20
 - 26s - loss: 0.1723 - acc: 0.9486 - val_loss: 0.1233 - val_acc: 0.9612
Epoch 13/20
 - 25s - loss: 0.1706 - acc: 0.9517 - val_loss: 0.1226 - val_acc: 0.9628
Epoch 14/20
 - 26s - loss: 0.1657 - acc: 0.9525 - val_loss: 0.1001 - val_acc: 0.9719
Epoch 15/20
 - 26s - loss: 0.1645 - acc: 0.9517 - val_loss: 0.1646 - val_acc: 0.9537
Epoch 16/20
 - 26s - loss: 0.1663 - acc: 0.9515 - val_loss: 0.1000 - val_acc: 0.9705
Epoch 17/20
 - 26s - loss: 0.1627 - acc: 0.9533 - val_loss: 0.1258 - val_acc: 0.9628
Epoch 18/20
 - 26s - loss: 0.1652 - acc: 0.9545 - val_loss: 0.0999 - val_acc: 0.9699
Epoch 19/20
 - 26s - loss: 0.1682 - acc: 0.9546 - val_loss: 0.0965 - val_acc: 0.9714
Epoch 20/20
 - 26s - loss: 0.1651 - acc: 0.9558 - val_loss: 0.1030 - val_acc: 0.9719
Test loss: 0.1027753331318876
Test accuracy: 0.972
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9541 - acc: 0.6917 - val_loss: 0.5741 - val_acc: 0.8156
Epoch 2/20
 - 3s - loss: 0.4589 - acc: 0.8538 - val_loss: 0.3630 - val_acc: 0.8856
Epoch 3/20
 - 3s - loss: 0.3443 - acc: 0.8901 - val_loss: 0.2789 - val_acc: 0.9135
Epoch 4/20
 - 3s - loss: 0.2956 - acc: 0.9073 - val_loss: 0.2091 - val_acc: 0.9331
Epoch 5/20
 - 3s - loss: 0.2643 - acc: 0.9177 - val_loss: 0.1776 - val_acc: 0.9444
Epoch 6/20
 - 3s - loss: 0.2384 - acc: 0.9268 - val_loss: 0.1999 - val_acc: 0.9359
Epoch 7/20
 - 3s - loss: 0.2281 - acc: 0.9290 - val_loss: 0.1915 - val_acc: 0.9388
Epoch 8/20
 - 3s - loss: 0.2206 - acc: 0.9317 - val_loss: 0.1316 - val_acc: 0.9592
Epoch 9/20
 - 3s - loss: 0.2113 - acc: 0.9361 - val_loss: 0.1696 - val_acc: 0.9478
Epoch 10/20
 - 3s - loss: 0.2022 - acc: 0.9386 - val_loss: 0.1754 - val_acc: 0.9487
Epoch 11/20
 - 3s - loss: 0.1997 - acc: 0.9389 - val_loss: 0.1268 - val_acc: 0.9627
Epoch 12/20
 - 3s - loss: 0.1992 - acc: 0.9415 - val_loss: 0.1535 - val_acc: 0.9534
Epoch 13/20
 - 3s - loss: 0.1955 - acc: 0.9420 - val_loss: 0.1634 - val_acc: 0.9516
Epoch 14/20
 - 3s - loss: 0.1969 - acc: 0.9429 - val_loss: 0.1302 - val_acc: 0.9619
Epoch 15/20
 - 3s - loss: 0.1988 - acc: 0.9423 - val_loss: 0.1238 - val_acc: 0.9632
Epoch 16/20
 - 3s - loss: 0.2012 - acc: 0.9421 - val_loss: 0.2030 - val_acc: 0.9436
Epoch 17/20
 - 3s - loss: 0.2004 - acc: 0.9432 - val_loss: 0.1289 - val_acc: 0.9634
Epoch 18/20
 - 3s - loss: 0.2031 - acc: 0.9441 - val_loss: 0.1181 - val_acc: 0.9633
Epoch 19/20
 - 3s - loss: 0.2024 - acc: 0.9437 - val_loss: 0.1224 - val_acc: 0.9634
Epoch 20/20
 - 3s - loss: 0.2014 - acc: 0.9444 - val_loss: 0.1140 - val_acc: 0.9692
Test loss: 0.11917482723398716
Test accuracy: 0.9658
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9735 - acc: 0.6865 - val_loss: 0.4271 - val_acc: 0.8583
Epoch 2/20
 - 3s - loss: 0.4428 - acc: 0.8596 - val_loss: 0.5268 - val_acc: 0.8296
Epoch 3/20
 - 3s - loss: 0.3296 - acc: 0.8961 - val_loss: 0.1972 - val_acc: 0.9371
Epoch 4/20
 - 3s - loss: 0.2779 - acc: 0.9125 - val_loss: 0.2001 - val_acc: 0.9376
Epoch 5/20
 - 3s - loss: 0.2440 - acc: 0.9239 - val_loss: 0.1590 - val_acc: 0.9483
Epoch 6/20
 - 3s - loss: 0.2257 - acc: 0.9310 - val_loss: 0.1472 - val_acc: 0.9552
Epoch 7/20
 - 3s - loss: 0.2133 - acc: 0.9345 - val_loss: 0.1714 - val_acc: 0.9482
Epoch 8/20
 - 3s - loss: 0.2038 - acc: 0.9383 - val_loss: 0.1479 - val_acc: 0.9521
Epoch 9/20
 - 3s - loss: 0.1978 - acc: 0.9412 - val_loss: 0.1696 - val_acc: 0.9481
Epoch 10/20
 - 3s - loss: 0.1944 - acc: 0.9421 - val_loss: 0.1352 - val_acc: 0.9556
Epoch 11/20
 - 3s - loss: 0.1894 - acc: 0.9436 - val_loss: 0.2066 - val_acc: 0.9362
Epoch 12/20
 - 3s - loss: 0.1870 - acc: 0.9455 - val_loss: 0.1187 - val_acc: 0.9628
Epoch 13/20
 - 3s - loss: 0.1876 - acc: 0.9455 - val_loss: 0.1242 - val_acc: 0.9647
Epoch 14/20
 - 3s - loss: 0.1855 - acc: 0.9462 - val_loss: 0.1634 - val_acc: 0.9534
Epoch 15/20
 - 3s - loss: 0.1839 - acc: 0.9481 - val_loss: 0.1227 - val_acc: 0.9652
Epoch 16/20
 - 3s - loss: 0.1846 - acc: 0.9478 - val_loss: 0.1368 - val_acc: 0.9622
Epoch 17/20
 - 3s - loss: 0.1829 - acc: 0.9468 - val_loss: 0.1211 - val_acc: 0.9618
Epoch 18/20
 - 3s - loss: 0.1827 - acc: 0.9492 - val_loss: 0.1301 - val_acc: 0.9645
Epoch 19/20
 - 3s - loss: 0.1853 - acc: 0.9481 - val_loss: 0.1288 - val_acc: 0.9606
Epoch 20/20
 - 3s - loss: 0.1826 - acc: 0.9486 - val_loss: 0.1640 - val_acc: 0.9544
Test loss: 0.1649064939829521
Test accuracy: 0.9524
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9200 - acc: 0.7010 - val_loss: 0.4314 - val_acc: 0.8560
Epoch 2/20
 - 3s - loss: 0.4429 - acc: 0.8581 - val_loss: 0.2523 - val_acc: 0.9177
Epoch 3/20
 - 3s - loss: 0.3307 - acc: 0.8952 - val_loss: 0.3857 - val_acc: 0.8798
Epoch 4/20
 - 3s - loss: 0.2761 - acc: 0.9138 - val_loss: 0.1753 - val_acc: 0.9443
Epoch 5/20
 - 3s - loss: 0.2458 - acc: 0.9239 - val_loss: 0.1742 - val_acc: 0.9445
Epoch 6/20
 - 3s - loss: 0.2249 - acc: 0.9298 - val_loss: 0.1432 - val_acc: 0.9539
Epoch 7/20
 - 3s - loss: 0.2096 - acc: 0.9353 - val_loss: 0.1893 - val_acc: 0.9385
Epoch 8/20
 - 3s - loss: 0.2005 - acc: 0.9395 - val_loss: 0.1261 - val_acc: 0.9604
Epoch 9/20
 - 3s - loss: 0.1939 - acc: 0.9411 - val_loss: 0.1344 - val_acc: 0.9572
Epoch 10/20
 - 3s - loss: 0.1896 - acc: 0.9438 - val_loss: 0.1519 - val_acc: 0.9507
Epoch 11/20
 - 3s - loss: 0.1826 - acc: 0.9454 - val_loss: 0.1219 - val_acc: 0.9624
Epoch 12/20
 - 3s - loss: 0.1811 - acc: 0.9470 - val_loss: 0.1111 - val_acc: 0.9663
Epoch 13/20
 - 3s - loss: 0.1799 - acc: 0.9473 - val_loss: 0.1161 - val_acc: 0.9622
Epoch 14/20
 - 3s - loss: 0.1764 - acc: 0.9492 - val_loss: 0.1391 - val_acc: 0.9564
Epoch 15/20
 - 3s - loss: 0.1725 - acc: 0.9499 - val_loss: 0.1182 - val_acc: 0.9649
Epoch 16/20
 - 3s - loss: 0.1721 - acc: 0.9496 - val_loss: 0.1106 - val_acc: 0.9696
Epoch 17/20
 - 3s - loss: 0.1791 - acc: 0.9488 - val_loss: 0.1244 - val_acc: 0.9675
Epoch 18/20
 - 3s - loss: 0.1743 - acc: 0.9511 - val_loss: 0.1049 - val_acc: 0.9698
Epoch 19/20
 - 3s - loss: 0.1762 - acc: 0.9504 - val_loss: 0.1221 - val_acc: 0.9677
Epoch 20/20
 - 3s - loss: 0.1778 - acc: 0.9517 - val_loss: 0.1261 - val_acc: 0.9670
Test loss: 0.12724712520090398
Test accuracy: 0.9664
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9393 - acc: 0.6973 - val_loss: 0.4928 - val_acc: 0.8277
Epoch 2/20
 - 3s - loss: 0.4433 - acc: 0.8581 - val_loss: 0.3559 - val_acc: 0.8932
Epoch 3/20
 - 3s - loss: 0.3244 - acc: 0.8973 - val_loss: 0.3656 - val_acc: 0.8743
Epoch 4/20
 - 3s - loss: 0.2730 - acc: 0.9149 - val_loss: 0.2107 - val_acc: 0.9364
Epoch 5/20
 - 3s - loss: 0.2393 - acc: 0.9254 - val_loss: 0.1475 - val_acc: 0.9495
Epoch 6/20
 - 3s - loss: 0.2176 - acc: 0.9327 - val_loss: 0.1194 - val_acc: 0.9630
Epoch 7/20
 - 3s - loss: 0.2006 - acc: 0.9389 - val_loss: 0.1296 - val_acc: 0.9587
Epoch 8/20
 - 3s - loss: 0.1909 - acc: 0.9418 - val_loss: 0.1267 - val_acc: 0.9625
Epoch 9/20
 - 3s - loss: 0.1850 - acc: 0.9443 - val_loss: 0.1830 - val_acc: 0.9405
Epoch 10/20
 - 3s - loss: 0.1813 - acc: 0.9456 - val_loss: 0.1924 - val_acc: 0.9429
Epoch 11/20
 - 3s - loss: 0.1793 - acc: 0.9464 - val_loss: 0.1254 - val_acc: 0.9616
Epoch 12/20
 - 3s - loss: 0.1707 - acc: 0.9497 - val_loss: 0.1730 - val_acc: 0.9455
Epoch 13/20
 - 3s - loss: 0.1735 - acc: 0.9491 - val_loss: 0.1100 - val_acc: 0.9671
Epoch 14/20
 - 3s - loss: 0.1675 - acc: 0.9512 - val_loss: 0.1599 - val_acc: 0.9478
Epoch 15/20
 - 3s - loss: 0.1668 - acc: 0.9518 - val_loss: 0.1128 - val_acc: 0.9658
Epoch 16/20
 - 3s - loss: 0.1652 - acc: 0.9522 - val_loss: 0.1188 - val_acc: 0.9685
Epoch 17/20
 - 3s - loss: 0.1706 - acc: 0.9521 - val_loss: 0.1058 - val_acc: 0.9702
Epoch 18/20
 - 3s - loss: 0.1701 - acc: 0.9514 - val_loss: 0.1124 - val_acc: 0.9686
Epoch 19/20
 - 3s - loss: 0.1679 - acc: 0.9530 - val_loss: 0.1247 - val_acc: 0.9656
Epoch 20/20
 - 3s - loss: 0.1615 - acc: 0.9547 - val_loss: 0.1206 - val_acc: 0.9641
Test loss: 0.12051548165013082
Test accuracy: 0.9657
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9491 - acc: 0.6917 - val_loss: 0.3880 - val_acc: 0.8795
Epoch 2/20
 - 4s - loss: 0.4432 - acc: 0.8575 - val_loss: 0.2718 - val_acc: 0.9166
Epoch 3/20
 - 4s - loss: 0.3295 - acc: 0.8976 - val_loss: 0.2087 - val_acc: 0.9370
Epoch 4/20
 - 4s - loss: 0.2730 - acc: 0.9143 - val_loss: 0.1982 - val_acc: 0.9396
Epoch 5/20
 - 4s - loss: 0.2390 - acc: 0.9246 - val_loss: 0.1838 - val_acc: 0.9391
Epoch 6/20
 - 4s - loss: 0.2189 - acc: 0.9313 - val_loss: 0.1380 - val_acc: 0.9558
Epoch 7/20
 - 4s - loss: 0.2055 - acc: 0.9362 - val_loss: 0.1707 - val_acc: 0.9430
Epoch 8/20
 - 4s - loss: 0.1955 - acc: 0.9404 - val_loss: 0.1158 - val_acc: 0.9631
Epoch 9/20
 - 4s - loss: 0.1903 - acc: 0.9433 - val_loss: 0.1322 - val_acc: 0.9609
Epoch 10/20
 - 4s - loss: 0.1833 - acc: 0.9456 - val_loss: 0.1883 - val_acc: 0.9446
Epoch 11/20
 - 4s - loss: 0.1751 - acc: 0.9483 - val_loss: 0.1308 - val_acc: 0.9617
Epoch 12/20
 - 4s - loss: 0.1746 - acc: 0.9480 - val_loss: 0.1098 - val_acc: 0.9654
Epoch 13/20
 - 4s - loss: 0.1723 - acc: 0.9491 - val_loss: 0.1559 - val_acc: 0.9563
Epoch 14/20
 - 4s - loss: 0.1717 - acc: 0.9498 - val_loss: 0.1779 - val_acc: 0.9519
Epoch 15/20
 - 4s - loss: 0.1686 - acc: 0.9509 - val_loss: 0.1133 - val_acc: 0.9655
Epoch 16/20
 - 4s - loss: 0.1680 - acc: 0.9522 - val_loss: 0.1155 - val_acc: 0.9684
Epoch 17/20
 - 4s - loss: 0.1666 - acc: 0.9520 - val_loss: 0.1181 - val_acc: 0.9678
Epoch 18/20
 - 4s - loss: 0.1645 - acc: 0.9528 - val_loss: 0.1122 - val_acc: 0.9670
Epoch 19/20
 - 4s - loss: 0.1668 - acc: 0.9533 - val_loss: 0.1160 - val_acc: 0.9651
Epoch 20/20
 - 4s - loss: 0.1658 - acc: 0.9536 - val_loss: 0.0970 - val_acc: 0.9702
Test loss: 0.09660989637194434
Test accuracy: 0.9702
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9235 - acc: 0.7001 - val_loss: 0.3336 - val_acc: 0.8947
Epoch 2/20
 - 4s - loss: 0.4323 - acc: 0.8639 - val_loss: 0.2470 - val_acc: 0.9256
Epoch 3/20
 - 4s - loss: 0.3214 - acc: 0.8974 - val_loss: 0.1864 - val_acc: 0.9378
Epoch 4/20
 - 4s - loss: 0.2714 - acc: 0.9163 - val_loss: 0.2687 - val_acc: 0.9098
Epoch 5/20
 - 4s - loss: 0.2393 - acc: 0.9259 - val_loss: 0.1644 - val_acc: 0.9478
Epoch 6/20
 - 4s - loss: 0.2177 - acc: 0.9337 - val_loss: 0.1298 - val_acc: 0.9569
Epoch 7/20
 - 4s - loss: 0.2044 - acc: 0.9379 - val_loss: 0.1471 - val_acc: 0.9527
Epoch 8/20
 - 4s - loss: 0.1937 - acc: 0.9404 - val_loss: 0.1096 - val_acc: 0.9658
Epoch 9/20
 - 4s - loss: 0.1868 - acc: 0.9440 - val_loss: 0.1380 - val_acc: 0.9607
Epoch 10/20
 - 4s - loss: 0.1782 - acc: 0.9460 - val_loss: 0.1053 - val_acc: 0.9671
Epoch 11/20
 - 4s - loss: 0.1728 - acc: 0.9480 - val_loss: 0.1019 - val_acc: 0.9697
Epoch 12/20
 - 4s - loss: 0.1709 - acc: 0.9493 - val_loss: 0.0943 - val_acc: 0.9705
Epoch 13/20
 - 4s - loss: 0.1686 - acc: 0.9506 - val_loss: 0.1333 - val_acc: 0.9594
Epoch 14/20
 - 4s - loss: 0.1668 - acc: 0.9518 - val_loss: 0.1082 - val_acc: 0.9669
Epoch 15/20
 - 4s - loss: 0.1661 - acc: 0.9516 - val_loss: 0.1790 - val_acc: 0.9490
Epoch 16/20
 - 4s - loss: 0.1650 - acc: 0.9521 - val_loss: 0.1545 - val_acc: 0.9555
Epoch 17/20
 - 4s - loss: 0.1611 - acc: 0.9538 - val_loss: 0.1050 - val_acc: 0.9673
Epoch 18/20
 - 4s - loss: 0.1606 - acc: 0.9536 - val_loss: 0.1584 - val_acc: 0.9568
Epoch 19/20
 - 4s - loss: 0.1649 - acc: 0.9532 - val_loss: 0.1008 - val_acc: 0.9719
Epoch 20/20
 - 4s - loss: 0.1607 - acc: 0.9548 - val_loss: 0.0855 - val_acc: 0.9741
Test loss: 0.08515604675192517
Test accuracy: 0.9751
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9354 - acc: 0.7006 - val_loss: 0.4448 - val_acc: 0.8548
Epoch 2/20
 - 6s - loss: 0.4297 - acc: 0.8637 - val_loss: 0.2247 - val_acc: 0.9281
Epoch 3/20
 - 6s - loss: 0.3176 - acc: 0.8995 - val_loss: 0.1816 - val_acc: 0.9450
Epoch 4/20
 - 6s - loss: 0.2666 - acc: 0.9160 - val_loss: 0.1775 - val_acc: 0.9480
Epoch 5/20
 - 6s - loss: 0.2356 - acc: 0.9249 - val_loss: 0.1651 - val_acc: 0.9456
Epoch 6/20
 - 6s - loss: 0.2172 - acc: 0.9321 - val_loss: 0.1515 - val_acc: 0.9529
Epoch 7/20
 - 6s - loss: 0.1981 - acc: 0.9388 - val_loss: 0.1688 - val_acc: 0.9473
Epoch 8/20
 - 6s - loss: 0.1904 - acc: 0.9426 - val_loss: 0.1321 - val_acc: 0.9577
Epoch 9/20
 - 6s - loss: 0.1841 - acc: 0.9453 - val_loss: 0.1743 - val_acc: 0.9507
Epoch 10/20
 - 6s - loss: 0.1778 - acc: 0.9467 - val_loss: 0.1235 - val_acc: 0.9624
Epoch 11/20
 - 6s - loss: 0.1720 - acc: 0.9492 - val_loss: 0.1502 - val_acc: 0.9564
Epoch 12/20
 - 6s - loss: 0.1686 - acc: 0.9497 - val_loss: 0.1264 - val_acc: 0.9606
Epoch 13/20
 - 6s - loss: 0.1684 - acc: 0.9513 - val_loss: 0.1356 - val_acc: 0.9629
Epoch 14/20
 - 6s - loss: 0.1657 - acc: 0.9517 - val_loss: 0.1158 - val_acc: 0.9664
Epoch 15/20
 - 6s - loss: 0.1653 - acc: 0.9537 - val_loss: 0.1167 - val_acc: 0.9668
Epoch 16/20
 - 6s - loss: 0.1628 - acc: 0.9538 - val_loss: 0.1511 - val_acc: 0.9579
Epoch 17/20
 - 6s - loss: 0.1648 - acc: 0.9528 - val_loss: 0.1081 - val_acc: 0.9710
Epoch 18/20
 - 6s - loss: 0.1647 - acc: 0.9537 - val_loss: 0.1255 - val_acc: 0.9654
Epoch 19/20
 - 6s - loss: 0.1618 - acc: 0.9553 - val_loss: 0.1107 - val_acc: 0.9694
Epoch 20/20
 - 6s - loss: 0.1640 - acc: 0.9554 - val_loss: 0.1360 - val_acc: 0.9682
Test loss: 0.13650730232812194
Test accuracy: 0.968
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9265 - acc: 0.7008 - val_loss: 0.3643 - val_acc: 0.8801
Epoch 2/20
 - 9s - loss: 0.4374 - acc: 0.8624 - val_loss: 0.5841 - val_acc: 0.8168
Epoch 3/20
 - 9s - loss: 0.3257 - acc: 0.8983 - val_loss: 0.1954 - val_acc: 0.9342
Epoch 4/20
 - 9s - loss: 0.2730 - acc: 0.9149 - val_loss: 0.1528 - val_acc: 0.9530
Epoch 5/20
 - 9s - loss: 0.2408 - acc: 0.9258 - val_loss: 0.1341 - val_acc: 0.9599
Epoch 6/20
 - 9s - loss: 0.2176 - acc: 0.9328 - val_loss: 0.1298 - val_acc: 0.9558
Epoch 7/20
 - 9s - loss: 0.2026 - acc: 0.9385 - val_loss: 0.1290 - val_acc: 0.9588
Epoch 8/20
 - 9s - loss: 0.1937 - acc: 0.9405 - val_loss: 0.1766 - val_acc: 0.9497
Epoch 9/20
 - 9s - loss: 0.1841 - acc: 0.9450 - val_loss: 0.1097 - val_acc: 0.9688
Epoch 10/20
 - 9s - loss: 0.1792 - acc: 0.9453 - val_loss: 0.2064 - val_acc: 0.9367
Epoch 11/20
 - 9s - loss: 0.1720 - acc: 0.9482 - val_loss: 0.1250 - val_acc: 0.9630
Epoch 12/20
 - 9s - loss: 0.1705 - acc: 0.9492 - val_loss: 0.1179 - val_acc: 0.9642
Epoch 13/20
 - 9s - loss: 0.1671 - acc: 0.9507 - val_loss: 0.1667 - val_acc: 0.9493
Epoch 14/20
 - 9s - loss: 0.1657 - acc: 0.9522 - val_loss: 0.1041 - val_acc: 0.9700
Epoch 15/20
 - 9s - loss: 0.1621 - acc: 0.9526 - val_loss: 0.1243 - val_acc: 0.9605
Epoch 16/20
 - 9s - loss: 0.1641 - acc: 0.9519 - val_loss: 0.1469 - val_acc: 0.9576
Epoch 17/20
 - 9s - loss: 0.1605 - acc: 0.9534 - val_loss: 0.1202 - val_acc: 0.9645
Epoch 18/20
 - 9s - loss: 0.1642 - acc: 0.9540 - val_loss: 0.1173 - val_acc: 0.9627
Epoch 19/20
 - 9s - loss: 0.1573 - acc: 0.9548 - val_loss: 0.1199 - val_acc: 0.9719
Epoch 20/20
 - 9s - loss: 0.1569 - acc: 0.9552 - val_loss: 0.1145 - val_acc: 0.9670
Test loss: 0.11514603984046552
Test accuracy: 0.9676
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9451 - acc: 0.6993 - val_loss: 0.5262 - val_acc: 0.8335
Epoch 2/20
 - 14s - loss: 0.4333 - acc: 0.8612 - val_loss: 0.2553 - val_acc: 0.9197
Epoch 3/20
 - 14s - loss: 0.3266 - acc: 0.8985 - val_loss: 0.2087 - val_acc: 0.9377
Epoch 4/20
 - 14s - loss: 0.2708 - acc: 0.9157 - val_loss: 0.2331 - val_acc: 0.9212
Epoch 5/20
 - 14s - loss: 0.2382 - acc: 0.9256 - val_loss: 0.1988 - val_acc: 0.9321
Epoch 6/20
 - 14s - loss: 0.2185 - acc: 0.9324 - val_loss: 0.1375 - val_acc: 0.9541
Epoch 7/20
 - 14s - loss: 0.2081 - acc: 0.9367 - val_loss: 0.1973 - val_acc: 0.9387
Epoch 8/20
 - 14s - loss: 0.1932 - acc: 0.9420 - val_loss: 0.1213 - val_acc: 0.9630
Epoch 9/20
 - 14s - loss: 0.1840 - acc: 0.9445 - val_loss: 0.1623 - val_acc: 0.9506
Epoch 10/20
 - 14s - loss: 0.1781 - acc: 0.9469 - val_loss: 0.1583 - val_acc: 0.9505
Epoch 11/20
 - 14s - loss: 0.1712 - acc: 0.9483 - val_loss: 0.1034 - val_acc: 0.9681
Epoch 12/20
 - 14s - loss: 0.1690 - acc: 0.9496 - val_loss: 0.1401 - val_acc: 0.9573
Epoch 13/20
 - 14s - loss: 0.1706 - acc: 0.9503 - val_loss: 0.0934 - val_acc: 0.9722
Epoch 14/20
 - 14s - loss: 0.1631 - acc: 0.9515 - val_loss: 0.1148 - val_acc: 0.9667
Epoch 15/20
 - 14s - loss: 0.1653 - acc: 0.9523 - val_loss: 0.1086 - val_acc: 0.9692
Epoch 16/20
 - 14s - loss: 0.1609 - acc: 0.9536 - val_loss: 0.0955 - val_acc: 0.9696
Epoch 17/20
 - 14s - loss: 0.1653 - acc: 0.9527 - val_loss: 0.1098 - val_acc: 0.9689
Epoch 18/20
 - 14s - loss: 0.1664 - acc: 0.9526 - val_loss: 0.1047 - val_acc: 0.9705
Epoch 19/20
 - 14s - loss: 0.1687 - acc: 0.9530 - val_loss: 0.1251 - val_acc: 0.9672
Epoch 20/20
 - 14s - loss: 0.1647 - acc: 0.9534 - val_loss: 0.1021 - val_acc: 0.9676
Test loss: 0.1019858069550246
Test accuracy: 0.9671
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9434 - acc: 0.6983 - val_loss: 0.4096 - val_acc: 0.8675
Epoch 2/20
 - 26s - loss: 0.4345 - acc: 0.8620 - val_loss: 0.4131 - val_acc: 0.8715
Epoch 3/20
 - 26s - loss: 0.3232 - acc: 0.8990 - val_loss: 0.2225 - val_acc: 0.9315
Epoch 4/20
 - 26s - loss: 0.2688 - acc: 0.9161 - val_loss: 0.1828 - val_acc: 0.9418
Epoch 5/20
 - 26s - loss: 0.2362 - acc: 0.9268 - val_loss: 0.2044 - val_acc: 0.9337
Epoch 6/20
 - 26s - loss: 0.2162 - acc: 0.9326 - val_loss: 0.1522 - val_acc: 0.9535
Epoch 7/20
 - 26s - loss: 0.2021 - acc: 0.9393 - val_loss: 0.1837 - val_acc: 0.9414
Epoch 8/20
 - 26s - loss: 0.1928 - acc: 0.9410 - val_loss: 0.1342 - val_acc: 0.9561
Epoch 9/20
 - 26s - loss: 0.1811 - acc: 0.9458 - val_loss: 0.1372 - val_acc: 0.9596
Epoch 10/20
 - 26s - loss: 0.1817 - acc: 0.9468 - val_loss: 0.1141 - val_acc: 0.9658
Epoch 11/20
 - 26s - loss: 0.1717 - acc: 0.9492 - val_loss: 0.1381 - val_acc: 0.9595
Epoch 12/20
 - 26s - loss: 0.1714 - acc: 0.9507 - val_loss: 0.0986 - val_acc: 0.9731
Epoch 13/20
 - 26s - loss: 0.1704 - acc: 0.9496 - val_loss: 0.1071 - val_acc: 0.9699
Epoch 14/20
 - 26s - loss: 0.1626 - acc: 0.9524 - val_loss: 0.1051 - val_acc: 0.9689
Epoch 15/20
 - 26s - loss: 0.1632 - acc: 0.9523 - val_loss: 0.1276 - val_acc: 0.9701
Epoch 16/20
 - 26s - loss: 0.1632 - acc: 0.9538 - val_loss: 0.1245 - val_acc: 0.9599
Epoch 17/20
 - 26s - loss: 0.1630 - acc: 0.9542 - val_loss: 0.1213 - val_acc: 0.9670
Epoch 18/20
 - 26s - loss: 0.1665 - acc: 0.9535 - val_loss: 0.1052 - val_acc: 0.9690
Epoch 19/20
 - 26s - loss: 0.1611 - acc: 0.9552 - val_loss: 0.1164 - val_acc: 0.9674
Epoch 20/20
 - 26s - loss: 0.1636 - acc: 0.9544 - val_loss: 0.1230 - val_acc: 0.9687
Test loss: 0.12245837438329908
Test accuracy: 0.9687
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9806 - acc: 0.6868 - val_loss: 0.5399 - val_acc: 0.8259
Epoch 2/20
 - 3s - loss: 0.4579 - acc: 0.8543 - val_loss: 0.2712 - val_acc: 0.9123
Epoch 3/20
 - 3s - loss: 0.3445 - acc: 0.8914 - val_loss: 0.2477 - val_acc: 0.9210
Epoch 4/20
 - 3s - loss: 0.2958 - acc: 0.9066 - val_loss: 0.2982 - val_acc: 0.9011
Epoch 5/20
 - 3s - loss: 0.2603 - acc: 0.9189 - val_loss: 0.1732 - val_acc: 0.9436
Epoch 6/20
 - 3s - loss: 0.2408 - acc: 0.9258 - val_loss: 0.1940 - val_acc: 0.9412
Epoch 7/20
 - 3s - loss: 0.2320 - acc: 0.9294 - val_loss: 0.1736 - val_acc: 0.9464
Epoch 8/20
 - 3s - loss: 0.2206 - acc: 0.9329 - val_loss: 0.1498 - val_acc: 0.9506
Epoch 9/20
 - 3s - loss: 0.2135 - acc: 0.9355 - val_loss: 0.1670 - val_acc: 0.9498
Epoch 10/20
 - 3s - loss: 0.2077 - acc: 0.9380 - val_loss: 0.1840 - val_acc: 0.9378
Epoch 11/20
 - 3s - loss: 0.2058 - acc: 0.9403 - val_loss: 0.1730 - val_acc: 0.9554
Epoch 12/20
 - 3s - loss: 0.2040 - acc: 0.9414 - val_loss: 0.1588 - val_acc: 0.9553
Epoch 13/20
 - 3s - loss: 0.2012 - acc: 0.9418 - val_loss: 0.1890 - val_acc: 0.9421
Epoch 14/20
 - 3s - loss: 0.1999 - acc: 0.9426 - val_loss: 0.1548 - val_acc: 0.9542
Epoch 15/20
 - 3s - loss: 0.1998 - acc: 0.9428 - val_loss: 0.1317 - val_acc: 0.9589
Epoch 16/20
 - 3s - loss: 0.2037 - acc: 0.9424 - val_loss: 0.1846 - val_acc: 0.9462
Epoch 17/20
 - 3s - loss: 0.2079 - acc: 0.9413 - val_loss: 0.1205 - val_acc: 0.9669
Epoch 18/20
 - 3s - loss: 0.2007 - acc: 0.9438 - val_loss: 0.1094 - val_acc: 0.9665
Epoch 19/20
 - 3s - loss: 0.2013 - acc: 0.9438 - val_loss: 0.1467 - val_acc: 0.9609
Epoch 20/20
 - 3s - loss: 0.2005 - acc: 0.9438 - val_loss: 0.1497 - val_acc: 0.9570
Test loss: 0.14669121755121742
Test accuracy: 0.9568
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9749 - acc: 0.6873 - val_loss: 0.4786 - val_acc: 0.8488
Epoch 2/20
 - 3s - loss: 0.4467 - acc: 0.8585 - val_loss: 0.2851 - val_acc: 0.9103
Epoch 3/20
 - 3s - loss: 0.3313 - acc: 0.8954 - val_loss: 0.2561 - val_acc: 0.9173
Epoch 4/20
 - 3s - loss: 0.2814 - acc: 0.9115 - val_loss: 0.1752 - val_acc: 0.9437
Epoch 5/20
 - 3s - loss: 0.2442 - acc: 0.9237 - val_loss: 0.2070 - val_acc: 0.9342
Epoch 6/20
 - 3s - loss: 0.2279 - acc: 0.9297 - val_loss: 0.2057 - val_acc: 0.9327
Epoch 7/20
 - 3s - loss: 0.2151 - acc: 0.9337 - val_loss: 0.1659 - val_acc: 0.9467
Epoch 8/20
 - 3s - loss: 0.2051 - acc: 0.9377 - val_loss: 0.1922 - val_acc: 0.9406
Epoch 9/20
 - 3s - loss: 0.1988 - acc: 0.9408 - val_loss: 0.1663 - val_acc: 0.9501
Epoch 10/20
 - 3s - loss: 0.1933 - acc: 0.9409 - val_loss: 0.1258 - val_acc: 0.9625
Epoch 11/20
 - 3s - loss: 0.1856 - acc: 0.9446 - val_loss: 0.1256 - val_acc: 0.9621
Epoch 12/20
 - 3s - loss: 0.1878 - acc: 0.9451 - val_loss: 0.1120 - val_acc: 0.9648
Epoch 13/20
 - 3s - loss: 0.1886 - acc: 0.9452 - val_loss: 0.1506 - val_acc: 0.9605
Epoch 14/20
 - 3s - loss: 0.1838 - acc: 0.9464 - val_loss: 0.1152 - val_acc: 0.9651
Epoch 15/20
 - 3s - loss: 0.1825 - acc: 0.9473 - val_loss: 0.1191 - val_acc: 0.9683
Epoch 16/20
 - 3s - loss: 0.1882 - acc: 0.9476 - val_loss: 0.1593 - val_acc: 0.9597
Epoch 17/20
 - 3s - loss: 0.1828 - acc: 0.9483 - val_loss: 0.1412 - val_acc: 0.9631
Epoch 18/20
 - 3s - loss: 0.1811 - acc: 0.9493 - val_loss: 0.1166 - val_acc: 0.9667
Epoch 19/20
 - 3s - loss: 0.1826 - acc: 0.9493 - val_loss: 0.1121 - val_acc: 0.9662
Epoch 20/20
 - 3s - loss: 0.1812 - acc: 0.9498 - val_loss: 0.0943 - val_acc: 0.9714
Test loss: 0.09876082408674557
Test accuracy: 0.9731
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9253 - acc: 0.6985 - val_loss: 0.4795 - val_acc: 0.8489
Epoch 2/20
 - 3s - loss: 0.4345 - acc: 0.8601 - val_loss: 0.2610 - val_acc: 0.9133
Epoch 3/20
 - 3s - loss: 0.3263 - acc: 0.8978 - val_loss: 0.4896 - val_acc: 0.8463
Epoch 4/20
 - 3s - loss: 0.2722 - acc: 0.9143 - val_loss: 0.1580 - val_acc: 0.9517
Epoch 5/20
 - 3s - loss: 0.2405 - acc: 0.9251 - val_loss: 0.2721 - val_acc: 0.9201
Epoch 6/20
 - 3s - loss: 0.2224 - acc: 0.9306 - val_loss: 0.1380 - val_acc: 0.9571
Epoch 7/20
 - 3s - loss: 0.2092 - acc: 0.9372 - val_loss: 0.2097 - val_acc: 0.9365
Epoch 8/20
 - 3s - loss: 0.2017 - acc: 0.9390 - val_loss: 0.1338 - val_acc: 0.9573
Epoch 9/20
 - 3s - loss: 0.1948 - acc: 0.9413 - val_loss: 0.1579 - val_acc: 0.9548
Epoch 10/20
 - 3s - loss: 0.1810 - acc: 0.9450 - val_loss: 0.1872 - val_acc: 0.9411
Epoch 11/20
 - 3s - loss: 0.1810 - acc: 0.9459 - val_loss: 0.1405 - val_acc: 0.9554
Epoch 12/20
 - 3s - loss: 0.1743 - acc: 0.9485 - val_loss: 0.1346 - val_acc: 0.9609
Epoch 13/20
 - 3s - loss: 0.1772 - acc: 0.9484 - val_loss: 0.1227 - val_acc: 0.9607
Epoch 14/20
 - 3s - loss: 0.1722 - acc: 0.9503 - val_loss: 0.1094 - val_acc: 0.9654
Epoch 15/20
 - 3s - loss: 0.1701 - acc: 0.9494 - val_loss: 0.1634 - val_acc: 0.9524
Epoch 16/20
 - 3s - loss: 0.1767 - acc: 0.9502 - val_loss: 0.1335 - val_acc: 0.9645
Epoch 17/20
 - 3s - loss: 0.1727 - acc: 0.9507 - val_loss: 0.1633 - val_acc: 0.9523
Epoch 18/20
 - 3s - loss: 0.1749 - acc: 0.9505 - val_loss: 0.1120 - val_acc: 0.9650
Epoch 19/20
 - 3s - loss: 0.1763 - acc: 0.9515 - val_loss: 0.1247 - val_acc: 0.9657
Epoch 20/20
 - 3s - loss: 0.1755 - acc: 0.9506 - val_loss: 0.1226 - val_acc: 0.9672
Test loss: 0.12447201920363878
Test accuracy: 0.966
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9401 - acc: 0.7011 - val_loss: 0.4286 - val_acc: 0.8594
Epoch 2/20
 - 3s - loss: 0.4321 - acc: 0.8629 - val_loss: 0.2872 - val_acc: 0.9093
Epoch 3/20
 - 3s - loss: 0.3261 - acc: 0.8964 - val_loss: 0.1876 - val_acc: 0.9410
Epoch 4/20
 - 3s - loss: 0.2664 - acc: 0.9159 - val_loss: 0.3134 - val_acc: 0.9005
Epoch 5/20
 - 3s - loss: 0.2379 - acc: 0.9265 - val_loss: 0.1382 - val_acc: 0.9555
Epoch 6/20
 - 3s - loss: 0.2171 - acc: 0.9322 - val_loss: 0.1510 - val_acc: 0.9520
Epoch 7/20
 - 3s - loss: 0.2046 - acc: 0.9378 - val_loss: 0.1428 - val_acc: 0.9545
Epoch 8/20
 - 3s - loss: 0.1967 - acc: 0.9409 - val_loss: 0.1353 - val_acc: 0.9577
Epoch 9/20
 - 3s - loss: 0.1833 - acc: 0.9440 - val_loss: 0.1202 - val_acc: 0.9629
Epoch 10/20
 - 3s - loss: 0.1832 - acc: 0.9452 - val_loss: 0.1733 - val_acc: 0.9466
Epoch 11/20
 - 3s - loss: 0.1765 - acc: 0.9477 - val_loss: 0.1419 - val_acc: 0.9593
Epoch 12/20
 - 3s - loss: 0.1731 - acc: 0.9500 - val_loss: 0.1101 - val_acc: 0.9686
Epoch 13/20
 - 3s - loss: 0.1686 - acc: 0.9512 - val_loss: 0.1211 - val_acc: 0.9674
Epoch 14/20
 - 3s - loss: 0.1661 - acc: 0.9512 - val_loss: 0.1242 - val_acc: 0.9678
Epoch 15/20
 - 3s - loss: 0.1706 - acc: 0.9520 - val_loss: 0.1430 - val_acc: 0.9567
Epoch 16/20
 - 3s - loss: 0.1691 - acc: 0.9525 - val_loss: 0.1118 - val_acc: 0.9678
Epoch 17/20
 - 3s - loss: 0.1688 - acc: 0.9522 - val_loss: 0.1686 - val_acc: 0.9478
Epoch 18/20
 - 3s - loss: 0.1673 - acc: 0.9530 - val_loss: 0.1514 - val_acc: 0.9581
Epoch 19/20
 - 3s - loss: 0.1694 - acc: 0.9522 - val_loss: 0.1082 - val_acc: 0.9711
Epoch 20/20
 - 3s - loss: 0.1717 - acc: 0.9530 - val_loss: 0.1175 - val_acc: 0.9684
Test loss: 0.11860751607540296
Test accuracy: 0.9687
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9276 - acc: 0.6983 - val_loss: 0.5525 - val_acc: 0.8192
Epoch 2/20
 - 4s - loss: 0.4284 - acc: 0.8624 - val_loss: 0.3238 - val_acc: 0.8947
Epoch 3/20
 - 4s - loss: 0.3217 - acc: 0.8988 - val_loss: 0.2620 - val_acc: 0.9107
Epoch 4/20
 - 4s - loss: 0.2695 - acc: 0.9158 - val_loss: 0.2393 - val_acc: 0.9185
Epoch 5/20
 - 4s - loss: 0.2390 - acc: 0.9252 - val_loss: 0.1554 - val_acc: 0.9525
Epoch 6/20
 - 4s - loss: 0.2186 - acc: 0.9328 - val_loss: 0.1659 - val_acc: 0.9462
Epoch 7/20
 - 4s - loss: 0.2058 - acc: 0.9372 - val_loss: 0.1223 - val_acc: 0.9612
Epoch 8/20
 - 4s - loss: 0.1936 - acc: 0.9404 - val_loss: 0.1160 - val_acc: 0.9622
Epoch 9/20
 - 4s - loss: 0.1832 - acc: 0.9441 - val_loss: 0.1954 - val_acc: 0.9394
Epoch 10/20
 - 4s - loss: 0.1784 - acc: 0.9465 - val_loss: 0.1820 - val_acc: 0.9509
Epoch 11/20
 - 4s - loss: 0.1766 - acc: 0.9479 - val_loss: 0.1342 - val_acc: 0.9592
Epoch 12/20
 - 4s - loss: 0.1723 - acc: 0.9488 - val_loss: 0.1296 - val_acc: 0.9611
Epoch 13/20
 - 4s - loss: 0.1632 - acc: 0.9509 - val_loss: 0.1048 - val_acc: 0.9680
Epoch 14/20
 - 4s - loss: 0.1658 - acc: 0.9518 - val_loss: 0.1178 - val_acc: 0.9653
Epoch 15/20
 - 4s - loss: 0.1680 - acc: 0.9516 - val_loss: 0.1075 - val_acc: 0.9685
Epoch 16/20
 - 4s - loss: 0.1630 - acc: 0.9532 - val_loss: 0.1095 - val_acc: 0.9691
Epoch 17/20
 - 4s - loss: 0.1658 - acc: 0.9532 - val_loss: 0.1205 - val_acc: 0.9673
Epoch 18/20
 - 4s - loss: 0.1609 - acc: 0.9542 - val_loss: 0.1253 - val_acc: 0.9636
Epoch 19/20
 - 4s - loss: 0.1621 - acc: 0.9538 - val_loss: 0.1690 - val_acc: 0.9584
Epoch 20/20
 - 4s - loss: 0.1640 - acc: 0.9541 - val_loss: 0.1035 - val_acc: 0.9683
Test loss: 0.1049341536719352
Test accuracy: 0.9686
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9441 - acc: 0.6994 - val_loss: 0.4903 - val_acc: 0.8467
Epoch 2/20
 - 4s - loss: 0.4334 - acc: 0.8630 - val_loss: 0.3056 - val_acc: 0.9023
Epoch 3/20
 - 4s - loss: 0.3176 - acc: 0.9004 - val_loss: 0.2413 - val_acc: 0.9199
Epoch 4/20
 - 4s - loss: 0.2688 - acc: 0.9162 - val_loss: 0.1532 - val_acc: 0.9510
Epoch 5/20
 - 4s - loss: 0.2374 - acc: 0.9273 - val_loss: 0.2370 - val_acc: 0.9278
Epoch 6/20
 - 4s - loss: 0.2126 - acc: 0.9356 - val_loss: 0.1801 - val_acc: 0.9476
Epoch 7/20
 - 4s - loss: 0.2024 - acc: 0.9379 - val_loss: 0.1579 - val_acc: 0.9533
Epoch 8/20
 - 4s - loss: 0.1880 - acc: 0.9425 - val_loss: 0.1320 - val_acc: 0.9594
Epoch 9/20
 - 4s - loss: 0.1806 - acc: 0.9441 - val_loss: 0.1461 - val_acc: 0.9538
Epoch 10/20
 - 4s - loss: 0.1770 - acc: 0.9478 - val_loss: 0.1065 - val_acc: 0.9682
Epoch 11/20
 - 4s - loss: 0.1704 - acc: 0.9495 - val_loss: 0.1607 - val_acc: 0.9503
Epoch 12/20
 - 4s - loss: 0.1667 - acc: 0.9501 - val_loss: 0.1191 - val_acc: 0.9640
Epoch 13/20
 - 4s - loss: 0.1655 - acc: 0.9513 - val_loss: 0.1465 - val_acc: 0.9583
Epoch 14/20
 - 4s - loss: 0.1657 - acc: 0.9528 - val_loss: 0.0895 - val_acc: 0.9726
Epoch 15/20
 - 4s - loss: 0.1599 - acc: 0.9526 - val_loss: 0.1329 - val_acc: 0.9591
Epoch 16/20
 - 4s - loss: 0.1589 - acc: 0.9530 - val_loss: 0.1683 - val_acc: 0.9542
Epoch 17/20
 - 4s - loss: 0.1605 - acc: 0.9541 - val_loss: 0.1120 - val_acc: 0.9698
Epoch 18/20
 - 4s - loss: 0.1600 - acc: 0.9548 - val_loss: 0.1178 - val_acc: 0.9658
Epoch 19/20
 - 4s - loss: 0.1617 - acc: 0.9552 - val_loss: 0.1155 - val_acc: 0.9662
Epoch 20/20
 - 4s - loss: 0.1547 - acc: 0.9567 - val_loss: 0.0928 - val_acc: 0.9730
Test loss: 0.09273462788730394
Test accuracy: 0.9726
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9353 - acc: 0.6985 - val_loss: 0.3151 - val_acc: 0.9044
Epoch 2/20
 - 6s - loss: 0.4389 - acc: 0.8610 - val_loss: 0.2262 - val_acc: 0.9278
Epoch 3/20
 - 6s - loss: 0.3202 - acc: 0.8989 - val_loss: 0.2294 - val_acc: 0.9291
Epoch 4/20
 - 6s - loss: 0.2711 - acc: 0.9154 - val_loss: 0.1784 - val_acc: 0.9423
Epoch 5/20
 - 6s - loss: 0.2371 - acc: 0.9263 - val_loss: 0.1649 - val_acc: 0.9505
Epoch 6/20
 - 6s - loss: 0.2156 - acc: 0.9329 - val_loss: 0.1470 - val_acc: 0.9536
Epoch 7/20
 - 6s - loss: 0.2055 - acc: 0.9379 - val_loss: 0.1625 - val_acc: 0.9530
Epoch 8/20
 - 6s - loss: 0.1923 - acc: 0.9423 - val_loss: 0.1529 - val_acc: 0.9533
Epoch 9/20
 - 6s - loss: 0.1845 - acc: 0.9450 - val_loss: 0.1558 - val_acc: 0.9536
Epoch 10/20
 - 6s - loss: 0.1813 - acc: 0.9459 - val_loss: 0.1151 - val_acc: 0.9647
Epoch 11/20
 - 6s - loss: 0.1745 - acc: 0.9480 - val_loss: 0.1187 - val_acc: 0.9650
Epoch 12/20
 - 6s - loss: 0.1728 - acc: 0.9480 - val_loss: 0.0985 - val_acc: 0.9698
Epoch 13/20
 - 6s - loss: 0.1690 - acc: 0.9509 - val_loss: 0.1381 - val_acc: 0.9583
Epoch 14/20
 - 6s - loss: 0.1681 - acc: 0.9523 - val_loss: 0.1144 - val_acc: 0.9685
Epoch 15/20
 - 6s - loss: 0.1670 - acc: 0.9518 - val_loss: 0.1172 - val_acc: 0.9657
Epoch 16/20
 - 6s - loss: 0.1682 - acc: 0.9522 - val_loss: 0.1127 - val_acc: 0.9698
Epoch 17/20
 - 6s - loss: 0.1701 - acc: 0.9512 - val_loss: 0.1109 - val_acc: 0.9688
Epoch 18/20
 - 6s - loss: 0.1633 - acc: 0.9546 - val_loss: 0.1005 - val_acc: 0.9727
Epoch 19/20
 - 6s - loss: 0.1657 - acc: 0.9533 - val_loss: 0.1589 - val_acc: 0.9565
Epoch 20/20
 - 6s - loss: 0.1644 - acc: 0.9549 - val_loss: 0.1072 - val_acc: 0.9725
Test loss: 0.10731676640909373
Test accuracy: 0.9724
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9281 - acc: 0.6947 - val_loss: 0.6015 - val_acc: 0.8045
Epoch 2/20
 - 9s - loss: 0.4352 - acc: 0.8601 - val_loss: 0.3165 - val_acc: 0.9012
Epoch 3/20
 - 9s - loss: 0.3281 - acc: 0.8960 - val_loss: 0.2158 - val_acc: 0.9302
Epoch 4/20
 - 9s - loss: 0.2717 - acc: 0.9154 - val_loss: 0.2013 - val_acc: 0.9336
Epoch 5/20
 - 9s - loss: 0.2407 - acc: 0.9247 - val_loss: 0.1736 - val_acc: 0.9491
Epoch 6/20
 - 9s - loss: 0.2192 - acc: 0.9321 - val_loss: 0.1732 - val_acc: 0.9424
Epoch 7/20
 - 9s - loss: 0.2065 - acc: 0.9371 - val_loss: 0.1278 - val_acc: 0.9605
Epoch 8/20
 - 9s - loss: 0.1915 - acc: 0.9421 - val_loss: 0.1301 - val_acc: 0.9617
Epoch 9/20
 - 9s - loss: 0.1864 - acc: 0.9436 - val_loss: 0.1091 - val_acc: 0.9648
Epoch 10/20
 - 9s - loss: 0.1796 - acc: 0.9466 - val_loss: 0.1280 - val_acc: 0.9614
Epoch 11/20
 - 9s - loss: 0.1745 - acc: 0.9487 - val_loss: 0.2300 - val_acc: 0.9325
Epoch 12/20
 - 9s - loss: 0.1790 - acc: 0.9473 - val_loss: 0.1602 - val_acc: 0.9516
Epoch 13/20
 - 9s - loss: 0.1713 - acc: 0.9496 - val_loss: 0.1217 - val_acc: 0.9640
Epoch 14/20
 - 9s - loss: 0.1639 - acc: 0.9518 - val_loss: 0.1141 - val_acc: 0.9679
Epoch 15/20
 - 9s - loss: 0.1673 - acc: 0.9519 - val_loss: 0.1375 - val_acc: 0.9596
Epoch 16/20
 - 9s - loss: 0.1651 - acc: 0.9529 - val_loss: 0.1014 - val_acc: 0.9680
Epoch 17/20
 - 9s - loss: 0.1642 - acc: 0.9534 - val_loss: 0.1353 - val_acc: 0.9658
Epoch 18/20
 - 9s - loss: 0.1645 - acc: 0.9533 - val_loss: 0.1209 - val_acc: 0.9697
Epoch 19/20
 - 9s - loss: 0.1639 - acc: 0.9532 - val_loss: 0.1122 - val_acc: 0.9688
Epoch 20/20
 - 9s - loss: 0.1618 - acc: 0.9545 - val_loss: 0.0996 - val_acc: 0.9745
Test loss: 0.09983304170388856
Test accuracy: 0.9744
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9302 - acc: 0.7020 - val_loss: 0.3704 - val_acc: 0.8788
Epoch 2/20
 - 14s - loss: 0.4334 - acc: 0.8622 - val_loss: 0.2822 - val_acc: 0.9074
Epoch 3/20
 - 14s - loss: 0.3234 - acc: 0.8988 - val_loss: 0.4910 - val_acc: 0.8486
Epoch 4/20
 - 14s - loss: 0.2707 - acc: 0.9151 - val_loss: 0.1795 - val_acc: 0.9411
Epoch 5/20
 - 14s - loss: 0.2376 - acc: 0.9264 - val_loss: 0.1513 - val_acc: 0.9517
Epoch 6/20
 - 14s - loss: 0.2144 - acc: 0.9344 - val_loss: 0.1448 - val_acc: 0.9559
Epoch 7/20
 - 14s - loss: 0.2018 - acc: 0.9379 - val_loss: 0.1422 - val_acc: 0.9569
Epoch 8/20
 - 14s - loss: 0.1937 - acc: 0.9415 - val_loss: 0.1418 - val_acc: 0.9538
Epoch 9/20
 - 14s - loss: 0.1838 - acc: 0.9453 - val_loss: 0.1305 - val_acc: 0.9594
Epoch 10/20
 - 14s - loss: 0.1776 - acc: 0.9469 - val_loss: 0.1113 - val_acc: 0.9632
Epoch 11/20
 - 14s - loss: 0.1748 - acc: 0.9481 - val_loss: 0.1261 - val_acc: 0.9586
Epoch 12/20
 - 14s - loss: 0.1685 - acc: 0.9492 - val_loss: 0.1417 - val_acc: 0.9584
Epoch 13/20
 - 14s - loss: 0.1681 - acc: 0.9505 - val_loss: 0.1001 - val_acc: 0.9692
Epoch 14/20
 - 14s - loss: 0.1634 - acc: 0.9513 - val_loss: 0.1907 - val_acc: 0.9412
Epoch 15/20
 - 14s - loss: 0.1631 - acc: 0.9523 - val_loss: 0.0922 - val_acc: 0.9710
Epoch 16/20
 - 14s - loss: 0.1609 - acc: 0.9534 - val_loss: 0.1441 - val_acc: 0.9528
Epoch 17/20
 - 14s - loss: 0.1630 - acc: 0.9538 - val_loss: 0.1345 - val_acc: 0.9637
Epoch 18/20
 - 14s - loss: 0.1571 - acc: 0.9560 - val_loss: 0.1241 - val_acc: 0.9634
Epoch 19/20
 - 14s - loss: 0.1594 - acc: 0.9555 - val_loss: 0.1104 - val_acc: 0.9677
Epoch 20/20
 - 14s - loss: 0.1588 - acc: 0.9556 - val_loss: 0.1911 - val_acc: 0.9452
Test loss: 0.19106436965460888
Test accuracy: 0.9442
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9386 - acc: 0.7011 - val_loss: 0.5480 - val_acc: 0.8097
Epoch 2/20
 - 26s - loss: 0.4311 - acc: 0.8639 - val_loss: 0.4126 - val_acc: 0.8695
Epoch 3/20
 - 26s - loss: 0.3153 - acc: 0.9005 - val_loss: 0.2398 - val_acc: 0.9218
Epoch 4/20
 - 26s - loss: 0.2681 - acc: 0.9155 - val_loss: 0.2299 - val_acc: 0.9287
Epoch 5/20
 - 26s - loss: 0.2344 - acc: 0.9276 - val_loss: 0.1862 - val_acc: 0.9407
Epoch 6/20
 - 26s - loss: 0.2137 - acc: 0.9335 - val_loss: 0.1415 - val_acc: 0.9558
Epoch 7/20
 - 26s - loss: 0.1968 - acc: 0.9404 - val_loss: 0.1257 - val_acc: 0.9606
Epoch 8/20
 - 26s - loss: 0.1863 - acc: 0.9437 - val_loss: 0.1562 - val_acc: 0.9529
Epoch 9/20
 - 26s - loss: 0.1838 - acc: 0.9441 - val_loss: 0.1539 - val_acc: 0.9515
Epoch 10/20
 - 26s - loss: 0.1736 - acc: 0.9469 - val_loss: 0.1676 - val_acc: 0.9505
Epoch 11/20
 - 26s - loss: 0.1692 - acc: 0.9487 - val_loss: 0.1668 - val_acc: 0.9504
Epoch 12/20
 - 26s - loss: 0.1715 - acc: 0.9502 - val_loss: 0.1205 - val_acc: 0.9642
Epoch 13/20
 - 26s - loss: 0.1676 - acc: 0.9504 - val_loss: 0.1377 - val_acc: 0.9613
Epoch 14/20
 - 26s - loss: 0.1642 - acc: 0.9519 - val_loss: 0.1028 - val_acc: 0.9699
Epoch 15/20
 - 26s - loss: 0.1623 - acc: 0.9534 - val_loss: 0.1355 - val_acc: 0.9626
Epoch 16/20
 - 26s - loss: 0.1588 - acc: 0.9544 - val_loss: 0.1226 - val_acc: 0.9656
Epoch 17/20
 - 26s - loss: 0.1567 - acc: 0.9551 - val_loss: 0.1256 - val_acc: 0.9634
Epoch 18/20
 - 26s - loss: 0.1574 - acc: 0.9548 - val_loss: 0.0967 - val_acc: 0.9708
Epoch 19/20
 - 26s - loss: 0.1598 - acc: 0.9549 - val_loss: 0.0945 - val_acc: 0.9722
Epoch 20/20
 - 26s - loss: 0.1571 - acc: 0.9561 - val_loss: 0.1142 - val_acc: 0.9686
Test loss: 0.11430992129103978
Test accuracy: 0.9684
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9601 - acc: 0.6883 - val_loss: 0.6292 - val_acc: 0.7810
Epoch 2/20
 - 3s - loss: 0.4736 - acc: 0.8477 - val_loss: 0.3518 - val_acc: 0.8893
Epoch 3/20
 - 3s - loss: 0.3553 - acc: 0.8872 - val_loss: 0.3522 - val_acc: 0.8875
Epoch 4/20
 - 3s - loss: 0.3013 - acc: 0.9052 - val_loss: 0.1874 - val_acc: 0.9409
Epoch 5/20
 - 3s - loss: 0.2658 - acc: 0.9176 - val_loss: 0.2381 - val_acc: 0.9210
Epoch 6/20
 - 3s - loss: 0.2453 - acc: 0.9228 - val_loss: 0.1955 - val_acc: 0.9327
Epoch 7/20
 - 3s - loss: 0.2334 - acc: 0.9282 - val_loss: 0.1894 - val_acc: 0.9392
Epoch 8/20
 - 3s - loss: 0.2209 - acc: 0.9323 - val_loss: 0.1480 - val_acc: 0.9566
Epoch 9/20
 - 3s - loss: 0.2143 - acc: 0.9353 - val_loss: 0.1721 - val_acc: 0.9488
Epoch 10/20
 - 3s - loss: 0.2102 - acc: 0.9374 - val_loss: 0.1287 - val_acc: 0.9615
Epoch 11/20
 - 3s - loss: 0.2078 - acc: 0.9385 - val_loss: 0.1210 - val_acc: 0.9644
Epoch 12/20
 - 3s - loss: 0.2058 - acc: 0.9390 - val_loss: 0.1925 - val_acc: 0.9402
Epoch 13/20
 - 3s - loss: 0.1996 - acc: 0.9416 - val_loss: 0.1395 - val_acc: 0.9578
Epoch 14/20
 - 3s - loss: 0.2021 - acc: 0.9405 - val_loss: 0.1581 - val_acc: 0.9514
Epoch 15/20
 - 3s - loss: 0.1942 - acc: 0.9422 - val_loss: 0.1371 - val_acc: 0.9581
Epoch 16/20
 - 3s - loss: 0.1982 - acc: 0.9433 - val_loss: 0.1453 - val_acc: 0.9597
Epoch 17/20
 - 3s - loss: 0.1993 - acc: 0.9419 - val_loss: 0.1250 - val_acc: 0.9625
Epoch 18/20
 - 3s - loss: 0.1961 - acc: 0.9441 - val_loss: 0.1222 - val_acc: 0.9658
Epoch 19/20
 - 3s - loss: 0.1948 - acc: 0.9452 - val_loss: 0.1104 - val_acc: 0.9669
Epoch 20/20
 - 3s - loss: 0.1992 - acc: 0.9438 - val_loss: 0.1472 - val_acc: 0.9593
Test loss: 0.13775460153010208
Test accuracy: 0.9617
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9346 - acc: 0.6937 - val_loss: 0.4350 - val_acc: 0.8645
Epoch 2/20
 - 3s - loss: 0.4485 - acc: 0.8563 - val_loss: 0.3270 - val_acc: 0.8929
Epoch 3/20
 - 3s - loss: 0.3357 - acc: 0.8934 - val_loss: 0.3461 - val_acc: 0.8834
Epoch 4/20
 - 3s - loss: 0.2876 - acc: 0.9097 - val_loss: 0.2175 - val_acc: 0.9306
Epoch 5/20
 - 3s - loss: 0.2539 - acc: 0.9212 - val_loss: 0.2527 - val_acc: 0.9229
Epoch 6/20
 - 3s - loss: 0.2303 - acc: 0.9290 - val_loss: 0.1448 - val_acc: 0.9554
Epoch 7/20
 - 3s - loss: 0.2141 - acc: 0.9332 - val_loss: 0.1973 - val_acc: 0.9374
Epoch 8/20
 - 3s - loss: 0.2064 - acc: 0.9374 - val_loss: 0.1593 - val_acc: 0.9502
Epoch 9/20
 - 3s - loss: 0.1986 - acc: 0.9392 - val_loss: 0.1379 - val_acc: 0.9590
Epoch 10/20
 - 3s - loss: 0.1918 - acc: 0.9423 - val_loss: 0.1266 - val_acc: 0.9610
Epoch 11/20
 - 3s - loss: 0.1881 - acc: 0.9437 - val_loss: 0.1284 - val_acc: 0.9640
Epoch 12/20
 - 3s - loss: 0.1817 - acc: 0.9456 - val_loss: 0.1380 - val_acc: 0.9614
Epoch 13/20
 - 3s - loss: 0.1808 - acc: 0.9471 - val_loss: 0.1327 - val_acc: 0.9607
Epoch 14/20
 - 3s - loss: 0.1760 - acc: 0.9475 - val_loss: 0.1224 - val_acc: 0.9640
Epoch 15/20
 - 3s - loss: 0.1806 - acc: 0.9468 - val_loss: 0.1328 - val_acc: 0.9579
Epoch 16/20
 - 3s - loss: 0.1746 - acc: 0.9491 - val_loss: 0.1162 - val_acc: 0.9678
Epoch 17/20
 - 3s - loss: 0.1806 - acc: 0.9487 - val_loss: 0.1225 - val_acc: 0.9658
Epoch 18/20
 - 3s - loss: 0.1790 - acc: 0.9490 - val_loss: 0.1289 - val_acc: 0.9597
Epoch 19/20
 - 3s - loss: 0.1749 - acc: 0.9508 - val_loss: 0.1092 - val_acc: 0.9714
Epoch 20/20
 - 3s - loss: 0.1763 - acc: 0.9503 - val_loss: 0.1188 - val_acc: 0.9679
Test loss: 0.11829053010526114
Test accuracy: 0.968
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9119 - acc: 0.7033 - val_loss: 0.4954 - val_acc: 0.8468
Epoch 2/20
 - 3s - loss: 0.4335 - acc: 0.8610 - val_loss: 0.5336 - val_acc: 0.8276
Epoch 3/20
 - 3s - loss: 0.3286 - acc: 0.8958 - val_loss: 0.3014 - val_acc: 0.8992
Epoch 4/20
 - 3s - loss: 0.2759 - acc: 0.9139 - val_loss: 0.3098 - val_acc: 0.8934
Epoch 5/20
 - 3s - loss: 0.2412 - acc: 0.9238 - val_loss: 0.1408 - val_acc: 0.9557
Epoch 6/20
 - 3s - loss: 0.2167 - acc: 0.9322 - val_loss: 0.1485 - val_acc: 0.9491
Epoch 7/20
 - 3s - loss: 0.2057 - acc: 0.9362 - val_loss: 0.1243 - val_acc: 0.9621
Epoch 8/20
 - 3s - loss: 0.1927 - acc: 0.9411 - val_loss: 0.1897 - val_acc: 0.9431
Epoch 9/20
 - 3s - loss: 0.1861 - acc: 0.9436 - val_loss: 0.1161 - val_acc: 0.9644
Epoch 10/20
 - 3s - loss: 0.1792 - acc: 0.9454 - val_loss: 0.1105 - val_acc: 0.9669
Epoch 11/20
 - 3s - loss: 0.1774 - acc: 0.9470 - val_loss: 0.1598 - val_acc: 0.9523
Epoch 12/20
 - 3s - loss: 0.1717 - acc: 0.9493 - val_loss: 0.1065 - val_acc: 0.9680
Epoch 13/20
 - 3s - loss: 0.1695 - acc: 0.9492 - val_loss: 0.1227 - val_acc: 0.9616
Epoch 14/20
 - 3s - loss: 0.1643 - acc: 0.9509 - val_loss: 0.1177 - val_acc: 0.9670
Epoch 15/20
 - 3s - loss: 0.1657 - acc: 0.9514 - val_loss: 0.1023 - val_acc: 0.9699
Epoch 16/20
 - 3s - loss: 0.1651 - acc: 0.9529 - val_loss: 0.0985 - val_acc: 0.9703
Epoch 17/20
 - 3s - loss: 0.1598 - acc: 0.9528 - val_loss: 0.1189 - val_acc: 0.9695
Epoch 18/20
 - 3s - loss: 0.1639 - acc: 0.9519 - val_loss: 0.1099 - val_acc: 0.9697
Epoch 19/20
 - 3s - loss: 0.1651 - acc: 0.9537 - val_loss: 0.1247 - val_acc: 0.9637
Epoch 20/20
 - 3s - loss: 0.1657 - acc: 0.9524 - val_loss: 0.1207 - val_acc: 0.9679
Test loss: 0.11820729902260355
Test accuracy: 0.9682
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9458 - acc: 0.6935 - val_loss: 0.3766 - val_acc: 0.8794
Epoch 2/20
 - 3s - loss: 0.4331 - acc: 0.8616 - val_loss: 0.4447 - val_acc: 0.8533
Epoch 3/20
 - 3s - loss: 0.3235 - acc: 0.8981 - val_loss: 0.2168 - val_acc: 0.9271
Epoch 4/20
 - 3s - loss: 0.2679 - acc: 0.9163 - val_loss: 0.1756 - val_acc: 0.9458
Epoch 5/20
 - 3s - loss: 0.2374 - acc: 0.9258 - val_loss: 0.2206 - val_acc: 0.9304
Epoch 6/20
 - 3s - loss: 0.2147 - acc: 0.9337 - val_loss: 0.1275 - val_acc: 0.9603
Epoch 7/20
 - 3s - loss: 0.2061 - acc: 0.9377 - val_loss: 0.2671 - val_acc: 0.9162
Epoch 8/20
 - 3s - loss: 0.1934 - acc: 0.9414 - val_loss: 0.1492 - val_acc: 0.9561
Epoch 9/20
 - 3s - loss: 0.1859 - acc: 0.9443 - val_loss: 0.1394 - val_acc: 0.9548
Epoch 10/20
 - 3s - loss: 0.1751 - acc: 0.9474 - val_loss: 0.1310 - val_acc: 0.9616
Epoch 11/20
 - 3s - loss: 0.1766 - acc: 0.9474 - val_loss: 0.1592 - val_acc: 0.9523
Epoch 12/20
 - 3s - loss: 0.1729 - acc: 0.9499 - val_loss: 0.1463 - val_acc: 0.9574
Epoch 13/20
 - 3s - loss: 0.1712 - acc: 0.9490 - val_loss: 0.1155 - val_acc: 0.9667
Epoch 14/20
 - 3s - loss: 0.1685 - acc: 0.9509 - val_loss: 0.1067 - val_acc: 0.9705
Epoch 15/20
 - 3s - loss: 0.1715 - acc: 0.9524 - val_loss: 0.1216 - val_acc: 0.9637
Epoch 16/20
 - 3s - loss: 0.1711 - acc: 0.9517 - val_loss: 0.1027 - val_acc: 0.9716
Epoch 17/20
 - 3s - loss: 0.1660 - acc: 0.9534 - val_loss: 0.1043 - val_acc: 0.9704
Epoch 18/20
 - 3s - loss: 0.1685 - acc: 0.9520 - val_loss: 0.1161 - val_acc: 0.9644
Epoch 19/20
 - 3s - loss: 0.1689 - acc: 0.9530 - val_loss: 0.1275 - val_acc: 0.9637
Epoch 20/20
 - 3s - loss: 0.1693 - acc: 0.9530 - val_loss: 0.1081 - val_acc: 0.9690
Test loss: 0.1110654013693129
Test accuracy: 0.9684
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9382 - acc: 0.7003 - val_loss: 0.4280 - val_acc: 0.8664
Epoch 2/20
 - 4s - loss: 0.4279 - acc: 0.8623 - val_loss: 0.2071 - val_acc: 0.9380
Epoch 3/20
 - 4s - loss: 0.3185 - acc: 0.8986 - val_loss: 0.3318 - val_acc: 0.8872
Epoch 4/20
 - 4s - loss: 0.2682 - acc: 0.9171 - val_loss: 0.1730 - val_acc: 0.9476
Epoch 5/20
 - 4s - loss: 0.2391 - acc: 0.9256 - val_loss: 0.1372 - val_acc: 0.9574
Epoch 6/20
 - 4s - loss: 0.2198 - acc: 0.9312 - val_loss: 0.1372 - val_acc: 0.9579
Epoch 7/20
 - 4s - loss: 0.1969 - acc: 0.9393 - val_loss: 0.1434 - val_acc: 0.9564
Epoch 8/20
 - 4s - loss: 0.1964 - acc: 0.9404 - val_loss: 0.1176 - val_acc: 0.9643
Epoch 9/20
 - 4s - loss: 0.1866 - acc: 0.9434 - val_loss: 0.1484 - val_acc: 0.9558
Epoch 10/20
 - 4s - loss: 0.1753 - acc: 0.9467 - val_loss: 0.1051 - val_acc: 0.9706
Epoch 11/20
 - 4s - loss: 0.1799 - acc: 0.9467 - val_loss: 0.1211 - val_acc: 0.9638
Epoch 12/20
 - 4s - loss: 0.1773 - acc: 0.9492 - val_loss: 0.1529 - val_acc: 0.9525
Epoch 13/20
 - 4s - loss: 0.1720 - acc: 0.9489 - val_loss: 0.1146 - val_acc: 0.9697
Epoch 14/20
 - 4s - loss: 0.1735 - acc: 0.9503 - val_loss: 0.1248 - val_acc: 0.9622
Epoch 15/20
 - 4s - loss: 0.1697 - acc: 0.9521 - val_loss: 0.1054 - val_acc: 0.9667
Epoch 16/20
 - 4s - loss: 0.1682 - acc: 0.9526 - val_loss: 0.1426 - val_acc: 0.9590
Epoch 17/20
 - 4s - loss: 0.1677 - acc: 0.9530 - val_loss: 0.1072 - val_acc: 0.9718
Epoch 18/20
 - 4s - loss: 0.1731 - acc: 0.9524 - val_loss: 0.1257 - val_acc: 0.9640
Epoch 19/20
 - 4s - loss: 0.1719 - acc: 0.9519 - val_loss: 0.1052 - val_acc: 0.9708
Epoch 20/20
 - 4s - loss: 0.1758 - acc: 0.9522 - val_loss: 0.1103 - val_acc: 0.9689
Test loss: 0.10998313427903922
Test accuracy: 0.9693
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9381 - acc: 0.6966 - val_loss: 0.4566 - val_acc: 0.8570
Epoch 2/20
 - 4s - loss: 0.4356 - acc: 0.8634 - val_loss: 0.2023 - val_acc: 0.9393
Epoch 3/20
 - 4s - loss: 0.3277 - acc: 0.8949 - val_loss: 0.2387 - val_acc: 0.9272
Epoch 4/20
 - 4s - loss: 0.2712 - acc: 0.9146 - val_loss: 0.1788 - val_acc: 0.9440
Epoch 5/20
 - 4s - loss: 0.2359 - acc: 0.9260 - val_loss: 0.1817 - val_acc: 0.9449
Epoch 6/20
 - 4s - loss: 0.2189 - acc: 0.9331 - val_loss: 0.2161 - val_acc: 0.9306
Epoch 7/20
 - 4s - loss: 0.2043 - acc: 0.9383 - val_loss: 0.1339 - val_acc: 0.9576
Epoch 8/20
 - 4s - loss: 0.1933 - acc: 0.9413 - val_loss: 0.1773 - val_acc: 0.9466
Epoch 9/20
 - 4s - loss: 0.1840 - acc: 0.9432 - val_loss: 0.1863 - val_acc: 0.9480
Epoch 10/20
 - 4s - loss: 0.1795 - acc: 0.9457 - val_loss: 0.2339 - val_acc: 0.9188
Epoch 11/20
 - 4s - loss: 0.1731 - acc: 0.9487 - val_loss: 0.1116 - val_acc: 0.9636
Epoch 12/20
 - 4s - loss: 0.1690 - acc: 0.9495 - val_loss: 0.1301 - val_acc: 0.9611
Epoch 13/20
 - 4s - loss: 0.1685 - acc: 0.9505 - val_loss: 0.1026 - val_acc: 0.9698
Epoch 14/20
 - 4s - loss: 0.1703 - acc: 0.9499 - val_loss: 0.0948 - val_acc: 0.9720
Epoch 15/20
 - 4s - loss: 0.1648 - acc: 0.9517 - val_loss: 0.1421 - val_acc: 0.9552
Epoch 16/20
 - 4s - loss: 0.1619 - acc: 0.9531 - val_loss: 0.1752 - val_acc: 0.9528
Epoch 17/20
 - 4s - loss: 0.1612 - acc: 0.9547 - val_loss: 0.1091 - val_acc: 0.9672
Epoch 18/20
 - 4s - loss: 0.1589 - acc: 0.9545 - val_loss: 0.0918 - val_acc: 0.9712
Epoch 19/20
 - 4s - loss: 0.1597 - acc: 0.9548 - val_loss: 0.0978 - val_acc: 0.9708
Epoch 20/20
 - 4s - loss: 0.1647 - acc: 0.9536 - val_loss: 0.1168 - val_acc: 0.9707
Test loss: 0.11671388023272447
Test accuracy: 0.9704
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9475 - acc: 0.6958 - val_loss: 0.6328 - val_acc: 0.7834
Epoch 2/20
 - 6s - loss: 0.4338 - acc: 0.8616 - val_loss: 0.3637 - val_acc: 0.8736
Epoch 3/20
 - 6s - loss: 0.3254 - acc: 0.8984 - val_loss: 0.1995 - val_acc: 0.9354
Epoch 4/20
 - 6s - loss: 0.2716 - acc: 0.9154 - val_loss: 0.1554 - val_acc: 0.9549
Epoch 5/20
 - 6s - loss: 0.2347 - acc: 0.9263 - val_loss: 0.2714 - val_acc: 0.9139
Epoch 6/20
 - 6s - loss: 0.2142 - acc: 0.9344 - val_loss: 0.1924 - val_acc: 0.9383
Epoch 7/20
 - 6s - loss: 0.2041 - acc: 0.9371 - val_loss: 0.1561 - val_acc: 0.9528
Epoch 8/20
 - 6s - loss: 0.1892 - acc: 0.9419 - val_loss: 0.1284 - val_acc: 0.9616
Epoch 9/20
 - 6s - loss: 0.1857 - acc: 0.9440 - val_loss: 0.1082 - val_acc: 0.9662
Epoch 10/20
 - 6s - loss: 0.1776 - acc: 0.9469 - val_loss: 0.1297 - val_acc: 0.9607
Epoch 11/20
 - 6s - loss: 0.1703 - acc: 0.9489 - val_loss: 0.1008 - val_acc: 0.9701
Epoch 12/20
 - 6s - loss: 0.1699 - acc: 0.9497 - val_loss: 0.1213 - val_acc: 0.9619
Epoch 13/20
 - 6s - loss: 0.1616 - acc: 0.9508 - val_loss: 0.1456 - val_acc: 0.9611
Epoch 14/20
 - 6s - loss: 0.1605 - acc: 0.9524 - val_loss: 0.1920 - val_acc: 0.9465
Epoch 15/20
 - 6s - loss: 0.1650 - acc: 0.9515 - val_loss: 0.1018 - val_acc: 0.9706
Epoch 16/20
 - 6s - loss: 0.1633 - acc: 0.9529 - val_loss: 0.1010 - val_acc: 0.9727
Epoch 17/20
 - 6s - loss: 0.1621 - acc: 0.9533 - val_loss: 0.1219 - val_acc: 0.9639
Epoch 18/20
 - 6s - loss: 0.1647 - acc: 0.9539 - val_loss: 0.1144 - val_acc: 0.9674
Epoch 19/20
 - 6s - loss: 0.1617 - acc: 0.9545 - val_loss: 0.1008 - val_acc: 0.9725
Epoch 20/20
 - 6s - loss: 0.1616 - acc: 0.9552 - val_loss: 0.1193 - val_acc: 0.9652
Test loss: 0.11933614941157866
Test accuracy: 0.9646
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9426 - acc: 0.6984 - val_loss: 0.4377 - val_acc: 0.8527
Epoch 2/20
 - 9s - loss: 0.4373 - acc: 0.8604 - val_loss: 0.2821 - val_acc: 0.9128
Epoch 3/20
 - 9s - loss: 0.3230 - acc: 0.8999 - val_loss: 0.1678 - val_acc: 0.9488
Epoch 4/20
 - 9s - loss: 0.2671 - acc: 0.9162 - val_loss: 0.2075 - val_acc: 0.9305
Epoch 5/20
 - 9s - loss: 0.2361 - acc: 0.9262 - val_loss: 0.1427 - val_acc: 0.9547
Epoch 6/20
 - 9s - loss: 0.2192 - acc: 0.9330 - val_loss: 0.2063 - val_acc: 0.9366
Epoch 7/20
 - 9s - loss: 0.2038 - acc: 0.9373 - val_loss: 0.1552 - val_acc: 0.9519
Epoch 8/20
 - 9s - loss: 0.1944 - acc: 0.9405 - val_loss: 0.1210 - val_acc: 0.9620
Epoch 9/20
 - 9s - loss: 0.1857 - acc: 0.9431 - val_loss: 0.1453 - val_acc: 0.9528
Epoch 10/20
 - 9s - loss: 0.1782 - acc: 0.9470 - val_loss: 0.1278 - val_acc: 0.9649
Epoch 11/20
 - 9s - loss: 0.1768 - acc: 0.9478 - val_loss: 0.1058 - val_acc: 0.9667
Epoch 12/20
 - 9s - loss: 0.1731 - acc: 0.9486 - val_loss: 0.1124 - val_acc: 0.9657
Epoch 13/20
 - 9s - loss: 0.1701 - acc: 0.9503 - val_loss: 0.1088 - val_acc: 0.9681
Epoch 14/20
 - 9s - loss: 0.1695 - acc: 0.9511 - val_loss: 0.1089 - val_acc: 0.9702
Epoch 15/20
 - 9s - loss: 0.1637 - acc: 0.9528 - val_loss: 0.2715 - val_acc: 0.9138
Epoch 16/20
 - 9s - loss: 0.1653 - acc: 0.9531 - val_loss: 0.1546 - val_acc: 0.9527
Epoch 17/20
 - 9s - loss: 0.1668 - acc: 0.9522 - val_loss: 0.1316 - val_acc: 0.9635
Epoch 18/20
 - 9s - loss: 0.1670 - acc: 0.9539 - val_loss: 0.1671 - val_acc: 0.9530
Epoch 19/20
 - 9s - loss: 0.1641 - acc: 0.9550 - val_loss: 0.1173 - val_acc: 0.9690
Epoch 20/20
 - 9s - loss: 0.1633 - acc: 0.9544 - val_loss: 0.1660 - val_acc: 0.9562
Test loss: 0.1664157210984733
Test accuracy: 0.9561
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9454 - acc: 0.6942 - val_loss: 0.5045 - val_acc: 0.8197
Epoch 2/20
 - 14s - loss: 0.4300 - acc: 0.8623 - val_loss: 0.2552 - val_acc: 0.9240
Epoch 3/20
 - 14s - loss: 0.3172 - acc: 0.8997 - val_loss: 0.2076 - val_acc: 0.9365
Epoch 4/20
 - 14s - loss: 0.2616 - acc: 0.9189 - val_loss: 0.1510 - val_acc: 0.9523
Epoch 5/20
 - 14s - loss: 0.2349 - acc: 0.9278 - val_loss: 0.1443 - val_acc: 0.9547
Epoch 6/20
 - 14s - loss: 0.2150 - acc: 0.9341 - val_loss: 0.1324 - val_acc: 0.9587
Epoch 7/20
 - 14s - loss: 0.2008 - acc: 0.9383 - val_loss: 0.3071 - val_acc: 0.9039
Epoch 8/20
 - 14s - loss: 0.1860 - acc: 0.9422 - val_loss: 0.1233 - val_acc: 0.9623
Epoch 9/20
 - 14s - loss: 0.1817 - acc: 0.9450 - val_loss: 0.1258 - val_acc: 0.9619
Epoch 10/20
 - 14s - loss: 0.1748 - acc: 0.9479 - val_loss: 0.0996 - val_acc: 0.9695
Epoch 11/20
 - 14s - loss: 0.1726 - acc: 0.9470 - val_loss: 0.1163 - val_acc: 0.9666
Epoch 12/20
 - 14s - loss: 0.1675 - acc: 0.9507 - val_loss: 0.1122 - val_acc: 0.9644
Epoch 13/20
 - 14s - loss: 0.1640 - acc: 0.9527 - val_loss: 0.1167 - val_acc: 0.9661
Epoch 14/20
 - 14s - loss: 0.1631 - acc: 0.9525 - val_loss: 0.1447 - val_acc: 0.9588
Epoch 15/20
 - 14s - loss: 0.1636 - acc: 0.9530 - val_loss: 0.1131 - val_acc: 0.9730
Epoch 16/20
 - 14s - loss: 0.1651 - acc: 0.9535 - val_loss: 0.1444 - val_acc: 0.9581
Epoch 17/20
 - 14s - loss: 0.1636 - acc: 0.9525 - val_loss: 0.0953 - val_acc: 0.9728
Epoch 18/20
 - 14s - loss: 0.1576 - acc: 0.9549 - val_loss: 0.1014 - val_acc: 0.9714
Epoch 19/20
 - 14s - loss: 0.1620 - acc: 0.9546 - val_loss: 0.0990 - val_acc: 0.9736
Epoch 20/20
 - 14s - loss: 0.1649 - acc: 0.9544 - val_loss: 0.1074 - val_acc: 0.9697
Test loss: 0.10755289789556992
Test accuracy: 0.9699
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9373 - acc: 0.6998 - val_loss: 0.4100 - val_acc: 0.8630
Epoch 2/20
 - 26s - loss: 0.4283 - acc: 0.8623 - val_loss: 0.2249 - val_acc: 0.9324
Epoch 3/20
 - 26s - loss: 0.3146 - acc: 0.9004 - val_loss: 0.2260 - val_acc: 0.9265
Epoch 4/20
 - 26s - loss: 0.2611 - acc: 0.9184 - val_loss: 0.2408 - val_acc: 0.9189
Epoch 5/20
 - 26s - loss: 0.2316 - acc: 0.9276 - val_loss: 0.1442 - val_acc: 0.9559
Epoch 6/20
 - 26s - loss: 0.2119 - acc: 0.9338 - val_loss: 0.2141 - val_acc: 0.9321
Epoch 7/20
 - 26s - loss: 0.1993 - acc: 0.9391 - val_loss: 0.1817 - val_acc: 0.9436
Epoch 8/20
 - 26s - loss: 0.1906 - acc: 0.9427 - val_loss: 0.1541 - val_acc: 0.9540
Epoch 9/20
 - 26s - loss: 0.1805 - acc: 0.9444 - val_loss: 0.1243 - val_acc: 0.9603
Epoch 10/20
 - 26s - loss: 0.1781 - acc: 0.9462 - val_loss: 0.1220 - val_acc: 0.9628
Epoch 11/20
 - 26s - loss: 0.1737 - acc: 0.9491 - val_loss: 0.1171 - val_acc: 0.9639
Epoch 12/20
 - 26s - loss: 0.1684 - acc: 0.9503 - val_loss: 0.1099 - val_acc: 0.9657
Epoch 13/20
 - 26s - loss: 0.1663 - acc: 0.9515 - val_loss: 0.1184 - val_acc: 0.9644
Epoch 14/20
 - 26s - loss: 0.1633 - acc: 0.9518 - val_loss: 0.1094 - val_acc: 0.9672
Epoch 15/20
 - 26s - loss: 0.1638 - acc: 0.9528 - val_loss: 0.1206 - val_acc: 0.9667
Epoch 16/20
 - 26s - loss: 0.1657 - acc: 0.9520 - val_loss: 0.1128 - val_acc: 0.9680
Epoch 17/20
 - 26s - loss: 0.1649 - acc: 0.9543 - val_loss: 0.0977 - val_acc: 0.9715
Epoch 18/20
 - 26s - loss: 0.1622 - acc: 0.9543 - val_loss: 0.0944 - val_acc: 0.9734
Epoch 19/20
 - 26s - loss: 0.1699 - acc: 0.9529 - val_loss: 0.0956 - val_acc: 0.9718
Epoch 20/20
 - 26s - loss: 0.1664 - acc: 0.9534 - val_loss: 0.1197 - val_acc: 0.9667
Test loss: 0.11943203423656523
Test accuracy: 0.9664
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9626 - acc: 0.6888 - val_loss: 0.4025 - val_acc: 0.8785
Epoch 2/20
 - 3s - loss: 0.4580 - acc: 0.8522 - val_loss: 0.2980 - val_acc: 0.9028
Epoch 3/20
 - 3s - loss: 0.3453 - acc: 0.8896 - val_loss: 0.2416 - val_acc: 0.9235
Epoch 4/20
 - 3s - loss: 0.2923 - acc: 0.9089 - val_loss: 0.1682 - val_acc: 0.9479
Epoch 5/20
 - 3s - loss: 0.2589 - acc: 0.9188 - val_loss: 0.1575 - val_acc: 0.9467
Epoch 6/20
 - 3s - loss: 0.2397 - acc: 0.9259 - val_loss: 0.1633 - val_acc: 0.9493
Epoch 7/20
 - 3s - loss: 0.2294 - acc: 0.9303 - val_loss: 0.1543 - val_acc: 0.9517
Epoch 8/20
 - 3s - loss: 0.2208 - acc: 0.9324 - val_loss: 0.1896 - val_acc: 0.9435
Epoch 9/20
 - 3s - loss: 0.2150 - acc: 0.9362 - val_loss: 0.1125 - val_acc: 0.9632
Epoch 10/20
 - 3s - loss: 0.2100 - acc: 0.9374 - val_loss: 0.1927 - val_acc: 0.9350
Epoch 11/20
 - 3s - loss: 0.2054 - acc: 0.9391 - val_loss: 0.1347 - val_acc: 0.9578
Epoch 12/20
 - 3s - loss: 0.2007 - acc: 0.9415 - val_loss: 0.1554 - val_acc: 0.9543
Epoch 13/20
 - 3s - loss: 0.2048 - acc: 0.9413 - val_loss: 0.1310 - val_acc: 0.9617
Epoch 14/20
 - 3s - loss: 0.1984 - acc: 0.9430 - val_loss: 0.1403 - val_acc: 0.9555
Epoch 15/20
 - 3s - loss: 0.1966 - acc: 0.9427 - val_loss: 0.1804 - val_acc: 0.9451
Epoch 16/20
 - 3s - loss: 0.2001 - acc: 0.9445 - val_loss: 0.1290 - val_acc: 0.9615
Epoch 17/20
 - 3s - loss: 0.2010 - acc: 0.9433 - val_loss: 0.1388 - val_acc: 0.9570
Epoch 18/20
 - 3s - loss: 0.2020 - acc: 0.9434 - val_loss: 0.1767 - val_acc: 0.9536
Epoch 19/20
 - 3s - loss: 0.2045 - acc: 0.9431 - val_loss: 0.1149 - val_acc: 0.9678
Epoch 20/20
 - 3s - loss: 0.2006 - acc: 0.9448 - val_loss: 0.1304 - val_acc: 0.9592
Test loss: 0.13097405055253766
Test accuracy: 0.9601
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9349 - acc: 0.6965 - val_loss: 0.3416 - val_acc: 0.8904
Epoch 2/20
 - 3s - loss: 0.4431 - acc: 0.8592 - val_loss: 0.2940 - val_acc: 0.9032
Epoch 3/20
 - 3s - loss: 0.3340 - acc: 0.8937 - val_loss: 0.3294 - val_acc: 0.8959
Epoch 4/20
 - 3s - loss: 0.2770 - acc: 0.9136 - val_loss: 0.1534 - val_acc: 0.9521
Epoch 5/20
 - 3s - loss: 0.2484 - acc: 0.9212 - val_loss: 0.1533 - val_acc: 0.9514
Epoch 6/20
 - 3s - loss: 0.2271 - acc: 0.9301 - val_loss: 0.1827 - val_acc: 0.9426
Epoch 7/20
 - 3s - loss: 0.2118 - acc: 0.9348 - val_loss: 0.1393 - val_acc: 0.9570
Epoch 8/20
 - 3s - loss: 0.2026 - acc: 0.9372 - val_loss: 0.2239 - val_acc: 0.9330
Epoch 9/20
 - 3s - loss: 0.1961 - acc: 0.9406 - val_loss: 0.1464 - val_acc: 0.9533
Epoch 10/20
 - 3s - loss: 0.1893 - acc: 0.9418 - val_loss: 0.1366 - val_acc: 0.9584
Epoch 11/20
 - 3s - loss: 0.1849 - acc: 0.9440 - val_loss: 0.1566 - val_acc: 0.9498
Epoch 12/20
 - 3s - loss: 0.1806 - acc: 0.9465 - val_loss: 0.1280 - val_acc: 0.9606
Epoch 13/20
 - 3s - loss: 0.1794 - acc: 0.9480 - val_loss: 0.1186 - val_acc: 0.9636
Epoch 14/20
 - 3s - loss: 0.1737 - acc: 0.9481 - val_loss: 0.1470 - val_acc: 0.9530
Epoch 15/20
 - 3s - loss: 0.1782 - acc: 0.9498 - val_loss: 0.1034 - val_acc: 0.9705
Epoch 16/20
 - 3s - loss: 0.1794 - acc: 0.9487 - val_loss: 0.1144 - val_acc: 0.9673
Epoch 17/20
 - 3s - loss: 0.1776 - acc: 0.9496 - val_loss: 0.1402 - val_acc: 0.9587
Epoch 18/20
 - 3s - loss: 0.1749 - acc: 0.9499 - val_loss: 0.1714 - val_acc: 0.9519
Epoch 19/20
 - 3s - loss: 0.1741 - acc: 0.9503 - val_loss: 0.1113 - val_acc: 0.9679
Epoch 20/20
 - 3s - loss: 0.1755 - acc: 0.9507 - val_loss: 0.1418 - val_acc: 0.9592
Test loss: 0.14303091945054475
Test accuracy: 0.9578
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9168 - acc: 0.7033 - val_loss: 0.6189 - val_acc: 0.8032
Epoch 2/20
 - 3s - loss: 0.4378 - acc: 0.8603 - val_loss: 0.2366 - val_acc: 0.9237
Epoch 3/20
 - 3s - loss: 0.3265 - acc: 0.8967 - val_loss: 0.2055 - val_acc: 0.9353
Epoch 4/20
 - 3s - loss: 0.2699 - acc: 0.9151 - val_loss: 0.1831 - val_acc: 0.9433
Epoch 5/20
 - 3s - loss: 0.2418 - acc: 0.9246 - val_loss: 0.1802 - val_acc: 0.9418
Epoch 6/20
 - 3s - loss: 0.2188 - acc: 0.9311 - val_loss: 0.1741 - val_acc: 0.9442
Epoch 7/20
 - 3s - loss: 0.2053 - acc: 0.9367 - val_loss: 0.2668 - val_acc: 0.9175
Epoch 8/20
 - 3s - loss: 0.1989 - acc: 0.9390 - val_loss: 0.1538 - val_acc: 0.9526
Epoch 9/20
 - 3s - loss: 0.1904 - acc: 0.9436 - val_loss: 0.1391 - val_acc: 0.9577
Epoch 10/20
 - 3s - loss: 0.1833 - acc: 0.9447 - val_loss: 0.1412 - val_acc: 0.9579
Epoch 11/20
 - 3s - loss: 0.1825 - acc: 0.9457 - val_loss: 0.1388 - val_acc: 0.9588
Epoch 12/20
 - 3s - loss: 0.1751 - acc: 0.9485 - val_loss: 0.1230 - val_acc: 0.9639
Epoch 13/20
 - 3s - loss: 0.1729 - acc: 0.9490 - val_loss: 0.1030 - val_acc: 0.9714
Epoch 14/20
 - 3s - loss: 0.1762 - acc: 0.9500 - val_loss: 0.1087 - val_acc: 0.9670
Epoch 15/20
 - 3s - loss: 0.1714 - acc: 0.9512 - val_loss: 0.1042 - val_acc: 0.9704
Epoch 16/20
 - 3s - loss: 0.1729 - acc: 0.9503 - val_loss: 0.1337 - val_acc: 0.9636
Epoch 17/20
 - 3s - loss: 0.1719 - acc: 0.9514 - val_loss: 0.1731 - val_acc: 0.9528
Epoch 18/20
 - 3s - loss: 0.1687 - acc: 0.9520 - val_loss: 0.1050 - val_acc: 0.9687
Epoch 19/20
 - 3s - loss: 0.1706 - acc: 0.9526 - val_loss: 0.1096 - val_acc: 0.9664
Epoch 20/20
 - 3s - loss: 0.1707 - acc: 0.9528 - val_loss: 0.1125 - val_acc: 0.9693
Test loss: 0.11485122917760146
Test accuracy: 0.9695
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9430 - acc: 0.6994 - val_loss: 0.4378 - val_acc: 0.8535
Epoch 2/20
 - 3s - loss: 0.4445 - acc: 0.8578 - val_loss: 0.2540 - val_acc: 0.9188
Epoch 3/20
 - 3s - loss: 0.3232 - acc: 0.8985 - val_loss: 0.2214 - val_acc: 0.9298
Epoch 4/20
 - 3s - loss: 0.2706 - acc: 0.9145 - val_loss: 0.2099 - val_acc: 0.9312
Epoch 5/20
 - 3s - loss: 0.2375 - acc: 0.9269 - val_loss: 0.1854 - val_acc: 0.9390
Epoch 6/20
 - 3s - loss: 0.2172 - acc: 0.9332 - val_loss: 0.2008 - val_acc: 0.9386
Epoch 7/20
 - 3s - loss: 0.2019 - acc: 0.9376 - val_loss: 0.1677 - val_acc: 0.9507
Epoch 8/20
 - 3s - loss: 0.1906 - acc: 0.9420 - val_loss: 0.1184 - val_acc: 0.9636
Epoch 9/20
 - 3s - loss: 0.1836 - acc: 0.9446 - val_loss: 0.1185 - val_acc: 0.9631
Epoch 10/20
 - 3s - loss: 0.1760 - acc: 0.9473 - val_loss: 0.1639 - val_acc: 0.9487
Epoch 11/20
 - 3s - loss: 0.1736 - acc: 0.9475 - val_loss: 0.1252 - val_acc: 0.9617
Epoch 12/20
 - 3s - loss: 0.1677 - acc: 0.9501 - val_loss: 0.1219 - val_acc: 0.9627
Epoch 13/20
 - 3s - loss: 0.1664 - acc: 0.9514 - val_loss: 0.1570 - val_acc: 0.9574
Epoch 14/20
 - 3s - loss: 0.1701 - acc: 0.9515 - val_loss: 0.1523 - val_acc: 0.9623
Epoch 15/20
 - 3s - loss: 0.1677 - acc: 0.9516 - val_loss: 0.1876 - val_acc: 0.9542
Epoch 16/20
 - 3s - loss: 0.1698 - acc: 0.9516 - val_loss: 0.0994 - val_acc: 0.9702
Epoch 17/20
 - 3s - loss: 0.1646 - acc: 0.9530 - val_loss: 0.1024 - val_acc: 0.9714
Epoch 18/20
 - 3s - loss: 0.1668 - acc: 0.9523 - val_loss: 0.1143 - val_acc: 0.9660
Epoch 19/20
 - 3s - loss: 0.1655 - acc: 0.9533 - val_loss: 0.1453 - val_acc: 0.9625
Epoch 20/20
 - 3s - loss: 0.1647 - acc: 0.9546 - val_loss: 0.0960 - val_acc: 0.9727
Test loss: 0.09602927675651299
Test accuracy: 0.9732
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9373 - acc: 0.6972 - val_loss: 0.4397 - val_acc: 0.8576
Epoch 2/20
 - 4s - loss: 0.4318 - acc: 0.8634 - val_loss: 0.2405 - val_acc: 0.9220
Epoch 3/20
 - 4s - loss: 0.3244 - acc: 0.8983 - val_loss: 0.2134 - val_acc: 0.9316
Epoch 4/20
 - 4s - loss: 0.2698 - acc: 0.9161 - val_loss: 0.2257 - val_acc: 0.9247
Epoch 5/20
 - 4s - loss: 0.2359 - acc: 0.9273 - val_loss: 0.1588 - val_acc: 0.9491
Epoch 6/20
 - 4s - loss: 0.2168 - acc: 0.9342 - val_loss: 0.1650 - val_acc: 0.9458
Epoch 7/20
 - 4s - loss: 0.1979 - acc: 0.9385 - val_loss: 0.1308 - val_acc: 0.9618
Epoch 8/20
 - 4s - loss: 0.1920 - acc: 0.9420 - val_loss: 0.1277 - val_acc: 0.9614
Epoch 9/20
 - 4s - loss: 0.1832 - acc: 0.9455 - val_loss: 0.1362 - val_acc: 0.9583
Epoch 10/20
 - 4s - loss: 0.1782 - acc: 0.9458 - val_loss: 0.1247 - val_acc: 0.9621
Epoch 11/20
 - 4s - loss: 0.1773 - acc: 0.9476 - val_loss: 0.1052 - val_acc: 0.9683
Epoch 12/20
 - 4s - loss: 0.1713 - acc: 0.9488 - val_loss: 0.1605 - val_acc: 0.9553
Epoch 13/20
 - 4s - loss: 0.1672 - acc: 0.9502 - val_loss: 0.1293 - val_acc: 0.9590
Epoch 14/20
 - 4s - loss: 0.1681 - acc: 0.9516 - val_loss: 0.1025 - val_acc: 0.9715
Epoch 15/20
 - 4s - loss: 0.1623 - acc: 0.9524 - val_loss: 0.1214 - val_acc: 0.9628
Epoch 16/20
 - 4s - loss: 0.1650 - acc: 0.9527 - val_loss: 0.1252 - val_acc: 0.9618
Epoch 17/20
 - 4s - loss: 0.1654 - acc: 0.9528 - val_loss: 0.1224 - val_acc: 0.9648
Epoch 18/20
 - 4s - loss: 0.1658 - acc: 0.9532 - val_loss: 0.1091 - val_acc: 0.9674
Epoch 19/20
 - 4s - loss: 0.1667 - acc: 0.9528 - val_loss: 0.2206 - val_acc: 0.9395
Epoch 20/20
 - 4s - loss: 0.1687 - acc: 0.9527 - val_loss: 0.1005 - val_acc: 0.9720
Test loss: 0.09985353596222121
Test accuracy: 0.9711
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9254 - acc: 0.7004 - val_loss: 0.5603 - val_acc: 0.8243
Epoch 2/20
 - 4s - loss: 0.4253 - acc: 0.8648 - val_loss: 0.3640 - val_acc: 0.8749
Epoch 3/20
 - 4s - loss: 0.3187 - acc: 0.9004 - val_loss: 0.2050 - val_acc: 0.9352
Epoch 4/20
 - 4s - loss: 0.2649 - acc: 0.9171 - val_loss: 0.2461 - val_acc: 0.9202
Epoch 5/20
 - 4s - loss: 0.2374 - acc: 0.9275 - val_loss: 0.1764 - val_acc: 0.9416
Epoch 6/20
 - 4s - loss: 0.2140 - acc: 0.9331 - val_loss: 0.1636 - val_acc: 0.9498
Epoch 7/20
 - 4s - loss: 0.2024 - acc: 0.9387 - val_loss: 0.1721 - val_acc: 0.9428
Epoch 8/20
 - 4s - loss: 0.1892 - acc: 0.9424 - val_loss: 0.1855 - val_acc: 0.9416
Epoch 9/20
 - 4s - loss: 0.1823 - acc: 0.9456 - val_loss: 0.1427 - val_acc: 0.9599
Epoch 10/20
 - 4s - loss: 0.1791 - acc: 0.9464 - val_loss: 0.1163 - val_acc: 0.9660
Epoch 11/20
 - 4s - loss: 0.1758 - acc: 0.9476 - val_loss: 0.2095 - val_acc: 0.9472
Epoch 12/20
 - 4s - loss: 0.1730 - acc: 0.9492 - val_loss: 0.1279 - val_acc: 0.9638
Epoch 13/20
 - 4s - loss: 0.1676 - acc: 0.9511 - val_loss: 0.1520 - val_acc: 0.9569
Epoch 14/20
 - 4s - loss: 0.1702 - acc: 0.9510 - val_loss: 0.1995 - val_acc: 0.9503
Epoch 15/20
 - 4s - loss: 0.1660 - acc: 0.9532 - val_loss: 0.1409 - val_acc: 0.9598
Epoch 16/20
 - 4s - loss: 0.1652 - acc: 0.9530 - val_loss: 0.1093 - val_acc: 0.9678
Epoch 17/20
 - 4s - loss: 0.1708 - acc: 0.9516 - val_loss: 0.1079 - val_acc: 0.9706
Epoch 18/20
 - 4s - loss: 0.1641 - acc: 0.9545 - val_loss: 0.1034 - val_acc: 0.9696
Epoch 19/20
 - 4s - loss: 0.1700 - acc: 0.9529 - val_loss: 0.1113 - val_acc: 0.9687
Epoch 20/20
 - 4s - loss: 0.1692 - acc: 0.9541 - val_loss: 0.1236 - val_acc: 0.9653
Test loss: 0.12257532925480046
Test accuracy: 0.9657
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9178 - acc: 0.7020 - val_loss: 0.5401 - val_acc: 0.8111
Epoch 2/20
 - 6s - loss: 0.4268 - acc: 0.8625 - val_loss: 0.3702 - val_acc: 0.8738
Epoch 3/20
 - 6s - loss: 0.3162 - acc: 0.9002 - val_loss: 0.3673 - val_acc: 0.8831
Epoch 4/20
 - 6s - loss: 0.2654 - acc: 0.9173 - val_loss: 0.1750 - val_acc: 0.9436
Epoch 5/20
 - 6s - loss: 0.2346 - acc: 0.9268 - val_loss: 0.1527 - val_acc: 0.9524
Epoch 6/20
 - 6s - loss: 0.2128 - acc: 0.9341 - val_loss: 0.2246 - val_acc: 0.9324
Epoch 7/20
 - 6s - loss: 0.1962 - acc: 0.9401 - val_loss: 0.1192 - val_acc: 0.9634
Epoch 8/20
 - 6s - loss: 0.1872 - acc: 0.9428 - val_loss: 0.1082 - val_acc: 0.9663
Epoch 9/20
 - 6s - loss: 0.1799 - acc: 0.9461 - val_loss: 0.1280 - val_acc: 0.9617
Epoch 10/20
 - 6s - loss: 0.1736 - acc: 0.9477 - val_loss: 0.1087 - val_acc: 0.9662
Epoch 11/20
 - 6s - loss: 0.1699 - acc: 0.9487 - val_loss: 0.1515 - val_acc: 0.9543
Epoch 12/20
 - 6s - loss: 0.1688 - acc: 0.9503 - val_loss: 0.2017 - val_acc: 0.9485
Epoch 13/20
 - 6s - loss: 0.1668 - acc: 0.9513 - val_loss: 0.0961 - val_acc: 0.9684
Epoch 14/20
 - 6s - loss: 0.1627 - acc: 0.9527 - val_loss: 0.1213 - val_acc: 0.9634
Epoch 15/20
 - 6s - loss: 0.1631 - acc: 0.9520 - val_loss: 0.1220 - val_acc: 0.9656
Epoch 16/20
 - 6s - loss: 0.1617 - acc: 0.9537 - val_loss: 0.1095 - val_acc: 0.9688
Epoch 17/20
 - 6s - loss: 0.1624 - acc: 0.9542 - val_loss: 0.1406 - val_acc: 0.9587
Epoch 18/20
 - 6s - loss: 0.1604 - acc: 0.9555 - val_loss: 0.0919 - val_acc: 0.9742
Epoch 19/20
 - 6s - loss: 0.1621 - acc: 0.9548 - val_loss: 0.1252 - val_acc: 0.9634
Epoch 20/20
 - 6s - loss: 0.1660 - acc: 0.9544 - val_loss: 0.1171 - val_acc: 0.9663
Test loss: 0.11666911317654304
Test accuracy: 0.9662
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9119 - acc: 0.7034 - val_loss: 0.3886 - val_acc: 0.8722
Epoch 2/20
 - 9s - loss: 0.4268 - acc: 0.8638 - val_loss: 0.3059 - val_acc: 0.8991
Epoch 3/20
 - 9s - loss: 0.3230 - acc: 0.8968 - val_loss: 0.1788 - val_acc: 0.9445
Epoch 4/20
 - 9s - loss: 0.2722 - acc: 0.9158 - val_loss: 0.2142 - val_acc: 0.9330
Epoch 5/20
 - 9s - loss: 0.2374 - acc: 0.9264 - val_loss: 0.1512 - val_acc: 0.9524
Epoch 6/20
 - 9s - loss: 0.2180 - acc: 0.9331 - val_loss: 0.2003 - val_acc: 0.9379
Epoch 7/20
 - 9s - loss: 0.2057 - acc: 0.9376 - val_loss: 0.1322 - val_acc: 0.9580
Epoch 8/20
 - 9s - loss: 0.1933 - acc: 0.9412 - val_loss: 0.1309 - val_acc: 0.9589
Epoch 9/20
 - 9s - loss: 0.1825 - acc: 0.9438 - val_loss: 0.1460 - val_acc: 0.9587
Epoch 10/20
 - 9s - loss: 0.1783 - acc: 0.9470 - val_loss: 0.1539 - val_acc: 0.9564
Epoch 11/20
 - 9s - loss: 0.1736 - acc: 0.9487 - val_loss: 0.1114 - val_acc: 0.9652
Epoch 12/20
 - 9s - loss: 0.1678 - acc: 0.9505 - val_loss: 0.1114 - val_acc: 0.9683
Epoch 13/20
 - 9s - loss: 0.1703 - acc: 0.9503 - val_loss: 0.1163 - val_acc: 0.9655
Epoch 14/20
 - 9s - loss: 0.1653 - acc: 0.9521 - val_loss: 0.1556 - val_acc: 0.9582
Epoch 15/20
 - 9s - loss: 0.1651 - acc: 0.9527 - val_loss: 0.1049 - val_acc: 0.9675
Epoch 16/20
 - 9s - loss: 0.1634 - acc: 0.9519 - val_loss: 0.1301 - val_acc: 0.9621
Epoch 17/20
 - 9s - loss: 0.1636 - acc: 0.9542 - val_loss: 0.1235 - val_acc: 0.9625
Epoch 18/20
 - 9s - loss: 0.1693 - acc: 0.9524 - val_loss: 0.1540 - val_acc: 0.9613
Epoch 19/20
 - 9s - loss: 0.1620 - acc: 0.9541 - val_loss: 0.1184 - val_acc: 0.9711
Epoch 20/20
 - 9s - loss: 0.1638 - acc: 0.9540 - val_loss: 0.1792 - val_acc: 0.9520
Test loss: 0.18005524989661206
Test accuracy: 0.9518
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9362 - acc: 0.7007 - val_loss: 0.6635 - val_acc: 0.7732
Epoch 2/20
 - 14s - loss: 0.4261 - acc: 0.8656 - val_loss: 0.2312 - val_acc: 0.9251
Epoch 3/20
 - 14s - loss: 0.3211 - acc: 0.8996 - val_loss: 0.1979 - val_acc: 0.9389
Epoch 4/20
 - 14s - loss: 0.2658 - acc: 0.9158 - val_loss: 0.1778 - val_acc: 0.9429
Epoch 5/20
 - 14s - loss: 0.2359 - acc: 0.9268 - val_loss: 0.1424 - val_acc: 0.9554
Epoch 6/20
 - 14s - loss: 0.2151 - acc: 0.9339 - val_loss: 0.1736 - val_acc: 0.9423
Epoch 7/20
 - 14s - loss: 0.1994 - acc: 0.9401 - val_loss: 0.1224 - val_acc: 0.9606
Epoch 8/20
 - 14s - loss: 0.1929 - acc: 0.9418 - val_loss: 0.1162 - val_acc: 0.9638
Epoch 9/20
 - 14s - loss: 0.1843 - acc: 0.9451 - val_loss: 0.1414 - val_acc: 0.9582
Epoch 10/20
 - 14s - loss: 0.1752 - acc: 0.9467 - val_loss: 0.1590 - val_acc: 0.9524
Epoch 11/20
 - 14s - loss: 0.1698 - acc: 0.9492 - val_loss: 0.1317 - val_acc: 0.9588
Epoch 12/20
 - 14s - loss: 0.1644 - acc: 0.9514 - val_loss: 0.1026 - val_acc: 0.9685
Epoch 13/20
 - 14s - loss: 0.1629 - acc: 0.9521 - val_loss: 0.0980 - val_acc: 0.9699
Epoch 14/20
 - 14s - loss: 0.1633 - acc: 0.9520 - val_loss: 0.1171 - val_acc: 0.9661
Epoch 15/20
 - 14s - loss: 0.1605 - acc: 0.9522 - val_loss: 0.1168 - val_acc: 0.9660
Epoch 16/20
 - 14s - loss: 0.1668 - acc: 0.9528 - val_loss: 0.1045 - val_acc: 0.9705
Epoch 17/20
 - 14s - loss: 0.1610 - acc: 0.9543 - val_loss: 0.1071 - val_acc: 0.9702
Epoch 18/20
 - 14s - loss: 0.1610 - acc: 0.9544 - val_loss: 0.1627 - val_acc: 0.9553
Epoch 19/20
 - 14s - loss: 0.1634 - acc: 0.9542 - val_loss: 0.1329 - val_acc: 0.9669
Epoch 20/20
 - 14s - loss: 0.1640 - acc: 0.9540 - val_loss: 0.1242 - val_acc: 0.9622
Test loss: 0.12429151486419142
Test accuracy: 0.9622
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9346 - acc: 0.6987 - val_loss: 0.4525 - val_acc: 0.8451
Epoch 2/20
 - 26s - loss: 0.4403 - acc: 0.8577 - val_loss: 0.4140 - val_acc: 0.8678
Epoch 3/20
 - 26s - loss: 0.3221 - acc: 0.8979 - val_loss: 0.1807 - val_acc: 0.9436
Epoch 4/20
 - 26s - loss: 0.2674 - acc: 0.9160 - val_loss: 0.2068 - val_acc: 0.9373
Epoch 5/20
 - 26s - loss: 0.2360 - acc: 0.9267 - val_loss: 0.1740 - val_acc: 0.9449
Epoch 6/20
 - 26s - loss: 0.2186 - acc: 0.9328 - val_loss: 0.1422 - val_acc: 0.9584
Epoch 7/20
 - 26s - loss: 0.2001 - acc: 0.9375 - val_loss: 0.2212 - val_acc: 0.9349
Epoch 8/20
 - 26s - loss: 0.1904 - acc: 0.9422 - val_loss: 0.1462 - val_acc: 0.9561
Epoch 9/20
 - 26s - loss: 0.1828 - acc: 0.9453 - val_loss: 0.1427 - val_acc: 0.9568
Epoch 10/20
 - 26s - loss: 0.1771 - acc: 0.9468 - val_loss: 0.1299 - val_acc: 0.9605
Epoch 11/20
 - 26s - loss: 0.1745 - acc: 0.9478 - val_loss: 0.1337 - val_acc: 0.9591
Epoch 12/20
 - 26s - loss: 0.1695 - acc: 0.9503 - val_loss: 0.1316 - val_acc: 0.9601
Epoch 13/20
 - 26s - loss: 0.1627 - acc: 0.9516 - val_loss: 0.1001 - val_acc: 0.9700
Epoch 14/20
 - 26s - loss: 0.1663 - acc: 0.9524 - val_loss: 0.1176 - val_acc: 0.9652
Epoch 15/20
 - 26s - loss: 0.1628 - acc: 0.9539 - val_loss: 0.1083 - val_acc: 0.9684
Epoch 16/20
 - 26s - loss: 0.1621 - acc: 0.9538 - val_loss: 0.1019 - val_acc: 0.9700
Epoch 17/20
 - 26s - loss: 0.1643 - acc: 0.9540 - val_loss: 0.1055 - val_acc: 0.9669
Epoch 18/20
 - 26s - loss: 0.1603 - acc: 0.9550 - val_loss: 0.1095 - val_acc: 0.9676
Epoch 19/20
 - 26s - loss: 0.1579 - acc: 0.9556 - val_loss: 0.1046 - val_acc: 0.9709
Epoch 20/20
 - 26s - loss: 0.1636 - acc: 0.9548 - val_loss: 0.0971 - val_acc: 0.9726
Test loss: 0.09731959378126812
Test accuracy: 0.9722
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9511 - acc: 0.6902 - val_loss: 0.3899 - val_acc: 0.8741
Epoch 2/20
 - 3s - loss: 0.4550 - acc: 0.8544 - val_loss: 0.3937 - val_acc: 0.8701
Epoch 3/20
 - 3s - loss: 0.3423 - acc: 0.8910 - val_loss: 0.3101 - val_acc: 0.9046
Epoch 4/20
 - 3s - loss: 0.2925 - acc: 0.9085 - val_loss: 0.2330 - val_acc: 0.9255
Epoch 5/20
 - 3s - loss: 0.2594 - acc: 0.9194 - val_loss: 0.1498 - val_acc: 0.9511
Epoch 6/20
 - 3s - loss: 0.2462 - acc: 0.9242 - val_loss: 0.1558 - val_acc: 0.9544
Epoch 7/20
 - 3s - loss: 0.2296 - acc: 0.9304 - val_loss: 0.1574 - val_acc: 0.9514
Epoch 8/20
 - 3s - loss: 0.2189 - acc: 0.9336 - val_loss: 0.1621 - val_acc: 0.9503
Epoch 9/20
 - 3s - loss: 0.2111 - acc: 0.9369 - val_loss: 0.1421 - val_acc: 0.9586
Epoch 10/20
 - 3s - loss: 0.2075 - acc: 0.9380 - val_loss: 0.1413 - val_acc: 0.9563
Epoch 11/20
 - 3s - loss: 0.2036 - acc: 0.9395 - val_loss: 0.2164 - val_acc: 0.9379
Epoch 12/20
 - 3s - loss: 0.2010 - acc: 0.9413 - val_loss: 0.1333 - val_acc: 0.9599
Epoch 13/20
 - 3s - loss: 0.1975 - acc: 0.9430 - val_loss: 0.1394 - val_acc: 0.9554
Epoch 14/20
 - 3s - loss: 0.1995 - acc: 0.9440 - val_loss: 0.1416 - val_acc: 0.9563
Epoch 15/20
 - 3s - loss: 0.1978 - acc: 0.9431 - val_loss: 0.1375 - val_acc: 0.9570
Epoch 16/20
 - 3s - loss: 0.1944 - acc: 0.9436 - val_loss: 0.1273 - val_acc: 0.9628
Epoch 17/20
 - 3s - loss: 0.1947 - acc: 0.9459 - val_loss: 0.1602 - val_acc: 0.9522
Epoch 18/20
 - 3s - loss: 0.2014 - acc: 0.9434 - val_loss: 0.1208 - val_acc: 0.9626
Epoch 19/20
 - 3s - loss: 0.1993 - acc: 0.9450 - val_loss: 0.1452 - val_acc: 0.9636
Epoch 20/20
 - 3s - loss: 0.2020 - acc: 0.9440 - val_loss: 0.1327 - val_acc: 0.9600
Test loss: 0.13323310046344997
Test accuracy: 0.9597
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9663 - acc: 0.6904 - val_loss: 0.6131 - val_acc: 0.7910
Epoch 2/20
 - 3s - loss: 0.4445 - acc: 0.8597 - val_loss: 0.3155 - val_acc: 0.8958
Epoch 3/20
 - 3s - loss: 0.3338 - acc: 0.8933 - val_loss: 0.4151 - val_acc: 0.8698
Epoch 4/20
 - 3s - loss: 0.2794 - acc: 0.9121 - val_loss: 0.2015 - val_acc: 0.9327
Epoch 5/20
 - 3s - loss: 0.2476 - acc: 0.9230 - val_loss: 0.1881 - val_acc: 0.9461
Epoch 6/20
 - 3s - loss: 0.2232 - acc: 0.9309 - val_loss: 0.1583 - val_acc: 0.9504
Epoch 7/20
 - 3s - loss: 0.2135 - acc: 0.9347 - val_loss: 0.1708 - val_acc: 0.9446
Epoch 8/20
 - 3s - loss: 0.2018 - acc: 0.9382 - val_loss: 0.1318 - val_acc: 0.9632
Epoch 9/20
 - 3s - loss: 0.1986 - acc: 0.9402 - val_loss: 0.1497 - val_acc: 0.9555
Epoch 10/20
 - 3s - loss: 0.1894 - acc: 0.9433 - val_loss: 0.1406 - val_acc: 0.9547
Epoch 11/20
 - 3s - loss: 0.1859 - acc: 0.9454 - val_loss: 0.1559 - val_acc: 0.9485
Epoch 12/20
 - 3s - loss: 0.1867 - acc: 0.9459 - val_loss: 0.1326 - val_acc: 0.9591
Epoch 13/20
 - 3s - loss: 0.1807 - acc: 0.9470 - val_loss: 0.1262 - val_acc: 0.9637
Epoch 14/20
 - 3s - loss: 0.1797 - acc: 0.9477 - val_loss: 0.1150 - val_acc: 0.9666
Epoch 15/20
 - 3s - loss: 0.1812 - acc: 0.9486 - val_loss: 0.1140 - val_acc: 0.9632
Epoch 16/20
 - 3s - loss: 0.1773 - acc: 0.9489 - val_loss: 0.1159 - val_acc: 0.9650
Epoch 17/20
 - 3s - loss: 0.1769 - acc: 0.9503 - val_loss: 0.1170 - val_acc: 0.9673
Epoch 18/20
 - 3s - loss: 0.1797 - acc: 0.9499 - val_loss: 0.1124 - val_acc: 0.9687
Epoch 19/20
 - 3s - loss: 0.1762 - acc: 0.9506 - val_loss: 0.1104 - val_acc: 0.9691
Epoch 20/20
 - 3s - loss: 0.1757 - acc: 0.9518 - val_loss: 0.1427 - val_acc: 0.9605
Test loss: 0.14149364730265807
Test accuracy: 0.9611
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9408 - acc: 0.6988 - val_loss: 0.5712 - val_acc: 0.8115
Epoch 2/20
 - 3s - loss: 0.4393 - acc: 0.8583 - val_loss: 0.2704 - val_acc: 0.9130
Epoch 3/20
 - 3s - loss: 0.3262 - acc: 0.8975 - val_loss: 0.2707 - val_acc: 0.9151
Epoch 4/20
 - 3s - loss: 0.2748 - acc: 0.9130 - val_loss: 0.2273 - val_acc: 0.9298
Epoch 5/20
 - 3s - loss: 0.2435 - acc: 0.9242 - val_loss: 0.1441 - val_acc: 0.9522
Epoch 6/20
 - 3s - loss: 0.2192 - acc: 0.9322 - val_loss: 0.1981 - val_acc: 0.9400
Epoch 7/20
 - 3s - loss: 0.2093 - acc: 0.9358 - val_loss: 0.1237 - val_acc: 0.9603
Epoch 8/20
 - 3s - loss: 0.1950 - acc: 0.9408 - val_loss: 0.1793 - val_acc: 0.9466
Epoch 9/20
 - 3s - loss: 0.1923 - acc: 0.9419 - val_loss: 0.1114 - val_acc: 0.9660
Epoch 10/20
 - 3s - loss: 0.1843 - acc: 0.9446 - val_loss: 0.1371 - val_acc: 0.9585
Epoch 11/20
 - 3s - loss: 0.1818 - acc: 0.9457 - val_loss: 0.1370 - val_acc: 0.9571
Epoch 12/20
 - 3s - loss: 0.1761 - acc: 0.9478 - val_loss: 0.1011 - val_acc: 0.9690
Epoch 13/20
 - 3s - loss: 0.1725 - acc: 0.9493 - val_loss: 0.1171 - val_acc: 0.9667
Epoch 14/20
 - 3s - loss: 0.1691 - acc: 0.9501 - val_loss: 0.1302 - val_acc: 0.9611
Epoch 15/20
 - 3s - loss: 0.1724 - acc: 0.9500 - val_loss: 0.1396 - val_acc: 0.9598
Epoch 16/20
 - 3s - loss: 0.1760 - acc: 0.9503 - val_loss: 0.1118 - val_acc: 0.9666
Epoch 17/20
 - 3s - loss: 0.1743 - acc: 0.9515 - val_loss: 0.1087 - val_acc: 0.9697
Epoch 18/20
 - 3s - loss: 0.1770 - acc: 0.9507 - val_loss: 0.1213 - val_acc: 0.9633
Epoch 19/20
 - 3s - loss: 0.1760 - acc: 0.9505 - val_loss: 0.1086 - val_acc: 0.9681
Epoch 20/20
 - 3s - loss: 0.1688 - acc: 0.9533 - val_loss: 0.1224 - val_acc: 0.9607
Test loss: 0.12250994980251416
Test accuracy: 0.9611
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9189 - acc: 0.7037 - val_loss: 0.6822 - val_acc: 0.7917
Epoch 2/20
 - 3s - loss: 0.4327 - acc: 0.8638 - val_loss: 0.3129 - val_acc: 0.8982
Epoch 3/20
 - 3s - loss: 0.3178 - acc: 0.8985 - val_loss: 0.2015 - val_acc: 0.9362
Epoch 4/20
 - 3s - loss: 0.2674 - acc: 0.9165 - val_loss: 0.1587 - val_acc: 0.9488
Epoch 5/20
 - 3s - loss: 0.2321 - acc: 0.9280 - val_loss: 0.1494 - val_acc: 0.9519
Epoch 6/20
 - 3s - loss: 0.2156 - acc: 0.9329 - val_loss: 0.1493 - val_acc: 0.9549
Epoch 7/20
 - 3s - loss: 0.2025 - acc: 0.9386 - val_loss: 0.1541 - val_acc: 0.9522
Epoch 8/20
 - 3s - loss: 0.1912 - acc: 0.9416 - val_loss: 0.1371 - val_acc: 0.9586
Epoch 9/20
 - 3s - loss: 0.1847 - acc: 0.9441 - val_loss: 0.1595 - val_acc: 0.9520
Epoch 10/20
 - 3s - loss: 0.1830 - acc: 0.9460 - val_loss: 0.1222 - val_acc: 0.9626
Epoch 11/20
 - 3s - loss: 0.1799 - acc: 0.9469 - val_loss: 0.1798 - val_acc: 0.9454
Epoch 12/20
 - 3s - loss: 0.1754 - acc: 0.9489 - val_loss: 0.1180 - val_acc: 0.9664
Epoch 13/20
 - 3s - loss: 0.1701 - acc: 0.9509 - val_loss: 0.1407 - val_acc: 0.9586
Epoch 14/20
 - 3s - loss: 0.1730 - acc: 0.9504 - val_loss: 0.1433 - val_acc: 0.9577
Epoch 15/20
 - 3s - loss: 0.1685 - acc: 0.9517 - val_loss: 0.1077 - val_acc: 0.9657
Epoch 16/20
 - 3s - loss: 0.1705 - acc: 0.9502 - val_loss: 0.1331 - val_acc: 0.9612
Epoch 17/20
 - 3s - loss: 0.1689 - acc: 0.9513 - val_loss: 0.1089 - val_acc: 0.9694
Epoch 18/20
 - 3s - loss: 0.1665 - acc: 0.9522 - val_loss: 0.1115 - val_acc: 0.9663
Epoch 19/20
 - 3s - loss: 0.1709 - acc: 0.9528 - val_loss: 0.1020 - val_acc: 0.9713
Epoch 20/20
 - 3s - loss: 0.1748 - acc: 0.9527 - val_loss: 0.1200 - val_acc: 0.9680
Test loss: 0.12056339753077919
Test accuracy: 0.9676
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9277 - acc: 0.7013 - val_loss: 0.5757 - val_acc: 0.8052
Epoch 2/20
 - 4s - loss: 0.4277 - acc: 0.8631 - val_loss: 0.3697 - val_acc: 0.8810
Epoch 3/20
 - 4s - loss: 0.3181 - acc: 0.8997 - val_loss: 0.1968 - val_acc: 0.9396
Epoch 4/20
 - 4s - loss: 0.2676 - acc: 0.9170 - val_loss: 0.1634 - val_acc: 0.9492
Epoch 5/20
 - 4s - loss: 0.2375 - acc: 0.9268 - val_loss: 0.2103 - val_acc: 0.9320
Epoch 6/20
 - 4s - loss: 0.2203 - acc: 0.9325 - val_loss: 0.1436 - val_acc: 0.9528
Epoch 7/20
 - 4s - loss: 0.2000 - acc: 0.9383 - val_loss: 0.1620 - val_acc: 0.9473
Epoch 8/20
 - 4s - loss: 0.1953 - acc: 0.9411 - val_loss: 0.1431 - val_acc: 0.9538
Epoch 9/20
 - 4s - loss: 0.1876 - acc: 0.9430 - val_loss: 0.1164 - val_acc: 0.9629
Epoch 10/20
 - 4s - loss: 0.1814 - acc: 0.9459 - val_loss: 0.1038 - val_acc: 0.9683
Epoch 11/20
 - 4s - loss: 0.1791 - acc: 0.9466 - val_loss: 0.1119 - val_acc: 0.9652
Epoch 12/20
 - 4s - loss: 0.1720 - acc: 0.9504 - val_loss: 0.1711 - val_acc: 0.9462
Epoch 13/20
 - 4s - loss: 0.1732 - acc: 0.9487 - val_loss: 0.1185 - val_acc: 0.9657
Epoch 14/20
 - 4s - loss: 0.1671 - acc: 0.9523 - val_loss: 0.0926 - val_acc: 0.9725
Epoch 15/20
 - 4s - loss: 0.1639 - acc: 0.9533 - val_loss: 0.1048 - val_acc: 0.9702
Epoch 16/20
 - 4s - loss: 0.1655 - acc: 0.9521 - val_loss: 0.1122 - val_acc: 0.9656
Epoch 17/20
 - 4s - loss: 0.1674 - acc: 0.9522 - val_loss: 0.1071 - val_acc: 0.9691
Epoch 18/20
 - 4s - loss: 0.1653 - acc: 0.9540 - val_loss: 0.1739 - val_acc: 0.9562
Epoch 19/20
 - 4s - loss: 0.1680 - acc: 0.9534 - val_loss: 0.1171 - val_acc: 0.9648
Epoch 20/20
 - 4s - loss: 0.1644 - acc: 0.9536 - val_loss: 0.1200 - val_acc: 0.9673
Test loss: 0.12286331198262633
Test accuracy: 0.9666
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9602 - acc: 0.6936 - val_loss: 0.4019 - val_acc: 0.8644
Epoch 2/20
 - 4s - loss: 0.4266 - acc: 0.8634 - val_loss: 0.2304 - val_acc: 0.9224
Epoch 3/20
 - 4s - loss: 0.3203 - acc: 0.8986 - val_loss: 0.2539 - val_acc: 0.9181
Epoch 4/20
 - 4s - loss: 0.2679 - acc: 0.9164 - val_loss: 0.2757 - val_acc: 0.9119
Epoch 5/20
 - 4s - loss: 0.2335 - acc: 0.9275 - val_loss: 0.1359 - val_acc: 0.9576
Epoch 6/20
 - 4s - loss: 0.2142 - acc: 0.9351 - val_loss: 0.2888 - val_acc: 0.9076
Epoch 7/20
 - 4s - loss: 0.2035 - acc: 0.9377 - val_loss: 0.1310 - val_acc: 0.9578
Epoch 8/20
 - 4s - loss: 0.1909 - acc: 0.9423 - val_loss: 0.1403 - val_acc: 0.9581
Epoch 9/20
 - 4s - loss: 0.1827 - acc: 0.9442 - val_loss: 0.1094 - val_acc: 0.9642
Epoch 10/20
 - 4s - loss: 0.1754 - acc: 0.9482 - val_loss: 0.1675 - val_acc: 0.9502
Epoch 11/20
 - 4s - loss: 0.1701 - acc: 0.9491 - val_loss: 0.1537 - val_acc: 0.9564
Epoch 12/20
 - 4s - loss: 0.1650 - acc: 0.9503 - val_loss: 0.1128 - val_acc: 0.9653
Epoch 13/20
 - 4s - loss: 0.1625 - acc: 0.9524 - val_loss: 0.1144 - val_acc: 0.9684
Epoch 14/20
 - 4s - loss: 0.1640 - acc: 0.9529 - val_loss: 0.0964 - val_acc: 0.9704
Epoch 15/20
 - 4s - loss: 0.1649 - acc: 0.9522 - val_loss: 0.0927 - val_acc: 0.9731
Epoch 16/20
 - 4s - loss: 0.1614 - acc: 0.9539 - val_loss: 0.1284 - val_acc: 0.9609
Epoch 17/20
 - 4s - loss: 0.1612 - acc: 0.9537 - val_loss: 0.1081 - val_acc: 0.9709
Epoch 18/20
 - 4s - loss: 0.1607 - acc: 0.9550 - val_loss: 0.0938 - val_acc: 0.9736
Epoch 19/20
 - 4s - loss: 0.1594 - acc: 0.9551 - val_loss: 0.1200 - val_acc: 0.9643
Epoch 20/20
 - 4s - loss: 0.1637 - acc: 0.9536 - val_loss: 0.0878 - val_acc: 0.9740
Test loss: 0.08758271233718842
Test accuracy: 0.9735
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9593 - acc: 0.6927 - val_loss: 0.5039 - val_acc: 0.8405
Epoch 2/20
 - 6s - loss: 0.4341 - acc: 0.8622 - val_loss: 0.2291 - val_acc: 0.9259
Epoch 3/20
 - 6s - loss: 0.3203 - acc: 0.8991 - val_loss: 0.1809 - val_acc: 0.9418
Epoch 4/20
 - 6s - loss: 0.2709 - acc: 0.9156 - val_loss: 0.1469 - val_acc: 0.9552
Epoch 5/20
 - 6s - loss: 0.2348 - acc: 0.9269 - val_loss: 0.1524 - val_acc: 0.9534
Epoch 6/20
 - 6s - loss: 0.2116 - acc: 0.9344 - val_loss: 0.2300 - val_acc: 0.9243
Epoch 7/20
 - 6s - loss: 0.2009 - acc: 0.9393 - val_loss: 0.1268 - val_acc: 0.9630
Epoch 8/20
 - 6s - loss: 0.1874 - acc: 0.9431 - val_loss: 0.1393 - val_acc: 0.9562
Epoch 9/20
 - 6s - loss: 0.1822 - acc: 0.9449 - val_loss: 0.1703 - val_acc: 0.9481
Epoch 10/20
 - 6s - loss: 0.1776 - acc: 0.9471 - val_loss: 0.1603 - val_acc: 0.9530
Epoch 11/20
 - 6s - loss: 0.1746 - acc: 0.9478 - val_loss: 0.1706 - val_acc: 0.9474
Epoch 12/20
 - 6s - loss: 0.1658 - acc: 0.9513 - val_loss: 0.1148 - val_acc: 0.9671
Epoch 13/20
 - 6s - loss: 0.1650 - acc: 0.9511 - val_loss: 0.1306 - val_acc: 0.9642
Epoch 14/20
 - 6s - loss: 0.1632 - acc: 0.9531 - val_loss: 0.1234 - val_acc: 0.9650
Epoch 15/20
 - 6s - loss: 0.1624 - acc: 0.9530 - val_loss: 0.1118 - val_acc: 0.9679
Epoch 16/20
 - 6s - loss: 0.1582 - acc: 0.9539 - val_loss: 0.1060 - val_acc: 0.9677
Epoch 17/20
 - 6s - loss: 0.1651 - acc: 0.9524 - val_loss: 0.1293 - val_acc: 0.9622
Epoch 18/20
 - 6s - loss: 0.1643 - acc: 0.9551 - val_loss: 0.1579 - val_acc: 0.9618
Epoch 19/20
 - 6s - loss: 0.1660 - acc: 0.9541 - val_loss: 0.1016 - val_acc: 0.9723
Epoch 20/20
 - 6s - loss: 0.1604 - acc: 0.9554 - val_loss: 0.1080 - val_acc: 0.9681
Test loss: 0.10820799967686762
Test accuracy: 0.968
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9401 - acc: 0.6994 - val_loss: 0.3807 - val_acc: 0.8780
Epoch 2/20
 - 9s - loss: 0.4294 - acc: 0.8636 - val_loss: 0.2310 - val_acc: 0.9277
Epoch 3/20
 - 9s - loss: 0.3162 - acc: 0.8995 - val_loss: 0.2047 - val_acc: 0.9348
Epoch 4/20
 - 9s - loss: 0.2698 - acc: 0.9170 - val_loss: 0.2037 - val_acc: 0.9362
Epoch 5/20
 - 9s - loss: 0.2332 - acc: 0.9279 - val_loss: 0.1582 - val_acc: 0.9529
Epoch 6/20
 - 9s - loss: 0.2153 - acc: 0.9347 - val_loss: 0.1514 - val_acc: 0.9546
Epoch 7/20
 - 9s - loss: 0.2035 - acc: 0.9378 - val_loss: 0.1132 - val_acc: 0.9675
Epoch 8/20
 - 9s - loss: 0.1901 - acc: 0.9421 - val_loss: 0.1867 - val_acc: 0.9403
Epoch 9/20
 - 9s - loss: 0.1859 - acc: 0.9435 - val_loss: 0.1741 - val_acc: 0.9487
Epoch 10/20
 - 9s - loss: 0.1792 - acc: 0.9459 - val_loss: 0.1119 - val_acc: 0.9654
Epoch 11/20
 - 9s - loss: 0.1759 - acc: 0.9494 - val_loss: 0.1008 - val_acc: 0.9709
Epoch 12/20
 - 9s - loss: 0.1749 - acc: 0.9492 - val_loss: 0.1050 - val_acc: 0.9667
Epoch 13/20
 - 9s - loss: 0.1686 - acc: 0.9510 - val_loss: 0.1261 - val_acc: 0.9651
Epoch 14/20
 - 9s - loss: 0.1711 - acc: 0.9512 - val_loss: 0.1179 - val_acc: 0.9676
Epoch 15/20
 - 9s - loss: 0.1622 - acc: 0.9524 - val_loss: 0.1013 - val_acc: 0.9728
Epoch 16/20
 - 9s - loss: 0.1660 - acc: 0.9525 - val_loss: 0.1145 - val_acc: 0.9706
Epoch 17/20
 - 9s - loss: 0.1643 - acc: 0.9539 - val_loss: 0.0979 - val_acc: 0.9748
Epoch 18/20
 - 9s - loss: 0.1690 - acc: 0.9526 - val_loss: 0.1151 - val_acc: 0.9673
Epoch 19/20
 - 9s - loss: 0.1680 - acc: 0.9535 - val_loss: 0.1261 - val_acc: 0.9640
Epoch 20/20
 - 9s - loss: 0.1611 - acc: 0.9552 - val_loss: 0.1123 - val_acc: 0.9688
Test loss: 0.1116187631473411
Test accuracy: 0.9692
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9420 - acc: 0.6982 - val_loss: 0.3841 - val_acc: 0.8775
Epoch 2/20
 - 14s - loss: 0.4338 - acc: 0.8607 - val_loss: 0.2881 - val_acc: 0.9067
Epoch 3/20
 - 14s - loss: 0.3205 - acc: 0.8981 - val_loss: 0.2559 - val_acc: 0.9182
Epoch 4/20
 - 14s - loss: 0.2717 - acc: 0.9149 - val_loss: 0.1720 - val_acc: 0.9447
Epoch 5/20
 - 14s - loss: 0.2398 - acc: 0.9251 - val_loss: 0.1700 - val_acc: 0.9442
Epoch 6/20
 - 14s - loss: 0.2169 - acc: 0.9332 - val_loss: 0.1391 - val_acc: 0.9570
Epoch 7/20
 - 14s - loss: 0.2040 - acc: 0.9381 - val_loss: 0.1115 - val_acc: 0.9655
Epoch 8/20
 - 14s - loss: 0.1918 - acc: 0.9424 - val_loss: 0.1354 - val_acc: 0.9565
Epoch 9/20
 - 14s - loss: 0.1833 - acc: 0.9442 - val_loss: 0.1603 - val_acc: 0.9530
Epoch 10/20
 - 14s - loss: 0.1753 - acc: 0.9463 - val_loss: 0.1442 - val_acc: 0.9566
Epoch 11/20
 - 14s - loss: 0.1730 - acc: 0.9485 - val_loss: 0.1269 - val_acc: 0.9580
Epoch 12/20
 - 14s - loss: 0.1722 - acc: 0.9482 - val_loss: 0.1099 - val_acc: 0.9666
Epoch 13/20
 - 14s - loss: 0.1671 - acc: 0.9511 - val_loss: 0.1179 - val_acc: 0.9658
Epoch 14/20
 - 14s - loss: 0.1615 - acc: 0.9526 - val_loss: 0.1998 - val_acc: 0.9499
Epoch 15/20
 - 14s - loss: 0.1641 - acc: 0.9528 - val_loss: 0.1060 - val_acc: 0.9701
Epoch 16/20
 - 14s - loss: 0.1618 - acc: 0.9542 - val_loss: 0.2154 - val_acc: 0.9286
Epoch 17/20
 - 14s - loss: 0.1634 - acc: 0.9530 - val_loss: 0.1534 - val_acc: 0.9563
Epoch 18/20
 - 14s - loss: 0.1604 - acc: 0.9544 - val_loss: 0.1090 - val_acc: 0.9703
Epoch 19/20
 - 14s - loss: 0.1626 - acc: 0.9539 - val_loss: 0.1449 - val_acc: 0.9554
Epoch 20/20
 - 14s - loss: 0.1591 - acc: 0.9550 - val_loss: 0.1017 - val_acc: 0.9722
Test loss: 0.10191520098769107
Test accuracy: 0.9723
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9511 - acc: 0.6932 - val_loss: 0.4082 - val_acc: 0.8593
Epoch 2/20
 - 26s - loss: 0.4299 - acc: 0.8624 - val_loss: 0.2353 - val_acc: 0.9246
Epoch 3/20
 - 26s - loss: 0.3202 - acc: 0.8981 - val_loss: 0.1985 - val_acc: 0.9376
Epoch 4/20
 - 26s - loss: 0.2653 - acc: 0.9174 - val_loss: 0.3311 - val_acc: 0.8906
Epoch 5/20
 - 26s - loss: 0.2379 - acc: 0.9262 - val_loss: 0.2083 - val_acc: 0.9327
Epoch 6/20
 - 26s - loss: 0.2149 - acc: 0.9338 - val_loss: 0.1220 - val_acc: 0.9602
Epoch 7/20
 - 26s - loss: 0.2020 - acc: 0.9378 - val_loss: 0.1807 - val_acc: 0.9458
Epoch 8/20
 - 26s - loss: 0.1866 - acc: 0.9434 - val_loss: 0.1081 - val_acc: 0.9652
Epoch 9/20
 - 26s - loss: 0.1854 - acc: 0.9446 - val_loss: 0.1437 - val_acc: 0.9560
Epoch 10/20
 - 26s - loss: 0.1774 - acc: 0.9463 - val_loss: 0.1180 - val_acc: 0.9643
Epoch 11/20
 - 26s - loss: 0.1743 - acc: 0.9483 - val_loss: 0.1056 - val_acc: 0.9664
Epoch 12/20
 - 26s - loss: 0.1738 - acc: 0.9493 - val_loss: 0.0988 - val_acc: 0.9686
Epoch 13/20
 - 26s - loss: 0.1667 - acc: 0.9514 - val_loss: 0.1225 - val_acc: 0.9655
Epoch 14/20
 - 26s - loss: 0.1655 - acc: 0.9519 - val_loss: 0.0996 - val_acc: 0.9696
Epoch 15/20
 - 26s - loss: 0.1635 - acc: 0.9538 - val_loss: 0.1314 - val_acc: 0.9615
Epoch 16/20
 - 26s - loss: 0.1662 - acc: 0.9535 - val_loss: 0.1013 - val_acc: 0.9724
Epoch 17/20
 - 26s - loss: 0.1668 - acc: 0.9532 - val_loss: 0.1227 - val_acc: 0.9667
Epoch 18/20
 - 26s - loss: 0.1673 - acc: 0.9534 - val_loss: 0.1014 - val_acc: 0.9681
Epoch 19/20
 - 26s - loss: 0.1603 - acc: 0.9550 - val_loss: 0.1151 - val_acc: 0.9672
Epoch 20/20
 - 26s - loss: 0.1643 - acc: 0.9547 - val_loss: 0.1519 - val_acc: 0.9598
Test loss: 0.15172226957110688
Test accuracy: 0.9594
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9678 - acc: 0.6880 - val_loss: 0.3726 - val_acc: 0.8784
Epoch 2/20
 - 3s - loss: 0.4574 - acc: 0.8543 - val_loss: 0.3538 - val_acc: 0.8863
Epoch 3/20
 - 3s - loss: 0.3457 - acc: 0.8922 - val_loss: 0.4314 - val_acc: 0.8535
Epoch 4/20
 - 3s - loss: 0.2948 - acc: 0.9068 - val_loss: 0.2153 - val_acc: 0.9328
Epoch 5/20
 - 3s - loss: 0.2627 - acc: 0.9169 - val_loss: 0.1849 - val_acc: 0.9468
Epoch 6/20
 - 3s - loss: 0.2409 - acc: 0.9245 - val_loss: 0.1659 - val_acc: 0.9492
Epoch 7/20
 - 3s - loss: 0.2294 - acc: 0.9299 - val_loss: 0.2342 - val_acc: 0.9294
Epoch 8/20
 - 3s - loss: 0.2175 - acc: 0.9329 - val_loss: 0.2168 - val_acc: 0.9348
Epoch 9/20
 - 3s - loss: 0.2130 - acc: 0.9362 - val_loss: 0.1656 - val_acc: 0.9476
Epoch 10/20
 - 3s - loss: 0.2088 - acc: 0.9372 - val_loss: 0.1389 - val_acc: 0.9586
Epoch 11/20
 - 3s - loss: 0.2095 - acc: 0.9387 - val_loss: 0.1276 - val_acc: 0.9615
Epoch 12/20
 - 3s - loss: 0.2029 - acc: 0.9410 - val_loss: 0.1492 - val_acc: 0.9545
Epoch 13/20
 - 3s - loss: 0.2030 - acc: 0.9405 - val_loss: 0.1259 - val_acc: 0.9646
Epoch 14/20
 - 3s - loss: 0.2001 - acc: 0.9414 - val_loss: 0.1580 - val_acc: 0.9530
Epoch 15/20
 - 3s - loss: 0.1982 - acc: 0.9443 - val_loss: 0.1372 - val_acc: 0.9601
Epoch 16/20
 - 3s - loss: 0.2058 - acc: 0.9418 - val_loss: 0.1486 - val_acc: 0.9611
Epoch 17/20
 - 3s - loss: 0.2019 - acc: 0.9421 - val_loss: 0.1379 - val_acc: 0.9600
Epoch 18/20
 - 3s - loss: 0.2068 - acc: 0.9421 - val_loss: 0.1267 - val_acc: 0.9628
Epoch 19/20
 - 3s - loss: 0.2059 - acc: 0.9425 - val_loss: 0.1189 - val_acc: 0.9672
Epoch 20/20
 - 3s - loss: 0.2106 - acc: 0.9432 - val_loss: 0.1556 - val_acc: 0.9568
Test loss: 0.15376736150480283
Test accuracy: 0.9572
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9413 - acc: 0.6971 - val_loss: 0.5753 - val_acc: 0.8249
Epoch 2/20
 - 3s - loss: 0.4379 - acc: 0.8591 - val_loss: 0.2616 - val_acc: 0.9191
Epoch 3/20
 - 3s - loss: 0.3316 - acc: 0.8952 - val_loss: 0.2644 - val_acc: 0.9113
Epoch 4/20
 - 3s - loss: 0.2745 - acc: 0.9151 - val_loss: 0.2161 - val_acc: 0.9318
Epoch 5/20
 - 3s - loss: 0.2442 - acc: 0.9244 - val_loss: 0.1583 - val_acc: 0.9477
Epoch 6/20
 - 3s - loss: 0.2252 - acc: 0.9295 - val_loss: 0.1401 - val_acc: 0.9569
Epoch 7/20
 - 3s - loss: 0.2156 - acc: 0.9338 - val_loss: 0.1448 - val_acc: 0.9567
Epoch 8/20
 - 3s - loss: 0.2013 - acc: 0.9382 - val_loss: 0.2173 - val_acc: 0.9297
Epoch 9/20
 - 3s - loss: 0.1953 - acc: 0.9400 - val_loss: 0.1224 - val_acc: 0.9640
Epoch 10/20
 - 3s - loss: 0.1915 - acc: 0.9420 - val_loss: 0.1533 - val_acc: 0.9549
Epoch 11/20
 - 3s - loss: 0.1835 - acc: 0.9452 - val_loss: 0.1402 - val_acc: 0.9608
Epoch 12/20
 - 3s - loss: 0.1876 - acc: 0.9448 - val_loss: 0.1130 - val_acc: 0.9673
Epoch 13/20
 - 3s - loss: 0.1837 - acc: 0.9465 - val_loss: 0.1139 - val_acc: 0.9655
Epoch 14/20
 - 3s - loss: 0.1794 - acc: 0.9478 - val_loss: 0.1295 - val_acc: 0.9606
Epoch 15/20
 - 3s - loss: 0.1796 - acc: 0.9481 - val_loss: 0.1566 - val_acc: 0.9542
Epoch 16/20
 - 3s - loss: 0.1757 - acc: 0.9494 - val_loss: 0.1073 - val_acc: 0.9680
Epoch 17/20
 - 3s - loss: 0.1737 - acc: 0.9495 - val_loss: 0.1126 - val_acc: 0.9671
Epoch 18/20
 - 3s - loss: 0.1793 - acc: 0.9483 - val_loss: 0.1357 - val_acc: 0.9606
Epoch 19/20
 - 3s - loss: 0.1752 - acc: 0.9497 - val_loss: 0.2455 - val_acc: 0.9290
Epoch 20/20
 - 3s - loss: 0.1797 - acc: 0.9504 - val_loss: 0.1126 - val_acc: 0.9681
Test loss: 0.11608528304533684
Test accuracy: 0.9687
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9524 - acc: 0.6979 - val_loss: 0.7954 - val_acc: 0.7524
Epoch 2/20
 - 3s - loss: 0.4378 - acc: 0.8600 - val_loss: 0.4464 - val_acc: 0.8611
Epoch 3/20
 - 3s - loss: 0.3314 - acc: 0.8951 - val_loss: 0.2057 - val_acc: 0.9366
Epoch 4/20
 - 3s - loss: 0.2796 - acc: 0.9133 - val_loss: 0.2972 - val_acc: 0.9084
Epoch 5/20
 - 3s - loss: 0.2452 - acc: 0.9236 - val_loss: 0.2067 - val_acc: 0.9328
Epoch 6/20
 - 3s - loss: 0.2279 - acc: 0.9287 - val_loss: 0.1743 - val_acc: 0.9447
Epoch 7/20
 - 3s - loss: 0.2108 - acc: 0.9353 - val_loss: 0.1709 - val_acc: 0.9473
Epoch 8/20
 - 3s - loss: 0.2006 - acc: 0.9386 - val_loss: 0.1339 - val_acc: 0.9578
Epoch 9/20
 - 3s - loss: 0.1894 - acc: 0.9424 - val_loss: 0.1461 - val_acc: 0.9541
Epoch 10/20
 - 3s - loss: 0.1838 - acc: 0.9442 - val_loss: 0.1377 - val_acc: 0.9566
Epoch 11/20
 - 3s - loss: 0.1827 - acc: 0.9457 - val_loss: 0.1125 - val_acc: 0.9627
Epoch 12/20
 - 3s - loss: 0.1755 - acc: 0.9470 - val_loss: 0.1492 - val_acc: 0.9559
Epoch 13/20
 - 3s - loss: 0.1780 - acc: 0.9467 - val_loss: 0.1215 - val_acc: 0.9650
Epoch 14/20
 - 3s - loss: 0.1751 - acc: 0.9486 - val_loss: 0.1228 - val_acc: 0.9610
Epoch 15/20
 - 3s - loss: 0.1705 - acc: 0.9496 - val_loss: 0.1158 - val_acc: 0.9635
Epoch 16/20
 - 3s - loss: 0.1688 - acc: 0.9502 - val_loss: 0.0940 - val_acc: 0.9721
Epoch 17/20
 - 3s - loss: 0.1716 - acc: 0.9498 - val_loss: 0.1265 - val_acc: 0.9628
Epoch 18/20
 - 3s - loss: 0.1688 - acc: 0.9520 - val_loss: 0.0956 - val_acc: 0.9716
Epoch 19/20
 - 3s - loss: 0.1701 - acc: 0.9518 - val_loss: 0.1084 - val_acc: 0.9697
Epoch 20/20
 - 3s - loss: 0.1703 - acc: 0.9526 - val_loss: 0.1182 - val_acc: 0.9664
Test loss: 0.11802938397603575
Test accuracy: 0.9663
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9451 - acc: 0.6970 - val_loss: 0.4230 - val_acc: 0.8640
Epoch 2/20
 - 3s - loss: 0.4433 - acc: 0.8585 - val_loss: 0.2941 - val_acc: 0.9045
Epoch 3/20
 - 3s - loss: 0.3315 - acc: 0.8967 - val_loss: 0.1881 - val_acc: 0.9405
Epoch 4/20
 - 3s - loss: 0.2695 - acc: 0.9147 - val_loss: 0.1901 - val_acc: 0.9404
Epoch 5/20
 - 3s - loss: 0.2434 - acc: 0.9244 - val_loss: 0.1786 - val_acc: 0.9452
Epoch 6/20
 - 3s - loss: 0.2216 - acc: 0.9323 - val_loss: 0.1386 - val_acc: 0.9558
Epoch 7/20
 - 3s - loss: 0.2020 - acc: 0.9376 - val_loss: 0.1622 - val_acc: 0.9514
Epoch 8/20
 - 3s - loss: 0.1909 - acc: 0.9413 - val_loss: 0.1210 - val_acc: 0.9631
Epoch 9/20
 - 3s - loss: 0.1875 - acc: 0.9433 - val_loss: 0.1528 - val_acc: 0.9519
Epoch 10/20
 - 3s - loss: 0.1767 - acc: 0.9456 - val_loss: 0.1560 - val_acc: 0.9521
Epoch 11/20
 - 3s - loss: 0.1783 - acc: 0.9461 - val_loss: 0.1350 - val_acc: 0.9585
Epoch 12/20
 - 3s - loss: 0.1705 - acc: 0.9496 - val_loss: 0.1152 - val_acc: 0.9663
Epoch 13/20
 - 3s - loss: 0.1721 - acc: 0.9493 - val_loss: 0.1198 - val_acc: 0.9621
Epoch 14/20
 - 3s - loss: 0.1624 - acc: 0.9525 - val_loss: 0.1059 - val_acc: 0.9690
Epoch 15/20
 - 3s - loss: 0.1662 - acc: 0.9517 - val_loss: 0.1253 - val_acc: 0.9664
Epoch 16/20
 - 3s - loss: 0.1685 - acc: 0.9515 - val_loss: 0.1112 - val_acc: 0.9692
Epoch 17/20
 - 3s - loss: 0.1606 - acc: 0.9538 - val_loss: 0.1236 - val_acc: 0.9644
Epoch 18/20
 - 3s - loss: 0.1691 - acc: 0.9522 - val_loss: 0.1060 - val_acc: 0.9676
Epoch 19/20
 - 3s - loss: 0.1617 - acc: 0.9543 - val_loss: 0.1316 - val_acc: 0.9639
Epoch 20/20
 - 3s - loss: 0.1641 - acc: 0.9540 - val_loss: 0.1131 - val_acc: 0.9704
Test loss: 0.11508346856168356
Test accuracy: 0.9687
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9450 - acc: 0.6906 - val_loss: 0.4134 - val_acc: 0.8671
Epoch 2/20
 - 4s - loss: 0.4390 - acc: 0.8601 - val_loss: 0.3608 - val_acc: 0.8840
Epoch 3/20
 - 4s - loss: 0.3239 - acc: 0.8982 - val_loss: 0.1866 - val_acc: 0.9391
Epoch 4/20
 - 4s - loss: 0.2684 - acc: 0.9179 - val_loss: 0.1705 - val_acc: 0.9438
Epoch 5/20
 - 4s - loss: 0.2394 - acc: 0.9259 - val_loss: 0.1651 - val_acc: 0.9485
Epoch 6/20
 - 4s - loss: 0.2157 - acc: 0.9339 - val_loss: 0.1876 - val_acc: 0.9411
Epoch 7/20
 - 4s - loss: 0.2004 - acc: 0.9381 - val_loss: 0.1715 - val_acc: 0.9431
Epoch 8/20
 - 4s - loss: 0.1928 - acc: 0.9419 - val_loss: 0.1264 - val_acc: 0.9614
Epoch 9/20
 - 4s - loss: 0.1848 - acc: 0.9439 - val_loss: 0.1571 - val_acc: 0.9533
Epoch 10/20
 - 4s - loss: 0.1764 - acc: 0.9475 - val_loss: 0.1315 - val_acc: 0.9615
Epoch 11/20
 - 4s - loss: 0.1762 - acc: 0.9486 - val_loss: 0.1553 - val_acc: 0.9516
Epoch 12/20
 - 4s - loss: 0.1690 - acc: 0.9507 - val_loss: 0.1219 - val_acc: 0.9602
Epoch 13/20
 - 4s - loss: 0.1728 - acc: 0.9506 - val_loss: 0.1199 - val_acc: 0.9644
Epoch 14/20
 - 4s - loss: 0.1704 - acc: 0.9506 - val_loss: 0.1074 - val_acc: 0.9675
Epoch 15/20
 - 4s - loss: 0.1732 - acc: 0.9507 - val_loss: 0.1045 - val_acc: 0.9706
Epoch 16/20
 - 4s - loss: 0.1695 - acc: 0.9513 - val_loss: 0.1042 - val_acc: 0.9674
Epoch 17/20
 - 4s - loss: 0.1681 - acc: 0.9525 - val_loss: 0.1239 - val_acc: 0.9662
Epoch 18/20
 - 4s - loss: 0.1721 - acc: 0.9517 - val_loss: 0.1206 - val_acc: 0.9655
Epoch 19/20
 - 4s - loss: 0.1717 - acc: 0.9519 - val_loss: 0.1048 - val_acc: 0.9672
Epoch 20/20
 - 4s - loss: 0.1697 - acc: 0.9530 - val_loss: 0.1014 - val_acc: 0.9698
Test loss: 0.10075826017505024
Test accuracy: 0.9691
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9384 - acc: 0.6962 - val_loss: 0.4304 - val_acc: 0.8654
Epoch 2/20
 - 4s - loss: 0.4403 - acc: 0.8593 - val_loss: 0.2771 - val_acc: 0.9122
Epoch 3/20
 - 4s - loss: 0.3246 - acc: 0.8987 - val_loss: 0.2336 - val_acc: 0.9245
Epoch 4/20
 - 4s - loss: 0.2743 - acc: 0.9156 - val_loss: 0.1716 - val_acc: 0.9465
Epoch 5/20
 - 4s - loss: 0.2417 - acc: 0.9251 - val_loss: 0.2788 - val_acc: 0.9113
Epoch 6/20
 - 4s - loss: 0.2194 - acc: 0.9341 - val_loss: 0.1458 - val_acc: 0.9537
Epoch 7/20
 - 4s - loss: 0.2035 - acc: 0.9374 - val_loss: 0.1500 - val_acc: 0.9536
Epoch 8/20
 - 4s - loss: 0.1921 - acc: 0.9403 - val_loss: 0.1110 - val_acc: 0.9660
Epoch 9/20
 - 4s - loss: 0.1819 - acc: 0.9446 - val_loss: 0.1576 - val_acc: 0.9508
Epoch 10/20
 - 4s - loss: 0.1783 - acc: 0.9464 - val_loss: 0.1230 - val_acc: 0.9626
Epoch 11/20
 - 4s - loss: 0.1759 - acc: 0.9468 - val_loss: 0.1200 - val_acc: 0.9640
Epoch 12/20
 - 4s - loss: 0.1720 - acc: 0.9488 - val_loss: 0.1580 - val_acc: 0.9528
Epoch 13/20
 - 4s - loss: 0.1666 - acc: 0.9508 - val_loss: 0.1545 - val_acc: 0.9522
Epoch 14/20
 - 4s - loss: 0.1672 - acc: 0.9504 - val_loss: 0.1335 - val_acc: 0.9603
Epoch 15/20
 - 4s - loss: 0.1680 - acc: 0.9528 - val_loss: 0.1069 - val_acc: 0.9701
Epoch 16/20
 - 4s - loss: 0.1652 - acc: 0.9521 - val_loss: 0.2021 - val_acc: 0.9434
Epoch 17/20
 - 4s - loss: 0.1626 - acc: 0.9526 - val_loss: 0.1121 - val_acc: 0.9676
Epoch 18/20
 - 4s - loss: 0.1660 - acc: 0.9529 - val_loss: 0.1077 - val_acc: 0.9698
Epoch 19/20
 - 4s - loss: 0.1663 - acc: 0.9532 - val_loss: 0.1248 - val_acc: 0.9646
Epoch 20/20
 - 4s - loss: 0.1628 - acc: 0.9545 - val_loss: 0.1039 - val_acc: 0.9679
Test loss: 0.10436556004600134
Test accuracy: 0.9675
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9331 - acc: 0.7009 - val_loss: 0.4351 - val_acc: 0.8602
Epoch 2/20
 - 6s - loss: 0.4320 - acc: 0.8622 - val_loss: 0.2057 - val_acc: 0.9345
Epoch 3/20
 - 6s - loss: 0.3162 - acc: 0.9004 - val_loss: 0.1945 - val_acc: 0.9393
Epoch 4/20
 - 6s - loss: 0.2604 - acc: 0.9189 - val_loss: 0.1767 - val_acc: 0.9438
Epoch 5/20
 - 6s - loss: 0.2377 - acc: 0.9257 - val_loss: 0.1861 - val_acc: 0.9422
Epoch 6/20
 - 6s - loss: 0.2152 - acc: 0.9341 - val_loss: 0.1501 - val_acc: 0.9538
Epoch 7/20
 - 6s - loss: 0.2002 - acc: 0.9388 - val_loss: 0.1327 - val_acc: 0.9607
Epoch 8/20
 - 6s - loss: 0.1902 - acc: 0.9407 - val_loss: 0.1546 - val_acc: 0.9495
Epoch 9/20
 - 6s - loss: 0.1849 - acc: 0.9445 - val_loss: 0.1142 - val_acc: 0.9624
Epoch 10/20
 - 6s - loss: 0.1765 - acc: 0.9475 - val_loss: 0.1147 - val_acc: 0.9668
Epoch 11/20
 - 6s - loss: 0.1774 - acc: 0.9489 - val_loss: 0.1320 - val_acc: 0.9611
Epoch 12/20
 - 6s - loss: 0.1740 - acc: 0.9488 - val_loss: 0.1419 - val_acc: 0.9598
Epoch 13/20
 - 6s - loss: 0.1664 - acc: 0.9512 - val_loss: 0.1108 - val_acc: 0.9644
Epoch 14/20
 - 6s - loss: 0.1713 - acc: 0.9513 - val_loss: 0.1078 - val_acc: 0.9653
Epoch 15/20
 - 6s - loss: 0.1674 - acc: 0.9511 - val_loss: 0.1032 - val_acc: 0.9715
Epoch 16/20
 - 6s - loss: 0.1630 - acc: 0.9533 - val_loss: 0.1050 - val_acc: 0.9712
Epoch 17/20
 - 6s - loss: 0.1673 - acc: 0.9533 - val_loss: 0.1780 - val_acc: 0.9580
Epoch 18/20
 - 6s - loss: 0.1632 - acc: 0.9553 - val_loss: 0.1082 - val_acc: 0.9705
Epoch 19/20
 - 6s - loss: 0.1670 - acc: 0.9543 - val_loss: 0.1087 - val_acc: 0.9709
Epoch 20/20
 - 6s - loss: 0.1680 - acc: 0.9545 - val_loss: 0.1174 - val_acc: 0.9667
Test loss: 0.11841166587451007
Test accuracy: 0.967
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9360 - acc: 0.6999 - val_loss: 0.7635 - val_acc: 0.7670
Epoch 2/20
 - 9s - loss: 0.4428 - acc: 0.8598 - val_loss: 0.5554 - val_acc: 0.8327
Epoch 3/20
 - 9s - loss: 0.3271 - acc: 0.8975 - val_loss: 0.2890 - val_acc: 0.9118
Epoch 4/20
 - 9s - loss: 0.2712 - acc: 0.9146 - val_loss: 0.2084 - val_acc: 0.9300
Epoch 5/20
 - 9s - loss: 0.2381 - acc: 0.9267 - val_loss: 0.1628 - val_acc: 0.9488
Epoch 6/20
 - 9s - loss: 0.2200 - acc: 0.9328 - val_loss: 0.1461 - val_acc: 0.9550
Epoch 7/20
 - 9s - loss: 0.2048 - acc: 0.9373 - val_loss: 0.1232 - val_acc: 0.9610
Epoch 8/20
 - 9s - loss: 0.1927 - acc: 0.9412 - val_loss: 0.1940 - val_acc: 0.9387
Epoch 9/20
 - 9s - loss: 0.1799 - acc: 0.9451 - val_loss: 0.1397 - val_acc: 0.9583
Epoch 10/20
 - 9s - loss: 0.1798 - acc: 0.9467 - val_loss: 0.1180 - val_acc: 0.9640
Epoch 11/20
 - 9s - loss: 0.1787 - acc: 0.9468 - val_loss: 0.1654 - val_acc: 0.9519
Epoch 12/20
 - 9s - loss: 0.1736 - acc: 0.9488 - val_loss: 0.0950 - val_acc: 0.9719
Epoch 13/20
 - 9s - loss: 0.1709 - acc: 0.9500 - val_loss: 0.1299 - val_acc: 0.9606
Epoch 14/20
 - 9s - loss: 0.1708 - acc: 0.9509 - val_loss: 0.1151 - val_acc: 0.9675
Epoch 15/20
 - 9s - loss: 0.1723 - acc: 0.9509 - val_loss: 0.1279 - val_acc: 0.9614
Epoch 16/20
 - 9s - loss: 0.1688 - acc: 0.9522 - val_loss: 0.1014 - val_acc: 0.9685
Epoch 17/20
 - 9s - loss: 0.1678 - acc: 0.9526 - val_loss: 0.1357 - val_acc: 0.9612
Epoch 18/20
 - 9s - loss: 0.1672 - acc: 0.9532 - val_loss: 0.1255 - val_acc: 0.9639
Epoch 19/20
 - 9s - loss: 0.1686 - acc: 0.9525 - val_loss: 0.1148 - val_acc: 0.9679
Epoch 20/20
 - 9s - loss: 0.1607 - acc: 0.9558 - val_loss: 0.1564 - val_acc: 0.9608
Test loss: 0.1571674453941203
Test accuracy: 0.9608
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9223 - acc: 0.7016 - val_loss: 0.6303 - val_acc: 0.8170
Epoch 2/20
 - 14s - loss: 0.4349 - acc: 0.8611 - val_loss: 0.2893 - val_acc: 0.9089
Epoch 3/20
 - 14s - loss: 0.3218 - acc: 0.8991 - val_loss: 0.3129 - val_acc: 0.8924
Epoch 4/20
 - 14s - loss: 0.2648 - acc: 0.9151 - val_loss: 0.2804 - val_acc: 0.9098
Epoch 5/20
 - 14s - loss: 0.2360 - acc: 0.9259 - val_loss: 0.1936 - val_acc: 0.9415
Epoch 6/20
 - 14s - loss: 0.2194 - acc: 0.9331 - val_loss: 0.1371 - val_acc: 0.9546
Epoch 7/20
 - 14s - loss: 0.2002 - acc: 0.9390 - val_loss: 0.1491 - val_acc: 0.9543
Epoch 8/20
 - 14s - loss: 0.1898 - acc: 0.9426 - val_loss: 0.1598 - val_acc: 0.9488
Epoch 9/20
 - 14s - loss: 0.1836 - acc: 0.9445 - val_loss: 0.1000 - val_acc: 0.9699
Epoch 10/20
 - 14s - loss: 0.1754 - acc: 0.9475 - val_loss: 0.1152 - val_acc: 0.9644
Epoch 11/20
 - 14s - loss: 0.1740 - acc: 0.9484 - val_loss: 0.1056 - val_acc: 0.9688
Epoch 12/20
 - 14s - loss: 0.1683 - acc: 0.9501 - val_loss: 0.1174 - val_acc: 0.9609
Epoch 13/20
 - 14s - loss: 0.1685 - acc: 0.9503 - val_loss: 0.1186 - val_acc: 0.9646
Epoch 14/20
 - 14s - loss: 0.1599 - acc: 0.9538 - val_loss: 0.1610 - val_acc: 0.9545
Epoch 15/20
 - 14s - loss: 0.1612 - acc: 0.9526 - val_loss: 0.1536 - val_acc: 0.9590
Epoch 16/20
 - 14s - loss: 0.1631 - acc: 0.9538 - val_loss: 0.0997 - val_acc: 0.9714
Epoch 17/20
 - 14s - loss: 0.1590 - acc: 0.9542 - val_loss: 0.1466 - val_acc: 0.9619
Epoch 18/20
 - 14s - loss: 0.1650 - acc: 0.9540 - val_loss: 0.1076 - val_acc: 0.9690
Epoch 19/20
 - 14s - loss: 0.1609 - acc: 0.9549 - val_loss: 0.0971 - val_acc: 0.9721
Epoch 20/20
 - 14s - loss: 0.1624 - acc: 0.9544 - val_loss: 0.0970 - val_acc: 0.9717
Test loss: 0.09702220958918333
Test accuracy: 0.972
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9296 - acc: 0.7038 - val_loss: 0.7329 - val_acc: 0.7613
Epoch 2/20
 - 26s - loss: 0.4248 - acc: 0.8651 - val_loss: 0.3094 - val_acc: 0.9042
Epoch 3/20
 - 26s - loss: 0.3141 - acc: 0.9011 - val_loss: 0.2344 - val_acc: 0.9249
Epoch 4/20
 - 26s - loss: 0.2624 - acc: 0.9186 - val_loss: 0.1816 - val_acc: 0.9394
Epoch 5/20
 - 26s - loss: 0.2318 - acc: 0.9286 - val_loss: 0.1601 - val_acc: 0.9496
Epoch 6/20
 - 26s - loss: 0.2125 - acc: 0.9344 - val_loss: 0.1563 - val_acc: 0.9500
Epoch 7/20
 - 26s - loss: 0.2032 - acc: 0.9383 - val_loss: 0.1482 - val_acc: 0.9551
Epoch 8/20
 - 26s - loss: 0.1928 - acc: 0.9417 - val_loss: 0.1318 - val_acc: 0.9587
Epoch 9/20
 - 26s - loss: 0.1820 - acc: 0.9445 - val_loss: 0.1447 - val_acc: 0.9542
Epoch 10/20
 - 26s - loss: 0.1790 - acc: 0.9468 - val_loss: 0.1257 - val_acc: 0.9621
Epoch 11/20
 - 26s - loss: 0.1730 - acc: 0.9482 - val_loss: 0.1118 - val_acc: 0.9647
Epoch 12/20
 - 26s - loss: 0.1719 - acc: 0.9505 - val_loss: 0.1341 - val_acc: 0.9591
Epoch 13/20
 - 26s - loss: 0.1694 - acc: 0.9511 - val_loss: 0.1423 - val_acc: 0.9557
Epoch 14/20
 - 26s - loss: 0.1649 - acc: 0.9512 - val_loss: 0.1043 - val_acc: 0.9678
Epoch 15/20
 - 26s - loss: 0.1634 - acc: 0.9529 - val_loss: 0.1077 - val_acc: 0.9702
Epoch 16/20
 - 26s - loss: 0.1640 - acc: 0.9531 - val_loss: 0.1026 - val_acc: 0.9711
Epoch 17/20
 - 26s - loss: 0.1649 - acc: 0.9539 - val_loss: 0.1220 - val_acc: 0.9637
Epoch 18/20
 - 26s - loss: 0.1629 - acc: 0.9548 - val_loss: 0.0985 - val_acc: 0.9701
Epoch 19/20
 - 26s - loss: 0.1660 - acc: 0.9530 - val_loss: 0.1068 - val_acc: 0.9693
Epoch 20/20
 - 26s - loss: 0.1644 - acc: 0.9539 - val_loss: 0.1091 - val_acc: 0.9667
Test loss: 0.10906551439855393
Test accuracy: 0.9669
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9600 - acc: 0.6915 - val_loss: 0.3346 - val_acc: 0.8969
Epoch 2/20
 - 3s - loss: 0.4490 - acc: 0.8567 - val_loss: 0.4733 - val_acc: 0.8493
Epoch 3/20
 - 3s - loss: 0.3387 - acc: 0.8928 - val_loss: 0.2106 - val_acc: 0.9304
Epoch 4/20
 - 3s - loss: 0.2861 - acc: 0.9099 - val_loss: 0.2399 - val_acc: 0.9252
Epoch 5/20
 - 3s - loss: 0.2564 - acc: 0.9210 - val_loss: 0.2012 - val_acc: 0.9369
Epoch 6/20
 - 3s - loss: 0.2413 - acc: 0.9265 - val_loss: 0.1391 - val_acc: 0.9560
Epoch 7/20
 - 3s - loss: 0.2262 - acc: 0.9304 - val_loss: 0.1556 - val_acc: 0.9531
Epoch 8/20
 - 3s - loss: 0.2149 - acc: 0.9329 - val_loss: 0.1364 - val_acc: 0.9586
Epoch 9/20
 - 3s - loss: 0.2074 - acc: 0.9374 - val_loss: 0.1498 - val_acc: 0.9528
Epoch 10/20
 - 3s - loss: 0.2051 - acc: 0.9404 - val_loss: 0.1419 - val_acc: 0.9587
Epoch 11/20
 - 3s - loss: 0.2035 - acc: 0.9401 - val_loss: 0.1295 - val_acc: 0.9591
Epoch 12/20
 - 3s - loss: 0.2000 - acc: 0.9409 - val_loss: 0.1512 - val_acc: 0.9542
Epoch 13/20
 - 3s - loss: 0.2023 - acc: 0.9430 - val_loss: 0.1174 - val_acc: 0.9633
Epoch 14/20
 - 3s - loss: 0.1993 - acc: 0.9428 - val_loss: 0.1541 - val_acc: 0.9543
Epoch 15/20
 - 3s - loss: 0.1965 - acc: 0.9434 - val_loss: 0.1490 - val_acc: 0.9562
Epoch 16/20
 - 3s - loss: 0.1981 - acc: 0.9447 - val_loss: 0.1279 - val_acc: 0.9633
Epoch 17/20
 - 3s - loss: 0.1966 - acc: 0.9448 - val_loss: 0.1320 - val_acc: 0.9626
Epoch 18/20
 - 3s - loss: 0.1982 - acc: 0.9452 - val_loss: 0.1264 - val_acc: 0.9666
Epoch 19/20
 - 3s - loss: 0.1962 - acc: 0.9457 - val_loss: 0.1268 - val_acc: 0.9618
Epoch 20/20
 - 3s - loss: 0.2004 - acc: 0.9437 - val_loss: 0.1942 - val_acc: 0.9414
Test loss: 0.18893799677863718
Test accuracy: 0.9408
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9522 - acc: 0.6933 - val_loss: 0.3606 - val_acc: 0.8858
Epoch 2/20
 - 3s - loss: 0.4543 - acc: 0.8537 - val_loss: 0.2691 - val_acc: 0.9158
Epoch 3/20
 - 3s - loss: 0.3386 - acc: 0.8934 - val_loss: 0.2437 - val_acc: 0.9239
Epoch 4/20
 - 3s - loss: 0.2847 - acc: 0.9098 - val_loss: 0.1588 - val_acc: 0.9483
Epoch 5/20
 - 3s - loss: 0.2559 - acc: 0.9204 - val_loss: 0.2569 - val_acc: 0.9164
Epoch 6/20
 - 3s - loss: 0.2289 - acc: 0.9281 - val_loss: 0.2116 - val_acc: 0.9333
Epoch 7/20
 - 3s - loss: 0.2197 - acc: 0.9310 - val_loss: 0.1658 - val_acc: 0.9498
Epoch 8/20
 - 3s - loss: 0.2095 - acc: 0.9360 - val_loss: 0.1830 - val_acc: 0.9422
Epoch 9/20
 - 3s - loss: 0.2005 - acc: 0.9393 - val_loss: 0.1193 - val_acc: 0.9625
Epoch 10/20
 - 3s - loss: 0.1935 - acc: 0.9418 - val_loss: 0.1355 - val_acc: 0.9594
Epoch 11/20
 - 3s - loss: 0.1900 - acc: 0.9437 - val_loss: 0.1307 - val_acc: 0.9594
Epoch 12/20
 - 3s - loss: 0.1860 - acc: 0.9445 - val_loss: 0.1488 - val_acc: 0.9554
Epoch 13/20
 - 3s - loss: 0.1834 - acc: 0.9462 - val_loss: 0.1618 - val_acc: 0.9491
Epoch 14/20
 - 3s - loss: 0.1849 - acc: 0.9464 - val_loss: 0.1060 - val_acc: 0.9668
Epoch 15/20
 - 3s - loss: 0.1813 - acc: 0.9467 - val_loss: 0.1145 - val_acc: 0.9665
Epoch 16/20
 - 3s - loss: 0.1812 - acc: 0.9480 - val_loss: 0.1131 - val_acc: 0.9645
Epoch 17/20
 - 3s - loss: 0.1782 - acc: 0.9482 - val_loss: 0.1051 - val_acc: 0.9690
Epoch 18/20
 - 3s - loss: 0.1803 - acc: 0.9488 - val_loss: 0.1046 - val_acc: 0.9673
Epoch 19/20
 - 3s - loss: 0.1850 - acc: 0.9488 - val_loss: 0.1423 - val_acc: 0.9604
Epoch 20/20
 - 3s - loss: 0.1786 - acc: 0.9489 - val_loss: 0.1143 - val_acc: 0.9661
Test loss: 0.11730348774553277
Test accuracy: 0.9653
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9298 - acc: 0.6952 - val_loss: 0.4104 - val_acc: 0.8771
Epoch 2/20
 - 3s - loss: 0.4430 - acc: 0.8580 - val_loss: 0.2217 - val_acc: 0.9313
Epoch 3/20
 - 3s - loss: 0.3283 - acc: 0.8957 - val_loss: 0.2610 - val_acc: 0.9142
Epoch 4/20
 - 3s - loss: 0.2874 - acc: 0.9113 - val_loss: 0.1794 - val_acc: 0.9447
Epoch 5/20
 - 3s - loss: 0.2446 - acc: 0.9244 - val_loss: 0.2391 - val_acc: 0.9201
Epoch 6/20
 - 3s - loss: 0.2251 - acc: 0.9310 - val_loss: 0.1868 - val_acc: 0.9423
Epoch 7/20
 - 3s - loss: 0.2107 - acc: 0.9360 - val_loss: 0.1898 - val_acc: 0.9398
Epoch 8/20
 - 3s - loss: 0.2017 - acc: 0.9375 - val_loss: 0.1312 - val_acc: 0.9591
Epoch 9/20
 - 3s - loss: 0.1937 - acc: 0.9422 - val_loss: 0.1487 - val_acc: 0.9549
Epoch 10/20
 - 3s - loss: 0.1873 - acc: 0.9433 - val_loss: 0.1186 - val_acc: 0.9639
Epoch 11/20
 - 3s - loss: 0.1824 - acc: 0.9454 - val_loss: 0.1120 - val_acc: 0.9660
Epoch 12/20
 - 3s - loss: 0.1757 - acc: 0.9472 - val_loss: 0.1314 - val_acc: 0.9618
Epoch 13/20
 - 3s - loss: 0.1780 - acc: 0.9482 - val_loss: 0.1330 - val_acc: 0.9605
Epoch 14/20
 - 3s - loss: 0.1720 - acc: 0.9492 - val_loss: 0.1103 - val_acc: 0.9675
Epoch 15/20
 - 3s - loss: 0.1736 - acc: 0.9500 - val_loss: 0.1023 - val_acc: 0.9697
Epoch 16/20
 - 3s - loss: 0.1706 - acc: 0.9491 - val_loss: 0.1285 - val_acc: 0.9638
Epoch 17/20
 - 3s - loss: 0.1711 - acc: 0.9509 - val_loss: 0.0946 - val_acc: 0.9721
Epoch 18/20
 - 3s - loss: 0.1686 - acc: 0.9516 - val_loss: 0.1840 - val_acc: 0.9434
Epoch 19/20
 - 3s - loss: 0.1674 - acc: 0.9514 - val_loss: 0.1189 - val_acc: 0.9690
Epoch 20/20
 - 3s - loss: 0.1669 - acc: 0.9523 - val_loss: 0.1548 - val_acc: 0.9551
Test loss: 0.15278467052141204
Test accuracy: 0.9548
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9201 - acc: 0.6999 - val_loss: 0.5196 - val_acc: 0.8305
Epoch 2/20
 - 3s - loss: 0.4390 - acc: 0.8592 - val_loss: 0.3277 - val_acc: 0.8940
Epoch 3/20
 - 3s - loss: 0.3325 - acc: 0.8965 - val_loss: 0.2074 - val_acc: 0.9372
Epoch 4/20
 - 3s - loss: 0.2756 - acc: 0.9138 - val_loss: 0.1740 - val_acc: 0.9463
Epoch 5/20
 - 3s - loss: 0.2429 - acc: 0.9249 - val_loss: 0.1553 - val_acc: 0.9531
Epoch 6/20
 - 3s - loss: 0.2253 - acc: 0.9304 - val_loss: 0.1457 - val_acc: 0.9549
Epoch 7/20
 - 3s - loss: 0.2045 - acc: 0.9363 - val_loss: 0.1523 - val_acc: 0.9520
Epoch 8/20
 - 3s - loss: 0.1975 - acc: 0.9390 - val_loss: 0.1522 - val_acc: 0.9503
Epoch 9/20
 - 3s - loss: 0.1896 - acc: 0.9427 - val_loss: 0.1609 - val_acc: 0.9500
Epoch 10/20
 - 3s - loss: 0.1791 - acc: 0.9459 - val_loss: 0.1665 - val_acc: 0.9517
Epoch 11/20
 - 3s - loss: 0.1767 - acc: 0.9466 - val_loss: 0.1444 - val_acc: 0.9535
Epoch 12/20
 - 3s - loss: 0.1725 - acc: 0.9481 - val_loss: 0.1474 - val_acc: 0.9531
Epoch 13/20
 - 3s - loss: 0.1667 - acc: 0.9505 - val_loss: 0.1868 - val_acc: 0.9391
Epoch 14/20
 - 3s - loss: 0.1747 - acc: 0.9489 - val_loss: 0.0980 - val_acc: 0.9684
Epoch 15/20
 - 3s - loss: 0.1656 - acc: 0.9520 - val_loss: 0.1164 - val_acc: 0.9644
Epoch 16/20
 - 3s - loss: 0.1642 - acc: 0.9519 - val_loss: 0.1023 - val_acc: 0.9710
Epoch 17/20
 - 3s - loss: 0.1617 - acc: 0.9533 - val_loss: 0.1291 - val_acc: 0.9620
Epoch 18/20
 - 3s - loss: 0.1625 - acc: 0.9533 - val_loss: 0.1023 - val_acc: 0.9705
Epoch 19/20
 - 3s - loss: 0.1585 - acc: 0.9551 - val_loss: 0.1096 - val_acc: 0.9689
Epoch 20/20
 - 3s - loss: 0.1642 - acc: 0.9531 - val_loss: 0.1025 - val_acc: 0.9701
Test loss: 0.10142706967270933
Test accuracy: 0.9694
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9315 - acc: 0.6974 - val_loss: 0.3521 - val_acc: 0.8869
Epoch 2/20
 - 4s - loss: 0.4354 - acc: 0.8618 - val_loss: 0.2890 - val_acc: 0.9058
Epoch 3/20
 - 4s - loss: 0.3184 - acc: 0.9003 - val_loss: 0.2257 - val_acc: 0.9272
Epoch 4/20
 - 4s - loss: 0.2684 - acc: 0.9166 - val_loss: 0.2022 - val_acc: 0.9386
Epoch 5/20
 - 4s - loss: 0.2347 - acc: 0.9274 - val_loss: 0.4138 - val_acc: 0.8623
Epoch 6/20
 - 4s - loss: 0.2131 - acc: 0.9360 - val_loss: 0.3184 - val_acc: 0.8904
Epoch 7/20
 - 4s - loss: 0.1999 - acc: 0.9386 - val_loss: 0.1344 - val_acc: 0.9568
Epoch 8/20
 - 4s - loss: 0.1909 - acc: 0.9428 - val_loss: 0.1672 - val_acc: 0.9501
Epoch 9/20
 - 4s - loss: 0.1862 - acc: 0.9448 - val_loss: 0.1111 - val_acc: 0.9638
Epoch 10/20
 - 4s - loss: 0.1743 - acc: 0.9471 - val_loss: 0.1617 - val_acc: 0.9509
Epoch 11/20
 - 4s - loss: 0.1762 - acc: 0.9473 - val_loss: 0.1717 - val_acc: 0.9501
Epoch 12/20
 - 4s - loss: 0.1720 - acc: 0.9495 - val_loss: 0.1767 - val_acc: 0.9535
Epoch 13/20
 - 4s - loss: 0.1690 - acc: 0.9499 - val_loss: 0.1152 - val_acc: 0.9670
Epoch 14/20
 - 4s - loss: 0.1667 - acc: 0.9521 - val_loss: 0.1348 - val_acc: 0.9602
Epoch 15/20
 - 4s - loss: 0.1644 - acc: 0.9544 - val_loss: 0.1111 - val_acc: 0.9681
Epoch 16/20
 - 4s - loss: 0.1673 - acc: 0.9527 - val_loss: 0.1176 - val_acc: 0.9640
Epoch 17/20
 - 4s - loss: 0.1639 - acc: 0.9539 - val_loss: 0.1201 - val_acc: 0.9677
Epoch 18/20
 - 4s - loss: 0.1649 - acc: 0.9538 - val_loss: 0.0959 - val_acc: 0.9729
Epoch 19/20
 - 4s - loss: 0.1676 - acc: 0.9536 - val_loss: 0.0921 - val_acc: 0.9734
Epoch 20/20
 - 4s - loss: 0.1666 - acc: 0.9543 - val_loss: 0.1042 - val_acc: 0.9701
Test loss: 0.10457566480997484
Test accuracy: 0.9688
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9245 - acc: 0.6999 - val_loss: 0.3665 - val_acc: 0.8841
Epoch 2/20
 - 4s - loss: 0.4357 - acc: 0.8610 - val_loss: 0.3120 - val_acc: 0.9025
Epoch 3/20
 - 4s - loss: 0.3159 - acc: 0.9004 - val_loss: 0.2477 - val_acc: 0.9228
Epoch 4/20
 - 4s - loss: 0.2651 - acc: 0.9170 - val_loss: 0.2225 - val_acc: 0.9302
Epoch 5/20
 - 4s - loss: 0.2329 - acc: 0.9272 - val_loss: 0.1321 - val_acc: 0.9577
Epoch 6/20
 - 4s - loss: 0.2136 - acc: 0.9337 - val_loss: 0.1334 - val_acc: 0.9572
Epoch 7/20
 - 4s - loss: 0.2041 - acc: 0.9383 - val_loss: 0.1733 - val_acc: 0.9456
Epoch 8/20
 - 4s - loss: 0.1926 - acc: 0.9412 - val_loss: 0.1397 - val_acc: 0.9569
Epoch 9/20
 - 4s - loss: 0.1817 - acc: 0.9446 - val_loss: 0.1433 - val_acc: 0.9601
Epoch 10/20
 - 4s - loss: 0.1774 - acc: 0.9468 - val_loss: 0.1063 - val_acc: 0.9694
Epoch 11/20
 - 4s - loss: 0.1747 - acc: 0.9486 - val_loss: 0.1093 - val_acc: 0.9663
Epoch 12/20
 - 4s - loss: 0.1754 - acc: 0.9489 - val_loss: 0.1300 - val_acc: 0.9588
Epoch 13/20
 - 4s - loss: 0.1644 - acc: 0.9521 - val_loss: 0.1260 - val_acc: 0.9605
Epoch 14/20
 - 4s - loss: 0.1666 - acc: 0.9518 - val_loss: 0.0996 - val_acc: 0.9716
Epoch 15/20
 - 4s - loss: 0.1642 - acc: 0.9521 - val_loss: 0.1090 - val_acc: 0.9668
Epoch 16/20
 - 4s - loss: 0.1667 - acc: 0.9523 - val_loss: 0.0972 - val_acc: 0.9725
Epoch 17/20
 - 4s - loss: 0.1634 - acc: 0.9536 - val_loss: 0.1115 - val_acc: 0.9680
Epoch 18/20
 - 4s - loss: 0.1625 - acc: 0.9537 - val_loss: 0.1484 - val_acc: 0.9607
Epoch 19/20
 - 4s - loss: 0.1639 - acc: 0.9541 - val_loss: 0.1085 - val_acc: 0.9662
Epoch 20/20
 - 4s - loss: 0.1653 - acc: 0.9539 - val_loss: 0.1460 - val_acc: 0.9640
Test loss: 0.14619169510006286
Test accuracy: 0.9642
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9290 - acc: 0.7017 - val_loss: 0.5352 - val_acc: 0.8168
Epoch 2/20
 - 6s - loss: 0.4316 - acc: 0.8633 - val_loss: 0.5740 - val_acc: 0.8249
Epoch 3/20
 - 6s - loss: 0.3263 - acc: 0.8959 - val_loss: 0.1828 - val_acc: 0.9419
Epoch 4/20
 - 6s - loss: 0.2679 - acc: 0.9157 - val_loss: 0.2365 - val_acc: 0.9252
Epoch 5/20
 - 6s - loss: 0.2355 - acc: 0.9264 - val_loss: 0.1482 - val_acc: 0.9538
Epoch 6/20
 - 6s - loss: 0.2165 - acc: 0.9338 - val_loss: 0.1532 - val_acc: 0.9562
Epoch 7/20
 - 6s - loss: 0.1999 - acc: 0.9386 - val_loss: 0.1122 - val_acc: 0.9656
Epoch 8/20
 - 6s - loss: 0.1975 - acc: 0.9412 - val_loss: 0.1472 - val_acc: 0.9569
Epoch 9/20
 - 6s - loss: 0.1835 - acc: 0.9454 - val_loss: 0.1717 - val_acc: 0.9464
Epoch 10/20
 - 6s - loss: 0.1797 - acc: 0.9461 - val_loss: 0.1236 - val_acc: 0.9644
Epoch 11/20
 - 6s - loss: 0.1775 - acc: 0.9472 - val_loss: 0.1515 - val_acc: 0.9579
Epoch 12/20
 - 6s - loss: 0.1755 - acc: 0.9485 - val_loss: 0.1202 - val_acc: 0.9639
Epoch 13/20
 - 6s - loss: 0.1698 - acc: 0.9506 - val_loss: 0.1225 - val_acc: 0.9655
Epoch 14/20
 - 6s - loss: 0.1650 - acc: 0.9531 - val_loss: 0.1527 - val_acc: 0.9579
Epoch 15/20
 - 6s - loss: 0.1673 - acc: 0.9530 - val_loss: 0.1256 - val_acc: 0.9608
Epoch 16/20
 - 6s - loss: 0.1684 - acc: 0.9515 - val_loss: 0.1035 - val_acc: 0.9719
Epoch 17/20
 - 6s - loss: 0.1668 - acc: 0.9531 - val_loss: 0.1814 - val_acc: 0.9481
Epoch 18/20
 - 6s - loss: 0.1682 - acc: 0.9528 - val_loss: 0.1322 - val_acc: 0.9653
Epoch 19/20
 - 6s - loss: 0.1678 - acc: 0.9527 - val_loss: 0.1242 - val_acc: 0.9613
Epoch 20/20
 - 6s - loss: 0.1632 - acc: 0.9537 - val_loss: 0.1113 - val_acc: 0.9669
Test loss: 0.11138387088860618
Test accuracy: 0.9677
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9394 - acc: 0.6960 - val_loss: 0.3736 - val_acc: 0.8872
Epoch 2/20
 - 9s - loss: 0.4306 - acc: 0.8629 - val_loss: 0.3118 - val_acc: 0.9006
Epoch 3/20
 - 9s - loss: 0.3233 - acc: 0.8987 - val_loss: 0.1778 - val_acc: 0.9449
Epoch 4/20
 - 9s - loss: 0.2702 - acc: 0.9170 - val_loss: 0.1494 - val_acc: 0.9533
Epoch 5/20
 - 9s - loss: 0.2372 - acc: 0.9262 - val_loss: 0.1738 - val_acc: 0.9454
Epoch 6/20
 - 9s - loss: 0.2177 - acc: 0.9330 - val_loss: 0.1420 - val_acc: 0.9575
Epoch 7/20
 - 9s - loss: 0.2034 - acc: 0.9372 - val_loss: 0.1995 - val_acc: 0.9387
Epoch 8/20
 - 9s - loss: 0.1923 - acc: 0.9401 - val_loss: 0.1477 - val_acc: 0.9538
Epoch 9/20
 - 9s - loss: 0.1874 - acc: 0.9435 - val_loss: 0.1551 - val_acc: 0.9540
Epoch 10/20
 - 9s - loss: 0.1769 - acc: 0.9474 - val_loss: 0.1138 - val_acc: 0.9676
Epoch 11/20
 - 9s - loss: 0.1748 - acc: 0.9483 - val_loss: 0.1181 - val_acc: 0.9655
Epoch 12/20
 - 9s - loss: 0.1665 - acc: 0.9504 - val_loss: 0.1069 - val_acc: 0.9676
Epoch 13/20
 - 9s - loss: 0.1701 - acc: 0.9499 - val_loss: 0.1039 - val_acc: 0.9697
Epoch 14/20
 - 9s - loss: 0.1627 - acc: 0.9517 - val_loss: 0.1207 - val_acc: 0.9646
Epoch 15/20
 - 9s - loss: 0.1678 - acc: 0.9507 - val_loss: 0.1591 - val_acc: 0.9553
Epoch 16/20
 - 9s - loss: 0.1638 - acc: 0.9542 - val_loss: 0.1640 - val_acc: 0.9559
Epoch 17/20
 - 9s - loss: 0.1616 - acc: 0.9528 - val_loss: 0.1149 - val_acc: 0.9691
Epoch 18/20
 - 9s - loss: 0.1630 - acc: 0.9541 - val_loss: 0.1499 - val_acc: 0.9591
Epoch 19/20
 - 9s - loss: 0.1623 - acc: 0.9555 - val_loss: 0.1054 - val_acc: 0.9689
Epoch 20/20
 - 9s - loss: 0.1635 - acc: 0.9544 - val_loss: 0.1193 - val_acc: 0.9671
Test loss: 0.11947056132405559
Test accuracy: 0.9663
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9345 - acc: 0.6989 - val_loss: 0.3387 - val_acc: 0.8959
Epoch 2/20
 - 14s - loss: 0.4292 - acc: 0.8626 - val_loss: 0.3917 - val_acc: 0.8725
Epoch 3/20
 - 14s - loss: 0.3220 - acc: 0.8998 - val_loss: 0.2592 - val_acc: 0.9214
Epoch 4/20
 - 14s - loss: 0.2703 - acc: 0.9156 - val_loss: 0.2725 - val_acc: 0.9129
Epoch 5/20
 - 14s - loss: 0.2394 - acc: 0.9262 - val_loss: 0.3441 - val_acc: 0.8984
Epoch 6/20
 - 14s - loss: 0.2174 - acc: 0.9338 - val_loss: 0.2005 - val_acc: 0.9356
Epoch 7/20
 - 14s - loss: 0.2028 - acc: 0.9392 - val_loss: 0.1284 - val_acc: 0.9605
Epoch 8/20
 - 15s - loss: 0.1904 - acc: 0.9422 - val_loss: 0.1410 - val_acc: 0.9553
Epoch 9/20
 - 14s - loss: 0.1845 - acc: 0.9436 - val_loss: 0.1207 - val_acc: 0.9615
Epoch 10/20
 - 14s - loss: 0.1766 - acc: 0.9467 - val_loss: 0.1252 - val_acc: 0.9608
Epoch 11/20
 - 14s - loss: 0.1769 - acc: 0.9475 - val_loss: 0.1158 - val_acc: 0.9641
Epoch 12/20
 - 14s - loss: 0.1687 - acc: 0.9495 - val_loss: 0.1039 - val_acc: 0.9665
Epoch 13/20
 - 14s - loss: 0.1638 - acc: 0.9519 - val_loss: 0.1049 - val_acc: 0.9685
Epoch 14/20
 - 14s - loss: 0.1628 - acc: 0.9519 - val_loss: 0.0939 - val_acc: 0.9735
Epoch 15/20
 - 14s - loss: 0.1577 - acc: 0.9536 - val_loss: 0.0977 - val_acc: 0.9700
Epoch 16/20
 - 14s - loss: 0.1592 - acc: 0.9538 - val_loss: 0.1246 - val_acc: 0.9666
Epoch 17/20
 - 14s - loss: 0.1586 - acc: 0.9538 - val_loss: 0.0997 - val_acc: 0.9724
Epoch 18/20
 - 14s - loss: 0.1591 - acc: 0.9549 - val_loss: 0.1393 - val_acc: 0.9598
Epoch 19/20
 - 14s - loss: 0.1593 - acc: 0.9549 - val_loss: 0.1542 - val_acc: 0.9601
Epoch 20/20
 - 14s - loss: 0.1556 - acc: 0.9568 - val_loss: 0.1126 - val_acc: 0.9712
Test loss: 0.11282007510279508
Test accuracy: 0.9712
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9270 - acc: 0.7002 - val_loss: 0.6178 - val_acc: 0.8006
Epoch 2/20
 - 26s - loss: 0.4321 - acc: 0.8630 - val_loss: 0.2778 - val_acc: 0.9125
Epoch 3/20
 - 26s - loss: 0.3209 - acc: 0.8995 - val_loss: 0.1758 - val_acc: 0.9444
Epoch 4/20
 - 26s - loss: 0.2649 - acc: 0.9174 - val_loss: 0.2708 - val_acc: 0.9067
Epoch 5/20
 - 26s - loss: 0.2375 - acc: 0.9267 - val_loss: 0.1574 - val_acc: 0.9502
Epoch 6/20
 - 26s - loss: 0.2138 - acc: 0.9346 - val_loss: 0.1498 - val_acc: 0.9567
Epoch 7/20
 - 26s - loss: 0.1998 - acc: 0.9397 - val_loss: 0.2088 - val_acc: 0.9316
Epoch 8/20
 - 26s - loss: 0.1904 - acc: 0.9427 - val_loss: 0.1147 - val_acc: 0.9637
Epoch 9/20
 - 26s - loss: 0.1793 - acc: 0.9455 - val_loss: 0.1125 - val_acc: 0.9660
Epoch 10/20
 - 26s - loss: 0.1718 - acc: 0.9479 - val_loss: 0.1177 - val_acc: 0.9661
Epoch 11/20
 - 26s - loss: 0.1687 - acc: 0.9492 - val_loss: 0.1145 - val_acc: 0.9657
Epoch 12/20
 - 26s - loss: 0.1625 - acc: 0.9509 - val_loss: 0.1008 - val_acc: 0.9699
Epoch 13/20
 - 26s - loss: 0.1662 - acc: 0.9510 - val_loss: 0.1090 - val_acc: 0.9675
Epoch 14/20
 - 26s - loss: 0.1612 - acc: 0.9530 - val_loss: 0.1212 - val_acc: 0.9686
Epoch 15/20
 - 26s - loss: 0.1591 - acc: 0.9542 - val_loss: 0.1090 - val_acc: 0.9687
Epoch 16/20
 - 26s - loss: 0.1612 - acc: 0.9540 - val_loss: 0.0952 - val_acc: 0.9710
Epoch 17/20
 - 26s - loss: 0.1599 - acc: 0.9540 - val_loss: 0.0964 - val_acc: 0.9730
Epoch 18/20
 - 26s - loss: 0.1533 - acc: 0.9568 - val_loss: 0.1236 - val_acc: 0.9689
Epoch 19/20
 - 26s - loss: 0.1560 - acc: 0.9551 - val_loss: 0.1241 - val_acc: 0.9616
Epoch 20/20
 - 26s - loss: 0.1586 - acc: 0.9553 - val_loss: 0.1212 - val_acc: 0.9681
Test loss: 0.12127464425064537
Test accuracy: 0.9679
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9582 - acc: 0.6944 - val_loss: 0.8532 - val_acc: 0.7379
Epoch 2/20
 - 3s - loss: 0.4598 - acc: 0.8527 - val_loss: 0.3256 - val_acc: 0.8931
Epoch 3/20
 - 3s - loss: 0.3471 - acc: 0.8894 - val_loss: 0.2039 - val_acc: 0.9367
Epoch 4/20
 - 3s - loss: 0.2972 - acc: 0.9066 - val_loss: 0.3230 - val_acc: 0.8954
Epoch 5/20
 - 3s - loss: 0.2612 - acc: 0.9180 - val_loss: 0.3436 - val_acc: 0.8926
Epoch 6/20
 - 3s - loss: 0.2440 - acc: 0.9238 - val_loss: 0.1345 - val_acc: 0.9582
Epoch 7/20
 - 3s - loss: 0.2315 - acc: 0.9288 - val_loss: 0.1653 - val_acc: 0.9484
Epoch 8/20
 - 3s - loss: 0.2200 - acc: 0.9324 - val_loss: 0.1781 - val_acc: 0.9469
Epoch 9/20
 - 3s - loss: 0.2090 - acc: 0.9362 - val_loss: 0.1418 - val_acc: 0.9581
Epoch 10/20
 - 3s - loss: 0.2041 - acc: 0.9388 - val_loss: 0.1199 - val_acc: 0.9617
Epoch 11/20
 - 3s - loss: 0.2014 - acc: 0.9396 - val_loss: 0.1267 - val_acc: 0.9602
Epoch 12/20
 - 3s - loss: 0.1984 - acc: 0.9408 - val_loss: 0.1352 - val_acc: 0.9574
Epoch 13/20
 - 3s - loss: 0.1990 - acc: 0.9417 - val_loss: 0.1259 - val_acc: 0.9640
Epoch 14/20
 - 3s - loss: 0.1943 - acc: 0.9441 - val_loss: 0.1147 - val_acc: 0.9658
Epoch 15/20
 - 3s - loss: 0.1998 - acc: 0.9419 - val_loss: 0.1280 - val_acc: 0.9613
Epoch 16/20
 - 3s - loss: 0.1971 - acc: 0.9439 - val_loss: 0.2214 - val_acc: 0.9458
Epoch 17/20
 - 3s - loss: 0.1979 - acc: 0.9437 - val_loss: 0.1167 - val_acc: 0.9656
Epoch 18/20
 - 3s - loss: 0.1962 - acc: 0.9439 - val_loss: 0.1391 - val_acc: 0.9587
Epoch 19/20
 - 3s - loss: 0.1932 - acc: 0.9448 - val_loss: 0.1239 - val_acc: 0.9624
Epoch 20/20
 - 3s - loss: 0.1954 - acc: 0.9449 - val_loss: 0.1408 - val_acc: 0.9597
Test loss: 0.1355211067963857
Test accuracy: 0.9586
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9519 - acc: 0.6910 - val_loss: 0.8038 - val_acc: 0.7043
Epoch 2/20
 - 3s - loss: 0.4483 - acc: 0.8567 - val_loss: 0.3610 - val_acc: 0.8851
Epoch 3/20
 - 3s - loss: 0.3362 - acc: 0.8931 - val_loss: 0.2282 - val_acc: 0.9308
Epoch 4/20
 - 3s - loss: 0.2832 - acc: 0.9115 - val_loss: 0.2230 - val_acc: 0.9314
Epoch 5/20
 - 3s - loss: 0.2487 - acc: 0.9232 - val_loss: 0.2151 - val_acc: 0.9326
Epoch 6/20
 - 3s - loss: 0.2308 - acc: 0.9275 - val_loss: 0.1862 - val_acc: 0.9424
Epoch 7/20
 - 3s - loss: 0.2196 - acc: 0.9315 - val_loss: 0.1312 - val_acc: 0.9589
Epoch 8/20
 - 3s - loss: 0.2056 - acc: 0.9375 - val_loss: 0.1627 - val_acc: 0.9490
Epoch 9/20
 - 3s - loss: 0.1971 - acc: 0.9406 - val_loss: 0.1304 - val_acc: 0.9592
Epoch 10/20
 - 3s - loss: 0.1894 - acc: 0.9424 - val_loss: 0.1209 - val_acc: 0.9628
Epoch 11/20
 - 3s - loss: 0.1860 - acc: 0.9439 - val_loss: 0.1325 - val_acc: 0.9579
Epoch 12/20
 - 3s - loss: 0.1855 - acc: 0.9460 - val_loss: 0.1107 - val_acc: 0.9683
Epoch 13/20
 - 3s - loss: 0.1830 - acc: 0.9457 - val_loss: 0.1458 - val_acc: 0.9584
Epoch 14/20
 - 3s - loss: 0.1814 - acc: 0.9471 - val_loss: 0.1493 - val_acc: 0.9580
Epoch 15/20
 - 3s - loss: 0.1801 - acc: 0.9476 - val_loss: 0.2083 - val_acc: 0.9373
Epoch 16/20
 - 3s - loss: 0.1809 - acc: 0.9477 - val_loss: 0.1101 - val_acc: 0.9661
Epoch 17/20
 - 3s - loss: 0.1800 - acc: 0.9485 - val_loss: 0.1166 - val_acc: 0.9656
Epoch 18/20
 - 3s - loss: 0.1802 - acc: 0.9489 - val_loss: 0.1161 - val_acc: 0.9670
Epoch 19/20
 - 3s - loss: 0.1734 - acc: 0.9509 - val_loss: 0.1369 - val_acc: 0.9574
Epoch 20/20
 - 3s - loss: 0.1809 - acc: 0.9503 - val_loss: 0.1161 - val_acc: 0.9645
Test loss: 0.12286198753253556
Test accuracy: 0.9623
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9361 - acc: 0.6963 - val_loss: 0.9086 - val_acc: 0.7014
Epoch 2/20
 - 3s - loss: 0.4436 - acc: 0.8576 - val_loss: 0.3024 - val_acc: 0.9010
Epoch 3/20
 - 3s - loss: 0.3314 - acc: 0.8963 - val_loss: 0.2606 - val_acc: 0.9164
Epoch 4/20
 - 3s - loss: 0.2724 - acc: 0.9141 - val_loss: 0.1954 - val_acc: 0.9358
Epoch 5/20
 - 3s - loss: 0.2409 - acc: 0.9247 - val_loss: 0.2431 - val_acc: 0.9251
Epoch 6/20
 - 3s - loss: 0.2195 - acc: 0.9328 - val_loss: 0.1969 - val_acc: 0.9370
Epoch 7/20
 - 3s - loss: 0.2060 - acc: 0.9365 - val_loss: 0.1345 - val_acc: 0.9579
Epoch 8/20
 - 3s - loss: 0.1994 - acc: 0.9394 - val_loss: 0.1670 - val_acc: 0.9479
Epoch 9/20
 - 3s - loss: 0.1878 - acc: 0.9435 - val_loss: 0.1406 - val_acc: 0.9566
Epoch 10/20
 - 3s - loss: 0.1805 - acc: 0.9449 - val_loss: 0.1265 - val_acc: 0.9611
Epoch 11/20
 - 3s - loss: 0.1753 - acc: 0.9485 - val_loss: 0.1521 - val_acc: 0.9496
Epoch 12/20
 - 3s - loss: 0.1750 - acc: 0.9482 - val_loss: 0.1327 - val_acc: 0.9619
Epoch 13/20
 - 3s - loss: 0.1752 - acc: 0.9472 - val_loss: 0.1228 - val_acc: 0.9627
Epoch 14/20
 - 3s - loss: 0.1704 - acc: 0.9514 - val_loss: 0.1320 - val_acc: 0.9606
Epoch 15/20
 - 3s - loss: 0.1697 - acc: 0.9508 - val_loss: 0.1212 - val_acc: 0.9649
Epoch 16/20
 - 3s - loss: 0.1688 - acc: 0.9516 - val_loss: 0.1511 - val_acc: 0.9582
Epoch 17/20
 - 3s - loss: 0.1697 - acc: 0.9527 - val_loss: 0.1417 - val_acc: 0.9611
Epoch 18/20
 - 3s - loss: 0.1664 - acc: 0.9531 - val_loss: 0.1154 - val_acc: 0.9663
Epoch 19/20
 - 3s - loss: 0.1667 - acc: 0.9521 - val_loss: 0.1630 - val_acc: 0.9585
Epoch 20/20
 - 3s - loss: 0.1721 - acc: 0.9520 - val_loss: 0.1260 - val_acc: 0.9644
Test loss: 0.12701510807633168
Test accuracy: 0.9645
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9598 - acc: 0.6984 - val_loss: 0.4470 - val_acc: 0.8572
Epoch 2/20
 - 3s - loss: 0.4309 - acc: 0.8647 - val_loss: 0.3364 - val_acc: 0.8899
Epoch 3/20
 - 3s - loss: 0.3278 - acc: 0.8969 - val_loss: 0.2919 - val_acc: 0.8988
Epoch 4/20
 - 3s - loss: 0.2753 - acc: 0.9140 - val_loss: 0.3340 - val_acc: 0.8888
Epoch 5/20
 - 3s - loss: 0.2432 - acc: 0.9241 - val_loss: 0.2104 - val_acc: 0.9318
Epoch 6/20
 - 3s - loss: 0.2252 - acc: 0.9307 - val_loss: 0.2120 - val_acc: 0.9323
Epoch 7/20
 - 3s - loss: 0.2106 - acc: 0.9351 - val_loss: 0.1410 - val_acc: 0.9550
Epoch 8/20
 - 3s - loss: 0.1991 - acc: 0.9396 - val_loss: 0.2459 - val_acc: 0.9292
Epoch 9/20
 - 3s - loss: 0.1880 - acc: 0.9429 - val_loss: 0.1542 - val_acc: 0.9499
Epoch 10/20
 - 3s - loss: 0.1814 - acc: 0.9453 - val_loss: 0.1444 - val_acc: 0.9550
Epoch 11/20
 - 3s - loss: 0.1772 - acc: 0.9472 - val_loss: 0.1309 - val_acc: 0.9647
Epoch 12/20
 - 3s - loss: 0.1789 - acc: 0.9469 - val_loss: 0.1290 - val_acc: 0.9610
Epoch 13/20
 - 3s - loss: 0.1718 - acc: 0.9498 - val_loss: 0.1186 - val_acc: 0.9648
Epoch 14/20
 - 3s - loss: 0.1718 - acc: 0.9492 - val_loss: 0.1229 - val_acc: 0.9607
Epoch 15/20
 - 3s - loss: 0.1704 - acc: 0.9514 - val_loss: 0.1387 - val_acc: 0.9600
Epoch 16/20
 - 3s - loss: 0.1696 - acc: 0.9504 - val_loss: 0.1105 - val_acc: 0.9694
Epoch 17/20
 - 3s - loss: 0.1688 - acc: 0.9514 - val_loss: 0.1158 - val_acc: 0.9675
Epoch 18/20
 - 3s - loss: 0.1676 - acc: 0.9527 - val_loss: 0.1359 - val_acc: 0.9625
Epoch 19/20
 - 3s - loss: 0.1676 - acc: 0.9527 - val_loss: 0.1351 - val_acc: 0.9666
Epoch 20/20
 - 3s - loss: 0.1697 - acc: 0.9528 - val_loss: 0.1162 - val_acc: 0.9639
Test loss: 0.1144919853896834
Test accuracy: 0.9633
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9108 - acc: 0.7064 - val_loss: 0.4620 - val_acc: 0.8432
Epoch 2/20
 - 4s - loss: 0.4313 - acc: 0.8639 - val_loss: 0.3146 - val_acc: 0.8933
Epoch 3/20
 - 4s - loss: 0.3209 - acc: 0.8975 - val_loss: 0.1957 - val_acc: 0.9412
Epoch 4/20
 - 4s - loss: 0.2669 - acc: 0.9162 - val_loss: 0.2108 - val_acc: 0.9300
Epoch 5/20
 - 4s - loss: 0.2351 - acc: 0.9267 - val_loss: 0.1731 - val_acc: 0.9488
Epoch 6/20
 - 4s - loss: 0.2149 - acc: 0.9347 - val_loss: 0.1396 - val_acc: 0.9580
Epoch 7/20
 - 4s - loss: 0.1996 - acc: 0.9387 - val_loss: 0.1501 - val_acc: 0.9535
Epoch 8/20
 - 4s - loss: 0.1928 - acc: 0.9419 - val_loss: 0.1510 - val_acc: 0.9525
Epoch 9/20
 - 4s - loss: 0.1844 - acc: 0.9453 - val_loss: 0.1072 - val_acc: 0.9677
Epoch 10/20
 - 4s - loss: 0.1805 - acc: 0.9469 - val_loss: 0.1532 - val_acc: 0.9542
Epoch 11/20
 - 4s - loss: 0.1727 - acc: 0.9482 - val_loss: 0.1219 - val_acc: 0.9609
Epoch 12/20
 - 4s - loss: 0.1697 - acc: 0.9497 - val_loss: 0.1247 - val_acc: 0.9629
Epoch 13/20
 - 4s - loss: 0.1692 - acc: 0.9503 - val_loss: 0.1003 - val_acc: 0.9705
Epoch 14/20
 - 4s - loss: 0.1659 - acc: 0.9512 - val_loss: 0.0992 - val_acc: 0.9698
Epoch 15/20
 - 4s - loss: 0.1673 - acc: 0.9515 - val_loss: 0.1053 - val_acc: 0.9703
Epoch 16/20
 - 4s - loss: 0.1648 - acc: 0.9536 - val_loss: 0.1364 - val_acc: 0.9654
Epoch 17/20
 - 4s - loss: 0.1598 - acc: 0.9540 - val_loss: 0.1513 - val_acc: 0.9604
Epoch 18/20
 - 4s - loss: 0.1649 - acc: 0.9542 - val_loss: 0.1097 - val_acc: 0.9698
Epoch 19/20
 - 4s - loss: 0.1688 - acc: 0.9531 - val_loss: 0.0996 - val_acc: 0.9731
Epoch 20/20
 - 4s - loss: 0.1676 - acc: 0.9540 - val_loss: 0.1381 - val_acc: 0.9584
Test loss: 0.13757389136301354
Test accuracy: 0.9581
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9517 - acc: 0.6969 - val_loss: 0.5231 - val_acc: 0.8158
Epoch 2/20
 - 4s - loss: 0.4346 - acc: 0.8617 - val_loss: 0.2503 - val_acc: 0.9251
Epoch 3/20
 - 4s - loss: 0.3247 - acc: 0.8967 - val_loss: 0.2991 - val_acc: 0.8942
Epoch 4/20
 - 4s - loss: 0.2737 - acc: 0.9143 - val_loss: 0.1992 - val_acc: 0.9402
Epoch 5/20
 - 4s - loss: 0.2392 - acc: 0.9247 - val_loss: 0.1535 - val_acc: 0.9524
Epoch 6/20
 - 4s - loss: 0.2177 - acc: 0.9323 - val_loss: 0.1321 - val_acc: 0.9588
Epoch 7/20
 - 4s - loss: 0.2038 - acc: 0.9373 - val_loss: 0.1537 - val_acc: 0.9566
Epoch 8/20
 - 4s - loss: 0.1902 - acc: 0.9423 - val_loss: 0.1370 - val_acc: 0.9586
Epoch 9/20
 - 4s - loss: 0.1889 - acc: 0.9436 - val_loss: 0.1447 - val_acc: 0.9557
Epoch 10/20
 - 4s - loss: 0.1769 - acc: 0.9461 - val_loss: 0.1102 - val_acc: 0.9660
Epoch 11/20
 - 4s - loss: 0.1713 - acc: 0.9493 - val_loss: 0.1243 - val_acc: 0.9621
Epoch 12/20
 - 4s - loss: 0.1663 - acc: 0.9504 - val_loss: 0.1316 - val_acc: 0.9611
Epoch 13/20
 - 4s - loss: 0.1712 - acc: 0.9504 - val_loss: 0.1000 - val_acc: 0.9686
Epoch 14/20
 - 4s - loss: 0.1629 - acc: 0.9521 - val_loss: 0.1259 - val_acc: 0.9626
Epoch 15/20
 - 4s - loss: 0.1634 - acc: 0.9526 - val_loss: 0.1330 - val_acc: 0.9626
Epoch 16/20
 - 4s - loss: 0.1607 - acc: 0.9532 - val_loss: 0.1265 - val_acc: 0.9621
Epoch 17/20
 - 4s - loss: 0.1606 - acc: 0.9535 - val_loss: 0.1474 - val_acc: 0.9574
Epoch 18/20
 - 4s - loss: 0.1599 - acc: 0.9545 - val_loss: 0.1332 - val_acc: 0.9549
Epoch 19/20
 - 4s - loss: 0.1555 - acc: 0.9563 - val_loss: 0.1155 - val_acc: 0.9690
Epoch 20/20
 - 4s - loss: 0.1603 - acc: 0.9551 - val_loss: 0.1351 - val_acc: 0.9608
Test loss: 0.13470616239733646
Test accuracy: 0.9622
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9627 - acc: 0.6914 - val_loss: 0.4238 - val_acc: 0.8670
Epoch 2/20
 - 6s - loss: 0.4353 - acc: 0.8612 - val_loss: 0.3125 - val_acc: 0.9029
Epoch 3/20
 - 6s - loss: 0.3263 - acc: 0.8983 - val_loss: 0.1996 - val_acc: 0.9341
Epoch 4/20
 - 6s - loss: 0.2734 - acc: 0.9149 - val_loss: 0.1809 - val_acc: 0.9428
Epoch 5/20
 - 6s - loss: 0.2389 - acc: 0.9252 - val_loss: 0.1434 - val_acc: 0.9542
Epoch 6/20
 - 6s - loss: 0.2156 - acc: 0.9336 - val_loss: 0.2308 - val_acc: 0.9275
Epoch 7/20
 - 6s - loss: 0.2021 - acc: 0.9379 - val_loss: 0.1141 - val_acc: 0.9639
Epoch 8/20
 - 6s - loss: 0.1920 - acc: 0.9427 - val_loss: 0.1226 - val_acc: 0.9626
Epoch 9/20
 - 6s - loss: 0.1818 - acc: 0.9449 - val_loss: 0.3486 - val_acc: 0.8829
Epoch 10/20
 - 6s - loss: 0.1797 - acc: 0.9455 - val_loss: 0.1134 - val_acc: 0.9681
Epoch 11/20
 - 6s - loss: 0.1750 - acc: 0.9486 - val_loss: 0.1258 - val_acc: 0.9625
Epoch 12/20
 - 6s - loss: 0.1673 - acc: 0.9500 - val_loss: 0.1305 - val_acc: 0.9604
Epoch 13/20
 - 6s - loss: 0.1671 - acc: 0.9505 - val_loss: 0.1419 - val_acc: 0.9556
Epoch 14/20
 - 6s - loss: 0.1657 - acc: 0.9510 - val_loss: 0.1339 - val_acc: 0.9655
Epoch 15/20
 - 6s - loss: 0.1624 - acc: 0.9532 - val_loss: 0.1415 - val_acc: 0.9569
Epoch 16/20
 - 6s - loss: 0.1659 - acc: 0.9532 - val_loss: 0.1017 - val_acc: 0.9685
Epoch 17/20
 - 6s - loss: 0.1650 - acc: 0.9537 - val_loss: 0.1116 - val_acc: 0.9693
Epoch 18/20
 - 6s - loss: 0.1683 - acc: 0.9533 - val_loss: 0.0909 - val_acc: 0.9715
Epoch 19/20
 - 6s - loss: 0.1654 - acc: 0.9539 - val_loss: 0.1145 - val_acc: 0.9670
Epoch 20/20
 - 6s - loss: 0.1652 - acc: 0.9540 - val_loss: 0.1475 - val_acc: 0.9623
Test loss: 0.14768691010959883
Test accuracy: 0.9627
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9608 - acc: 0.6957 - val_loss: 0.5067 - val_acc: 0.8298
Epoch 2/20
 - 9s - loss: 0.4353 - acc: 0.8603 - val_loss: 0.3539 - val_acc: 0.8841
Epoch 3/20
 - 9s - loss: 0.3198 - acc: 0.8991 - val_loss: 0.1567 - val_acc: 0.9489
Epoch 4/20
 - 9s - loss: 0.2629 - acc: 0.9172 - val_loss: 0.1820 - val_acc: 0.9415
Epoch 5/20
 - 9s - loss: 0.2338 - acc: 0.9281 - val_loss: 0.1451 - val_acc: 0.9524
Epoch 6/20
 - 9s - loss: 0.2105 - acc: 0.9347 - val_loss: 0.1589 - val_acc: 0.9472
Epoch 7/20
 - 9s - loss: 0.1998 - acc: 0.9389 - val_loss: 0.1151 - val_acc: 0.9654
Epoch 8/20
 - 9s - loss: 0.1910 - acc: 0.9416 - val_loss: 0.1201 - val_acc: 0.9642
Epoch 9/20
 - 9s - loss: 0.1824 - acc: 0.9454 - val_loss: 0.1029 - val_acc: 0.9688
Epoch 10/20
 - 9s - loss: 0.1775 - acc: 0.9466 - val_loss: 0.1494 - val_acc: 0.9562
Epoch 11/20
 - 9s - loss: 0.1718 - acc: 0.9493 - val_loss: 0.1101 - val_acc: 0.9666
Epoch 12/20
 - 9s - loss: 0.1703 - acc: 0.9498 - val_loss: 0.1111 - val_acc: 0.9684
Epoch 13/20
 - 9s - loss: 0.1707 - acc: 0.9505 - val_loss: 0.1086 - val_acc: 0.9660
Epoch 14/20
 - 9s - loss: 0.1695 - acc: 0.9515 - val_loss: 0.0788 - val_acc: 0.9751
Epoch 15/20
 - 9s - loss: 0.1667 - acc: 0.9524 - val_loss: 0.0927 - val_acc: 0.9707
Epoch 16/20
 - 9s - loss: 0.1652 - acc: 0.9531 - val_loss: 0.0957 - val_acc: 0.9713
Epoch 17/20
 - 9s - loss: 0.1638 - acc: 0.9543 - val_loss: 0.1256 - val_acc: 0.9659
Epoch 18/20
 - 9s - loss: 0.1710 - acc: 0.9514 - val_loss: 0.1065 - val_acc: 0.9701
Epoch 19/20
 - 9s - loss: 0.1666 - acc: 0.9537 - val_loss: 0.1226 - val_acc: 0.9697
Epoch 20/20
 - 9s - loss: 0.1657 - acc: 0.9540 - val_loss: 0.0941 - val_acc: 0.9737
Test loss: 0.09442284493033803
Test accuracy: 0.9744
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9351 - acc: 0.7017 - val_loss: 0.5357 - val_acc: 0.8326
Epoch 2/20
 - 14s - loss: 0.4326 - acc: 0.8619 - val_loss: 0.2934 - val_acc: 0.9045
Epoch 3/20
 - 14s - loss: 0.3290 - acc: 0.8966 - val_loss: 0.2121 - val_acc: 0.9294
Epoch 4/20
 - 14s - loss: 0.2712 - acc: 0.9160 - val_loss: 0.2704 - val_acc: 0.9152
Epoch 5/20
 - 14s - loss: 0.2381 - acc: 0.9265 - val_loss: 0.1564 - val_acc: 0.9520
Epoch 6/20
 - 15s - loss: 0.2152 - acc: 0.9330 - val_loss: 0.1484 - val_acc: 0.9542
Epoch 7/20
 - 14s - loss: 0.2010 - acc: 0.9377 - val_loss: 0.1429 - val_acc: 0.9543
Epoch 8/20
 - 14s - loss: 0.1926 - acc: 0.9413 - val_loss: 0.1794 - val_acc: 0.9436
Epoch 9/20
 - 15s - loss: 0.1839 - acc: 0.9439 - val_loss: 0.1144 - val_acc: 0.9637
Epoch 10/20
 - 15s - loss: 0.1776 - acc: 0.9461 - val_loss: 0.1225 - val_acc: 0.9625
Epoch 11/20
 - 14s - loss: 0.1705 - acc: 0.9490 - val_loss: 0.1354 - val_acc: 0.9568
Epoch 12/20
 - 14s - loss: 0.1707 - acc: 0.9497 - val_loss: 0.1212 - val_acc: 0.9627
Epoch 13/20
 - 14s - loss: 0.1677 - acc: 0.9512 - val_loss: 0.1065 - val_acc: 0.9670
Epoch 14/20
 - 14s - loss: 0.1638 - acc: 0.9520 - val_loss: 0.1485 - val_acc: 0.9578
Epoch 15/20
 - 14s - loss: 0.1636 - acc: 0.9530 - val_loss: 0.1144 - val_acc: 0.9666
Epoch 16/20
 - 15s - loss: 0.1632 - acc: 0.9531 - val_loss: 0.1210 - val_acc: 0.9685
Epoch 17/20
 - 14s - loss: 0.1637 - acc: 0.9528 - val_loss: 0.1454 - val_acc: 0.9610
Epoch 18/20
 - 14s - loss: 0.1614 - acc: 0.9545 - val_loss: 0.1657 - val_acc: 0.9502
Epoch 19/20
 - 14s - loss: 0.1581 - acc: 0.9548 - val_loss: 0.0934 - val_acc: 0.9730
Epoch 20/20
 - 14s - loss: 0.1618 - acc: 0.9553 - val_loss: 0.0962 - val_acc: 0.9727
Test loss: 0.09626069094957493
Test accuracy: 0.9728
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9272 - acc: 0.7018 - val_loss: 0.4724 - val_acc: 0.8461
Epoch 2/20
 - 26s - loss: 0.4387 - acc: 0.8591 - val_loss: 0.2635 - val_acc: 0.9118
Epoch 3/20
 - 26s - loss: 0.3255 - acc: 0.8978 - val_loss: 0.2326 - val_acc: 0.9224
Epoch 4/20
 - 26s - loss: 0.2687 - acc: 0.9164 - val_loss: 0.2377 - val_acc: 0.9271
Epoch 5/20
 - 26s - loss: 0.2364 - acc: 0.9277 - val_loss: 0.1795 - val_acc: 0.9430
Epoch 6/20
 - 26s - loss: 0.2169 - acc: 0.9339 - val_loss: 0.1589 - val_acc: 0.9506
Epoch 7/20
 - 26s - loss: 0.2032 - acc: 0.9374 - val_loss: 0.1598 - val_acc: 0.9530
Epoch 8/20
 - 26s - loss: 0.1923 - acc: 0.9421 - val_loss: 0.1718 - val_acc: 0.9484
Epoch 9/20
 - 26s - loss: 0.1860 - acc: 0.9443 - val_loss: 0.1175 - val_acc: 0.9646
Epoch 10/20
 - 26s - loss: 0.1780 - acc: 0.9462 - val_loss: 0.1156 - val_acc: 0.9645
Epoch 11/20
 - 26s - loss: 0.1769 - acc: 0.9486 - val_loss: 0.1159 - val_acc: 0.9641
Epoch 12/20
 - 26s - loss: 0.1711 - acc: 0.9488 - val_loss: 0.1587 - val_acc: 0.9530
Epoch 13/20
 - 26s - loss: 0.1703 - acc: 0.9510 - val_loss: 0.1096 - val_acc: 0.9670
Epoch 14/20
 - 26s - loss: 0.1671 - acc: 0.9514 - val_loss: 0.1191 - val_acc: 0.9639
Epoch 15/20
 - 26s - loss: 0.1638 - acc: 0.9524 - val_loss: 0.1239 - val_acc: 0.9639
Epoch 16/20
 - 26s - loss: 0.1651 - acc: 0.9534 - val_loss: 0.1102 - val_acc: 0.9672
Epoch 17/20
 - 26s - loss: 0.1596 - acc: 0.9541 - val_loss: 0.1404 - val_acc: 0.9613
Epoch 18/20
 - 26s - loss: 0.1633 - acc: 0.9537 - val_loss: 0.0944 - val_acc: 0.9703
Epoch 19/20
 - 26s - loss: 0.1653 - acc: 0.9535 - val_loss: 0.1305 - val_acc: 0.9598
Epoch 20/20
 - 26s - loss: 0.1627 - acc: 0.9542 - val_loss: 0.0890 - val_acc: 0.9743
Test loss: 0.08896470490696375
Test accuracy: 0.9748
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9627 - acc: 0.6882 - val_loss: 0.4673 - val_acc: 0.8406
Epoch 2/20
 - 3s - loss: 0.4559 - acc: 0.8541 - val_loss: 0.3417 - val_acc: 0.8898
Epoch 3/20
 - 3s - loss: 0.3441 - acc: 0.8909 - val_loss: 0.3311 - val_acc: 0.8890
Epoch 4/20
 - 3s - loss: 0.2924 - acc: 0.9083 - val_loss: 0.1735 - val_acc: 0.9461
Epoch 5/20
 - 3s - loss: 0.2610 - acc: 0.9174 - val_loss: 0.1852 - val_acc: 0.9425
Epoch 6/20
 - 3s - loss: 0.2430 - acc: 0.9254 - val_loss: 0.1708 - val_acc: 0.9472
Epoch 7/20
 - 3s - loss: 0.2276 - acc: 0.9295 - val_loss: 0.1443 - val_acc: 0.9544
Epoch 8/20
 - 3s - loss: 0.2197 - acc: 0.9330 - val_loss: 0.1751 - val_acc: 0.9465
Epoch 9/20
 - 3s - loss: 0.2102 - acc: 0.9366 - val_loss: 0.1765 - val_acc: 0.9449
Epoch 10/20
 - 3s - loss: 0.2078 - acc: 0.9377 - val_loss: 0.1437 - val_acc: 0.9541
Epoch 11/20
 - 3s - loss: 0.2014 - acc: 0.9401 - val_loss: 0.1341 - val_acc: 0.9585
Epoch 12/20
 - 3s - loss: 0.2008 - acc: 0.9412 - val_loss: 0.2636 - val_acc: 0.9349
Epoch 13/20
 - 3s - loss: 0.2010 - acc: 0.9412 - val_loss: 0.1652 - val_acc: 0.9543
Epoch 14/20
 - 3s - loss: 0.1972 - acc: 0.9431 - val_loss: 0.1722 - val_acc: 0.9480
Epoch 15/20
 - 3s - loss: 0.1990 - acc: 0.9422 - val_loss: 0.1187 - val_acc: 0.9637
Epoch 16/20
 - 3s - loss: 0.1932 - acc: 0.9450 - val_loss: 0.1266 - val_acc: 0.9651
Epoch 17/20
 - 3s - loss: 0.2020 - acc: 0.9422 - val_loss: 0.1590 - val_acc: 0.9585
Epoch 18/20
 - 3s - loss: 0.1996 - acc: 0.9432 - val_loss: 0.1220 - val_acc: 0.9643
Epoch 19/20
 - 3s - loss: 0.2009 - acc: 0.9435 - val_loss: 0.1288 - val_acc: 0.9629
Epoch 20/20
 - 3s - loss: 0.1969 - acc: 0.9457 - val_loss: 0.1692 - val_acc: 0.9538
Test loss: 0.16478315147385075
Test accuracy: 0.9549
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9628 - acc: 0.6882 - val_loss: 0.4359 - val_acc: 0.8490
Epoch 2/20
 - 3s - loss: 0.4432 - acc: 0.8576 - val_loss: 0.2753 - val_acc: 0.9130
Epoch 3/20
 - 3s - loss: 0.3354 - acc: 0.8935 - val_loss: 0.2778 - val_acc: 0.9111
Epoch 4/20
 - 3s - loss: 0.2802 - acc: 0.9123 - val_loss: 0.2040 - val_acc: 0.9336
Epoch 5/20
 - 3s - loss: 0.2474 - acc: 0.9222 - val_loss: 0.1741 - val_acc: 0.9424
Epoch 6/20
 - 3s - loss: 0.2315 - acc: 0.9281 - val_loss: 0.1554 - val_acc: 0.9511
Epoch 7/20
 - 3s - loss: 0.2118 - acc: 0.9344 - val_loss: 0.1610 - val_acc: 0.9495
Epoch 8/20
 - 3s - loss: 0.2028 - acc: 0.9381 - val_loss: 0.1517 - val_acc: 0.9516
Epoch 9/20
 - 3s - loss: 0.1981 - acc: 0.9397 - val_loss: 0.1130 - val_acc: 0.9650
Epoch 10/20
 - 3s - loss: 0.1880 - acc: 0.9435 - val_loss: 0.1436 - val_acc: 0.9591
Epoch 11/20
 - 3s - loss: 0.1913 - acc: 0.9431 - val_loss: 0.1106 - val_acc: 0.9657
Epoch 12/20
 - 3s - loss: 0.1837 - acc: 0.9458 - val_loss: 0.1043 - val_acc: 0.9685
Epoch 13/20
 - 3s - loss: 0.1809 - acc: 0.9471 - val_loss: 0.1430 - val_acc: 0.9583
Epoch 14/20
 - 3s - loss: 0.1760 - acc: 0.9483 - val_loss: 0.1809 - val_acc: 0.9473
Epoch 15/20
 - 3s - loss: 0.1782 - acc: 0.9479 - val_loss: 0.1130 - val_acc: 0.9692
Epoch 16/20
 - 3s - loss: 0.1785 - acc: 0.9498 - val_loss: 0.1105 - val_acc: 0.9674
Epoch 17/20
 - 3s - loss: 0.1734 - acc: 0.9497 - val_loss: 0.1653 - val_acc: 0.9566
Epoch 18/20
 - 3s - loss: 0.1798 - acc: 0.9491 - val_loss: 0.1283 - val_acc: 0.9607
Epoch 19/20
 - 3s - loss: 0.1817 - acc: 0.9490 - val_loss: 0.1179 - val_acc: 0.9655
Epoch 20/20
 - 3s - loss: 0.1793 - acc: 0.9494 - val_loss: 0.1335 - val_acc: 0.9617
Test loss: 0.13576876541869132
Test accuracy: 0.9612
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9278 - acc: 0.6974 - val_loss: 0.5087 - val_acc: 0.8240
Epoch 2/20
 - 3s - loss: 0.4380 - acc: 0.8599 - val_loss: 0.2672 - val_acc: 0.9104
Epoch 3/20
 - 3s - loss: 0.3271 - acc: 0.8962 - val_loss: 0.2775 - val_acc: 0.9098
Epoch 4/20
 - 3s - loss: 0.2733 - acc: 0.9141 - val_loss: 0.2827 - val_acc: 0.9111
Epoch 5/20
 - 3s - loss: 0.2446 - acc: 0.9237 - val_loss: 0.2299 - val_acc: 0.9291
Epoch 6/20
 - 3s - loss: 0.2249 - acc: 0.9308 - val_loss: 0.1536 - val_acc: 0.9539
Epoch 7/20
 - 3s - loss: 0.2042 - acc: 0.9370 - val_loss: 0.1516 - val_acc: 0.9535
Epoch 8/20
 - 3s - loss: 0.1994 - acc: 0.9394 - val_loss: 0.1698 - val_acc: 0.9449
Epoch 9/20
 - 3s - loss: 0.1930 - acc: 0.9420 - val_loss: 0.1212 - val_acc: 0.9640
Epoch 10/20
 - 3s - loss: 0.1824 - acc: 0.9452 - val_loss: 0.1148 - val_acc: 0.9643
Epoch 11/20
 - 3s - loss: 0.1774 - acc: 0.9463 - val_loss: 0.1510 - val_acc: 0.9537
Epoch 12/20
 - 3s - loss: 0.1731 - acc: 0.9478 - val_loss: 0.1348 - val_acc: 0.9570
Epoch 13/20
 - 3s - loss: 0.1765 - acc: 0.9483 - val_loss: 0.1186 - val_acc: 0.9647
Epoch 14/20
 - 3s - loss: 0.1723 - acc: 0.9502 - val_loss: 0.1108 - val_acc: 0.9673
Epoch 15/20
 - 3s - loss: 0.1665 - acc: 0.9515 - val_loss: 0.1212 - val_acc: 0.9650
Epoch 16/20
 - 3s - loss: 0.1659 - acc: 0.9511 - val_loss: 0.1220 - val_acc: 0.9651
Epoch 17/20
 - 3s - loss: 0.1703 - acc: 0.9521 - val_loss: 0.1580 - val_acc: 0.9626
Epoch 18/20
 - 3s - loss: 0.1678 - acc: 0.9531 - val_loss: 0.1222 - val_acc: 0.9647
Epoch 19/20
 - 3s - loss: 0.1666 - acc: 0.9530 - val_loss: 0.1037 - val_acc: 0.9698
Epoch 20/20
 - 3s - loss: 0.1711 - acc: 0.9521 - val_loss: 0.1442 - val_acc: 0.9592
Test loss: 0.14312245338913054
Test accuracy: 0.9589
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9317 - acc: 0.6966 - val_loss: 0.4144 - val_acc: 0.8604
Epoch 2/20
 - 3s - loss: 0.4348 - acc: 0.8609 - val_loss: 0.2285 - val_acc: 0.9265
Epoch 3/20
 - 3s - loss: 0.3228 - acc: 0.8986 - val_loss: 0.2112 - val_acc: 0.9304
Epoch 4/20
 - 3s - loss: 0.2715 - acc: 0.9138 - val_loss: 0.1700 - val_acc: 0.9481
Epoch 5/20
 - 3s - loss: 0.2399 - acc: 0.9254 - val_loss: 0.1625 - val_acc: 0.9486
Epoch 6/20
 - 3s - loss: 0.2200 - acc: 0.9312 - val_loss: 0.1692 - val_acc: 0.9445
Epoch 7/20
 - 3s - loss: 0.2053 - acc: 0.9376 - val_loss: 0.1342 - val_acc: 0.9582
Epoch 8/20
 - 3s - loss: 0.1947 - acc: 0.9407 - val_loss: 0.1754 - val_acc: 0.9456
Epoch 9/20
 - 3s - loss: 0.1896 - acc: 0.9436 - val_loss: 0.1160 - val_acc: 0.9655
Epoch 10/20
 - 3s - loss: 0.1852 - acc: 0.9452 - val_loss: 0.1199 - val_acc: 0.9615
Epoch 11/20
 - 3s - loss: 0.1796 - acc: 0.9466 - val_loss: 0.1434 - val_acc: 0.9591
Epoch 12/20
 - 3s - loss: 0.1748 - acc: 0.9476 - val_loss: 0.1841 - val_acc: 0.9470
Epoch 13/20
 - 3s - loss: 0.1749 - acc: 0.9496 - val_loss: 0.1480 - val_acc: 0.9489
Epoch 14/20
 - 3s - loss: 0.1726 - acc: 0.9494 - val_loss: 0.1103 - val_acc: 0.9674
Epoch 15/20
 - 3s - loss: 0.1771 - acc: 0.9487 - val_loss: 0.1455 - val_acc: 0.9587
Epoch 16/20
 - 3s - loss: 0.1726 - acc: 0.9508 - val_loss: 0.1153 - val_acc: 0.9662
Epoch 17/20
 - 3s - loss: 0.1760 - acc: 0.9500 - val_loss: 0.1487 - val_acc: 0.9548
Epoch 18/20
 - 3s - loss: 0.1747 - acc: 0.9504 - val_loss: 0.1200 - val_acc: 0.9654
Epoch 19/20
 - 3s - loss: 0.1703 - acc: 0.9523 - val_loss: 0.0951 - val_acc: 0.9730
Epoch 20/20
 - 3s - loss: 0.1749 - acc: 0.9520 - val_loss: 0.1320 - val_acc: 0.9630
Test loss: 0.13526416964302188
Test accuracy: 0.9627
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9509 - acc: 0.6965 - val_loss: 0.3961 - val_acc: 0.8759
Epoch 2/20
 - 4s - loss: 0.4363 - acc: 0.8607 - val_loss: 0.3612 - val_acc: 0.8793
Epoch 3/20
 - 4s - loss: 0.3260 - acc: 0.8977 - val_loss: 0.1746 - val_acc: 0.9426
Epoch 4/20
 - 4s - loss: 0.2661 - acc: 0.9162 - val_loss: 0.2088 - val_acc: 0.9337
Epoch 5/20
 - 4s - loss: 0.2341 - acc: 0.9274 - val_loss: 0.1473 - val_acc: 0.9537
Epoch 6/20
 - 4s - loss: 0.2160 - acc: 0.9340 - val_loss: 0.1342 - val_acc: 0.9578
Epoch 7/20
 - 4s - loss: 0.1992 - acc: 0.9388 - val_loss: 0.1444 - val_acc: 0.9564
Epoch 8/20
 - 4s - loss: 0.1895 - acc: 0.9429 - val_loss: 0.1214 - val_acc: 0.9628
Epoch 9/20
 - 4s - loss: 0.1855 - acc: 0.9445 - val_loss: 0.1325 - val_acc: 0.9593
Epoch 10/20
 - 4s - loss: 0.1794 - acc: 0.9465 - val_loss: 0.1303 - val_acc: 0.9588
Epoch 11/20
 - 4s - loss: 0.1781 - acc: 0.9477 - val_loss: 0.1499 - val_acc: 0.9540
Epoch 12/20
 - 4s - loss: 0.1703 - acc: 0.9499 - val_loss: 0.0918 - val_acc: 0.9743
Epoch 13/20
 - 4s - loss: 0.1661 - acc: 0.9514 - val_loss: 0.1508 - val_acc: 0.9578
Epoch 14/20
 - 4s - loss: 0.1686 - acc: 0.9512 - val_loss: 0.1054 - val_acc: 0.9687
Epoch 15/20
 - 4s - loss: 0.1647 - acc: 0.9531 - val_loss: 0.1037 - val_acc: 0.9706
Epoch 16/20
 - 4s - loss: 0.1682 - acc: 0.9522 - val_loss: 0.1169 - val_acc: 0.9671
Epoch 17/20
 - 4s - loss: 0.1650 - acc: 0.9538 - val_loss: 0.1117 - val_acc: 0.9698
Epoch 18/20
 - 4s - loss: 0.1667 - acc: 0.9533 - val_loss: 0.1109 - val_acc: 0.9688
Epoch 19/20
 - 4s - loss: 0.1705 - acc: 0.9545 - val_loss: 0.1196 - val_acc: 0.9681
Epoch 20/20
 - 4s - loss: 0.1647 - acc: 0.9542 - val_loss: 0.1016 - val_acc: 0.9705
Test loss: 0.10210483753748703
Test accuracy: 0.969
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9495 - acc: 0.6952 - val_loss: 0.5355 - val_acc: 0.8198
Epoch 2/20
 - 4s - loss: 0.4222 - acc: 0.8653 - val_loss: 0.2959 - val_acc: 0.9087
Epoch 3/20
 - 4s - loss: 0.3147 - acc: 0.9004 - val_loss: 0.1749 - val_acc: 0.9471
Epoch 4/20
 - 4s - loss: 0.2642 - acc: 0.9178 - val_loss: 0.1642 - val_acc: 0.9475
Epoch 5/20
 - 4s - loss: 0.2319 - acc: 0.9274 - val_loss: 0.2342 - val_acc: 0.9257
Epoch 6/20
 - 4s - loss: 0.2141 - acc: 0.9341 - val_loss: 0.1515 - val_acc: 0.9530
Epoch 7/20
 - 4s - loss: 0.2001 - acc: 0.9390 - val_loss: 0.1207 - val_acc: 0.9630
Epoch 8/20
 - 4s - loss: 0.1919 - acc: 0.9428 - val_loss: 0.1162 - val_acc: 0.9642
Epoch 9/20
 - 4s - loss: 0.1835 - acc: 0.9446 - val_loss: 0.1442 - val_acc: 0.9592
Epoch 10/20
 - 4s - loss: 0.1750 - acc: 0.9470 - val_loss: 0.1335 - val_acc: 0.9601
Epoch 11/20
 - 4s - loss: 0.1769 - acc: 0.9482 - val_loss: 0.1553 - val_acc: 0.9516
Epoch 12/20
 - 4s - loss: 0.1712 - acc: 0.9502 - val_loss: 0.1102 - val_acc: 0.9654
Epoch 13/20
 - 4s - loss: 0.1726 - acc: 0.9504 - val_loss: 0.1687 - val_acc: 0.9536
Epoch 14/20
 - 4s - loss: 0.1693 - acc: 0.9501 - val_loss: 0.1074 - val_acc: 0.9676
Epoch 15/20
 - 4s - loss: 0.1644 - acc: 0.9530 - val_loss: 0.1100 - val_acc: 0.9693
Epoch 16/20
 - 4s - loss: 0.1675 - acc: 0.9523 - val_loss: 0.2565 - val_acc: 0.9406
Epoch 17/20
 - 4s - loss: 0.1711 - acc: 0.9522 - val_loss: 0.1156 - val_acc: 0.9643
Epoch 18/20
 - 4s - loss: 0.1672 - acc: 0.9528 - val_loss: 0.1214 - val_acc: 0.9620
Epoch 19/20
 - 4s - loss: 0.1700 - acc: 0.9528 - val_loss: 0.1348 - val_acc: 0.9606
Epoch 20/20
 - 4s - loss: 0.1682 - acc: 0.9536 - val_loss: 0.1034 - val_acc: 0.9693
Test loss: 0.10400951988510787
Test accuracy: 0.968
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9408 - acc: 0.6985 - val_loss: 0.3557 - val_acc: 0.8875
Epoch 2/20
 - 6s - loss: 0.4337 - acc: 0.8625 - val_loss: 0.4430 - val_acc: 0.8503
Epoch 3/20
 - 6s - loss: 0.3247 - acc: 0.8981 - val_loss: 0.2633 - val_acc: 0.9152
Epoch 4/20
 - 6s - loss: 0.2680 - acc: 0.9164 - val_loss: 0.1477 - val_acc: 0.9546
Epoch 5/20
 - 6s - loss: 0.2380 - acc: 0.9275 - val_loss: 0.2184 - val_acc: 0.9332
Epoch 6/20
 - 6s - loss: 0.2137 - acc: 0.9340 - val_loss: 0.2234 - val_acc: 0.9311
Epoch 7/20
 - 6s - loss: 0.2039 - acc: 0.9387 - val_loss: 0.1313 - val_acc: 0.9597
Epoch 8/20
 - 6s - loss: 0.1881 - acc: 0.9428 - val_loss: 0.1168 - val_acc: 0.9640
Epoch 9/20
 - 6s - loss: 0.1825 - acc: 0.9455 - val_loss: 0.1305 - val_acc: 0.9592
Epoch 10/20
 - 6s - loss: 0.1743 - acc: 0.9483 - val_loss: 0.1346 - val_acc: 0.9610
Epoch 11/20
 - 6s - loss: 0.1712 - acc: 0.9492 - val_loss: 0.1674 - val_acc: 0.9494
Epoch 12/20
 - 6s - loss: 0.1712 - acc: 0.9502 - val_loss: 0.1188 - val_acc: 0.9638
Epoch 13/20
 - 6s - loss: 0.1695 - acc: 0.9498 - val_loss: 0.1204 - val_acc: 0.9629
Epoch 14/20
 - 6s - loss: 0.1657 - acc: 0.9505 - val_loss: 0.1330 - val_acc: 0.9592
Epoch 15/20
 - 6s - loss: 0.1678 - acc: 0.9521 - val_loss: 0.0969 - val_acc: 0.9711
Epoch 16/20
 - 6s - loss: 0.1651 - acc: 0.9534 - val_loss: 0.1914 - val_acc: 0.9569
Epoch 17/20
 - 6s - loss: 0.1655 - acc: 0.9533 - val_loss: 0.1243 - val_acc: 0.9675
Epoch 18/20
 - 6s - loss: 0.1650 - acc: 0.9536 - val_loss: 0.0937 - val_acc: 0.9737
Epoch 19/20
 - 6s - loss: 0.1657 - acc: 0.9555 - val_loss: 0.1075 - val_acc: 0.9726
Epoch 20/20
 - 6s - loss: 0.1678 - acc: 0.9534 - val_loss: 0.1819 - val_acc: 0.9612
Test loss: 0.18208860169679464
Test accuracy: 0.9604
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9580 - acc: 0.6980 - val_loss: 0.5070 - val_acc: 0.8465
Epoch 2/20
 - 9s - loss: 0.4336 - acc: 0.8609 - val_loss: 0.3147 - val_acc: 0.8948
Epoch 3/20
 - 9s - loss: 0.3177 - acc: 0.9001 - val_loss: 0.2581 - val_acc: 0.9144
Epoch 4/20
 - 9s - loss: 0.2714 - acc: 0.9153 - val_loss: 0.2335 - val_acc: 0.9327
Epoch 5/20
 - 9s - loss: 0.2347 - acc: 0.9268 - val_loss: 0.1968 - val_acc: 0.9364
Epoch 6/20
 - 9s - loss: 0.2155 - acc: 0.9338 - val_loss: 0.1668 - val_acc: 0.9496
Epoch 7/20
 - 9s - loss: 0.2004 - acc: 0.9388 - val_loss: 0.1331 - val_acc: 0.9618
Epoch 8/20
 - 9s - loss: 0.1879 - acc: 0.9429 - val_loss: 0.2845 - val_acc: 0.9183
Epoch 9/20
 - 9s - loss: 0.1852 - acc: 0.9453 - val_loss: 0.1240 - val_acc: 0.9643
Epoch 10/20
 - 9s - loss: 0.1777 - acc: 0.9466 - val_loss: 0.1518 - val_acc: 0.9523
Epoch 11/20
 - 9s - loss: 0.1769 - acc: 0.9487 - val_loss: 0.1292 - val_acc: 0.9601
Epoch 12/20
 - 9s - loss: 0.1757 - acc: 0.9499 - val_loss: 0.1252 - val_acc: 0.9651
Epoch 13/20
 - 9s - loss: 0.1738 - acc: 0.9509 - val_loss: 0.1087 - val_acc: 0.9683
Epoch 14/20
 - 9s - loss: 0.1691 - acc: 0.9525 - val_loss: 0.1139 - val_acc: 0.9650
Epoch 15/20
 - 9s - loss: 0.1633 - acc: 0.9534 - val_loss: 0.1101 - val_acc: 0.9696
Epoch 16/20
 - 9s - loss: 0.1725 - acc: 0.9517 - val_loss: 0.1217 - val_acc: 0.9671
Epoch 17/20
 - 9s - loss: 0.1677 - acc: 0.9535 - val_loss: 0.1321 - val_acc: 0.9646
Epoch 18/20
 - 9s - loss: 0.1697 - acc: 0.9532 - val_loss: 0.1193 - val_acc: 0.9660
Epoch 19/20
 - 9s - loss: 0.1704 - acc: 0.9535 - val_loss: 0.1272 - val_acc: 0.9687
Epoch 20/20
 - 9s - loss: 0.1681 - acc: 0.9538 - val_loss: 0.2325 - val_acc: 0.9372
Test loss: 0.23253774404115976
Test accuracy: 0.9378
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9214 - acc: 0.7002 - val_loss: 0.4297 - val_acc: 0.8685
Epoch 2/20
 - 14s - loss: 0.4288 - acc: 0.8644 - val_loss: 0.3654 - val_acc: 0.8749
Epoch 3/20
 - 14s - loss: 0.3212 - acc: 0.8979 - val_loss: 0.2021 - val_acc: 0.9344
Epoch 4/20
 - 14s - loss: 0.2661 - acc: 0.9174 - val_loss: 0.1666 - val_acc: 0.9511
Epoch 5/20
 - 14s - loss: 0.2364 - acc: 0.9270 - val_loss: 0.2541 - val_acc: 0.9189
Epoch 6/20
 - 14s - loss: 0.2198 - acc: 0.9320 - val_loss: 0.1866 - val_acc: 0.9392
Epoch 7/20
 - 14s - loss: 0.1989 - acc: 0.9392 - val_loss: 0.1762 - val_acc: 0.9456
Epoch 8/20
 - 14s - loss: 0.1934 - acc: 0.9405 - val_loss: 0.1140 - val_acc: 0.9644
Epoch 9/20
 - 14s - loss: 0.1862 - acc: 0.9438 - val_loss: 0.1288 - val_acc: 0.9588
Epoch 10/20
 - 14s - loss: 0.2095 - acc: 0.9449 - val_loss: 0.1205 - val_acc: 0.9614
Epoch 11/20
 - 14s - loss: 0.1712 - acc: 0.9494 - val_loss: 0.1264 - val_acc: 0.9606
Epoch 12/20
 - 14s - loss: 0.1684 - acc: 0.9505 - val_loss: 0.1344 - val_acc: 0.9645
Epoch 13/20
 - 14s - loss: 0.1678 - acc: 0.9515 - val_loss: 0.1532 - val_acc: 0.9518
Epoch 14/20
 - 14s - loss: 0.1637 - acc: 0.9516 - val_loss: 0.1086 - val_acc: 0.9683
Epoch 15/20
 - 14s - loss: 0.1643 - acc: 0.9525 - val_loss: 0.1238 - val_acc: 0.9649
Epoch 16/20
 - 14s - loss: 0.1632 - acc: 0.9526 - val_loss: 0.1286 - val_acc: 0.9588
Epoch 17/20
 - 14s - loss: 0.1607 - acc: 0.9536 - val_loss: 0.0983 - val_acc: 0.9704
Epoch 18/20
 - 14s - loss: 0.1608 - acc: 0.9547 - val_loss: 0.0937 - val_acc: 0.9713
Epoch 19/20
 - 14s - loss: 0.1649 - acc: 0.9531 - val_loss: 0.1074 - val_acc: 0.9689
Epoch 20/20
 - 14s - loss: 0.1683 - acc: 0.9536 - val_loss: 0.1244 - val_acc: 0.9671
Test loss: 0.1243700813169351
Test accuracy: 0.967
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9501 - acc: 0.6958 - val_loss: 0.3431 - val_acc: 0.8912
Epoch 2/20
 - 26s - loss: 0.4238 - acc: 0.8656 - val_loss: 0.2497 - val_acc: 0.9184
Epoch 3/20
 - 26s - loss: 0.3133 - acc: 0.9017 - val_loss: 0.3118 - val_acc: 0.9003
Epoch 4/20
 - 26s - loss: 0.2646 - acc: 0.9166 - val_loss: 0.1744 - val_acc: 0.9454
Epoch 5/20
 - 26s - loss: 0.2345 - acc: 0.9272 - val_loss: 0.1457 - val_acc: 0.9552
Epoch 6/20
 - 26s - loss: 0.2134 - acc: 0.9346 - val_loss: 0.2480 - val_acc: 0.9215
Epoch 7/20
 - 26s - loss: 0.1987 - acc: 0.9403 - val_loss: 0.1365 - val_acc: 0.9571
Epoch 8/20
 - 26s - loss: 0.1905 - acc: 0.9436 - val_loss: 0.1837 - val_acc: 0.9419
Epoch 9/20
 - 26s - loss: 0.1831 - acc: 0.9455 - val_loss: 0.1683 - val_acc: 0.9470
Epoch 10/20
 - 26s - loss: 0.1776 - acc: 0.9479 - val_loss: 0.1185 - val_acc: 0.9644
Epoch 11/20
 - 26s - loss: 0.1758 - acc: 0.9475 - val_loss: 0.1045 - val_acc: 0.9680
Epoch 12/20
 - 26s - loss: 0.1720 - acc: 0.9495 - val_loss: 0.1443 - val_acc: 0.9545
Epoch 13/20
 - 26s - loss: 0.1668 - acc: 0.9516 - val_loss: 0.1323 - val_acc: 0.9650
Epoch 14/20
 - 26s - loss: 0.1640 - acc: 0.9526 - val_loss: 0.0912 - val_acc: 0.9737
Epoch 15/20
 - 26s - loss: 0.1619 - acc: 0.9529 - val_loss: 0.1089 - val_acc: 0.9681
Epoch 16/20
 - 26s - loss: 0.1650 - acc: 0.9528 - val_loss: 0.1073 - val_acc: 0.9667
Epoch 17/20
 - 26s - loss: 0.1640 - acc: 0.9533 - val_loss: 0.1476 - val_acc: 0.9595
Epoch 18/20
 - 26s - loss: 0.1608 - acc: 0.9545 - val_loss: 0.0920 - val_acc: 0.9726
Epoch 19/20
 - 26s - loss: 0.1656 - acc: 0.9539 - val_loss: 0.0918 - val_acc: 0.9736
Epoch 20/20
 - 26s - loss: 0.1600 - acc: 0.9558 - val_loss: 0.1083 - val_acc: 0.9688
Test loss: 0.10828850152580707
Test accuracy: 0.9689
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9648 - acc: 0.6888 - val_loss: 0.5117 - val_acc: 0.8242
Epoch 2/20
 - 3s - loss: 0.4629 - acc: 0.8518 - val_loss: 0.2898 - val_acc: 0.9016
Epoch 3/20
 - 3s - loss: 0.3520 - acc: 0.8876 - val_loss: 0.4065 - val_acc: 0.8792
Epoch 4/20
 - 3s - loss: 0.2995 - acc: 0.9047 - val_loss: 0.2178 - val_acc: 0.9336
Epoch 5/20
 - 3s - loss: 0.2670 - acc: 0.9164 - val_loss: 0.1484 - val_acc: 0.9526
Epoch 6/20
 - 3s - loss: 0.2453 - acc: 0.9232 - val_loss: 0.1584 - val_acc: 0.9501
Epoch 7/20
 - 3s - loss: 0.2302 - acc: 0.9293 - val_loss: 0.2043 - val_acc: 0.9380
Epoch 8/20
 - 3s - loss: 0.2199 - acc: 0.9335 - val_loss: 0.2000 - val_acc: 0.9407
Epoch 9/20
 - 3s - loss: 0.2133 - acc: 0.9343 - val_loss: 0.1938 - val_acc: 0.9409
Epoch 10/20
 - 3s - loss: 0.2103 - acc: 0.9378 - val_loss: 0.1878 - val_acc: 0.9458
Epoch 11/20
 - 3s - loss: 0.2037 - acc: 0.9388 - val_loss: 0.1569 - val_acc: 0.9539
Epoch 12/20
 - 3s - loss: 0.1950 - acc: 0.9413 - val_loss: 0.1339 - val_acc: 0.9637
Epoch 13/20
 - 3s - loss: 0.2004 - acc: 0.9416 - val_loss: 0.1496 - val_acc: 0.9535
Epoch 14/20
 - 3s - loss: 0.1961 - acc: 0.9418 - val_loss: 0.1459 - val_acc: 0.9549
Epoch 15/20
 - 3s - loss: 0.1984 - acc: 0.9416 - val_loss: 0.1230 - val_acc: 0.9639
Epoch 16/20
 - 3s - loss: 0.1950 - acc: 0.9438 - val_loss: 0.1267 - val_acc: 0.9642
Epoch 17/20
 - 3s - loss: 0.1929 - acc: 0.9444 - val_loss: 0.1227 - val_acc: 0.9649
Epoch 18/20
 - 3s - loss: 0.1991 - acc: 0.9445 - val_loss: 0.1234 - val_acc: 0.9635
Epoch 19/20
 - 3s - loss: 0.1947 - acc: 0.9443 - val_loss: 0.1529 - val_acc: 0.9532
Epoch 20/20
 - 3s - loss: 0.1937 - acc: 0.9451 - val_loss: 0.1365 - val_acc: 0.9579
Test loss: 0.13479035989250987
Test accuracy: 0.9619
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9380 - acc: 0.6928 - val_loss: 0.3150 - val_acc: 0.9022
Epoch 2/20
 - 3s - loss: 0.4448 - acc: 0.8592 - val_loss: 1.0150 - val_acc: 0.7070
Epoch 3/20
 - 3s - loss: 0.3331 - acc: 0.8951 - val_loss: 0.3525 - val_acc: 0.8868
Epoch 4/20
 - 3s - loss: 0.2839 - acc: 0.9111 - val_loss: 0.1595 - val_acc: 0.9507
Epoch 5/20
 - 3s - loss: 0.2497 - acc: 0.9214 - val_loss: 0.1652 - val_acc: 0.9450
Epoch 6/20
 - 3s - loss: 0.2287 - acc: 0.9292 - val_loss: 0.1463 - val_acc: 0.9524
Epoch 7/20
 - 3s - loss: 0.2148 - acc: 0.9338 - val_loss: 0.2140 - val_acc: 0.9357
Epoch 8/20
 - 3s - loss: 0.2080 - acc: 0.9371 - val_loss: 0.1290 - val_acc: 0.9613
Epoch 9/20
 - 3s - loss: 0.1993 - acc: 0.9397 - val_loss: 0.1893 - val_acc: 0.9399
Epoch 10/20
 - 3s - loss: 0.1922 - acc: 0.9428 - val_loss: 0.1344 - val_acc: 0.9615
Epoch 11/20
 - 3s - loss: 0.1887 - acc: 0.9443 - val_loss: 0.1170 - val_acc: 0.9653
Epoch 12/20
 - 3s - loss: 0.1881 - acc: 0.9442 - val_loss: 0.1700 - val_acc: 0.9506
Epoch 13/20
 - 3s - loss: 0.1878 - acc: 0.9442 - val_loss: 0.1220 - val_acc: 0.9628
Epoch 14/20
 - 3s - loss: 0.1849 - acc: 0.9462 - val_loss: 0.1263 - val_acc: 0.9626
Epoch 15/20
 - 3s - loss: 0.1849 - acc: 0.9469 - val_loss: 0.1196 - val_acc: 0.9639
Epoch 16/20
 - 3s - loss: 0.1856 - acc: 0.9477 - val_loss: 0.1506 - val_acc: 0.9568
Epoch 17/20
 - 3s - loss: 0.1885 - acc: 0.9477 - val_loss: 0.1178 - val_acc: 0.9644
Epoch 18/20
 - 3s - loss: 0.1836 - acc: 0.9487 - val_loss: 0.1175 - val_acc: 0.9639
Epoch 19/20
 - 3s - loss: 0.1866 - acc: 0.9476 - val_loss: 0.1130 - val_acc: 0.9707
Epoch 20/20
 - 3s - loss: 0.1799 - acc: 0.9506 - val_loss: 0.1611 - val_acc: 0.9494
Test loss: 0.15695896791853012
Test accuracy: 0.9517
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9517 - acc: 0.6943 - val_loss: 0.4767 - val_acc: 0.8444
Epoch 2/20
 - 3s - loss: 0.4391 - acc: 0.8611 - val_loss: 0.2278 - val_acc: 0.9261
Epoch 3/20
 - 3s - loss: 0.3274 - acc: 0.8959 - val_loss: 0.2196 - val_acc: 0.9274
Epoch 4/20
 - 3s - loss: 0.2720 - acc: 0.9146 - val_loss: 0.1963 - val_acc: 0.9382
Epoch 5/20
 - 3s - loss: 0.2405 - acc: 0.9244 - val_loss: 0.1911 - val_acc: 0.9406
Epoch 6/20
 - 3s - loss: 0.2224 - acc: 0.9320 - val_loss: 0.2133 - val_acc: 0.9312
Epoch 7/20
 - 3s - loss: 0.2096 - acc: 0.9366 - val_loss: 0.1376 - val_acc: 0.9559
Epoch 8/20
 - 3s - loss: 0.1987 - acc: 0.9401 - val_loss: 0.1634 - val_acc: 0.9515
Epoch 9/20
 - 3s - loss: 0.1911 - acc: 0.9426 - val_loss: 0.1441 - val_acc: 0.9547
Epoch 10/20
 - 3s - loss: 0.1859 - acc: 0.9444 - val_loss: 0.1528 - val_acc: 0.9591
Epoch 11/20
 - 3s - loss: 0.1838 - acc: 0.9455 - val_loss: 0.1321 - val_acc: 0.9574
Epoch 12/20
 - 3s - loss: 0.1762 - acc: 0.9479 - val_loss: 0.1375 - val_acc: 0.9587
Epoch 13/20
 - 3s - loss: 0.1813 - acc: 0.9486 - val_loss: 0.1173 - val_acc: 0.9684
Epoch 14/20
 - 3s - loss: 0.1770 - acc: 0.9502 - val_loss: 0.1275 - val_acc: 0.9641
Epoch 15/20
 - 3s - loss: 0.1785 - acc: 0.9497 - val_loss: 0.1104 - val_acc: 0.9678
Epoch 16/20
 - 3s - loss: 0.1723 - acc: 0.9503 - val_loss: 0.1119 - val_acc: 0.9692
Epoch 17/20
 - 3s - loss: 0.1771 - acc: 0.9497 - val_loss: 0.1239 - val_acc: 0.9643
Epoch 18/20
 - 3s - loss: 0.1775 - acc: 0.9505 - val_loss: 0.1272 - val_acc: 0.9633
Epoch 19/20
 - 3s - loss: 0.1705 - acc: 0.9518 - val_loss: 0.1185 - val_acc: 0.9654
Epoch 20/20
 - 3s - loss: 0.1725 - acc: 0.9521 - val_loss: 0.1180 - val_acc: 0.9660
Test loss: 0.11560600399770773
Test accuracy: 0.9661
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9240 - acc: 0.6995 - val_loss: 0.5206 - val_acc: 0.8258
Epoch 2/20
 - 3s - loss: 0.4401 - acc: 0.8604 - val_loss: 0.2683 - val_acc: 0.9136
Epoch 3/20
 - 3s - loss: 0.3212 - acc: 0.8981 - val_loss: 0.2616 - val_acc: 0.9109
Epoch 4/20
 - 3s - loss: 0.2660 - acc: 0.9175 - val_loss: 0.2375 - val_acc: 0.9278
Epoch 5/20
 - 3s - loss: 0.2366 - acc: 0.9269 - val_loss: 0.1882 - val_acc: 0.9369
Epoch 6/20
 - 3s - loss: 0.2166 - acc: 0.9335 - val_loss: 0.1484 - val_acc: 0.9539
Epoch 7/20
 - 3s - loss: 0.2030 - acc: 0.9377 - val_loss: 0.1370 - val_acc: 0.9573
Epoch 8/20
 - 3s - loss: 0.1935 - acc: 0.9416 - val_loss: 0.1241 - val_acc: 0.9614
Epoch 9/20
 - 3s - loss: 0.1829 - acc: 0.9448 - val_loss: 0.1221 - val_acc: 0.9637
Epoch 10/20
 - 3s - loss: 0.1762 - acc: 0.9460 - val_loss: 0.1161 - val_acc: 0.9647
Epoch 11/20
 - 3s - loss: 0.1752 - acc: 0.9483 - val_loss: 0.1177 - val_acc: 0.9644
Epoch 12/20
 - 3s - loss: 0.1697 - acc: 0.9492 - val_loss: 0.1187 - val_acc: 0.9618
Epoch 13/20
 - 3s - loss: 0.1710 - acc: 0.9494 - val_loss: 0.1257 - val_acc: 0.9652
Epoch 14/20
 - 3s - loss: 0.1697 - acc: 0.9520 - val_loss: 0.1115 - val_acc: 0.9656
Epoch 15/20
 - 3s - loss: 0.1689 - acc: 0.9520 - val_loss: 0.2038 - val_acc: 0.9458
Epoch 16/20
 - 3s - loss: 0.1669 - acc: 0.9521 - val_loss: 0.1328 - val_acc: 0.9616
Epoch 17/20
 - 3s - loss: 0.1652 - acc: 0.9532 - val_loss: 0.1178 - val_acc: 0.9661
Epoch 18/20
 - 3s - loss: 0.1668 - acc: 0.9538 - val_loss: 0.1015 - val_acc: 0.9689
Epoch 19/20
 - 3s - loss: 0.1665 - acc: 0.9530 - val_loss: 0.0979 - val_acc: 0.9696
Epoch 20/20
 - 3s - loss: 0.1679 - acc: 0.9531 - val_loss: 0.1189 - val_acc: 0.9669
Test loss: 0.12079442854351365
Test accuracy: 0.9674
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9277 - acc: 0.7009 - val_loss: 0.8905 - val_acc: 0.7593
Epoch 2/20
 - 4s - loss: 0.4375 - acc: 0.8599 - val_loss: 0.4551 - val_acc: 0.8548
Epoch 3/20
 - 4s - loss: 0.3295 - acc: 0.8955 - val_loss: 0.2699 - val_acc: 0.9135
Epoch 4/20
 - 4s - loss: 0.2748 - acc: 0.9140 - val_loss: 0.2603 - val_acc: 0.9132
Epoch 5/20
 - 4s - loss: 0.2426 - acc: 0.9237 - val_loss: 0.1630 - val_acc: 0.9461
Epoch 6/20
 - 4s - loss: 0.2190 - acc: 0.9320 - val_loss: 0.1412 - val_acc: 0.9572
Epoch 7/20
 - 4s - loss: 0.1995 - acc: 0.9378 - val_loss: 0.1706 - val_acc: 0.9475
Epoch 8/20
 - 4s - loss: 0.1939 - acc: 0.9420 - val_loss: 0.1394 - val_acc: 0.9551
Epoch 9/20
 - 4s - loss: 0.1861 - acc: 0.9442 - val_loss: 0.1649 - val_acc: 0.9524
Epoch 10/20
 - 4s - loss: 0.1786 - acc: 0.9467 - val_loss: 0.1224 - val_acc: 0.9653
Epoch 11/20
 - 4s - loss: 0.1716 - acc: 0.9488 - val_loss: 0.1164 - val_acc: 0.9630
Epoch 12/20
 - 4s - loss: 0.1741 - acc: 0.9490 - val_loss: 0.1340 - val_acc: 0.9605
Epoch 13/20
 - 4s - loss: 0.1710 - acc: 0.9497 - val_loss: 0.1131 - val_acc: 0.9668
Epoch 14/20
 - 4s - loss: 0.1657 - acc: 0.9500 - val_loss: 0.1119 - val_acc: 0.9683
Epoch 15/20
 - 4s - loss: 0.1657 - acc: 0.9527 - val_loss: 0.1070 - val_acc: 0.9676
Epoch 16/20
 - 4s - loss: 0.1621 - acc: 0.9532 - val_loss: 0.1073 - val_acc: 0.9692
Epoch 17/20
 - 4s - loss: 0.1641 - acc: 0.9538 - val_loss: 0.1331 - val_acc: 0.9625
Epoch 18/20
 - 4s - loss: 0.1632 - acc: 0.9535 - val_loss: 0.1205 - val_acc: 0.9634
Epoch 19/20
 - 4s - loss: 0.1649 - acc: 0.9550 - val_loss: 0.1101 - val_acc: 0.9678
Epoch 20/20
 - 4s - loss: 0.1602 - acc: 0.9555 - val_loss: 0.1257 - val_acc: 0.9645
Test loss: 0.12379138685767539
Test accuracy: 0.965
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9426 - acc: 0.6968 - val_loss: 0.4335 - val_acc: 0.8444
Epoch 2/20
 - 4s - loss: 0.4440 - acc: 0.8570 - val_loss: 0.2227 - val_acc: 0.9350
Epoch 3/20
 - 4s - loss: 0.3289 - acc: 0.8953 - val_loss: 0.1983 - val_acc: 0.9435
Epoch 4/20
 - 4s - loss: 0.2714 - acc: 0.9143 - val_loss: 0.1654 - val_acc: 0.9484
Epoch 5/20
 - 4s - loss: 0.2402 - acc: 0.9261 - val_loss: 0.2258 - val_acc: 0.9272
Epoch 6/20
 - 4s - loss: 0.2214 - acc: 0.9316 - val_loss: 0.1405 - val_acc: 0.9583
Epoch 7/20
 - 4s - loss: 0.2049 - acc: 0.9369 - val_loss: 0.1242 - val_acc: 0.9610
Epoch 8/20
 - 4s - loss: 0.1938 - acc: 0.9413 - val_loss: 0.1375 - val_acc: 0.9565
Epoch 9/20
 - 4s - loss: 0.1847 - acc: 0.9441 - val_loss: 0.1451 - val_acc: 0.9540
Epoch 10/20
 - 4s - loss: 0.1788 - acc: 0.9457 - val_loss: 0.1314 - val_acc: 0.9606
Epoch 11/20
 - 4s - loss: 0.1785 - acc: 0.9472 - val_loss: 0.1046 - val_acc: 0.9699
Epoch 12/20
 - 4s - loss: 0.1733 - acc: 0.9484 - val_loss: 0.1102 - val_acc: 0.9677
Epoch 13/20
 - 4s - loss: 0.1678 - acc: 0.9498 - val_loss: 0.1291 - val_acc: 0.9631
Epoch 14/20
 - 4s - loss: 0.1662 - acc: 0.9521 - val_loss: 0.1263 - val_acc: 0.9629
Epoch 15/20
 - 4s - loss: 0.1658 - acc: 0.9508 - val_loss: 0.1033 - val_acc: 0.9700
Epoch 16/20
 - 4s - loss: 0.1665 - acc: 0.9525 - val_loss: 0.1235 - val_acc: 0.9658
Epoch 17/20
 - 4s - loss: 0.1623 - acc: 0.9520 - val_loss: 0.1466 - val_acc: 0.9591
Epoch 18/20
 - 4s - loss: 0.1658 - acc: 0.9530 - val_loss: 0.0968 - val_acc: 0.9752
Epoch 19/20
 - 4s - loss: 0.1618 - acc: 0.9533 - val_loss: 0.1015 - val_acc: 0.9727
Epoch 20/20
 - 4s - loss: 0.1640 - acc: 0.9532 - val_loss: 0.0967 - val_acc: 0.9726
Test loss: 0.09673007456156775
Test accuracy: 0.9723
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9107 - acc: 0.7091 - val_loss: 0.5748 - val_acc: 0.8069
Epoch 2/20
 - 6s - loss: 0.4249 - acc: 0.8648 - val_loss: 0.3413 - val_acc: 0.8897
Epoch 3/20
 - 6s - loss: 0.3228 - acc: 0.8991 - val_loss: 0.1967 - val_acc: 0.9402
Epoch 4/20
 - 6s - loss: 0.2682 - acc: 0.9159 - val_loss: 0.1826 - val_acc: 0.9450
Epoch 5/20
 - 6s - loss: 0.2362 - acc: 0.9271 - val_loss: 0.1710 - val_acc: 0.9457
Epoch 6/20
 - 6s - loss: 0.2167 - acc: 0.9321 - val_loss: 0.2087 - val_acc: 0.9319
Epoch 7/20
 - 6s - loss: 0.2035 - acc: 0.9372 - val_loss: 0.1816 - val_acc: 0.9413
Epoch 8/20
 - 6s - loss: 0.1916 - acc: 0.9416 - val_loss: 0.1439 - val_acc: 0.9555
Epoch 9/20
 - 6s - loss: 0.1872 - acc: 0.9430 - val_loss: 0.1503 - val_acc: 0.9543
Epoch 10/20
 - 6s - loss: 0.1778 - acc: 0.9468 - val_loss: 0.1175 - val_acc: 0.9651
Epoch 11/20
 - 6s - loss: 0.1739 - acc: 0.9490 - val_loss: 0.1038 - val_acc: 0.9683
Epoch 12/20
 - 6s - loss: 0.1703 - acc: 0.9501 - val_loss: 0.1432 - val_acc: 0.9553
Epoch 13/20
 - 6s - loss: 0.1676 - acc: 0.9502 - val_loss: 0.1009 - val_acc: 0.9710
Epoch 14/20
 - 6s - loss: 0.1634 - acc: 0.9517 - val_loss: 0.1241 - val_acc: 0.9662
Epoch 15/20
 - 6s - loss: 0.1644 - acc: 0.9524 - val_loss: 0.1159 - val_acc: 0.9634
Epoch 16/20
 - 6s - loss: 0.1609 - acc: 0.9539 - val_loss: 0.2091 - val_acc: 0.9338
Epoch 17/20
 - 6s - loss: 0.1646 - acc: 0.9532 - val_loss: 0.0915 - val_acc: 0.9706
Epoch 18/20
 - 6s - loss: 0.1563 - acc: 0.9555 - val_loss: 0.1016 - val_acc: 0.9692
Epoch 19/20
 - 6s - loss: 0.1570 - acc: 0.9542 - val_loss: 0.1188 - val_acc: 0.9660
Epoch 20/20
 - 6s - loss: 0.1629 - acc: 0.9544 - val_loss: 0.1178 - val_acc: 0.9627
Test loss: 0.11823579771067307
Test accuracy: 0.9632
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9396 - acc: 0.7000 - val_loss: 0.3670 - val_acc: 0.8835
Epoch 2/20
 - 9s - loss: 0.4311 - acc: 0.8619 - val_loss: 0.3859 - val_acc: 0.8657
Epoch 3/20
 - 9s - loss: 0.3209 - acc: 0.8989 - val_loss: 0.2867 - val_acc: 0.9100
Epoch 4/20
 - 9s - loss: 0.2649 - acc: 0.9171 - val_loss: 0.2329 - val_acc: 0.9174
Epoch 5/20
 - 9s - loss: 0.2347 - acc: 0.9284 - val_loss: 0.1593 - val_acc: 0.9498
Epoch 6/20
 - 9s - loss: 0.2117 - acc: 0.9350 - val_loss: 0.1666 - val_acc: 0.9472
Epoch 7/20
 - 9s - loss: 0.1979 - acc: 0.9410 - val_loss: 0.2346 - val_acc: 0.9282
Epoch 8/20
 - 9s - loss: 0.1906 - acc: 0.9418 - val_loss: 0.1538 - val_acc: 0.9542
Epoch 9/20
 - 9s - loss: 0.1829 - acc: 0.9451 - val_loss: 0.1355 - val_acc: 0.9600
Epoch 10/20
 - 9s - loss: 0.1772 - acc: 0.9471 - val_loss: 0.1145 - val_acc: 0.9683
Epoch 11/20
 - 9s - loss: 0.1773 - acc: 0.9478 - val_loss: 0.1118 - val_acc: 0.9664
Epoch 12/20
 - 9s - loss: 0.1712 - acc: 0.9495 - val_loss: 0.1224 - val_acc: 0.9628
Epoch 13/20
 - 9s - loss: 0.1718 - acc: 0.9510 - val_loss: 0.1252 - val_acc: 0.9627
Epoch 14/20
 - 9s - loss: 0.1697 - acc: 0.9507 - val_loss: 0.1138 - val_acc: 0.9650
Epoch 15/20
 - 9s - loss: 0.1712 - acc: 0.9511 - val_loss: 0.0899 - val_acc: 0.9717
Epoch 16/20
 - 9s - loss: 0.1663 - acc: 0.9521 - val_loss: 0.1269 - val_acc: 0.9613
Epoch 17/20
 - 9s - loss: 0.1666 - acc: 0.9522 - val_loss: 0.1071 - val_acc: 0.9692
Epoch 18/20
 - 9s - loss: 0.1705 - acc: 0.9525 - val_loss: 0.1038 - val_acc: 0.9693
Epoch 19/20
 - 9s - loss: 0.1660 - acc: 0.9534 - val_loss: 0.1477 - val_acc: 0.9613
Epoch 20/20
 - 9s - loss: 0.1726 - acc: 0.9531 - val_loss: 0.1159 - val_acc: 0.9663
Test loss: 0.11555692069409415
Test accuracy: 0.9669
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9183 - acc: 0.7035 - val_loss: 0.3951 - val_acc: 0.8771
Epoch 2/20
 - 14s - loss: 0.4255 - acc: 0.8654 - val_loss: 0.2415 - val_acc: 0.9250
Epoch 3/20
 - 14s - loss: 0.3098 - acc: 0.9038 - val_loss: 0.2503 - val_acc: 0.9186
Epoch 4/20
 - 14s - loss: 0.2589 - acc: 0.9187 - val_loss: 0.1514 - val_acc: 0.9547
Epoch 5/20
 - 14s - loss: 0.2362 - acc: 0.9280 - val_loss: 0.1587 - val_acc: 0.9507
Epoch 6/20
 - 14s - loss: 0.2114 - acc: 0.9347 - val_loss: 0.1274 - val_acc: 0.9612
Epoch 7/20
 - 14s - loss: 0.1988 - acc: 0.9385 - val_loss: 0.1255 - val_acc: 0.9602
Epoch 8/20
 - 14s - loss: 0.1851 - acc: 0.9433 - val_loss: 0.1283 - val_acc: 0.9584
Epoch 9/20
 - 14s - loss: 0.1776 - acc: 0.9461 - val_loss: 0.1521 - val_acc: 0.9541
Epoch 10/20
 - 14s - loss: 0.1745 - acc: 0.9483 - val_loss: 0.1465 - val_acc: 0.9521
Epoch 11/20
 - 14s - loss: 0.1667 - acc: 0.9494 - val_loss: 0.1070 - val_acc: 0.9680
Epoch 12/20
 - 14s - loss: 0.1654 - acc: 0.9499 - val_loss: 0.1204 - val_acc: 0.9649
Epoch 13/20
 - 14s - loss: 0.1656 - acc: 0.9515 - val_loss: 0.0978 - val_acc: 0.9727
Epoch 14/20
 - 14s - loss: 0.1618 - acc: 0.9546 - val_loss: 0.1003 - val_acc: 0.9703
Epoch 15/20
 - 14s - loss: 0.1599 - acc: 0.9544 - val_loss: 0.1165 - val_acc: 0.9688
Epoch 16/20
 - 14s - loss: 0.1583 - acc: 0.9538 - val_loss: 0.0984 - val_acc: 0.9706
Epoch 17/20
 - 14s - loss: 0.1547 - acc: 0.9554 - val_loss: 0.1052 - val_acc: 0.9703
Epoch 18/20
 - 14s - loss: 0.1575 - acc: 0.9554 - val_loss: 0.1001 - val_acc: 0.9727
Epoch 19/20
 - 14s - loss: 0.1596 - acc: 0.9553 - val_loss: 0.1199 - val_acc: 0.9670
Epoch 20/20
 - 14s - loss: 0.1568 - acc: 0.9558 - val_loss: 0.1423 - val_acc: 0.9656
Test loss: 0.14236440393435187
Test accuracy: 0.966
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9432 - acc: 0.6984 - val_loss: 0.5206 - val_acc: 0.8275
Epoch 2/20
 - 26s - loss: 0.4302 - acc: 0.8626 - val_loss: 0.2153 - val_acc: 0.9318
Epoch 3/20
 - 26s - loss: 0.3161 - acc: 0.9010 - val_loss: 0.2120 - val_acc: 0.9351
Epoch 4/20
 - 26s - loss: 0.2636 - acc: 0.9178 - val_loss: 0.2064 - val_acc: 0.9338
Epoch 5/20
 - 26s - loss: 0.2286 - acc: 0.9281 - val_loss: 0.1633 - val_acc: 0.9497
Epoch 6/20
 - 26s - loss: 0.2107 - acc: 0.9340 - val_loss: 0.1282 - val_acc: 0.9592
Epoch 7/20
 - 26s - loss: 0.1974 - acc: 0.9389 - val_loss: 0.1199 - val_acc: 0.9636
Epoch 8/20
 - 26s - loss: 0.1843 - acc: 0.9444 - val_loss: 0.1426 - val_acc: 0.9563
Epoch 9/20
 - 26s - loss: 0.1814 - acc: 0.9464 - val_loss: 0.1555 - val_acc: 0.9522
Epoch 10/20
 - 26s - loss: 0.1709 - acc: 0.9484 - val_loss: 0.1440 - val_acc: 0.9552
Epoch 11/20
 - 26s - loss: 0.1649 - acc: 0.9507 - val_loss: 0.1726 - val_acc: 0.9476
Epoch 12/20
 - 26s - loss: 0.1718 - acc: 0.9492 - val_loss: 0.1207 - val_acc: 0.9668
Epoch 13/20
 - 26s - loss: 0.1674 - acc: 0.9502 - val_loss: 0.1401 - val_acc: 0.9560
Epoch 14/20
 - 26s - loss: 0.1651 - acc: 0.9531 - val_loss: 0.1544 - val_acc: 0.9568
Epoch 15/20
 - 26s - loss: 0.1652 - acc: 0.9528 - val_loss: 0.1055 - val_acc: 0.9697
Epoch 16/20
 - 26s - loss: 0.1627 - acc: 0.9531 - val_loss: 0.1150 - val_acc: 0.9669
Epoch 17/20
 - 26s - loss: 0.1618 - acc: 0.9545 - val_loss: 0.0958 - val_acc: 0.9721
Epoch 18/20
 - 26s - loss: 0.1652 - acc: 0.9533 - val_loss: 0.1066 - val_acc: 0.9710
Epoch 19/20
 - 26s - loss: 0.1646 - acc: 0.9545 - val_loss: 0.1958 - val_acc: 0.9418
Epoch 20/20
 - 26s - loss: 0.1623 - acc: 0.9553 - val_loss: 0.1181 - val_acc: 0.9675
Test loss: 0.11821148233524291
Test accuracy: 0.9672
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9728 - acc: 0.6889 - val_loss: 0.3894 - val_acc: 0.8753
Epoch 2/20
 - 3s - loss: 0.4605 - acc: 0.8527 - val_loss: 0.2364 - val_acc: 0.9252
Epoch 3/20
 - 3s - loss: 0.3576 - acc: 0.8849 - val_loss: 0.2858 - val_acc: 0.9085
Epoch 4/20
 - 3s - loss: 0.2998 - acc: 0.9047 - val_loss: 0.1695 - val_acc: 0.9458
Epoch 5/20
 - 3s - loss: 0.2677 - acc: 0.9154 - val_loss: 0.1660 - val_acc: 0.9471
Epoch 6/20
 - 3s - loss: 0.2437 - acc: 0.9247 - val_loss: 0.1842 - val_acc: 0.9427
Epoch 7/20
 - 3s - loss: 0.2333 - acc: 0.9280 - val_loss: 0.3193 - val_acc: 0.8999
Epoch 8/20
 - 3s - loss: 0.2179 - acc: 0.9325 - val_loss: 0.1266 - val_acc: 0.9598
Epoch 9/20
 - 3s - loss: 0.2120 - acc: 0.9346 - val_loss: 0.2003 - val_acc: 0.9382
Epoch 10/20
 - 3s - loss: 0.2097 - acc: 0.9373 - val_loss: 0.1620 - val_acc: 0.9535
Epoch 11/20
 - 3s - loss: 0.2042 - acc: 0.9382 - val_loss: 0.1479 - val_acc: 0.9561
Epoch 12/20
 - 3s - loss: 0.2071 - acc: 0.9397 - val_loss: 0.1413 - val_acc: 0.9586
Epoch 13/20
 - 3s - loss: 0.2039 - acc: 0.9395 - val_loss: 0.1973 - val_acc: 0.9411
Epoch 14/20
 - 3s - loss: 0.1992 - acc: 0.9418 - val_loss: 0.1900 - val_acc: 0.9421
Epoch 15/20
 - 3s - loss: 0.1997 - acc: 0.9416 - val_loss: 0.1327 - val_acc: 0.9557
Epoch 16/20
 - 3s - loss: 0.1971 - acc: 0.9425 - val_loss: 0.1444 - val_acc: 0.9587
Epoch 17/20
 - 3s - loss: 0.2000 - acc: 0.9431 - val_loss: 0.1213 - val_acc: 0.9625
Epoch 18/20
 - 3s - loss: 0.1949 - acc: 0.9445 - val_loss: 0.1318 - val_acc: 0.9587
Epoch 19/20
 - 3s - loss: 0.1995 - acc: 0.9435 - val_loss: 0.1106 - val_acc: 0.9684
Epoch 20/20
 - 3s - loss: 0.1954 - acc: 0.9446 - val_loss: 0.1667 - val_acc: 0.9544
Test loss: 0.15791376401023008
Test accuracy: 0.956
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9594 - acc: 0.6909 - val_loss: 0.4388 - val_acc: 0.8534
Epoch 2/20
 - 3s - loss: 0.4386 - acc: 0.8584 - val_loss: 0.3081 - val_acc: 0.9060
Epoch 3/20
 - 3s - loss: 0.3325 - acc: 0.8942 - val_loss: 0.2026 - val_acc: 0.9372
Epoch 4/20
 - 3s - loss: 0.2798 - acc: 0.9143 - val_loss: 0.1775 - val_acc: 0.9421
Epoch 5/20
 - 3s - loss: 0.2472 - acc: 0.9227 - val_loss: 0.1713 - val_acc: 0.9457
Epoch 6/20
 - 3s - loss: 0.2298 - acc: 0.9294 - val_loss: 0.1638 - val_acc: 0.9458
Epoch 7/20
 - 3s - loss: 0.2092 - acc: 0.9368 - val_loss: 0.1418 - val_acc: 0.9564
Epoch 8/20
 - 3s - loss: 0.2034 - acc: 0.9379 - val_loss: 0.1521 - val_acc: 0.9539
Epoch 9/20
 - 3s - loss: 0.1988 - acc: 0.9419 - val_loss: 0.1912 - val_acc: 0.9441
Epoch 10/20
 - 3s - loss: 0.1934 - acc: 0.9424 - val_loss: 0.1305 - val_acc: 0.9583
Epoch 11/20
 - 3s - loss: 0.1854 - acc: 0.9450 - val_loss: 0.1793 - val_acc: 0.9442
Epoch 12/20
 - 3s - loss: 0.1860 - acc: 0.9454 - val_loss: 0.1281 - val_acc: 0.9609
Epoch 13/20
 - 3s - loss: 0.1860 - acc: 0.9462 - val_loss: 0.1371 - val_acc: 0.9600
Epoch 14/20
 - 3s - loss: 0.1831 - acc: 0.9469 - val_loss: 0.1217 - val_acc: 0.9658
Epoch 15/20
 - 3s - loss: 0.1838 - acc: 0.9472 - val_loss: 0.1233 - val_acc: 0.9631
Epoch 16/20
 - 3s - loss: 0.1780 - acc: 0.9487 - val_loss: 0.1137 - val_acc: 0.9662
Epoch 17/20
 - 3s - loss: 0.1812 - acc: 0.9479 - val_loss: 0.1563 - val_acc: 0.9595
Epoch 18/20
 - 3s - loss: 0.1844 - acc: 0.9485 - val_loss: 0.1080 - val_acc: 0.9693
Epoch 19/20
 - 3s - loss: 0.1820 - acc: 0.9495 - val_loss: 0.1340 - val_acc: 0.9606
Epoch 20/20
 - 3s - loss: 0.1795 - acc: 0.9499 - val_loss: 0.1177 - val_acc: 0.9646
Test loss: 0.1172303882429609
Test accuracy: 0.9659
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9570 - acc: 0.6936 - val_loss: 0.3673 - val_acc: 0.8921
Epoch 2/20
 - 3s - loss: 0.4340 - acc: 0.8612 - val_loss: 0.2451 - val_acc: 0.9228
Epoch 3/20
 - 3s - loss: 0.3224 - acc: 0.8986 - val_loss: 0.1807 - val_acc: 0.9452
Epoch 4/20
 - 3s - loss: 0.2690 - acc: 0.9159 - val_loss: 0.1975 - val_acc: 0.9385
Epoch 5/20
 - 3s - loss: 0.2347 - acc: 0.9260 - val_loss: 0.1503 - val_acc: 0.9546
Epoch 6/20
 - 3s - loss: 0.2178 - acc: 0.9324 - val_loss: 0.1545 - val_acc: 0.9506
Epoch 7/20
 - 3s - loss: 0.2055 - acc: 0.9369 - val_loss: 0.2370 - val_acc: 0.9267
Epoch 8/20
 - 3s - loss: 0.1994 - acc: 0.9402 - val_loss: 0.1279 - val_acc: 0.9613
Epoch 9/20
 - 3s - loss: 0.1916 - acc: 0.9416 - val_loss: 0.1540 - val_acc: 0.9537
Epoch 10/20
 - 3s - loss: 0.1856 - acc: 0.9441 - val_loss: 0.1634 - val_acc: 0.9538
Epoch 11/20
 - 3s - loss: 0.1773 - acc: 0.9471 - val_loss: 0.1347 - val_acc: 0.9606
Epoch 12/20
 - 3s - loss: 0.1755 - acc: 0.9489 - val_loss: 0.1096 - val_acc: 0.9671
Epoch 13/20
 - 3s - loss: 0.1742 - acc: 0.9486 - val_loss: 0.1235 - val_acc: 0.9618
Epoch 14/20
 - 3s - loss: 0.1722 - acc: 0.9497 - val_loss: 0.1100 - val_acc: 0.9667
Epoch 15/20
 - 3s - loss: 0.1756 - acc: 0.9492 - val_loss: 0.1043 - val_acc: 0.9705
Epoch 16/20
 - 3s - loss: 0.1718 - acc: 0.9510 - val_loss: 0.1232 - val_acc: 0.9631
Epoch 17/20
 - 3s - loss: 0.1687 - acc: 0.9522 - val_loss: 0.1959 - val_acc: 0.9491
Epoch 18/20
 - 3s - loss: 0.1722 - acc: 0.9521 - val_loss: 0.1171 - val_acc: 0.9661
Epoch 19/20
 - 3s - loss: 0.1689 - acc: 0.9525 - val_loss: 0.1301 - val_acc: 0.9686
Epoch 20/20
 - 3s - loss: 0.1719 - acc: 0.9517 - val_loss: 0.1111 - val_acc: 0.9699
Test loss: 0.11120216616713442
Test accuracy: 0.9685
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9187 - acc: 0.7017 - val_loss: 0.4348 - val_acc: 0.8588
Epoch 2/20
 - 3s - loss: 0.4388 - acc: 0.8601 - val_loss: 0.2412 - val_acc: 0.9264
Epoch 3/20
 - 3s - loss: 0.3228 - acc: 0.8988 - val_loss: 0.3316 - val_acc: 0.8867
Epoch 4/20
 - 3s - loss: 0.2729 - acc: 0.9149 - val_loss: 0.1845 - val_acc: 0.9414
Epoch 5/20
 - 3s - loss: 0.2433 - acc: 0.9249 - val_loss: 0.1638 - val_acc: 0.9508
Epoch 6/20
 - 3s - loss: 0.2190 - acc: 0.9319 - val_loss: 0.1424 - val_acc: 0.9564
Epoch 7/20
 - 3s - loss: 0.2059 - acc: 0.9360 - val_loss: 0.1129 - val_acc: 0.9662
Epoch 8/20
 - 3s - loss: 0.1945 - acc: 0.9404 - val_loss: 0.1351 - val_acc: 0.9568
Epoch 9/20
 - 3s - loss: 0.1886 - acc: 0.9421 - val_loss: 0.2034 - val_acc: 0.9376
Epoch 10/20
 - 3s - loss: 0.1821 - acc: 0.9458 - val_loss: 0.1815 - val_acc: 0.9495
Epoch 11/20
 - 3s - loss: 0.1743 - acc: 0.9486 - val_loss: 0.0947 - val_acc: 0.9714
Epoch 12/20
 - 3s - loss: 0.1751 - acc: 0.9487 - val_loss: 0.2131 - val_acc: 0.9405
Epoch 13/20
 - 3s - loss: 0.1720 - acc: 0.9494 - val_loss: 0.1481 - val_acc: 0.9551
Epoch 14/20
 - 3s - loss: 0.1707 - acc: 0.9508 - val_loss: 0.1570 - val_acc: 0.9554
Epoch 15/20
 - 3s - loss: 0.1687 - acc: 0.9519 - val_loss: 0.1306 - val_acc: 0.9633
Epoch 16/20
 - 3s - loss: 0.1718 - acc: 0.9508 - val_loss: 0.1535 - val_acc: 0.9580
Epoch 17/20
 - 3s - loss: 0.1702 - acc: 0.9518 - val_loss: 0.1389 - val_acc: 0.9598
Epoch 18/20
 - 3s - loss: 0.1676 - acc: 0.9531 - val_loss: 0.1031 - val_acc: 0.9712
Epoch 19/20
 - 3s - loss: 0.1638 - acc: 0.9543 - val_loss: 0.1071 - val_acc: 0.9713
Epoch 20/20
 - 3s - loss: 0.1676 - acc: 0.9533 - val_loss: 0.0997 - val_acc: 0.9725
Test loss: 0.10049169616418076
Test accuracy: 0.9716
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9585 - acc: 0.6984 - val_loss: 0.4789 - val_acc: 0.8530
Epoch 2/20
 - 4s - loss: 0.4279 - acc: 0.8645 - val_loss: 0.2614 - val_acc: 0.9136
Epoch 3/20
 - 4s - loss: 0.3241 - acc: 0.8982 - val_loss: 0.2708 - val_acc: 0.9177
Epoch 4/20
 - 4s - loss: 0.2644 - acc: 0.9171 - val_loss: 0.2453 - val_acc: 0.9215
Epoch 5/20
 - 4s - loss: 0.2334 - acc: 0.9274 - val_loss: 0.1654 - val_acc: 0.9487
Epoch 6/20
 - 4s - loss: 0.2150 - acc: 0.9345 - val_loss: 0.1459 - val_acc: 0.9549
Epoch 7/20
 - 4s - loss: 0.1996 - acc: 0.9385 - val_loss: 0.1556 - val_acc: 0.9549
Epoch 8/20
 - 4s - loss: 0.1968 - acc: 0.9413 - val_loss: 0.1481 - val_acc: 0.9559
Epoch 9/20
 - 4s - loss: 0.1846 - acc: 0.9449 - val_loss: 0.1620 - val_acc: 0.9542
Epoch 10/20
 - 4s - loss: 0.1826 - acc: 0.9454 - val_loss: 0.1185 - val_acc: 0.9638
Epoch 11/20
 - 4s - loss: 0.1777 - acc: 0.9478 - val_loss: 0.1095 - val_acc: 0.9703
Epoch 12/20
 - 4s - loss: 0.1731 - acc: 0.9498 - val_loss: 0.1383 - val_acc: 0.9612
Epoch 13/20
 - 4s - loss: 0.1728 - acc: 0.9486 - val_loss: 0.1213 - val_acc: 0.9647
Epoch 14/20
 - 4s - loss: 0.1693 - acc: 0.9516 - val_loss: 0.1227 - val_acc: 0.9637
Epoch 15/20
 - 4s - loss: 0.1658 - acc: 0.9522 - val_loss: 0.1219 - val_acc: 0.9644
Epoch 16/20
 - 4s - loss: 0.1679 - acc: 0.9526 - val_loss: 0.1019 - val_acc: 0.9724
Epoch 17/20
 - 4s - loss: 0.1698 - acc: 0.9513 - val_loss: 0.1711 - val_acc: 0.9495
Epoch 18/20
 - 4s - loss: 0.1704 - acc: 0.9533 - val_loss: 0.1255 - val_acc: 0.9663
Epoch 19/20
 - 4s - loss: 0.1663 - acc: 0.9546 - val_loss: 0.1898 - val_acc: 0.9500
Epoch 20/20
 - 4s - loss: 0.1709 - acc: 0.9529 - val_loss: 0.1102 - val_acc: 0.9700
Test loss: 0.1101740540689876
Test accuracy: 0.9699
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9347 - acc: 0.6962 - val_loss: 0.3938 - val_acc: 0.8767
Epoch 2/20
 - 4s - loss: 0.4351 - acc: 0.8623 - val_loss: 0.2221 - val_acc: 0.9296
Epoch 3/20
 - 4s - loss: 0.3267 - acc: 0.8971 - val_loss: 0.2199 - val_acc: 0.9319
Epoch 4/20
 - 4s - loss: 0.2734 - acc: 0.9146 - val_loss: 0.1697 - val_acc: 0.9483
Epoch 5/20
 - 4s - loss: 0.2388 - acc: 0.9254 - val_loss: 0.1591 - val_acc: 0.9523
Epoch 6/20
 - 4s - loss: 0.2177 - acc: 0.9332 - val_loss: 0.1382 - val_acc: 0.9587
Epoch 7/20
 - 4s - loss: 0.2062 - acc: 0.9369 - val_loss: 0.1420 - val_acc: 0.9528
Epoch 8/20
 - 4s - loss: 0.1918 - acc: 0.9416 - val_loss: 0.1200 - val_acc: 0.9631
Epoch 9/20
 - 4s - loss: 0.1846 - acc: 0.9445 - val_loss: 0.1203 - val_acc: 0.9610
Epoch 10/20
 - 4s - loss: 0.1790 - acc: 0.9470 - val_loss: 0.1178 - val_acc: 0.9635
Epoch 11/20
 - 4s - loss: 0.1732 - acc: 0.9495 - val_loss: 0.1057 - val_acc: 0.9684
Epoch 12/20
 - 4s - loss: 0.1674 - acc: 0.9500 - val_loss: 0.1196 - val_acc: 0.9653
Epoch 13/20
 - 4s - loss: 0.1692 - acc: 0.9499 - val_loss: 0.1772 - val_acc: 0.9451
Epoch 14/20
 - 4s - loss: 0.1639 - acc: 0.9518 - val_loss: 0.1020 - val_acc: 0.9721
Epoch 15/20
 - 4s - loss: 0.1645 - acc: 0.9530 - val_loss: 0.1034 - val_acc: 0.9683
Epoch 16/20
 - 4s - loss: 0.1589 - acc: 0.9533 - val_loss: 0.1257 - val_acc: 0.9601
Epoch 17/20
 - 4s - loss: 0.1601 - acc: 0.9546 - val_loss: 0.1244 - val_acc: 0.9662
Epoch 18/20
 - 4s - loss: 0.1655 - acc: 0.9539 - val_loss: 0.1151 - val_acc: 0.9665
Epoch 19/20
 - 4s - loss: 0.1636 - acc: 0.9537 - val_loss: 0.1341 - val_acc: 0.9626
Epoch 20/20
 - 4s - loss: 0.1624 - acc: 0.9540 - val_loss: 0.1123 - val_acc: 0.9685
Test loss: 0.11114196608632337
Test accuracy: 0.9681
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9351 - acc: 0.6978 - val_loss: 0.6140 - val_acc: 0.8049
Epoch 2/20
 - 6s - loss: 0.4291 - acc: 0.8626 - val_loss: 0.3182 - val_acc: 0.8921
Epoch 3/20
 - 6s - loss: 0.3242 - acc: 0.8967 - val_loss: 0.2140 - val_acc: 0.9326
Epoch 4/20
 - 6s - loss: 0.2665 - acc: 0.9157 - val_loss: 0.2857 - val_acc: 0.9022
Epoch 5/20
 - 6s - loss: 0.2360 - acc: 0.9273 - val_loss: 0.1474 - val_acc: 0.9532
Epoch 6/20
 - 6s - loss: 0.2164 - acc: 0.9327 - val_loss: 0.1403 - val_acc: 0.9547
Epoch 7/20
 - 6s - loss: 0.2020 - acc: 0.9381 - val_loss: 0.1344 - val_acc: 0.9586
Epoch 8/20
 - 6s - loss: 0.1916 - acc: 0.9408 - val_loss: 0.1392 - val_acc: 0.9564
Epoch 9/20
 - 6s - loss: 0.1833 - acc: 0.9453 - val_loss: 0.1638 - val_acc: 0.9477
Epoch 10/20
 - 6s - loss: 0.1774 - acc: 0.9467 - val_loss: 0.1192 - val_acc: 0.9641
Epoch 11/20
 - 6s - loss: 0.1699 - acc: 0.9493 - val_loss: 0.2020 - val_acc: 0.9341
Epoch 12/20
 - 6s - loss: 0.1655 - acc: 0.9511 - val_loss: 0.1275 - val_acc: 0.9639
Epoch 13/20
 - 6s - loss: 0.1662 - acc: 0.9504 - val_loss: 0.1528 - val_acc: 0.9591
Epoch 14/20
 - 6s - loss: 0.1658 - acc: 0.9509 - val_loss: 0.0878 - val_acc: 0.9728
Epoch 15/20
 - 6s - loss: 0.1604 - acc: 0.9535 - val_loss: 0.1064 - val_acc: 0.9668
Epoch 16/20
 - 6s - loss: 0.1581 - acc: 0.9542 - val_loss: 0.1096 - val_acc: 0.9683
Epoch 17/20
 - 6s - loss: 0.1573 - acc: 0.9548 - val_loss: 0.1212 - val_acc: 0.9661
Epoch 18/20
 - 6s - loss: 0.1586 - acc: 0.9535 - val_loss: 0.1184 - val_acc: 0.9667
Epoch 19/20
 - 6s - loss: 0.1589 - acc: 0.9548 - val_loss: 0.1585 - val_acc: 0.9570
Epoch 20/20
 - 6s - loss: 0.1579 - acc: 0.9549 - val_loss: 0.1378 - val_acc: 0.9604
Test loss: 0.13885451657343656
Test accuracy: 0.9596
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9319 - acc: 0.7050 - val_loss: 0.6265 - val_acc: 0.7735
Epoch 2/20
 - 9s - loss: 0.4224 - acc: 0.8641 - val_loss: 0.2360 - val_acc: 0.9269
Epoch 3/20
 - 9s - loss: 0.3209 - acc: 0.8991 - val_loss: 0.2105 - val_acc: 0.9341
Epoch 4/20
 - 9s - loss: 0.2683 - acc: 0.9163 - val_loss: 0.1788 - val_acc: 0.9401
Epoch 5/20
 - 9s - loss: 0.2340 - acc: 0.9289 - val_loss: 0.1821 - val_acc: 0.9438
Epoch 6/20
 - 9s - loss: 0.2162 - acc: 0.9328 - val_loss: 0.1700 - val_acc: 0.9467
Epoch 7/20
 - 9s - loss: 0.2014 - acc: 0.9381 - val_loss: 0.1747 - val_acc: 0.9437
Epoch 8/20
 - 9s - loss: 0.1864 - acc: 0.9426 - val_loss: 0.1605 - val_acc: 0.9499
Epoch 9/20
 - 9s - loss: 0.1773 - acc: 0.9467 - val_loss: 0.1166 - val_acc: 0.9667
Epoch 10/20
 - 9s - loss: 0.1742 - acc: 0.9471 - val_loss: 0.1419 - val_acc: 0.9573
Epoch 11/20
 - 9s - loss: 0.1708 - acc: 0.9499 - val_loss: 0.1444 - val_acc: 0.9546
Epoch 12/20
 - 9s - loss: 0.1658 - acc: 0.9501 - val_loss: 0.1112 - val_acc: 0.9664
Epoch 13/20
 - 9s - loss: 0.1632 - acc: 0.9519 - val_loss: 0.1088 - val_acc: 0.9665
Epoch 14/20
 - 9s - loss: 0.1614 - acc: 0.9531 - val_loss: 0.1171 - val_acc: 0.9644
Epoch 15/20
 - 9s - loss: 0.1625 - acc: 0.9530 - val_loss: 0.1475 - val_acc: 0.9599
Epoch 16/20
 - 9s - loss: 0.1656 - acc: 0.9528 - val_loss: 0.1089 - val_acc: 0.9694
Epoch 17/20
 - 9s - loss: 0.1596 - acc: 0.9544 - val_loss: 0.1364 - val_acc: 0.9648
Epoch 18/20
 - 9s - loss: 0.1623 - acc: 0.9541 - val_loss: 0.0920 - val_acc: 0.9728
Epoch 19/20
 - 9s - loss: 0.1613 - acc: 0.9545 - val_loss: 0.1074 - val_acc: 0.9690
Epoch 20/20
 - 9s - loss: 0.1581 - acc: 0.9546 - val_loss: 0.1745 - val_acc: 0.9566
Test loss: 0.17361870513249889
Test accuracy: 0.9572
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9362 - acc: 0.6955 - val_loss: 0.4409 - val_acc: 0.8472
Epoch 2/20
 - 14s - loss: 0.4377 - acc: 0.8618 - val_loss: 0.3641 - val_acc: 0.8871
Epoch 3/20
 - 14s - loss: 0.3170 - acc: 0.8983 - val_loss: 0.3125 - val_acc: 0.9050
Epoch 4/20
 - 14s - loss: 0.2668 - acc: 0.9161 - val_loss: 0.1669 - val_acc: 0.9474
Epoch 5/20
 - 14s - loss: 0.2364 - acc: 0.9279 - val_loss: 0.1918 - val_acc: 0.9408
Epoch 6/20
 - 14s - loss: 0.2174 - acc: 0.9332 - val_loss: 0.1942 - val_acc: 0.9397
Epoch 7/20
 - 14s - loss: 0.2037 - acc: 0.9385 - val_loss: 0.2012 - val_acc: 0.9370
Epoch 8/20
 - 14s - loss: 0.1930 - acc: 0.9419 - val_loss: 0.1631 - val_acc: 0.9517
Epoch 9/20
 - 14s - loss: 0.1891 - acc: 0.9430 - val_loss: 0.1190 - val_acc: 0.9625
Epoch 10/20
 - 14s - loss: 0.1826 - acc: 0.9445 - val_loss: 0.1426 - val_acc: 0.9558
Epoch 11/20
 - 14s - loss: 0.1741 - acc: 0.9487 - val_loss: 0.1503 - val_acc: 0.9537
Epoch 12/20
 - 14s - loss: 0.1734 - acc: 0.9490 - val_loss: 0.1240 - val_acc: 0.9642
Epoch 13/20
 - 14s - loss: 0.1674 - acc: 0.9507 - val_loss: 0.1126 - val_acc: 0.9665
Epoch 14/20
 - 14s - loss: 0.1647 - acc: 0.9523 - val_loss: 0.1436 - val_acc: 0.9589
Epoch 15/20
 - 14s - loss: 0.1678 - acc: 0.9519 - val_loss: 0.2329 - val_acc: 0.9257
Epoch 16/20
 - 14s - loss: 0.1651 - acc: 0.9528 - val_loss: 0.1000 - val_acc: 0.9711
Epoch 17/20
 - 14s - loss: 0.1649 - acc: 0.9541 - val_loss: 0.1500 - val_acc: 0.9556
Epoch 18/20
 - 14s - loss: 0.1644 - acc: 0.9540 - val_loss: 0.1192 - val_acc: 0.9650
Epoch 19/20
 - 14s - loss: 0.1697 - acc: 0.9531 - val_loss: 0.1241 - val_acc: 0.9680
Epoch 20/20
 - 14s - loss: 0.1674 - acc: 0.9540 - val_loss: 0.0974 - val_acc: 0.9740
Test loss: 0.09739279243941419
Test accuracy: 0.9743
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9463 - acc: 0.6955 - val_loss: 0.5336 - val_acc: 0.8172
Epoch 2/20
 - 26s - loss: 0.4332 - acc: 0.8616 - val_loss: 0.2301 - val_acc: 0.9341
Epoch 3/20
 - 26s - loss: 0.3195 - acc: 0.8984 - val_loss: 0.1919 - val_acc: 0.9402
Epoch 4/20
 - 26s - loss: 0.2743 - acc: 0.9154 - val_loss: 0.1532 - val_acc: 0.9509
Epoch 5/20
 - 26s - loss: 0.2385 - acc: 0.9264 - val_loss: 0.1573 - val_acc: 0.9532
Epoch 6/20
 - 26s - loss: 0.2154 - acc: 0.9333 - val_loss: 0.1726 - val_acc: 0.9476
Epoch 7/20
 - 26s - loss: 0.2033 - acc: 0.9372 - val_loss: 0.1501 - val_acc: 0.9563
Epoch 8/20
 - 26s - loss: 0.1902 - acc: 0.9427 - val_loss: 0.1259 - val_acc: 0.9624
Epoch 9/20
 - 26s - loss: 0.1838 - acc: 0.9437 - val_loss: 0.1231 - val_acc: 0.9613
Epoch 10/20
 - 26s - loss: 0.1781 - acc: 0.9469 - val_loss: 0.1595 - val_acc: 0.9515
Epoch 11/20
 - 26s - loss: 0.1720 - acc: 0.9486 - val_loss: 0.1663 - val_acc: 0.9487
Epoch 12/20
 - 26s - loss: 0.1708 - acc: 0.9497 - val_loss: 0.1230 - val_acc: 0.9641
Epoch 13/20
 - 26s - loss: 0.1656 - acc: 0.9500 - val_loss: 0.1178 - val_acc: 0.9656
Epoch 14/20
 - 26s - loss: 0.1631 - acc: 0.9521 - val_loss: 0.1935 - val_acc: 0.9413
Epoch 15/20
 - 26s - loss: 0.1598 - acc: 0.9539 - val_loss: 0.1627 - val_acc: 0.9557
Epoch 16/20
 - 26s - loss: 0.1640 - acc: 0.9519 - val_loss: 0.1171 - val_acc: 0.9668
Epoch 17/20
 - 26s - loss: 0.1585 - acc: 0.9546 - val_loss: 0.1899 - val_acc: 0.9413
Epoch 18/20
 - 26s - loss: 0.1599 - acc: 0.9555 - val_loss: 0.1372 - val_acc: 0.9670
Epoch 19/20
 - 26s - loss: 0.1557 - acc: 0.9558 - val_loss: 0.1110 - val_acc: 0.9681
Epoch 20/20
 - 26s - loss: 0.1580 - acc: 0.9562 - val_loss: 0.1043 - val_acc: 0.9721
Test loss: 0.10436601010762242
Test accuracy: 0.9729
================
Start of new run
================
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 1
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9503 - acc: 0.6926 - val_loss: 0.5397 - val_acc: 0.8250
Epoch 2/20
 - 3s - loss: 0.4577 - acc: 0.8536 - val_loss: 0.3285 - val_acc: 0.8880
Epoch 3/20
 - 3s - loss: 0.3465 - acc: 0.8901 - val_loss: 0.2900 - val_acc: 0.9019
Epoch 4/20
 - 3s - loss: 0.2888 - acc: 0.9098 - val_loss: 0.1943 - val_acc: 0.9388
Epoch 5/20
 - 3s - loss: 0.2620 - acc: 0.9185 - val_loss: 0.1908 - val_acc: 0.9415
Epoch 6/20
 - 3s - loss: 0.2410 - acc: 0.9247 - val_loss: 0.1508 - val_acc: 0.9548
Epoch 7/20
 - 3s - loss: 0.2301 - acc: 0.9299 - val_loss: 0.1516 - val_acc: 0.9522
Epoch 8/20
 - 3s - loss: 0.2162 - acc: 0.9341 - val_loss: 0.1644 - val_acc: 0.9460
Epoch 9/20
 - 3s - loss: 0.2114 - acc: 0.9348 - val_loss: 0.1619 - val_acc: 0.9487
Epoch 10/20
 - 3s - loss: 0.2061 - acc: 0.9386 - val_loss: 0.1429 - val_acc: 0.9561
Epoch 11/20
 - 3s - loss: 0.2031 - acc: 0.9390 - val_loss: 0.1690 - val_acc: 0.9479
Epoch 12/20
 - 3s - loss: 0.2029 - acc: 0.9395 - val_loss: 0.1156 - val_acc: 0.9648
Epoch 13/20
 - 3s - loss: 0.1959 - acc: 0.9422 - val_loss: 0.1412 - val_acc: 0.9554
Epoch 14/20
 - 3s - loss: 0.2008 - acc: 0.9435 - val_loss: 0.1307 - val_acc: 0.9605
Epoch 15/20
 - 3s - loss: 0.1920 - acc: 0.9424 - val_loss: 0.1156 - val_acc: 0.9663
Epoch 16/20
 - 3s - loss: 0.1997 - acc: 0.9426 - val_loss: 0.1692 - val_acc: 0.9487
Epoch 17/20
 - 3s - loss: 0.2003 - acc: 0.9436 - val_loss: 0.1091 - val_acc: 0.9662
Epoch 18/20
 - 3s - loss: 0.1945 - acc: 0.9456 - val_loss: 0.1450 - val_acc: 0.9581
Epoch 19/20
 - 3s - loss: 0.1975 - acc: 0.9454 - val_loss: 0.1243 - val_acc: 0.9632
Epoch 20/20
 - 3s - loss: 0.1941 - acc: 0.9452 - val_loss: 0.2179 - val_acc: 0.9468
Test loss: 0.21119695680277656
Test accuracy: 0.9484
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 2
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9305 - acc: 0.6945 - val_loss: 0.6107 - val_acc: 0.7910
Epoch 2/20
 - 3s - loss: 0.4488 - acc: 0.8545 - val_loss: 0.3160 - val_acc: 0.8969
Epoch 3/20
 - 3s - loss: 0.3394 - acc: 0.8921 - val_loss: 0.2215 - val_acc: 0.9301
Epoch 4/20
 - 3s - loss: 0.2840 - acc: 0.9112 - val_loss: 0.1781 - val_acc: 0.9436
Epoch 5/20
 - 3s - loss: 0.2498 - acc: 0.9212 - val_loss: 0.1550 - val_acc: 0.9504
Epoch 6/20
 - 3s - loss: 0.2291 - acc: 0.9296 - val_loss: 0.1687 - val_acc: 0.9492
Epoch 7/20
 - 3s - loss: 0.2155 - acc: 0.9332 - val_loss: 0.1435 - val_acc: 0.9563
Epoch 8/20
 - 3s - loss: 0.2067 - acc: 0.9371 - val_loss: 0.1506 - val_acc: 0.9550
Epoch 9/20
 - 3s - loss: 0.2002 - acc: 0.9397 - val_loss: 0.1879 - val_acc: 0.9404
Epoch 10/20
 - 3s - loss: 0.1925 - acc: 0.9415 - val_loss: 0.1413 - val_acc: 0.9571
Epoch 11/20
 - 3s - loss: 0.1929 - acc: 0.9426 - val_loss: 0.1259 - val_acc: 0.9598
Epoch 12/20
 - 3s - loss: 0.1855 - acc: 0.9457 - val_loss: 0.1251 - val_acc: 0.9605
Epoch 13/20
 - 3s - loss: 0.1810 - acc: 0.9458 - val_loss: 0.1589 - val_acc: 0.9555
Epoch 14/20
 - 3s - loss: 0.1804 - acc: 0.9470 - val_loss: 0.1479 - val_acc: 0.9569
Epoch 15/20
 - 3s - loss: 0.1832 - acc: 0.9468 - val_loss: 0.1068 - val_acc: 0.9681
Epoch 16/20
 - 3s - loss: 0.1840 - acc: 0.9471 - val_loss: 0.1875 - val_acc: 0.9506
Epoch 17/20
 - 3s - loss: 0.1799 - acc: 0.9484 - val_loss: 0.1191 - val_acc: 0.9663
Epoch 18/20
 - 3s - loss: 0.1795 - acc: 0.9497 - val_loss: 0.1266 - val_acc: 0.9641
Epoch 19/20
 - 3s - loss: 0.1791 - acc: 0.9497 - val_loss: 0.1131 - val_acc: 0.9681
Epoch 20/20
 - 3s - loss: 0.1804 - acc: 0.9490 - val_loss: 0.1096 - val_acc: 0.9679
Test loss: 0.10844392175190151
Test accuracy: 0.9689
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 4
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9431 - acc: 0.6953 - val_loss: 0.5310 - val_acc: 0.8198
Epoch 2/20
 - 3s - loss: 0.4387 - acc: 0.8610 - val_loss: 0.3657 - val_acc: 0.8740
Epoch 3/20
 - 3s - loss: 0.3302 - acc: 0.8962 - val_loss: 0.1946 - val_acc: 0.9400
Epoch 4/20
 - 3s - loss: 0.2730 - acc: 0.9139 - val_loss: 0.2218 - val_acc: 0.9315
Epoch 5/20
 - 3s - loss: 0.2381 - acc: 0.9254 - val_loss: 0.1741 - val_acc: 0.9398
Epoch 6/20
 - 3s - loss: 0.2203 - acc: 0.9324 - val_loss: 0.2397 - val_acc: 0.9269
Epoch 7/20
 - 3s - loss: 0.2070 - acc: 0.9368 - val_loss: 0.1639 - val_acc: 0.9487
Epoch 8/20
 - 3s - loss: 0.1934 - acc: 0.9404 - val_loss: 0.1538 - val_acc: 0.9535
Epoch 9/20
 - 3s - loss: 0.1884 - acc: 0.9434 - val_loss: 0.1492 - val_acc: 0.9549
Epoch 10/20
 - 3s - loss: 0.1838 - acc: 0.9452 - val_loss: 0.1077 - val_acc: 0.9664
Epoch 11/20
 - 3s - loss: 0.1790 - acc: 0.9460 - val_loss: 0.1236 - val_acc: 0.9646
Epoch 12/20
 - 3s - loss: 0.1750 - acc: 0.9486 - val_loss: 0.1095 - val_acc: 0.9684
Epoch 13/20
 - 3s - loss: 0.1737 - acc: 0.9498 - val_loss: 0.0983 - val_acc: 0.9718
Epoch 14/20
 - 3s - loss: 0.1731 - acc: 0.9497 - val_loss: 0.1376 - val_acc: 0.9573
Epoch 15/20
 - 3s - loss: 0.1684 - acc: 0.9511 - val_loss: 0.1177 - val_acc: 0.9635
Epoch 16/20
 - 3s - loss: 0.1661 - acc: 0.9518 - val_loss: 0.1307 - val_acc: 0.9660
Epoch 17/20
 - 3s - loss: 0.1716 - acc: 0.9517 - val_loss: 0.1298 - val_acc: 0.9637
Epoch 18/20
 - 3s - loss: 0.1686 - acc: 0.9529 - val_loss: 0.1169 - val_acc: 0.9673
Epoch 19/20
 - 3s - loss: 0.1676 - acc: 0.9517 - val_loss: 0.1316 - val_acc: 0.9629
Epoch 20/20
 - 3s - loss: 0.1679 - acc: 0.9526 - val_loss: 0.1223 - val_acc: 0.9660
Test loss: 0.12241236397557659
Test accuracy: 0.9675
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 8
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.9459 - acc: 0.6956 - val_loss: 1.0436 - val_acc: 0.6863
Epoch 2/20
 - 3s - loss: 0.4319 - acc: 0.8607 - val_loss: 0.2062 - val_acc: 0.9369
Epoch 3/20
 - 3s - loss: 0.3287 - acc: 0.8965 - val_loss: 0.2956 - val_acc: 0.8987
Epoch 4/20
 - 3s - loss: 0.2721 - acc: 0.9141 - val_loss: 0.2485 - val_acc: 0.9190
Epoch 5/20
 - 3s - loss: 0.2399 - acc: 0.9257 - val_loss: 0.1851 - val_acc: 0.9406
Epoch 6/20
 - 3s - loss: 0.2214 - acc: 0.9328 - val_loss: 0.1936 - val_acc: 0.9371
Epoch 7/20
 - 3s - loss: 0.2027 - acc: 0.9369 - val_loss: 0.1544 - val_acc: 0.9523
Epoch 8/20
 - 3s - loss: 0.1949 - acc: 0.9398 - val_loss: 0.1500 - val_acc: 0.9552
Epoch 9/20
 - 3s - loss: 0.1857 - acc: 0.9438 - val_loss: 0.2158 - val_acc: 0.9295
Epoch 10/20
 - 3s - loss: 0.1832 - acc: 0.9452 - val_loss: 0.1365 - val_acc: 0.9596
Epoch 11/20
 - 3s - loss: 0.1743 - acc: 0.9471 - val_loss: 0.1172 - val_acc: 0.9656
Epoch 12/20
 - 3s - loss: 0.1743 - acc: 0.9478 - val_loss: 0.1068 - val_acc: 0.9698
Epoch 13/20
 - 3s - loss: 0.1667 - acc: 0.9505 - val_loss: 0.1081 - val_acc: 0.9675
Epoch 14/20
 - 3s - loss: 0.1678 - acc: 0.9514 - val_loss: 0.1304 - val_acc: 0.9621
Epoch 15/20
 - 3s - loss: 0.1647 - acc: 0.9515 - val_loss: 0.1045 - val_acc: 0.9717
Epoch 16/20
 - 3s - loss: 0.1624 - acc: 0.9529 - val_loss: 0.1500 - val_acc: 0.9571
Epoch 17/20
 - 3s - loss: 0.1622 - acc: 0.9531 - val_loss: 0.1031 - val_acc: 0.9681
Epoch 18/20
 - 3s - loss: 0.1577 - acc: 0.9545 - val_loss: 0.0832 - val_acc: 0.9738
Epoch 19/20
 - 3s - loss: 0.1619 - acc: 0.9535 - val_loss: 0.1041 - val_acc: 0.9657
Epoch 20/20
 - 3s - loss: 0.1625 - acc: 0.9542 - val_loss: 0.1121 - val_acc: 0.9694
Test loss: 0.1114195748213795
Test accuracy: 0.97
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 16
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9316 - acc: 0.7001 - val_loss: 0.4059 - val_acc: 0.8643
Epoch 2/20
 - 4s - loss: 0.4282 - acc: 0.8640 - val_loss: 0.2192 - val_acc: 0.9304
Epoch 3/20
 - 4s - loss: 0.3183 - acc: 0.8994 - val_loss: 0.3663 - val_acc: 0.8734
Epoch 4/20
 - 4s - loss: 0.2716 - acc: 0.9144 - val_loss: 0.1916 - val_acc: 0.9430
Epoch 5/20
 - 4s - loss: 0.2356 - acc: 0.9265 - val_loss: 0.3353 - val_acc: 0.8931
Epoch 6/20
 - 4s - loss: 0.2192 - acc: 0.9341 - val_loss: 0.1559 - val_acc: 0.9499
Epoch 7/20
 - 4s - loss: 0.2032 - acc: 0.9383 - val_loss: 0.1491 - val_acc: 0.9542
Epoch 8/20
 - 4s - loss: 0.1976 - acc: 0.9394 - val_loss: 0.1640 - val_acc: 0.9480
Epoch 9/20
 - 4s - loss: 0.1902 - acc: 0.9433 - val_loss: 0.1166 - val_acc: 0.9673
Epoch 10/20
 - 4s - loss: 0.1847 - acc: 0.9446 - val_loss: 0.1148 - val_acc: 0.9630
Epoch 11/20
 - 4s - loss: 0.1785 - acc: 0.9466 - val_loss: 0.1523 - val_acc: 0.9581
Epoch 12/20
 - 4s - loss: 0.1744 - acc: 0.9495 - val_loss: 0.1227 - val_acc: 0.9639
Epoch 13/20
 - 4s - loss: 0.1721 - acc: 0.9494 - val_loss: 0.1210 - val_acc: 0.9615
Epoch 14/20
 - 4s - loss: 0.1681 - acc: 0.9507 - val_loss: 0.1025 - val_acc: 0.9694
Epoch 15/20
 - 4s - loss: 0.1675 - acc: 0.9516 - val_loss: 0.1156 - val_acc: 0.9662
Epoch 16/20
 - 4s - loss: 0.1714 - acc: 0.9516 - val_loss: 0.0993 - val_acc: 0.9706
Epoch 17/20
 - 4s - loss: 0.1660 - acc: 0.9532 - val_loss: 0.1404 - val_acc: 0.9636
Epoch 18/20
 - 4s - loss: 0.1658 - acc: 0.9525 - val_loss: 0.1000 - val_acc: 0.9724
Epoch 19/20
 - 4s - loss: 0.1708 - acc: 0.9511 - val_loss: 0.1396 - val_acc: 0.9600
Epoch 20/20
 - 4s - loss: 0.1671 - acc: 0.9530 - val_loss: 0.1272 - val_acc: 0.9646
Test loss: 0.12851115063978358
Test accuracy: 0.9647
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 7s - loss: 0.9375 - acc: 0.6980 - val_loss: 0.6586 - val_acc: 0.7870
Epoch 2/20
 - 4s - loss: 0.4366 - acc: 0.8593 - val_loss: 0.2789 - val_acc: 0.9108
Epoch 3/20
 - 4s - loss: 0.3291 - acc: 0.8951 - val_loss: 0.2414 - val_acc: 0.9252
Epoch 4/20
 - 4s - loss: 0.2721 - acc: 0.9142 - val_loss: 0.1822 - val_acc: 0.9416
Epoch 5/20
 - 4s - loss: 0.2397 - acc: 0.9253 - val_loss: 0.1701 - val_acc: 0.9471
Epoch 6/20
 - 4s - loss: 0.2177 - acc: 0.9329 - val_loss: 0.1498 - val_acc: 0.9530
Epoch 7/20
 - 4s - loss: 0.2025 - acc: 0.9391 - val_loss: 0.1869 - val_acc: 0.9415
Epoch 8/20
 - 4s - loss: 0.1955 - acc: 0.9403 - val_loss: 0.1363 - val_acc: 0.9594
Epoch 9/20
 - 4s - loss: 0.1838 - acc: 0.9445 - val_loss: 0.1355 - val_acc: 0.9567
Epoch 10/20
 - 4s - loss: 0.1803 - acc: 0.9446 - val_loss: 0.1185 - val_acc: 0.9646
Epoch 11/20
 - 4s - loss: 0.1739 - acc: 0.9483 - val_loss: 0.1081 - val_acc: 0.9688
Epoch 12/20
 - 4s - loss: 0.1705 - acc: 0.9494 - val_loss: 0.1224 - val_acc: 0.9655
Epoch 13/20
 - 4s - loss: 0.1694 - acc: 0.9498 - val_loss: 0.1199 - val_acc: 0.9681
Epoch 14/20
 - 4s - loss: 0.1647 - acc: 0.9518 - val_loss: 0.1252 - val_acc: 0.9650
Epoch 15/20
 - 4s - loss: 0.1632 - acc: 0.9520 - val_loss: 0.1211 - val_acc: 0.9606
Epoch 16/20
 - 4s - loss: 0.1641 - acc: 0.9539 - val_loss: 0.0997 - val_acc: 0.9697
Epoch 17/20
 - 4s - loss: 0.1614 - acc: 0.9539 - val_loss: 0.1029 - val_acc: 0.9710
Epoch 18/20
 - 4s - loss: 0.1671 - acc: 0.9524 - val_loss: 0.1442 - val_acc: 0.9584
Epoch 19/20
 - 4s - loss: 0.1618 - acc: 0.9538 - val_loss: 0.0997 - val_acc: 0.9710
Epoch 20/20
 - 4s - loss: 0.1649 - acc: 0.9528 - val_loss: 0.1076 - val_acc: 0.9723
Test loss: 0.10758112240904592
Test accuracy: 0.9703
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 64
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 9s - loss: 0.9610 - acc: 0.6975 - val_loss: 0.4782 - val_acc: 0.8349
Epoch 2/20
 - 6s - loss: 0.4344 - acc: 0.8627 - val_loss: 0.3307 - val_acc: 0.8932
Epoch 3/20
 - 6s - loss: 0.3248 - acc: 0.8985 - val_loss: 0.1685 - val_acc: 0.9465
Epoch 4/20
 - 6s - loss: 0.2675 - acc: 0.9168 - val_loss: 0.1509 - val_acc: 0.9524
Epoch 5/20
 - 6s - loss: 0.2381 - acc: 0.9262 - val_loss: 0.1418 - val_acc: 0.9544
Epoch 6/20
 - 6s - loss: 0.2148 - acc: 0.9335 - val_loss: 0.1733 - val_acc: 0.9435
Epoch 7/20
 - 6s - loss: 0.2015 - acc: 0.9382 - val_loss: 0.1200 - val_acc: 0.9610
Epoch 8/20
 - 6s - loss: 0.1926 - acc: 0.9418 - val_loss: 0.1326 - val_acc: 0.9593
Epoch 9/20
 - 6s - loss: 0.1842 - acc: 0.9449 - val_loss: 0.1156 - val_acc: 0.9640
Epoch 10/20
 - 6s - loss: 0.1789 - acc: 0.9463 - val_loss: 0.2019 - val_acc: 0.9267
Epoch 11/20
 - 6s - loss: 0.1761 - acc: 0.9477 - val_loss: 0.1156 - val_acc: 0.9625
Epoch 12/20
 - 6s - loss: 0.1707 - acc: 0.9496 - val_loss: 0.1235 - val_acc: 0.9626
Epoch 13/20
 - 6s - loss: 0.1684 - acc: 0.9508 - val_loss: 0.1260 - val_acc: 0.9656
Epoch 14/20
 - 6s - loss: 0.1687 - acc: 0.9512 - val_loss: 0.1353 - val_acc: 0.9607
Epoch 15/20
 - 6s - loss: 0.1677 - acc: 0.9524 - val_loss: 0.0985 - val_acc: 0.9695
Epoch 16/20
 - 6s - loss: 0.1635 - acc: 0.9538 - val_loss: 0.1511 - val_acc: 0.9551
Epoch 17/20
 - 6s - loss: 0.1639 - acc: 0.9539 - val_loss: 0.1609 - val_acc: 0.9492
Epoch 18/20
 - 6s - loss: 0.1681 - acc: 0.9517 - val_loss: 0.1282 - val_acc: 0.9663
Epoch 19/20
 - 6s - loss: 0.1681 - acc: 0.9537 - val_loss: 0.1138 - val_acc: 0.9653
Epoch 20/20
 - 6s - loss: 0.1658 - acc: 0.9539 - val_loss: 0.0992 - val_acc: 0.9708
Test loss: 0.09998481777328998
Test accuracy: 0.971
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 128
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 12s - loss: 0.9237 - acc: 0.7002 - val_loss: 0.3615 - val_acc: 0.8872
Epoch 2/20
 - 9s - loss: 0.4287 - acc: 0.8628 - val_loss: 0.2768 - val_acc: 0.9131
Epoch 3/20
 - 9s - loss: 0.3218 - acc: 0.8984 - val_loss: 0.3573 - val_acc: 0.8869
Epoch 4/20
 - 9s - loss: 0.2668 - acc: 0.9156 - val_loss: 0.1941 - val_acc: 0.9395
Epoch 5/20
 - 9s - loss: 0.2331 - acc: 0.9280 - val_loss: 0.2163 - val_acc: 0.9288
Epoch 6/20
 - 9s - loss: 0.2185 - acc: 0.9336 - val_loss: 0.1425 - val_acc: 0.9569
Epoch 7/20
 - 9s - loss: 0.2007 - acc: 0.9384 - val_loss: 0.1312 - val_acc: 0.9598
Epoch 8/20
 - 9s - loss: 0.1900 - acc: 0.9421 - val_loss: 0.1331 - val_acc: 0.9579
Epoch 9/20
 - 9s - loss: 0.1846 - acc: 0.9453 - val_loss: 0.1556 - val_acc: 0.9538
Epoch 10/20
 - 9s - loss: 0.1781 - acc: 0.9466 - val_loss: 0.1044 - val_acc: 0.9701
Epoch 11/20
 - 9s - loss: 0.1712 - acc: 0.9485 - val_loss: 0.1338 - val_acc: 0.9581
Epoch 12/20
 - 9s - loss: 0.1672 - acc: 0.9513 - val_loss: 0.1013 - val_acc: 0.9702
Epoch 13/20
 - 9s - loss: 0.1684 - acc: 0.9512 - val_loss: 0.1107 - val_acc: 0.9657
Epoch 14/20
 - 9s - loss: 0.1680 - acc: 0.9516 - val_loss: 0.1587 - val_acc: 0.9539
Epoch 15/20
 - 9s - loss: 0.1676 - acc: 0.9527 - val_loss: 0.1005 - val_acc: 0.9709
Epoch 16/20
 - 9s - loss: 0.1619 - acc: 0.9540 - val_loss: 0.1188 - val_acc: 0.9655
Epoch 17/20
 - 9s - loss: 0.1599 - acc: 0.9543 - val_loss: 0.1085 - val_acc: 0.9669
Epoch 18/20
 - 9s - loss: 0.1600 - acc: 0.9545 - val_loss: 0.1135 - val_acc: 0.9686
Epoch 19/20
 - 9s - loss: 0.1638 - acc: 0.9542 - val_loss: 0.1429 - val_acc: 0.9635
Epoch 20/20
 - 9s - loss: 0.1636 - acc: 0.9541 - val_loss: 0.1140 - val_acc: 0.9716
Test loss: 0.11398319601902804
Test accuracy: 0.9714
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 256
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 18s - loss: 0.9601 - acc: 0.6955 - val_loss: 0.3222 - val_acc: 0.8997
Epoch 2/20
 - 14s - loss: 0.4370 - acc: 0.8605 - val_loss: 0.2790 - val_acc: 0.9112
Epoch 3/20
 - 14s - loss: 0.3280 - acc: 0.8968 - val_loss: 0.3361 - val_acc: 0.8988
Epoch 4/20
 - 14s - loss: 0.2714 - acc: 0.9148 - val_loss: 0.2590 - val_acc: 0.9154
Epoch 5/20
 - 14s - loss: 0.2438 - acc: 0.9246 - val_loss: 0.1597 - val_acc: 0.9509
Epoch 6/20
 - 14s - loss: 0.2174 - acc: 0.9329 - val_loss: 0.1326 - val_acc: 0.9581
Epoch 7/20
 - 14s - loss: 0.2087 - acc: 0.9359 - val_loss: 0.1237 - val_acc: 0.9628
Epoch 8/20
 - 14s - loss: 0.1933 - acc: 0.9415 - val_loss: 0.2342 - val_acc: 0.9310
Epoch 9/20
 - 14s - loss: 0.1855 - acc: 0.9436 - val_loss: 0.1198 - val_acc: 0.9653
Epoch 10/20
 - 14s - loss: 0.1815 - acc: 0.9456 - val_loss: 0.1073 - val_acc: 0.9674
Epoch 11/20
 - 14s - loss: 0.1727 - acc: 0.9477 - val_loss: 0.1568 - val_acc: 0.9537
Epoch 12/20
 - 14s - loss: 0.1716 - acc: 0.9486 - val_loss: 0.1502 - val_acc: 0.9524
Epoch 13/20
 - 14s - loss: 0.1697 - acc: 0.9507 - val_loss: 0.1086 - val_acc: 0.9674
Epoch 14/20
 - 14s - loss: 0.1648 - acc: 0.9517 - val_loss: 0.1076 - val_acc: 0.9684
Epoch 15/20
 - 14s - loss: 0.1667 - acc: 0.9515 - val_loss: 0.1171 - val_acc: 0.9667
Epoch 16/20
 - 14s - loss: 0.1652 - acc: 0.9524 - val_loss: 0.1053 - val_acc: 0.9712
Epoch 17/20
 - 14s - loss: 0.1607 - acc: 0.9537 - val_loss: 0.1086 - val_acc: 0.9681
Epoch 18/20
 - 14s - loss: 0.1628 - acc: 0.9529 - val_loss: 0.1543 - val_acc: 0.9561
Epoch 19/20
 - 14s - loss: 0.1645 - acc: 0.9533 - val_loss: 0.1233 - val_acc: 0.9627
Epoch 20/20
 - 14s - loss: 0.1628 - acc: 0.9546 - val_loss: 0.1134 - val_acc: 0.9668
Test loss: 0.11383015576859253
Test accuracy: 0.9663
60000 train samples
10000 test samples
Stochastic model
Stochastic layer using a bit size of 512
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 29s - loss: 0.9310 - acc: 0.7008 - val_loss: 0.4845 - val_acc: 0.8487
Epoch 2/20
 - 26s - loss: 0.4373 - acc: 0.8613 - val_loss: 0.3204 - val_acc: 0.8958
Epoch 3/20
 - 26s - loss: 0.3199 - acc: 0.8970 - val_loss: 0.2612 - val_acc: 0.9145
Epoch 4/20
 - 26s - loss: 0.2659 - acc: 0.9170 - val_loss: 0.1916 - val_acc: 0.9405
Epoch 5/20
 - 26s - loss: 0.2368 - acc: 0.9263 - val_loss: 0.2309 - val_acc: 0.9293
Epoch 6/20
 - 26s - loss: 0.2168 - acc: 0.9323 - val_loss: 0.1432 - val_acc: 0.9563
Epoch 7/20
 - 26s - loss: 0.1985 - acc: 0.9398 - val_loss: 0.1334 - val_acc: 0.9574
Epoch 8/20
 - 26s - loss: 0.1889 - acc: 0.9415 - val_loss: 0.1490 - val_acc: 0.9557
Epoch 9/20
 - 26s - loss: 0.1802 - acc: 0.9451 - val_loss: 0.1119 - val_acc: 0.9648
Epoch 10/20
 - 26s - loss: 0.1774 - acc: 0.9471 - val_loss: 0.1590 - val_acc: 0.9498
Epoch 11/20
 - 26s - loss: 0.1719 - acc: 0.9486 - val_loss: 0.1182 - val_acc: 0.9645
Epoch 12/20
 - 26s - loss: 0.1654 - acc: 0.9506 - val_loss: 0.1035 - val_acc: 0.9684
Epoch 13/20
 - 26s - loss: 0.1666 - acc: 0.9508 - val_loss: 0.1204 - val_acc: 0.9639
Epoch 14/20
 - 26s - loss: 0.1585 - acc: 0.9536 - val_loss: 0.1331 - val_acc: 0.9607
Epoch 15/20
 - 26s - loss: 0.1602 - acc: 0.9536 - val_loss: 0.1048 - val_acc: 0.9678
Epoch 16/20
 - 26s - loss: 0.1563 - acc: 0.9541 - val_loss: 0.0908 - val_acc: 0.9734
Epoch 17/20
 - 26s - loss: 0.1603 - acc: 0.9543 - val_loss: 0.1506 - val_acc: 0.9565
Epoch 18/20
 - 26s - loss: 0.1524 - acc: 0.9564 - val_loss: 0.1133 - val_acc: 0.9697
Epoch 19/20
 - 26s - loss: 0.1575 - acc: 0.9560 - val_loss: 0.1947 - val_acc: 0.9556
Epoch 20/20
 - 26s - loss: 0.1598 - acc: 0.9545 - val_loss: 0.1250 - val_acc: 0.9626
Test loss: 0.12458329583352898
Test accuracy: 0.9627
