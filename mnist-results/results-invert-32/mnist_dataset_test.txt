================
Start of new run
================
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
60000 train samples
10000 test samples
Normal model
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.2475 - acc: 0.9234 - val_loss: 0.1005 - val_acc: 0.9693
Epoch 2/20
 - 2s - loss: 0.1023 - acc: 0.9693 - val_loss: 0.0903 - val_acc: 0.9713
Epoch 3/20
 - 2s - loss: 0.0768 - acc: 0.9766 - val_loss: 0.0764 - val_acc: 0.9791
Epoch 4/20
 - 2s - loss: 0.0601 - acc: 0.9818 - val_loss: 0.0729 - val_acc: 0.9802
Epoch 5/20
 - 2s - loss: 0.0501 - acc: 0.9840 - val_loss: 0.0934 - val_acc: 0.9771
Epoch 6/20
 - 2s - loss: 0.0456 - acc: 0.9866 - val_loss: 0.0772 - val_acc: 0.9799
Epoch 7/20
 - 2s - loss: 0.0404 - acc: 0.9877 - val_loss: 0.0807 - val_acc: 0.9818
Epoch 8/20
 - 2s - loss: 0.0343 - acc: 0.9901 - val_loss: 0.0852 - val_acc: 0.9799
Epoch 9/20
 - 2s - loss: 0.0310 - acc: 0.9905 - val_loss: 0.0849 - val_acc: 0.9815
Epoch 10/20
 - 2s - loss: 0.0274 - acc: 0.9923 - val_loss: 0.0975 - val_acc: 0.9813
Epoch 11/20
 - 2s - loss: 0.0281 - acc: 0.9922 - val_loss: 0.0861 - val_acc: 0.9827
Epoch 12/20
 - 2s - loss: 0.0230 - acc: 0.9931 - val_loss: 0.1033 - val_acc: 0.9814
Epoch 13/20
 - 2s - loss: 0.0242 - acc: 0.9931 - val_loss: 0.1014 - val_acc: 0.9838
Epoch 14/20
 - 2s - loss: 0.0224 - acc: 0.9938 - val_loss: 0.0966 - val_acc: 0.9828
Epoch 15/20
 - 2s - loss: 0.0211 - acc: 0.9936 - val_loss: 0.1213 - val_acc: 0.9805
Epoch 16/20
 - 2s - loss: 0.0205 - acc: 0.9943 - val_loss: 0.0951 - val_acc: 0.9843
Epoch 17/20
 - 2s - loss: 0.0202 - acc: 0.9944 - val_loss: 0.1061 - val_acc: 0.9826
Epoch 18/20
 - 2s - loss: 0.0191 - acc: 0.9948 - val_loss: 0.1138 - val_acc: 0.9827
Epoch 19/20
 - 2s - loss: 0.0189 - acc: 0.9950 - val_loss: 0.1215 - val_acc: 0.9808
Epoch 20/20
 - 2s - loss: 0.0166 - acc: 0.9955 - val_loss: 0.1137 - val_acc: 0.9833
Test loss: 0.11371324611930167
Test accuracy: 0.9833
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9418 - acc: 0.6966 - val_loss: 0.6284 - val_acc: 0.7852
Epoch 2/20
 - 4s - loss: 0.4288 - acc: 0.8640 - val_loss: 0.2339 - val_acc: 0.9244
Epoch 3/20
 - 4s - loss: 0.3186 - acc: 0.9001 - val_loss: 0.1856 - val_acc: 0.9422
Epoch 4/20
 - 4s - loss: 0.2615 - acc: 0.9194 - val_loss: 0.3794 - val_acc: 0.8857
Epoch 5/20
 - 4s - loss: 0.2353 - acc: 0.9272 - val_loss: 0.1511 - val_acc: 0.9525
Epoch 6/20
 - 4s - loss: 0.2145 - acc: 0.9339 - val_loss: 0.1431 - val_acc: 0.9528
Epoch 7/20
 - 4s - loss: 0.2019 - acc: 0.9378 - val_loss: 0.1491 - val_acc: 0.9539
Epoch 8/20
 - 4s - loss: 0.1918 - acc: 0.9410 - val_loss: 0.1099 - val_acc: 0.9654
Epoch 9/20
 - 4s - loss: 0.1804 - acc: 0.9453 - val_loss: 0.1194 - val_acc: 0.9619
Epoch 10/20
 - 4s - loss: 0.1815 - acc: 0.9450 - val_loss: 0.1058 - val_acc: 0.9681
Epoch 11/20
 - 4s - loss: 0.1728 - acc: 0.9481 - val_loss: 0.1142 - val_acc: 0.9678
Epoch 12/20
 - 4s - loss: 0.1699 - acc: 0.9504 - val_loss: 0.1600 - val_acc: 0.9556
Epoch 13/20
 - 4s - loss: 0.1686 - acc: 0.9502 - val_loss: 0.0980 - val_acc: 0.9728
Epoch 14/20
 - 4s - loss: 0.1688 - acc: 0.9511 - val_loss: 0.1179 - val_acc: 0.9664
Epoch 15/20
 - 4s - loss: 0.1609 - acc: 0.9529 - val_loss: 0.1365 - val_acc: 0.9564
Epoch 16/20
 - 4s - loss: 0.1693 - acc: 0.9508 - val_loss: 0.1053 - val_acc: 0.9717
Epoch 17/20
 - 4s - loss: 0.1604 - acc: 0.9546 - val_loss: 0.1218 - val_acc: 0.9626
Epoch 18/20
 - 4s - loss: 0.1630 - acc: 0.9538 - val_loss: 0.1157 - val_acc: 0.9685
Epoch 19/20
 - 4s - loss: 0.1616 - acc: 0.9545 - val_loss: 0.1070 - val_acc: 0.9673
Epoch 20/20
 - 4s - loss: 0.1655 - acc: 0.9541 - val_loss: 0.1120 - val_acc: 0.9674
Test loss: 0.11180068578803912
Test accuracy: 0.9659
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3349 - acc: 0.8954 - val_loss: 0.2148 - val_acc: 0.9315
Epoch 2/20
 - 1s - loss: 0.1346 - acc: 0.9587 - val_loss: 0.1907 - val_acc: 0.9413
Epoch 3/20
 - 1s - loss: 0.0907 - acc: 0.9720 - val_loss: 0.1185 - val_acc: 0.9662
Epoch 4/20
 - 1s - loss: 0.0675 - acc: 0.9794 - val_loss: 0.1230 - val_acc: 0.9666
Epoch 5/20
 - 1s - loss: 0.0545 - acc: 0.9827 - val_loss: 0.0836 - val_acc: 0.9769
Epoch 6/20
 - 1s - loss: 0.0436 - acc: 0.9864 - val_loss: 0.0945 - val_acc: 0.9762
Epoch 7/20
 - 1s - loss: 0.0339 - acc: 0.9888 - val_loss: 0.1029 - val_acc: 0.9746
Epoch 8/20
 - 1s - loss: 0.0324 - acc: 0.9902 - val_loss: 0.0960 - val_acc: 0.9771
Epoch 9/20
 - 1s - loss: 0.0267 - acc: 0.9912 - val_loss: 0.1035 - val_acc: 0.9781
Epoch 10/20
 - 1s - loss: 0.0224 - acc: 0.9932 - val_loss: 0.1178 - val_acc: 0.9769
Epoch 11/20
 - 1s - loss: 0.0221 - acc: 0.9930 - val_loss: 0.1051 - val_acc: 0.9795
Epoch 12/20
 - 1s - loss: 0.0209 - acc: 0.9938 - val_loss: 0.1234 - val_acc: 0.9776
Epoch 13/20
 - 1s - loss: 0.0200 - acc: 0.9943 - val_loss: 0.1237 - val_acc: 0.9786
Epoch 14/20
 - 1s - loss: 0.0156 - acc: 0.9955 - val_loss: 0.1206 - val_acc: 0.9782
Epoch 15/20
 - 1s - loss: 0.0166 - acc: 0.9944 - val_loss: 0.1402 - val_acc: 0.9777
Epoch 16/20
 - 1s - loss: 0.0154 - acc: 0.9954 - val_loss: 0.1396 - val_acc: 0.9775
Epoch 17/20
 - 1s - loss: 0.0126 - acc: 0.9963 - val_loss: 0.1379 - val_acc: 0.9800
Epoch 18/20
 - 1s - loss: 0.0134 - acc: 0.9958 - val_loss: 0.1414 - val_acc: 0.9804
Epoch 19/20
 - 1s - loss: 0.0130 - acc: 0.9962 - val_loss: 0.1360 - val_acc: 0.9801
Epoch 20/20
 - 1s - loss: 0.0126 - acc: 0.9966 - val_loss: 0.1606 - val_acc: 0.9785
Test loss: 0.160598048339559
Test accuracy: 0.9785
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2627 - acc: 0.6006 - val_loss: 0.8376 - val_acc: 0.7230
Epoch 2/20
 - 2s - loss: 0.6252 - acc: 0.7975 - val_loss: 0.5820 - val_acc: 0.8037
Epoch 3/20
 - 2s - loss: 0.4655 - acc: 0.8506 - val_loss: 0.3391 - val_acc: 0.8936
Epoch 4/20
 - 2s - loss: 0.3809 - acc: 0.8815 - val_loss: 0.7475 - val_acc: 0.7495
Epoch 5/20
 - 2s - loss: 0.3331 - acc: 0.8965 - val_loss: 0.3083 - val_acc: 0.8965
Epoch 6/20
 - 2s - loss: 0.2924 - acc: 0.9081 - val_loss: 0.2643 - val_acc: 0.9151
Epoch 7/20
 - 2s - loss: 0.2635 - acc: 0.9174 - val_loss: 0.1904 - val_acc: 0.9414
Epoch 8/20
 - 2s - loss: 0.2465 - acc: 0.9230 - val_loss: 0.1642 - val_acc: 0.9462
Epoch 9/20
 - 2s - loss: 0.2311 - acc: 0.9277 - val_loss: 0.2520 - val_acc: 0.9206
Epoch 10/20
 - 2s - loss: 0.2137 - acc: 0.9327 - val_loss: 0.2520 - val_acc: 0.9197
Epoch 11/20
 - 2s - loss: 0.2039 - acc: 0.9366 - val_loss: 0.1522 - val_acc: 0.9535
Epoch 12/20
 - 2s - loss: 0.1949 - acc: 0.9374 - val_loss: 0.1559 - val_acc: 0.9509
Epoch 13/20
 - 2s - loss: 0.1892 - acc: 0.9408 - val_loss: 0.1409 - val_acc: 0.9556
Epoch 14/20
 - 2s - loss: 0.1808 - acc: 0.9444 - val_loss: 0.1424 - val_acc: 0.9583
Epoch 15/20
 - 2s - loss: 0.1770 - acc: 0.9464 - val_loss: 0.1911 - val_acc: 0.9377
Epoch 16/20
 - 2s - loss: 0.1752 - acc: 0.9469 - val_loss: 0.1311 - val_acc: 0.9602
Epoch 17/20
 - 2s - loss: 0.1646 - acc: 0.9486 - val_loss: 0.1337 - val_acc: 0.9613
Epoch 18/20
 - 2s - loss: 0.1600 - acc: 0.9510 - val_loss: 0.2020 - val_acc: 0.9357
Epoch 19/20
 - 2s - loss: 0.1619 - acc: 0.9503 - val_loss: 0.1868 - val_acc: 0.9431
Epoch 20/20
 - 2s - loss: 0.1550 - acc: 0.9524 - val_loss: 0.2024 - val_acc: 0.9387
Test loss: 0.20276481160894036
Test accuracy: 0.9393
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4591 - acc: 0.8583 - val_loss: 0.2399 - val_acc: 0.9232
Epoch 2/20
 - 1s - loss: 0.1842 - acc: 0.9440 - val_loss: 0.1660 - val_acc: 0.9470
Epoch 3/20
 - 1s - loss: 0.1188 - acc: 0.9623 - val_loss: 0.1505 - val_acc: 0.9556
Epoch 4/20
 - 1s - loss: 0.0858 - acc: 0.9729 - val_loss: 0.1292 - val_acc: 0.9607
Epoch 5/20
 - 1s - loss: 0.0611 - acc: 0.9800 - val_loss: 0.1325 - val_acc: 0.9640
Epoch 6/20
 - 1s - loss: 0.0491 - acc: 0.9849 - val_loss: 0.1480 - val_acc: 0.9618
Epoch 7/20
 - 1s - loss: 0.0370 - acc: 0.9874 - val_loss: 0.1668 - val_acc: 0.9589
Epoch 8/20
 - 1s - loss: 0.0310 - acc: 0.9904 - val_loss: 0.1378 - val_acc: 0.9657
Epoch 9/20
 - 1s - loss: 0.0266 - acc: 0.9913 - val_loss: 0.1364 - val_acc: 0.9678
Epoch 10/20
 - 1s - loss: 0.0216 - acc: 0.9929 - val_loss: 0.1482 - val_acc: 0.9676
Epoch 11/20
 - 1s - loss: 0.0201 - acc: 0.9929 - val_loss: 0.1810 - val_acc: 0.9627
Epoch 12/20
 - 1s - loss: 0.0159 - acc: 0.9948 - val_loss: 0.1675 - val_acc: 0.9680
Epoch 13/20
 - 1s - loss: 0.0145 - acc: 0.9954 - val_loss: 0.1713 - val_acc: 0.9685
Epoch 14/20
 - 1s - loss: 0.0133 - acc: 0.9958 - val_loss: 0.1828 - val_acc: 0.9672
Epoch 15/20
 - 1s - loss: 0.0150 - acc: 0.9949 - val_loss: 0.1676 - val_acc: 0.9712
Epoch 16/20
 - 1s - loss: 0.0095 - acc: 0.9964 - val_loss: 0.1738 - val_acc: 0.9692
Epoch 17/20
 - 1s - loss: 0.0124 - acc: 0.9961 - val_loss: 0.1699 - val_acc: 0.9707
Epoch 18/20
 - 1s - loss: 0.0099 - acc: 0.9971 - val_loss: 0.1978 - val_acc: 0.9673
Epoch 19/20
 - 1s - loss: 0.0097 - acc: 0.9964 - val_loss: 0.1916 - val_acc: 0.9697
Epoch 20/20
 - 1s - loss: 0.0099 - acc: 0.9967 - val_loss: 0.2136 - val_acc: 0.9668
Test loss: 0.21363131870915458
Test accuracy: 0.9668
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6168 - acc: 0.4829 - val_loss: 0.8992 - val_acc: 0.6545
Epoch 2/20
 - 1s - loss: 0.8313 - acc: 0.7251 - val_loss: 0.7231 - val_acc: 0.7503
Epoch 3/20
 - 1s - loss: 0.6576 - acc: 0.7836 - val_loss: 0.8126 - val_acc: 0.7182
Epoch 4/20
 - 1s - loss: 0.5538 - acc: 0.8222 - val_loss: 0.6409 - val_acc: 0.7776
Epoch 5/20
 - 1s - loss: 0.4735 - acc: 0.8467 - val_loss: 0.7973 - val_acc: 0.7443
Epoch 6/20
 - 1s - loss: 0.4212 - acc: 0.8659 - val_loss: 1.0671 - val_acc: 0.7316
Epoch 7/20
 - 1s - loss: 0.3888 - acc: 0.8744 - val_loss: 0.3629 - val_acc: 0.8772
Epoch 8/20
 - 1s - loss: 0.3468 - acc: 0.8898 - val_loss: 0.4517 - val_acc: 0.8556
Epoch 9/20
 - 1s - loss: 0.3211 - acc: 0.8984 - val_loss: 0.6267 - val_acc: 0.8143
Epoch 10/20
 - 1s - loss: 0.2986 - acc: 0.9054 - val_loss: 0.8229 - val_acc: 0.7819
Epoch 11/20
 - 1s - loss: 0.2762 - acc: 0.9120 - val_loss: 0.3854 - val_acc: 0.8700
Epoch 12/20
 - 1s - loss: 0.2550 - acc: 0.9187 - val_loss: 0.2148 - val_acc: 0.9374
Epoch 13/20
 - 1s - loss: 0.2482 - acc: 0.9211 - val_loss: 0.3069 - val_acc: 0.9096
Epoch 14/20
 - 1s - loss: 0.2352 - acc: 0.9257 - val_loss: 0.1767 - val_acc: 0.9490
Epoch 15/20
 - 1s - loss: 0.2216 - acc: 0.9308 - val_loss: 0.2497 - val_acc: 0.9191
Epoch 16/20
 - 1s - loss: 0.2172 - acc: 0.9301 - val_loss: 0.4079 - val_acc: 0.8732
Epoch 17/20
 - 1s - loss: 0.2139 - acc: 0.9319 - val_loss: 0.2088 - val_acc: 0.9359
Epoch 18/20
 - 1s - loss: 0.2029 - acc: 0.9351 - val_loss: 0.2442 - val_acc: 0.9202
Epoch 19/20
 - 1s - loss: 0.1869 - acc: 0.9415 - val_loss: 0.1633 - val_acc: 0.9475
Epoch 20/20
 - 1s - loss: 0.1799 - acc: 0.9440 - val_loss: 0.3046 - val_acc: 0.9096
Test loss: 0.30378029413819313
Test accuracy: 0.9092
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.6004 - acc: 0.8096 - val_loss: 0.3832 - val_acc: 0.8763
Epoch 2/20
 - 0s - loss: 0.2426 - acc: 0.9276 - val_loss: 0.2259 - val_acc: 0.9308
Epoch 3/20
 - 0s - loss: 0.1666 - acc: 0.9499 - val_loss: 0.3302 - val_acc: 0.9017
Epoch 4/20
 - 0s - loss: 0.1152 - acc: 0.9648 - val_loss: 0.2011 - val_acc: 0.9415
Epoch 5/20
 - 0s - loss: 0.0844 - acc: 0.9747 - val_loss: 0.1758 - val_acc: 0.9458
Epoch 6/20
 - 0s - loss: 0.0666 - acc: 0.9799 - val_loss: 0.1771 - val_acc: 0.9477
Epoch 7/20
 - 0s - loss: 0.0456 - acc: 0.9865 - val_loss: 0.1859 - val_acc: 0.9498
Epoch 8/20
 - 0s - loss: 0.0350 - acc: 0.9892 - val_loss: 0.1800 - val_acc: 0.9530
Epoch 9/20
 - 0s - loss: 0.0284 - acc: 0.9912 - val_loss: 0.2101 - val_acc: 0.9505
Epoch 10/20
 - 0s - loss: 0.0227 - acc: 0.9920 - val_loss: 0.1897 - val_acc: 0.9534
Epoch 11/20
 - 0s - loss: 0.0175 - acc: 0.9952 - val_loss: 0.2212 - val_acc: 0.9519
Epoch 12/20
 - 0s - loss: 0.0172 - acc: 0.9951 - val_loss: 0.2208 - val_acc: 0.9524
Epoch 13/20
 - 0s - loss: 0.0111 - acc: 0.9967 - val_loss: 0.2260 - val_acc: 0.9558
Epoch 14/20
 - 0s - loss: 0.0145 - acc: 0.9956 - val_loss: 0.2282 - val_acc: 0.9539
Epoch 15/20
 - 0s - loss: 0.0088 - acc: 0.9969 - val_loss: 0.2594 - val_acc: 0.9516
Epoch 16/20
 - 0s - loss: 0.0095 - acc: 0.9969 - val_loss: 0.2704 - val_acc: 0.9524
Epoch 17/20
 - 0s - loss: 0.0108 - acc: 0.9961 - val_loss: 0.2444 - val_acc: 0.9544
Epoch 18/20
 - 0s - loss: 0.0052 - acc: 0.9983 - val_loss: 0.2737 - val_acc: 0.9524
Epoch 19/20
 - 0s - loss: 0.0106 - acc: 0.9969 - val_loss: 0.3084 - val_acc: 0.9482
Epoch 20/20
 - 0s - loss: 0.0067 - acc: 0.9980 - val_loss: 0.2764 - val_acc: 0.9544
Test loss: 0.27642019553390934
Test accuracy: 0.9544
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0129 - acc: 0.3561 - val_loss: 1.4426 - val_acc: 0.4484
Epoch 2/20
 - 1s - loss: 1.1419 - acc: 0.6185 - val_loss: 0.8372 - val_acc: 0.7436
Epoch 3/20
 - 1s - loss: 0.8811 - acc: 0.7128 - val_loss: 0.8402 - val_acc: 0.7221
Epoch 4/20
 - 1s - loss: 0.7195 - acc: 0.7613 - val_loss: 0.6114 - val_acc: 0.7822
Epoch 5/20
 - 1s - loss: 0.6632 - acc: 0.7809 - val_loss: 0.7273 - val_acc: 0.7546
Epoch 6/20
 - 1s - loss: 0.6028 - acc: 0.8023 - val_loss: 0.3842 - val_acc: 0.8799
Epoch 7/20
 - 1s - loss: 0.5443 - acc: 0.8267 - val_loss: 0.5793 - val_acc: 0.7880
Epoch 8/20
 - 1s - loss: 0.5077 - acc: 0.8384 - val_loss: 0.5382 - val_acc: 0.8290
Epoch 9/20
 - 1s - loss: 0.4554 - acc: 0.8540 - val_loss: 0.4615 - val_acc: 0.8492
Epoch 10/20
 - 1s - loss: 0.4118 - acc: 0.8673 - val_loss: 0.2970 - val_acc: 0.9076
Epoch 11/20
 - 1s - loss: 0.4113 - acc: 0.8684 - val_loss: 0.3388 - val_acc: 0.8891
Epoch 12/20
 - 1s - loss: 0.3724 - acc: 0.8796 - val_loss: 0.4329 - val_acc: 0.8641
Epoch 13/20
 - 1s - loss: 0.3617 - acc: 0.8816 - val_loss: 0.3454 - val_acc: 0.8857
Epoch 14/20
 - 1s - loss: 0.3386 - acc: 0.8892 - val_loss: 0.2722 - val_acc: 0.9190
Epoch 15/20
 - 1s - loss: 0.3164 - acc: 0.8989 - val_loss: 0.3478 - val_acc: 0.8854
Epoch 16/20
 - 1s - loss: 0.3000 - acc: 0.9027 - val_loss: 0.3908 - val_acc: 0.8768
Epoch 17/20
 - 1s - loss: 0.2842 - acc: 0.9091 - val_loss: 0.3272 - val_acc: 0.8943
Epoch 18/20
 - 1s - loss: 0.3021 - acc: 0.9020 - val_loss: 0.2462 - val_acc: 0.9221
Epoch 19/20
 - 1s - loss: 0.2556 - acc: 0.9151 - val_loss: 0.3117 - val_acc: 0.9032
Epoch 20/20
 - 1s - loss: 0.2613 - acc: 0.9175 - val_loss: 0.3434 - val_acc: 0.8946
Test loss: 0.3445080709218979
Test accuracy: 0.8946
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8249 - acc: 0.7395 - val_loss: 0.5059 - val_acc: 0.8297
Epoch 2/20
 - 0s - loss: 0.3221 - acc: 0.9037 - val_loss: 0.3508 - val_acc: 0.8894
Epoch 3/20
 - 0s - loss: 0.2326 - acc: 0.9312 - val_loss: 0.2927 - val_acc: 0.9111
Epoch 4/20
 - 0s - loss: 0.1656 - acc: 0.9515 - val_loss: 0.2690 - val_acc: 0.9182
Epoch 5/20
 - 0s - loss: 0.1221 - acc: 0.9600 - val_loss: 0.2325 - val_acc: 0.9289
Epoch 6/20
 - 0s - loss: 0.0949 - acc: 0.9683 - val_loss: 0.2684 - val_acc: 0.9205
Epoch 7/20
 - 0s - loss: 0.0714 - acc: 0.9787 - val_loss: 0.2414 - val_acc: 0.9315
Epoch 8/20
 - 0s - loss: 0.0445 - acc: 0.9864 - val_loss: 0.2405 - val_acc: 0.9339
Epoch 9/20
 - 0s - loss: 0.0344 - acc: 0.9901 - val_loss: 0.2482 - val_acc: 0.9355
Epoch 10/20
 - 0s - loss: 0.0334 - acc: 0.9891 - val_loss: 0.2543 - val_acc: 0.9354
Epoch 11/20
 - 0s - loss: 0.0234 - acc: 0.9933 - val_loss: 0.2399 - val_acc: 0.9411
Epoch 12/20
 - 0s - loss: 0.0147 - acc: 0.9963 - val_loss: 0.2474 - val_acc: 0.9427
Epoch 13/20
 - 0s - loss: 0.0200 - acc: 0.9933 - val_loss: 0.3001 - val_acc: 0.9340
Epoch 14/20
 - 0s - loss: 0.0097 - acc: 0.9976 - val_loss: 0.3261 - val_acc: 0.9318
Epoch 15/20
 - 0s - loss: 0.0171 - acc: 0.9941 - val_loss: 0.2446 - val_acc: 0.9459
Epoch 16/20
 - 0s - loss: 0.0109 - acc: 0.9973 - val_loss: 0.2607 - val_acc: 0.9456
Epoch 17/20
 - 0s - loss: 0.0084 - acc: 0.9981 - val_loss: 0.2986 - val_acc: 0.9404
Epoch 18/20
 - 0s - loss: 0.0026 - acc: 1.0000 - val_loss: 0.3070 - val_acc: 0.9392
Epoch 19/20
 - 0s - loss: 0.0165 - acc: 0.9955 - val_loss: 0.3480 - val_acc: 0.9291
Epoch 20/20
 - 0s - loss: 0.0041 - acc: 0.9989 - val_loss: 0.2885 - val_acc: 0.9454
Test loss: 0.2885470826355162
Test accuracy: 0.9454
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5409 - acc: 0.2483 - val_loss: 1.9793 - val_acc: 0.2294
Epoch 2/20
 - 1s - loss: 1.6039 - acc: 0.4664 - val_loss: 1.3128 - val_acc: 0.5554
Epoch 3/20
 - 1s - loss: 1.2187 - acc: 0.5979 - val_loss: 0.8928 - val_acc: 0.7124
Epoch 4/20
 - 1s - loss: 1.0243 - acc: 0.6552 - val_loss: 0.7870 - val_acc: 0.7469
Epoch 5/20
 - 1s - loss: 0.8564 - acc: 0.7197 - val_loss: 1.4123 - val_acc: 0.5428
Epoch 6/20
 - 1s - loss: 0.8324 - acc: 0.7285 - val_loss: 0.9452 - val_acc: 0.6688
Epoch 7/20
 - 1s - loss: 0.7760 - acc: 0.7381 - val_loss: 0.6148 - val_acc: 0.7949
Epoch 8/20
 - 1s - loss: 0.6871 - acc: 0.7725 - val_loss: 0.5998 - val_acc: 0.8153
Epoch 9/20
 - 1s - loss: 0.6884 - acc: 0.7749 - val_loss: 0.5672 - val_acc: 0.7981
Epoch 10/20
 - 1s - loss: 0.5970 - acc: 0.8045 - val_loss: 0.8424 - val_acc: 0.7232
Epoch 11/20
 - 1s - loss: 0.6179 - acc: 0.8059 - val_loss: 0.8934 - val_acc: 0.7723
Epoch 12/20
 - 1s - loss: 0.5863 - acc: 0.8200 - val_loss: 0.8605 - val_acc: 0.7219
Epoch 13/20
 - 1s - loss: 0.4989 - acc: 0.8347 - val_loss: 0.4925 - val_acc: 0.8335
Epoch 14/20
 - 1s - loss: 0.5640 - acc: 0.8267 - val_loss: 0.4493 - val_acc: 0.8613
Epoch 15/20
 - 1s - loss: 0.4831 - acc: 0.8373 - val_loss: 0.8977 - val_acc: 0.7040
Epoch 16/20
 - 1s - loss: 0.4738 - acc: 0.8531 - val_loss: 0.5270 - val_acc: 0.8145
Epoch 17/20
 - 1s - loss: 0.4276 - acc: 0.8581 - val_loss: 0.5366 - val_acc: 0.8272
Epoch 18/20
 - 1s - loss: 0.4691 - acc: 0.8507 - val_loss: 1.1220 - val_acc: 0.6906
Epoch 19/20
 - 1s - loss: 0.4248 - acc: 0.8648 - val_loss: 0.4210 - val_acc: 0.8620
Epoch 20/20
 - 1s - loss: 0.3989 - acc: 0.8744 - val_loss: 0.5358 - val_acc: 0.8268
Test loss: 0.5351409064412117
Test accuracy: 0.8272
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1396 - acc: 0.6352 - val_loss: 0.7473 - val_acc: 0.7612
Epoch 2/20
 - 0s - loss: 0.4673 - acc: 0.8587 - val_loss: 0.4627 - val_acc: 0.8572
Epoch 3/20
 - 0s - loss: 0.3146 - acc: 0.9109 - val_loss: 0.3724 - val_acc: 0.8859
Epoch 4/20
 - 0s - loss: 0.2309 - acc: 0.9312 - val_loss: 0.5188 - val_acc: 0.8417
Epoch 5/20
 - 0s - loss: 0.1862 - acc: 0.9467 - val_loss: 0.4127 - val_acc: 0.8751
Epoch 6/20
 - 0s - loss: 0.1510 - acc: 0.9531 - val_loss: 0.3212 - val_acc: 0.9044
Epoch 7/20
 - 0s - loss: 0.1198 - acc: 0.9659 - val_loss: 0.3027 - val_acc: 0.9092
Epoch 8/20
 - 0s - loss: 0.0877 - acc: 0.9739 - val_loss: 0.4043 - val_acc: 0.8821
Epoch 9/20
 - 0s - loss: 0.0559 - acc: 0.9861 - val_loss: 0.3524 - val_acc: 0.8988
Epoch 10/20
 - 0s - loss: 0.0517 - acc: 0.9851 - val_loss: 0.2903 - val_acc: 0.9179
Epoch 11/20
 - 0s - loss: 0.0323 - acc: 0.9909 - val_loss: 0.3469 - val_acc: 0.9103
Epoch 12/20
 - 0s - loss: 0.0312 - acc: 0.9909 - val_loss: 0.3198 - val_acc: 0.9158
Epoch 13/20
 - 0s - loss: 0.0187 - acc: 0.9941 - val_loss: 0.4239 - val_acc: 0.8988
Epoch 14/20
 - 0s - loss: 0.0211 - acc: 0.9952 - val_loss: 0.3168 - val_acc: 0.9207
Epoch 15/20
 - 0s - loss: 0.0521 - acc: 0.9872 - val_loss: 0.3071 - val_acc: 0.9241
Epoch 16/20
 - 0s - loss: 0.0046 - acc: 1.0000 - val_loss: 0.3142 - val_acc: 0.9250
Epoch 17/20
 - 0s - loss: 0.0079 - acc: 0.9979 - val_loss: 0.3668 - val_acc: 0.9150
Epoch 18/20
 - 0s - loss: 0.0096 - acc: 0.9973 - val_loss: 0.3270 - val_acc: 0.9261
Epoch 19/20
 - 0s - loss: 0.0082 - acc: 0.9979 - val_loss: 0.4159 - val_acc: 0.9137
Epoch 20/20
 - 0s - loss: 0.0047 - acc: 0.9995 - val_loss: 0.4363 - val_acc: 0.9055
Test loss: 0.4363007843358209
Test accuracy: 0.9055
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7906 - acc: 0.1723 - val_loss: 1.9898 - val_acc: 0.3423
Epoch 2/20
 - 1s - loss: 1.9747 - acc: 0.3120 - val_loss: 1.5975 - val_acc: 0.5281
Epoch 3/20
 - 1s - loss: 1.7273 - acc: 0.4443 - val_loss: 1.4758 - val_acc: 0.5773
Epoch 4/20
 - 1s - loss: 1.4661 - acc: 0.5131 - val_loss: 1.1790 - val_acc: 0.6469
Epoch 5/20
 - 1s - loss: 1.2847 - acc: 0.5792 - val_loss: 0.9927 - val_acc: 0.6705
Epoch 6/20
 - 1s - loss: 1.1358 - acc: 0.6293 - val_loss: 1.1102 - val_acc: 0.6084
Epoch 7/20
 - 1s - loss: 1.1074 - acc: 0.6299 - val_loss: 0.8806 - val_acc: 0.7128
Epoch 8/20
 - 1s - loss: 0.9614 - acc: 0.6907 - val_loss: 0.9172 - val_acc: 0.6912
Epoch 9/20
 - 1s - loss: 0.9014 - acc: 0.6987 - val_loss: 0.8630 - val_acc: 0.6947
Epoch 10/20
 - 1s - loss: 0.8984 - acc: 0.7131 - val_loss: 0.8194 - val_acc: 0.7366
Epoch 11/20
 - 1s - loss: 0.8109 - acc: 0.7323 - val_loss: 1.2807 - val_acc: 0.5819
Epoch 12/20
 - 1s - loss: 0.7995 - acc: 0.7525 - val_loss: 1.3255 - val_acc: 0.5953
Epoch 13/20
 - 1s - loss: 0.7584 - acc: 0.7536 - val_loss: 1.0227 - val_acc: 0.6656
Epoch 14/20
 - 1s - loss: 0.7435 - acc: 0.7557 - val_loss: 0.8523 - val_acc: 0.7062
Epoch 15/20
 - 1s - loss: 0.6918 - acc: 0.7840 - val_loss: 0.5994 - val_acc: 0.7930
Epoch 16/20
 - 1s - loss: 0.6398 - acc: 0.7883 - val_loss: 0.7613 - val_acc: 0.7462
Epoch 17/20
 - 1s - loss: 0.6991 - acc: 0.7771 - val_loss: 0.7128 - val_acc: 0.7903
Epoch 18/20
 - 1s - loss: 0.6021 - acc: 0.8000 - val_loss: 0.5779 - val_acc: 0.8107
Epoch 19/20
 - 1s - loss: 0.6710 - acc: 0.7813 - val_loss: 0.4863 - val_acc: 0.8350
Epoch 20/20
 - 1s - loss: 0.5490 - acc: 0.8325 - val_loss: 0.6950 - val_acc: 0.7658
Test loss: 0.6953296400547028
Test accuracy: 0.7673
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5221 - acc: 0.5048 - val_loss: 0.8064 - val_acc: 0.7552
Epoch 2/20
 - 0s - loss: 0.6210 - acc: 0.8026 - val_loss: 0.5507 - val_acc: 0.8317
Epoch 3/20
 - 0s - loss: 0.4161 - acc: 0.8762 - val_loss: 0.5197 - val_acc: 0.8289
Epoch 4/20
 - 0s - loss: 0.3094 - acc: 0.9082 - val_loss: 0.5743 - val_acc: 0.8105
Epoch 5/20
 - 0s - loss: 0.2360 - acc: 0.9296 - val_loss: 0.5132 - val_acc: 0.8427
Epoch 6/20
 - 0s - loss: 0.1547 - acc: 0.9626 - val_loss: 0.4154 - val_acc: 0.8717
Epoch 7/20
 - 0s - loss: 0.1509 - acc: 0.9605 - val_loss: 0.4107 - val_acc: 0.8750
Epoch 8/20
 - 0s - loss: 0.1015 - acc: 0.9755 - val_loss: 0.5823 - val_acc: 0.8240
Epoch 9/20
 - 0s - loss: 0.0999 - acc: 0.9691 - val_loss: 0.4521 - val_acc: 0.8703
Epoch 10/20
 - 0s - loss: 0.0667 - acc: 0.9819 - val_loss: 0.4549 - val_acc: 0.8668
Epoch 11/20
 - 0s - loss: 0.0526 - acc: 0.9872 - val_loss: 0.7301 - val_acc: 0.7947
Epoch 12/20
 - 0s - loss: 0.0851 - acc: 0.9733 - val_loss: 0.3835 - val_acc: 0.8919
Epoch 13/20
 - 0s - loss: 0.0245 - acc: 0.9957 - val_loss: 0.4284 - val_acc: 0.8799
Epoch 14/20
 - 0s - loss: 0.0203 - acc: 0.9968 - val_loss: 0.4055 - val_acc: 0.8892
Epoch 15/20
 - 0s - loss: 0.0108 - acc: 1.0000 - val_loss: 0.3967 - val_acc: 0.8952
Epoch 16/20
 - 0s - loss: 0.0106 - acc: 1.0000 - val_loss: 0.4487 - val_acc: 0.8868
Epoch 17/20
 - 0s - loss: 0.0483 - acc: 0.9861 - val_loss: 0.4079 - val_acc: 0.8974
Epoch 18/20
 - 0s - loss: 0.0068 - acc: 0.9989 - val_loss: 0.4465 - val_acc: 0.8926
Epoch 19/20
 - 0s - loss: 0.0037 - acc: 1.0000 - val_loss: 0.4384 - val_acc: 0.8931
Epoch 20/20
 - 0s - loss: 0.0041 - acc: 1.0000 - val_loss: 0.4906 - val_acc: 0.8872
Test loss: 0.4906449870023876
Test accuracy: 0.8872
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.0214 - acc: 0.1174 - val_loss: 2.2471 - val_acc: 0.1428
Epoch 2/20
 - 0s - loss: 2.1373 - acc: 0.2369 - val_loss: 2.0970 - val_acc: 0.2175
Epoch 3/20
 - 0s - loss: 1.9692 - acc: 0.3383 - val_loss: 1.9528 - val_acc: 0.3726
Epoch 4/20
 - 0s - loss: 1.8700 - acc: 0.3735 - val_loss: 1.7314 - val_acc: 0.4071
Epoch 5/20
 - 0s - loss: 1.6644 - acc: 0.4525 - val_loss: 2.2175 - val_acc: 0.2344
Epoch 6/20
 - 0s - loss: 1.5856 - acc: 0.4888 - val_loss: 1.7693 - val_acc: 0.4276
Epoch 7/20
 - 0s - loss: 1.3801 - acc: 0.5368 - val_loss: 1.3177 - val_acc: 0.4924
Epoch 8/20
 - 0s - loss: 1.4045 - acc: 0.5315 - val_loss: 1.5183 - val_acc: 0.5197
Epoch 9/20
 - 0s - loss: 1.1327 - acc: 0.6158 - val_loss: 2.0580 - val_acc: 0.3913
Epoch 10/20
 - 0s - loss: 1.2303 - acc: 0.5891 - val_loss: 1.2372 - val_acc: 0.5388
Epoch 11/20
 - 0s - loss: 0.9896 - acc: 0.6713 - val_loss: 1.5909 - val_acc: 0.5453
Epoch 12/20
 - 0s - loss: 1.0464 - acc: 0.6574 - val_loss: 0.7720 - val_acc: 0.7424
Epoch 13/20
 - 0s - loss: 0.9433 - acc: 0.6852 - val_loss: 0.9872 - val_acc: 0.6514
Epoch 14/20
 - 0s - loss: 0.8805 - acc: 0.7086 - val_loss: 0.9332 - val_acc: 0.6751
Epoch 15/20
 - 0s - loss: 0.9002 - acc: 0.7108 - val_loss: 1.7496 - val_acc: 0.4376
Epoch 16/20
 - 0s - loss: 0.8476 - acc: 0.7460 - val_loss: 1.5301 - val_acc: 0.5058
Epoch 17/20
 - 0s - loss: 1.0430 - acc: 0.6467 - val_loss: 0.7142 - val_acc: 0.7643
Epoch 18/20
 - 0s - loss: 0.6737 - acc: 0.7876 - val_loss: 1.3128 - val_acc: 0.5997
Epoch 19/20
 - 0s - loss: 0.8626 - acc: 0.7513 - val_loss: 0.7131 - val_acc: 0.7604
Epoch 20/20
 - 0s - loss: 0.6809 - acc: 0.7759 - val_loss: 0.8385 - val_acc: 0.7327
Test loss: 0.8399430278301239
Test accuracy: 0.7318
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8182 - acc: 0.3654 - val_loss: 1.1643 - val_acc: 0.6236
Epoch 2/20
 - 0s - loss: 0.8429 - acc: 0.7692 - val_loss: 0.8950 - val_acc: 0.7062
Epoch 3/20
 - 0s - loss: 0.4570 - acc: 0.8889 - val_loss: 0.7226 - val_acc: 0.7591
Epoch 4/20
 - 0s - loss: 0.3539 - acc: 0.9060 - val_loss: 0.7060 - val_acc: 0.7543
Epoch 5/20
 - 0s - loss: 0.3031 - acc: 0.9060 - val_loss: 0.7242 - val_acc: 0.7607
Epoch 6/20
 - 0s - loss: 0.1994 - acc: 0.9487 - val_loss: 0.5953 - val_acc: 0.8145
Epoch 7/20
 - 0s - loss: 0.1513 - acc: 0.9679 - val_loss: 0.5270 - val_acc: 0.8335
Epoch 8/20
 - 0s - loss: 0.1063 - acc: 0.9786 - val_loss: 0.6200 - val_acc: 0.8175
Epoch 9/20
 - 0s - loss: 0.1095 - acc: 0.9615 - val_loss: 0.5583 - val_acc: 0.8203
Epoch 10/20
 - 0s - loss: 0.0628 - acc: 0.9915 - val_loss: 0.6074 - val_acc: 0.8166
Epoch 11/20
 - 0s - loss: 0.0488 - acc: 0.9957 - val_loss: 0.5072 - val_acc: 0.8480
Epoch 12/20
 - 0s - loss: 0.0272 - acc: 1.0000 - val_loss: 0.5127 - val_acc: 0.8483
Epoch 13/20
 - 0s - loss: 0.0242 - acc: 1.0000 - val_loss: 0.5967 - val_acc: 0.8270
Epoch 14/20
 - 0s - loss: 0.0467 - acc: 0.9850 - val_loss: 1.4739 - val_acc: 0.6382
Epoch 15/20
 - 0s - loss: 0.2797 - acc: 0.9081 - val_loss: 0.5301 - val_acc: 0.8539
Epoch 16/20
 - 0s - loss: 0.0153 - acc: 1.0000 - val_loss: 0.5321 - val_acc: 0.8527
Epoch 17/20
 - 0s - loss: 0.0127 - acc: 1.0000 - val_loss: 0.5284 - val_acc: 0.8543
Epoch 18/20
 - 0s - loss: 0.0097 - acc: 1.0000 - val_loss: 0.5306 - val_acc: 0.8573
Epoch 19/20
 - 0s - loss: 0.0068 - acc: 1.0000 - val_loss: 0.5305 - val_acc: 0.8574
Epoch 20/20
 - 0s - loss: 0.0065 - acc: 1.0000 - val_loss: 0.5467 - val_acc: 0.8523
Test loss: 0.5466878745730966
Test accuracy: 0.8523
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.9650 - acc: 0.1303 - val_loss: 3.0996 - val_acc: 0.1159
Epoch 2/20
 - 0s - loss: 2.4903 - acc: 0.1987 - val_loss: 2.0299 - val_acc: 0.3246
Epoch 3/20
 - 0s - loss: 2.0348 - acc: 0.3056 - val_loss: 2.4321 - val_acc: 0.2472
Epoch 4/20
 - 0s - loss: 2.3047 - acc: 0.2115 - val_loss: 1.9671 - val_acc: 0.3188
Epoch 5/20
 - 0s - loss: 1.8327 - acc: 0.3846 - val_loss: 1.8374 - val_acc: 0.3700
Epoch 6/20
 - 0s - loss: 1.7536 - acc: 0.4145 - val_loss: 2.2101 - val_acc: 0.2954
Epoch 7/20
 - 0s - loss: 1.8241 - acc: 0.3974 - val_loss: 1.7697 - val_acc: 0.2816
Epoch 8/20
 - 0s - loss: 1.6721 - acc: 0.4466 - val_loss: 1.8057 - val_acc: 0.3958
Epoch 9/20
 - 0s - loss: 1.5291 - acc: 0.4765 - val_loss: 1.7593 - val_acc: 0.3740
Epoch 10/20
 - 0s - loss: 1.5619 - acc: 0.4679 - val_loss: 1.3288 - val_acc: 0.6171
Epoch 11/20
 - 0s - loss: 1.4453 - acc: 0.5427 - val_loss: 1.4769 - val_acc: 0.4378
Epoch 12/20
 - 0s - loss: 1.4515 - acc: 0.4829 - val_loss: 1.6298 - val_acc: 0.3982
Epoch 13/20
 - 0s - loss: 1.3624 - acc: 0.5363 - val_loss: 1.4692 - val_acc: 0.4994
Epoch 14/20
 - 0s - loss: 1.1982 - acc: 0.6239 - val_loss: 1.1454 - val_acc: 0.6477
Epoch 15/20
 - 0s - loss: 1.1703 - acc: 0.6111 - val_loss: 1.1994 - val_acc: 0.5929
Epoch 16/20
 - 0s - loss: 0.9280 - acc: 0.7244 - val_loss: 1.3755 - val_acc: 0.5324
Epoch 17/20
 - 0s - loss: 1.0247 - acc: 0.6624 - val_loss: 1.2753 - val_acc: 0.5329
Epoch 18/20
 - 0s - loss: 1.0327 - acc: 0.6688 - val_loss: 1.0784 - val_acc: 0.6501
Epoch 19/20
 - 0s - loss: 0.9219 - acc: 0.7051 - val_loss: 1.5631 - val_acc: 0.4771
Epoch 20/20
 - 0s - loss: 1.0559 - acc: 0.6389 - val_loss: 1.0948 - val_acc: 0.6104
Test loss: 1.095848690700531
Test accuracy: 0.6105
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0471 - acc: 0.2436 - val_loss: 1.8793 - val_acc: 0.3462
Epoch 2/20
 - 0s - loss: 1.3944 - acc: 0.5897 - val_loss: 1.3442 - val_acc: 0.6346
Epoch 3/20
 - 0s - loss: 0.7740 - acc: 0.8077 - val_loss: 1.0804 - val_acc: 0.6571
Epoch 4/20
 - 0s - loss: 0.5171 - acc: 0.8590 - val_loss: 0.9837 - val_acc: 0.7164
Epoch 5/20
 - 0s - loss: 0.3444 - acc: 0.9145 - val_loss: 0.8028 - val_acc: 0.7480
Epoch 6/20
 - 0s - loss: 0.2507 - acc: 0.9573 - val_loss: 0.9681 - val_acc: 0.7124
Epoch 7/20
 - 0s - loss: 0.2837 - acc: 0.9316 - val_loss: 1.2924 - val_acc: 0.6153
Epoch 8/20
 - 0s - loss: 0.3559 - acc: 0.9060 - val_loss: 0.8400 - val_acc: 0.7188
Epoch 9/20
 - 0s - loss: 0.1502 - acc: 0.9658 - val_loss: 0.7721 - val_acc: 0.7689
Epoch 10/20
 - 0s - loss: 0.0762 - acc: 0.9957 - val_loss: 0.7530 - val_acc: 0.7685
Epoch 11/20
 - 0s - loss: 0.0653 - acc: 1.0000 - val_loss: 0.7843 - val_acc: 0.7629
Epoch 12/20
 - 0s - loss: 0.0557 - acc: 0.9957 - val_loss: 0.7591 - val_acc: 0.7746
Epoch 13/20
 - 0s - loss: 0.0438 - acc: 1.0000 - val_loss: 0.7903 - val_acc: 0.7696
Epoch 14/20
 - 0s - loss: 0.0348 - acc: 1.0000 - val_loss: 0.7644 - val_acc: 0.7781
Epoch 15/20
 - 0s - loss: 0.0306 - acc: 1.0000 - val_loss: 0.8127 - val_acc: 0.7675
Epoch 16/20
 - 0s - loss: 0.0235 - acc: 1.0000 - val_loss: 0.7753 - val_acc: 0.7761
Epoch 17/20
 - 0s - loss: 0.0244 - acc: 1.0000 - val_loss: 0.8006 - val_acc: 0.7771
Epoch 18/20
 - 0s - loss: 0.0177 - acc: 1.0000 - val_loss: 0.7997 - val_acc: 0.7809
Epoch 19/20
 - 0s - loss: 0.0131 - acc: 1.0000 - val_loss: 0.7969 - val_acc: 0.7831
Epoch 20/20
 - 0s - loss: 0.0139 - acc: 1.0000 - val_loss: 0.8149 - val_acc: 0.7826
Test loss: 0.8148589085459709
Test accuracy: 0.7826
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.9888 - acc: 0.1154 - val_loss: 6.4738 - val_acc: 0.0958
Epoch 2/20
 - 0s - loss: 6.2307 - acc: 0.1453 - val_loss: 4.6999 - val_acc: 0.1785
Epoch 3/20
 - 0s - loss: 4.1562 - acc: 0.1325 - val_loss: 2.5891 - val_acc: 0.1139
Epoch 4/20
 - 0s - loss: 2.4713 - acc: 0.1624 - val_loss: 2.1646 - val_acc: 0.3471
Epoch 5/20
 - 0s - loss: 2.1133 - acc: 0.2692 - val_loss: 2.2273 - val_acc: 0.1167
Epoch 6/20
 - 0s - loss: 2.0669 - acc: 0.2393 - val_loss: 1.9896 - val_acc: 0.3145
Epoch 7/20
 - 0s - loss: 1.8981 - acc: 0.3675 - val_loss: 2.0849 - val_acc: 0.2722
Epoch 8/20
 - 0s - loss: 1.9989 - acc: 0.2949 - val_loss: 2.0867 - val_acc: 0.2557
Epoch 9/20
 - 0s - loss: 2.0031 - acc: 0.3034 - val_loss: 1.8915 - val_acc: 0.4147
Epoch 10/20
 - 0s - loss: 1.7756 - acc: 0.4359 - val_loss: 1.9498 - val_acc: 0.3856
Epoch 11/20
 - 0s - loss: 1.7479 - acc: 0.4359 - val_loss: 1.8027 - val_acc: 0.3788
Epoch 12/20
 - 0s - loss: 1.7493 - acc: 0.4103 - val_loss: 2.0924 - val_acc: 0.1882
Epoch 13/20
 - 0s - loss: 2.0990 - acc: 0.2222 - val_loss: 1.8708 - val_acc: 0.3445
Epoch 14/20
 - 0s - loss: 1.7750 - acc: 0.3675 - val_loss: 1.6775 - val_acc: 0.5024
Epoch 15/20
 - 0s - loss: 1.4094 - acc: 0.6068 - val_loss: 1.8900 - val_acc: 0.4389
Epoch 16/20
 - 0s - loss: 1.6903 - acc: 0.4530 - val_loss: 1.5865 - val_acc: 0.4440
Epoch 17/20
 - 0s - loss: 1.3330 - acc: 0.5385 - val_loss: 1.4945 - val_acc: 0.5280
Epoch 18/20
 - 0s - loss: 1.2501 - acc: 0.6538 - val_loss: 1.8311 - val_acc: 0.4057
Epoch 19/20
 - 0s - loss: 1.5000 - acc: 0.5085 - val_loss: 2.0478 - val_acc: 0.3118
Epoch 20/20
 - 0s - loss: 1.8605 - acc: 0.3675 - val_loss: 1.7419 - val_acc: 0.4653
Test loss: 1.7419912240982056
Test accuracy: 0.4656
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3528 - acc: 0.1197 - val_loss: 2.0216 - val_acc: 0.3929
Epoch 2/20
 - 0s - loss: 1.6086 - acc: 0.6068 - val_loss: 1.7493 - val_acc: 0.3816
Epoch 3/20
 - 0s - loss: 1.2285 - acc: 0.6581 - val_loss: 1.8343 - val_acc: 0.3949
Epoch 4/20
 - 0s - loss: 1.0626 - acc: 0.6838 - val_loss: 1.5592 - val_acc: 0.5053
Epoch 5/20
 - 0s - loss: 0.8485 - acc: 0.7692 - val_loss: 1.2163 - val_acc: 0.6004
Epoch 6/20
 - 0s - loss: 0.4896 - acc: 0.9487 - val_loss: 1.1557 - val_acc: 0.6389
Epoch 7/20
 - 0s - loss: 0.3174 - acc: 0.9402 - val_loss: 1.1061 - val_acc: 0.6308
Epoch 8/20
 - 0s - loss: 0.2620 - acc: 0.9573 - val_loss: 1.0732 - val_acc: 0.6607
Epoch 9/20
 - 0s - loss: 0.2023 - acc: 0.9573 - val_loss: 1.0832 - val_acc: 0.6509
Epoch 10/20
 - 0s - loss: 0.1625 - acc: 0.9915 - val_loss: 1.0518 - val_acc: 0.6839
Epoch 11/20
 - 0s - loss: 0.1284 - acc: 0.9915 - val_loss: 1.0568 - val_acc: 0.6703
Epoch 12/20
 - 0s - loss: 0.0915 - acc: 1.0000 - val_loss: 1.0086 - val_acc: 0.7065
Epoch 13/20
 - 0s - loss: 0.0658 - acc: 1.0000 - val_loss: 0.9913 - val_acc: 0.7087
Epoch 14/20
 - 0s - loss: 0.0418 - acc: 1.0000 - val_loss: 0.9891 - val_acc: 0.7125
Epoch 15/20
 - 0s - loss: 0.0389 - acc: 1.0000 - val_loss: 1.0049 - val_acc: 0.7131
Epoch 16/20
 - 0s - loss: 0.0357 - acc: 1.0000 - val_loss: 0.9784 - val_acc: 0.7204
Epoch 17/20
 - 0s - loss: 0.0332 - acc: 1.0000 - val_loss: 1.0357 - val_acc: 0.7083
Epoch 18/20
 - 0s - loss: 0.0309 - acc: 1.0000 - val_loss: 1.0067 - val_acc: 0.7127
Epoch 19/20
 - 0s - loss: 0.0270 - acc: 1.0000 - val_loss: 1.0126 - val_acc: 0.7180
Epoch 20/20
 - 0s - loss: 0.0246 - acc: 1.0000 - val_loss: 0.9964 - val_acc: 0.7242
Test loss: 0.9964498077869415
Test accuracy: 0.7242
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6154 - acc: 0.0855 - val_loss: 5.9374 - val_acc: 0.1743
Epoch 2/20
 - 0s - loss: 4.9883 - acc: 0.1880 - val_loss: 6.7756 - val_acc: 0.1073
Epoch 3/20
 - 0s - loss: 6.5948 - acc: 0.1282 - val_loss: 6.1870 - val_acc: 0.2281
Epoch 4/20
 - 0s - loss: 6.2957 - acc: 0.1966 - val_loss: 3.6179 - val_acc: 0.1430
Epoch 5/20
 - 0s - loss: 3.6073 - acc: 0.1538 - val_loss: 2.5143 - val_acc: 0.2390
Epoch 6/20
 - 0s - loss: 2.2913 - acc: 0.3162 - val_loss: 2.1402 - val_acc: 0.3340
Epoch 7/20
 - 0s - loss: 2.0959 - acc: 0.2222 - val_loss: 2.1584 - val_acc: 0.2275
Epoch 8/20
 - 0s - loss: 2.0463 - acc: 0.2821 - val_loss: 2.1201 - val_acc: 0.3413
Epoch 9/20
 - 0s - loss: 2.0508 - acc: 0.3077 - val_loss: 2.0601 - val_acc: 0.1856
Epoch 10/20
 - 0s - loss: 1.9086 - acc: 0.2991 - val_loss: 2.3242 - val_acc: 0.1600
Epoch 11/20
 - 0s - loss: 2.0621 - acc: 0.2564 - val_loss: 2.2747 - val_acc: 0.1916
Epoch 12/20
 - 0s - loss: 2.2380 - acc: 0.2821 - val_loss: 1.9943 - val_acc: 0.4056
Epoch 13/20
 - 0s - loss: 1.7604 - acc: 0.4786 - val_loss: 1.9331 - val_acc: 0.4059
Epoch 14/20
 - 0s - loss: 1.6281 - acc: 0.5299 - val_loss: 1.9009 - val_acc: 0.3209
Epoch 15/20
 - 0s - loss: 1.6680 - acc: 0.4872 - val_loss: 2.0342 - val_acc: 0.3583
Epoch 16/20
 - 0s - loss: 1.7027 - acc: 0.4957 - val_loss: 1.9773 - val_acc: 0.2768
Epoch 17/20
 - 0s - loss: 1.7034 - acc: 0.4188 - val_loss: 1.9190 - val_acc: 0.3454
Epoch 18/20
 - 0s - loss: 1.6310 - acc: 0.4530 - val_loss: 2.1229 - val_acc: 0.2005
Epoch 19/20
 - 0s - loss: 1.8270 - acc: 0.3761 - val_loss: 2.1863 - val_acc: 0.2969
Epoch 20/20
 - 0s - loss: 1.8612 - acc: 0.4701 - val_loss: 2.1173 - val_acc: 0.1630
Test loss: 2.117177868270874
Test accuracy: 0.1623
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.2454 - acc: 0.9251 - val_loss: 0.1264 - val_acc: 0.9620
Epoch 2/20
 - 2s - loss: 0.1043 - acc: 0.9682 - val_loss: 0.1011 - val_acc: 0.9688
Epoch 3/20
 - 2s - loss: 0.0739 - acc: 0.9773 - val_loss: 0.0754 - val_acc: 0.9775
Epoch 4/20
 - 2s - loss: 0.0598 - acc: 0.9814 - val_loss: 0.0671 - val_acc: 0.9813
Epoch 5/20
 - 2s - loss: 0.0512 - acc: 0.9851 - val_loss: 0.0860 - val_acc: 0.9780
Epoch 6/20
 - 2s - loss: 0.0444 - acc: 0.9867 - val_loss: 0.0739 - val_acc: 0.9798
Epoch 7/20
 - 2s - loss: 0.0390 - acc: 0.9880 - val_loss: 0.0737 - val_acc: 0.9812
Epoch 8/20
 - 2s - loss: 0.0352 - acc: 0.9894 - val_loss: 0.0824 - val_acc: 0.9813
Epoch 9/20
 - 2s - loss: 0.0341 - acc: 0.9907 - val_loss: 0.0911 - val_acc: 0.9797
Epoch 10/20
 - 2s - loss: 0.0298 - acc: 0.9912 - val_loss: 0.0956 - val_acc: 0.9820
Epoch 11/20
 - 2s - loss: 0.0273 - acc: 0.9926 - val_loss: 0.0934 - val_acc: 0.9846
Epoch 12/20
 - 2s - loss: 0.0263 - acc: 0.9925 - val_loss: 0.0922 - val_acc: 0.9822
Epoch 13/20
 - 2s - loss: 0.0246 - acc: 0.9927 - val_loss: 0.0844 - val_acc: 0.9837
Epoch 14/20
 - 2s - loss: 0.0228 - acc: 0.9939 - val_loss: 0.1132 - val_acc: 0.9821
Epoch 15/20
 - 2s - loss: 0.0241 - acc: 0.9932 - val_loss: 0.0961 - val_acc: 0.9830
Epoch 16/20
 - 2s - loss: 0.0211 - acc: 0.9944 - val_loss: 0.1134 - val_acc: 0.9813
Epoch 17/20
 - 2s - loss: 0.0209 - acc: 0.9948 - val_loss: 0.1136 - val_acc: 0.9818
Epoch 18/20
 - 2s - loss: 0.0207 - acc: 0.9945 - val_loss: 0.1039 - val_acc: 0.9836
Epoch 19/20
 - 2s - loss: 0.0194 - acc: 0.9951 - val_loss: 0.1044 - val_acc: 0.9837
Epoch 20/20
 - 2s - loss: 0.0191 - acc: 0.9950 - val_loss: 0.1076 - val_acc: 0.9836
Test loss: 0.10757149913919775
Test accuracy: 0.9836
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9381 - acc: 0.6979 - val_loss: 0.5370 - val_acc: 0.8192
Epoch 2/20
 - 4s - loss: 0.4364 - acc: 0.8602 - val_loss: 0.3103 - val_acc: 0.8992
Epoch 3/20
 - 4s - loss: 0.3275 - acc: 0.8970 - val_loss: 0.1834 - val_acc: 0.9461
Epoch 4/20
 - 4s - loss: 0.2686 - acc: 0.9148 - val_loss: 0.1673 - val_acc: 0.9479
Epoch 5/20
 - 4s - loss: 0.2414 - acc: 0.9256 - val_loss: 0.3646 - val_acc: 0.8839
Epoch 6/20
 - 4s - loss: 0.2194 - acc: 0.9323 - val_loss: 0.2763 - val_acc: 0.9136
Epoch 7/20
 - 4s - loss: 0.2066 - acc: 0.9369 - val_loss: 0.1491 - val_acc: 0.9539
Epoch 8/20
 - 4s - loss: 0.1938 - acc: 0.9403 - val_loss: 0.2229 - val_acc: 0.9396
Epoch 9/20
 - 4s - loss: 0.1853 - acc: 0.9431 - val_loss: 0.1324 - val_acc: 0.9607
Epoch 10/20
 - 4s - loss: 0.1808 - acc: 0.9458 - val_loss: 0.1814 - val_acc: 0.9452
Epoch 11/20
 - 4s - loss: 0.1761 - acc: 0.9470 - val_loss: 0.1287 - val_acc: 0.9625
Epoch 12/20
 - 4s - loss: 0.1717 - acc: 0.9487 - val_loss: 0.1528 - val_acc: 0.9514
Epoch 13/20
 - 4s - loss: 0.1719 - acc: 0.9504 - val_loss: 0.1127 - val_acc: 0.9669
Epoch 14/20
 - 4s - loss: 0.1701 - acc: 0.9507 - val_loss: 0.1025 - val_acc: 0.9702
Epoch 15/20
 - 4s - loss: 0.1691 - acc: 0.9508 - val_loss: 0.1279 - val_acc: 0.9616
Epoch 16/20
 - 4s - loss: 0.1678 - acc: 0.9528 - val_loss: 0.0941 - val_acc: 0.9723
Epoch 17/20
 - 4s - loss: 0.1675 - acc: 0.9510 - val_loss: 0.1432 - val_acc: 0.9589
Epoch 18/20
 - 4s - loss: 0.1645 - acc: 0.9533 - val_loss: 0.1091 - val_acc: 0.9691
Epoch 19/20
 - 4s - loss: 0.1642 - acc: 0.9535 - val_loss: 0.1126 - val_acc: 0.9677
Epoch 20/20
 - 4s - loss: 0.1645 - acc: 0.9537 - val_loss: 0.0989 - val_acc: 0.9727
Test loss: 0.0978372614412161
Test accuracy: 0.9719
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3328 - acc: 0.8966 - val_loss: 0.1592 - val_acc: 0.9484
Epoch 2/20
 - 1s - loss: 0.1352 - acc: 0.9597 - val_loss: 0.1378 - val_acc: 0.9552
Epoch 3/20
 - 1s - loss: 0.0905 - acc: 0.9716 - val_loss: 0.1182 - val_acc: 0.9624
Epoch 4/20
 - 1s - loss: 0.0698 - acc: 0.9786 - val_loss: 0.1165 - val_acc: 0.9685
Epoch 5/20
 - 1s - loss: 0.0504 - acc: 0.9834 - val_loss: 0.1136 - val_acc: 0.9691
Epoch 6/20
 - 1s - loss: 0.0446 - acc: 0.9856 - val_loss: 0.0894 - val_acc: 0.9761
Epoch 7/20
 - 1s - loss: 0.0365 - acc: 0.9885 - val_loss: 0.0947 - val_acc: 0.9752
Epoch 8/20
 - 1s - loss: 0.0301 - acc: 0.9905 - val_loss: 0.0987 - val_acc: 0.9777
Epoch 9/20
 - 1s - loss: 0.0263 - acc: 0.9916 - val_loss: 0.1325 - val_acc: 0.9702
Epoch 10/20
 - 1s - loss: 0.0259 - acc: 0.9914 - val_loss: 0.0979 - val_acc: 0.9786
Epoch 11/20
 - 1s - loss: 0.0205 - acc: 0.9933 - val_loss: 0.1194 - val_acc: 0.9773
Epoch 12/20
 - 1s - loss: 0.0186 - acc: 0.9941 - val_loss: 0.1226 - val_acc: 0.9785
Epoch 13/20
 - 1s - loss: 0.0186 - acc: 0.9941 - val_loss: 0.1229 - val_acc: 0.9794
Epoch 14/20
 - 1s - loss: 0.0182 - acc: 0.9943 - val_loss: 0.1190 - val_acc: 0.9786
Epoch 15/20
 - 1s - loss: 0.0154 - acc: 0.9945 - val_loss: 0.1265 - val_acc: 0.9790
Epoch 16/20
 - 1s - loss: 0.0146 - acc: 0.9954 - val_loss: 0.1236 - val_acc: 0.9788
Epoch 17/20
 - 1s - loss: 0.0153 - acc: 0.9953 - val_loss: 0.1309 - val_acc: 0.9795
Epoch 18/20
 - 1s - loss: 0.0141 - acc: 0.9961 - val_loss: 0.1268 - val_acc: 0.9782
Epoch 19/20
 - 1s - loss: 0.0121 - acc: 0.9961 - val_loss: 0.1300 - val_acc: 0.9811
Epoch 20/20
 - 1s - loss: 0.0106 - acc: 0.9968 - val_loss: 0.1415 - val_acc: 0.9797
Test loss: 0.14147713790777985
Test accuracy: 0.9797
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2394 - acc: 0.5951 - val_loss: 0.9623 - val_acc: 0.7027
Epoch 2/20
 - 2s - loss: 0.6155 - acc: 0.8037 - val_loss: 0.7753 - val_acc: 0.7468
Epoch 3/20
 - 2s - loss: 0.4685 - acc: 0.8502 - val_loss: 0.2634 - val_acc: 0.9150
Epoch 4/20
 - 2s - loss: 0.3813 - acc: 0.8784 - val_loss: 0.2471 - val_acc: 0.9237
Epoch 5/20
 - 2s - loss: 0.3285 - acc: 0.8973 - val_loss: 0.3567 - val_acc: 0.8803
Epoch 6/20
 - 2s - loss: 0.2926 - acc: 0.9082 - val_loss: 0.3151 - val_acc: 0.8971
Epoch 7/20
 - 2s - loss: 0.2664 - acc: 0.9159 - val_loss: 0.5786 - val_acc: 0.8309
Epoch 8/20
 - 2s - loss: 0.2442 - acc: 0.9232 - val_loss: 0.2111 - val_acc: 0.9322
Epoch 9/20
 - 2s - loss: 0.2295 - acc: 0.9297 - val_loss: 0.2645 - val_acc: 0.9127
Epoch 10/20
 - 2s - loss: 0.2212 - acc: 0.9310 - val_loss: 0.3146 - val_acc: 0.8991
Epoch 11/20
 - 2s - loss: 0.2041 - acc: 0.9366 - val_loss: 0.1647 - val_acc: 0.9517
Epoch 12/20
 - 2s - loss: 0.1942 - acc: 0.9406 - val_loss: 0.3230 - val_acc: 0.8996
Epoch 13/20
 - 2s - loss: 0.1863 - acc: 0.9424 - val_loss: 0.1485 - val_acc: 0.9520
Epoch 14/20
 - 2s - loss: 0.1785 - acc: 0.9446 - val_loss: 0.2182 - val_acc: 0.9362
Epoch 15/20
 - 2s - loss: 0.1732 - acc: 0.9458 - val_loss: 0.2042 - val_acc: 0.9377
Epoch 16/20
 - 2s - loss: 0.1740 - acc: 0.9472 - val_loss: 0.2852 - val_acc: 0.9182
Epoch 17/20
 - 2s - loss: 0.1636 - acc: 0.9504 - val_loss: 0.1379 - val_acc: 0.9593
Epoch 18/20
 - 2s - loss: 0.1619 - acc: 0.9515 - val_loss: 0.2347 - val_acc: 0.9222
Epoch 19/20
 - 2s - loss: 0.1608 - acc: 0.9521 - val_loss: 0.1248 - val_acc: 0.9614
Epoch 20/20
 - 2s - loss: 0.1489 - acc: 0.9535 - val_loss: 0.2028 - val_acc: 0.9429
Test loss: 0.2029913613792509
Test accuracy: 0.942
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4547 - acc: 0.8600 - val_loss: 0.2271 - val_acc: 0.9304
Epoch 2/20
 - 1s - loss: 0.1837 - acc: 0.9430 - val_loss: 0.2498 - val_acc: 0.9191
Epoch 3/20
 - 1s - loss: 0.1222 - acc: 0.9632 - val_loss: 0.1455 - val_acc: 0.9561
Epoch 4/20
 - 1s - loss: 0.0852 - acc: 0.9741 - val_loss: 0.1536 - val_acc: 0.9543
Epoch 5/20
 - 1s - loss: 0.0617 - acc: 0.9809 - val_loss: 0.1524 - val_acc: 0.9554
Epoch 6/20
 - 1s - loss: 0.0499 - acc: 0.9841 - val_loss: 0.1171 - val_acc: 0.9676
Epoch 7/20
 - 1s - loss: 0.0387 - acc: 0.9870 - val_loss: 0.1239 - val_acc: 0.9684
Epoch 8/20
 - 1s - loss: 0.0291 - acc: 0.9903 - val_loss: 0.1503 - val_acc: 0.9668
Epoch 9/20
 - 1s - loss: 0.0257 - acc: 0.9907 - val_loss: 0.1574 - val_acc: 0.9639
Epoch 10/20
 - 1s - loss: 0.0199 - acc: 0.9929 - val_loss: 0.1421 - val_acc: 0.9705
Epoch 11/20
 - 1s - loss: 0.0166 - acc: 0.9945 - val_loss: 0.1845 - val_acc: 0.9602
Epoch 12/20
 - 1s - loss: 0.0207 - acc: 0.9933 - val_loss: 0.1627 - val_acc: 0.9672
Epoch 13/20
 - 1s - loss: 0.0168 - acc: 0.9955 - val_loss: 0.1567 - val_acc: 0.9683
Epoch 14/20
 - 1s - loss: 0.0135 - acc: 0.9956 - val_loss: 0.1727 - val_acc: 0.9686
Epoch 15/20
 - 1s - loss: 0.0129 - acc: 0.9955 - val_loss: 0.1769 - val_acc: 0.9674
Epoch 16/20
 - 1s - loss: 0.0132 - acc: 0.9959 - val_loss: 0.1614 - val_acc: 0.9720
Epoch 17/20
 - 1s - loss: 0.0122 - acc: 0.9957 - val_loss: 0.1905 - val_acc: 0.9691
Epoch 18/20
 - 1s - loss: 0.0124 - acc: 0.9959 - val_loss: 0.1944 - val_acc: 0.9668
Epoch 19/20
 - 1s - loss: 0.0121 - acc: 0.9961 - val_loss: 0.1784 - val_acc: 0.9726
Epoch 20/20
 - 1s - loss: 0.0079 - acc: 0.9974 - val_loss: 0.2099 - val_acc: 0.9691
Test loss: 0.20994528199998358
Test accuracy: 0.9691
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6448 - acc: 0.4857 - val_loss: 1.2023 - val_acc: 0.6000
Epoch 2/20
 - 1s - loss: 0.8377 - acc: 0.7255 - val_loss: 0.9992 - val_acc: 0.6757
Epoch 3/20
 - 1s - loss: 0.6614 - acc: 0.7862 - val_loss: 0.5688 - val_acc: 0.8096
Epoch 4/20
 - 1s - loss: 0.5630 - acc: 0.8194 - val_loss: 1.3527 - val_acc: 0.5375
Epoch 5/20
 - 1s - loss: 0.4858 - acc: 0.8494 - val_loss: 0.4197 - val_acc: 0.8688
Epoch 6/20
 - 1s - loss: 0.4289 - acc: 0.8650 - val_loss: 0.5060 - val_acc: 0.8404
Epoch 7/20
 - 1s - loss: 0.3863 - acc: 0.8758 - val_loss: 0.6710 - val_acc: 0.7978
Epoch 8/20
 - 1s - loss: 0.3547 - acc: 0.8845 - val_loss: 0.4668 - val_acc: 0.8426
Epoch 9/20
 - 1s - loss: 0.3239 - acc: 0.8981 - val_loss: 0.3575 - val_acc: 0.8844
Epoch 10/20
 - 1s - loss: 0.3032 - acc: 0.9047 - val_loss: 0.4157 - val_acc: 0.8579
Epoch 11/20
 - 1s - loss: 0.2779 - acc: 0.9129 - val_loss: 0.6780 - val_acc: 0.7988
Epoch 12/20
 - 1s - loss: 0.2754 - acc: 0.9101 - val_loss: 0.3149 - val_acc: 0.9005
Epoch 13/20
 - 1s - loss: 0.2568 - acc: 0.9201 - val_loss: 0.2279 - val_acc: 0.9272
Epoch 14/20
 - 1s - loss: 0.2333 - acc: 0.9267 - val_loss: 0.2645 - val_acc: 0.9200
Epoch 15/20
 - 1s - loss: 0.2203 - acc: 0.9299 - val_loss: 0.3368 - val_acc: 0.8958
Epoch 16/20
 - 1s - loss: 0.2195 - acc: 0.9320 - val_loss: 0.5530 - val_acc: 0.8227
Epoch 17/20
 - 1s - loss: 0.2140 - acc: 0.9331 - val_loss: 0.1919 - val_acc: 0.9409
Epoch 18/20
 - 1s - loss: 0.1988 - acc: 0.9379 - val_loss: 0.2527 - val_acc: 0.9270
Epoch 19/20
 - 1s - loss: 0.1892 - acc: 0.9411 - val_loss: 0.3170 - val_acc: 0.8956
Epoch 20/20
 - 1s - loss: 0.1947 - acc: 0.9363 - val_loss: 0.2057 - val_acc: 0.9409
Test loss: 0.2054902637743391
Test accuracy: 0.9411
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.6064 - acc: 0.8076 - val_loss: 0.2707 - val_acc: 0.9168
Epoch 2/20
 - 0s - loss: 0.2450 - acc: 0.9273 - val_loss: 0.2161 - val_acc: 0.9325
Epoch 3/20
 - 0s - loss: 0.1627 - acc: 0.9520 - val_loss: 0.2352 - val_acc: 0.9243
Epoch 4/20
 - 0s - loss: 0.1200 - acc: 0.9641 - val_loss: 0.1856 - val_acc: 0.9420
Epoch 5/20
 - 0s - loss: 0.0888 - acc: 0.9727 - val_loss: 0.1775 - val_acc: 0.9450
Epoch 6/20
 - 0s - loss: 0.0582 - acc: 0.9816 - val_loss: 0.1755 - val_acc: 0.9507
Epoch 7/20
 - 0s - loss: 0.0467 - acc: 0.9845 - val_loss: 0.1787 - val_acc: 0.9545
Epoch 8/20
 - 0s - loss: 0.0346 - acc: 0.9885 - val_loss: 0.1846 - val_acc: 0.9524
Epoch 9/20
 - 0s - loss: 0.0269 - acc: 0.9916 - val_loss: 0.2464 - val_acc: 0.9399
Epoch 10/20
 - 0s - loss: 0.0234 - acc: 0.9919 - val_loss: 0.2422 - val_acc: 0.9457
Epoch 11/20
 - 0s - loss: 0.0221 - acc: 0.9939 - val_loss: 0.2210 - val_acc: 0.9510
Epoch 12/20
 - 0s - loss: 0.0148 - acc: 0.9955 - val_loss: 0.2494 - val_acc: 0.9468
Epoch 13/20
 - 0s - loss: 0.0125 - acc: 0.9969 - val_loss: 0.3078 - val_acc: 0.9431
Epoch 14/20
 - 0s - loss: 0.0121 - acc: 0.9959 - val_loss: 0.2602 - val_acc: 0.9477
Epoch 15/20
 - 0s - loss: 0.0120 - acc: 0.9961 - val_loss: 0.2666 - val_acc: 0.9501
Epoch 16/20
 - 0s - loss: 0.0085 - acc: 0.9972 - val_loss: 0.2494 - val_acc: 0.9531
Epoch 17/20
 - 0s - loss: 0.0097 - acc: 0.9961 - val_loss: 0.2629 - val_acc: 0.9530
Epoch 18/20
 - 0s - loss: 0.0063 - acc: 0.9980 - val_loss: 0.2703 - val_acc: 0.9544
Epoch 19/20
 - 0s - loss: 0.0108 - acc: 0.9964 - val_loss: 0.2455 - val_acc: 0.9563
Epoch 20/20
 - 0s - loss: 0.0051 - acc: 0.9983 - val_loss: 0.2519 - val_acc: 0.9571
Test loss: 0.25187579913722546
Test accuracy: 0.9571
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0337 - acc: 0.3511 - val_loss: 1.2592 - val_acc: 0.5370
Epoch 2/20
 - 1s - loss: 1.1292 - acc: 0.6312 - val_loss: 0.8390 - val_acc: 0.7407
Epoch 3/20
 - 1s - loss: 0.8717 - acc: 0.7113 - val_loss: 0.9386 - val_acc: 0.6913
Epoch 4/20
 - 1s - loss: 0.7569 - acc: 0.7516 - val_loss: 0.5282 - val_acc: 0.8279
Epoch 5/20
 - 1s - loss: 0.6518 - acc: 0.7981 - val_loss: 0.5844 - val_acc: 0.7898
Epoch 6/20
 - 1s - loss: 0.5877 - acc: 0.8088 - val_loss: 0.7636 - val_acc: 0.7654
Epoch 7/20
 - 1s - loss: 0.5176 - acc: 0.8343 - val_loss: 0.8888 - val_acc: 0.7346
Epoch 8/20
 - 1s - loss: 0.5034 - acc: 0.8431 - val_loss: 0.5952 - val_acc: 0.8029
Epoch 9/20
 - 1s - loss: 0.4796 - acc: 0.8467 - val_loss: 0.3984 - val_acc: 0.8714
Epoch 10/20
 - 1s - loss: 0.4292 - acc: 0.8635 - val_loss: 0.6159 - val_acc: 0.8133
Epoch 11/20
 - 1s - loss: 0.3934 - acc: 0.8759 - val_loss: 0.6309 - val_acc: 0.7972
Epoch 12/20
 - 1s - loss: 0.3758 - acc: 0.8817 - val_loss: 0.4417 - val_acc: 0.8583
Epoch 13/20
 - 1s - loss: 0.3376 - acc: 0.8897 - val_loss: 0.3640 - val_acc: 0.8844
Epoch 14/20
 - 1s - loss: 0.3531 - acc: 0.8880 - val_loss: 0.3495 - val_acc: 0.8884
Epoch 15/20
 - 1s - loss: 0.3282 - acc: 0.8971 - val_loss: 0.2630 - val_acc: 0.9173
Epoch 16/20
 - 1s - loss: 0.3068 - acc: 0.9013 - val_loss: 0.5856 - val_acc: 0.8198
Epoch 17/20
 - 1s - loss: 0.2986 - acc: 0.9065 - val_loss: 0.3019 - val_acc: 0.9043
Epoch 18/20
 - 1s - loss: 0.2817 - acc: 0.9105 - val_loss: 0.2521 - val_acc: 0.9187
Epoch 19/20
 - 1s - loss: 0.2654 - acc: 0.9151 - val_loss: 0.3998 - val_acc: 0.8732
Epoch 20/20
 - 1s - loss: 0.2710 - acc: 0.9116 - val_loss: 0.2373 - val_acc: 0.9275
Test loss: 0.23835974575653673
Test accuracy: 0.9278
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.7952 - acc: 0.7603 - val_loss: 0.8847 - val_acc: 0.7290
Epoch 2/20
 - 0s - loss: 0.3288 - acc: 0.9051 - val_loss: 0.5702 - val_acc: 0.8231
Epoch 3/20
 - 0s - loss: 0.2426 - acc: 0.9315 - val_loss: 0.3709 - val_acc: 0.8842
Epoch 4/20
 - 0s - loss: 0.1647 - acc: 0.9512 - val_loss: 0.3114 - val_acc: 0.9047
Epoch 5/20
 - 0s - loss: 0.1287 - acc: 0.9608 - val_loss: 0.2409 - val_acc: 0.9283
Epoch 6/20
 - 0s - loss: 0.0858 - acc: 0.9736 - val_loss: 0.3537 - val_acc: 0.9034
Epoch 7/20
 - 0s - loss: 0.0685 - acc: 0.9808 - val_loss: 0.2301 - val_acc: 0.9346
Epoch 8/20
 - 0s - loss: 0.0544 - acc: 0.9840 - val_loss: 0.3345 - val_acc: 0.9096
Epoch 9/20
 - 0s - loss: 0.0465 - acc: 0.9851 - val_loss: 0.2481 - val_acc: 0.9328
Epoch 10/20
 - 0s - loss: 0.0231 - acc: 0.9944 - val_loss: 0.2765 - val_acc: 0.9323
Epoch 11/20
 - 0s - loss: 0.0279 - acc: 0.9899 - val_loss: 0.2336 - val_acc: 0.9408
Epoch 12/20
 - 0s - loss: 0.0152 - acc: 0.9952 - val_loss: 0.3452 - val_acc: 0.9209
Epoch 13/20
 - 0s - loss: 0.0200 - acc: 0.9941 - val_loss: 0.3060 - val_acc: 0.9271
Epoch 14/20
 - 0s - loss: 0.0094 - acc: 0.9973 - val_loss: 0.3059 - val_acc: 0.9305
Epoch 15/20
 - 0s - loss: 0.0150 - acc: 0.9941 - val_loss: 0.2721 - val_acc: 0.9415
Epoch 16/20
 - 0s - loss: 0.0074 - acc: 0.9981 - val_loss: 0.2694 - val_acc: 0.9437
Epoch 17/20
 - 0s - loss: 0.0059 - acc: 0.9984 - val_loss: 0.2883 - val_acc: 0.9413
Epoch 18/20
 - 0s - loss: 0.0124 - acc: 0.9960 - val_loss: 0.3380 - val_acc: 0.9322
Epoch 19/20
 - 0s - loss: 0.0089 - acc: 0.9968 - val_loss: 0.3004 - val_acc: 0.9426
Epoch 20/20
 - 0s - loss: 0.0113 - acc: 0.9955 - val_loss: 0.2919 - val_acc: 0.9431
Test loss: 0.2918726167265671
Test accuracy: 0.9431
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.4824 - acc: 0.2360 - val_loss: 1.9177 - val_acc: 0.1912
Epoch 2/20
 - 1s - loss: 1.6202 - acc: 0.4741 - val_loss: 1.7444 - val_acc: 0.4276
Epoch 3/20
 - 1s - loss: 1.2293 - acc: 0.5997 - val_loss: 1.1805 - val_acc: 0.5919
Epoch 4/20
 - 1s - loss: 1.0603 - acc: 0.6432 - val_loss: 0.9977 - val_acc: 0.6359
Epoch 5/20
 - 1s - loss: 0.9370 - acc: 0.6907 - val_loss: 0.6970 - val_acc: 0.7628
Epoch 6/20
 - 1s - loss: 0.8533 - acc: 0.7309 - val_loss: 0.8200 - val_acc: 0.7275
Epoch 7/20
 - 1s - loss: 0.8174 - acc: 0.7248 - val_loss: 0.8798 - val_acc: 0.7251
Epoch 8/20
 - 1s - loss: 0.6369 - acc: 0.7869 - val_loss: 0.9908 - val_acc: 0.7108
Epoch 9/20
 - 1s - loss: 0.6766 - acc: 0.7840 - val_loss: 0.7951 - val_acc: 0.7049
Epoch 10/20
 - 1s - loss: 0.5901 - acc: 0.8085 - val_loss: 1.5642 - val_acc: 0.4991
Epoch 11/20
 - 1s - loss: 0.6664 - acc: 0.7877 - val_loss: 0.6711 - val_acc: 0.7803
Epoch 12/20
 - 1s - loss: 0.5278 - acc: 0.8285 - val_loss: 0.6853 - val_acc: 0.7707
Epoch 13/20
 - 1s - loss: 0.5315 - acc: 0.8331 - val_loss: 0.8650 - val_acc: 0.7312
Epoch 14/20
 - 1s - loss: 0.5222 - acc: 0.8320 - val_loss: 0.6014 - val_acc: 0.7988
Epoch 15/20
 - 1s - loss: 0.4877 - acc: 0.8456 - val_loss: 0.7585 - val_acc: 0.7459
Epoch 16/20
 - 1s - loss: 0.4716 - acc: 0.8485 - val_loss: 0.6278 - val_acc: 0.7975
Epoch 17/20
 - 1s - loss: 0.4693 - acc: 0.8480 - val_loss: 0.4456 - val_acc: 0.8659
Epoch 18/20
 - 1s - loss: 0.4239 - acc: 0.8635 - val_loss: 0.5176 - val_acc: 0.8389
Epoch 19/20
 - 1s - loss: 0.4103 - acc: 0.8683 - val_loss: 0.3366 - val_acc: 0.8873
Epoch 20/20
 - 1s - loss: 0.3553 - acc: 0.8837 - val_loss: 0.8316 - val_acc: 0.7940
Test loss: 0.8310889226675033
Test accuracy: 0.7945
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1296 - acc: 0.6405 - val_loss: 0.5936 - val_acc: 0.8055
Epoch 2/20
 - 0s - loss: 0.4782 - acc: 0.8581 - val_loss: 0.4155 - val_acc: 0.8764
Epoch 3/20
 - 0s - loss: 0.3080 - acc: 0.9147 - val_loss: 0.5038 - val_acc: 0.8351
Epoch 4/20
 - 0s - loss: 0.2400 - acc: 0.9216 - val_loss: 0.4051 - val_acc: 0.8759
Epoch 5/20
 - 0s - loss: 0.1939 - acc: 0.9424 - val_loss: 0.3371 - val_acc: 0.8953
Epoch 6/20
 - 0s - loss: 0.1384 - acc: 0.9584 - val_loss: 0.3455 - val_acc: 0.9010
Epoch 7/20
 - 0s - loss: 0.1189 - acc: 0.9664 - val_loss: 0.2821 - val_acc: 0.9134
Epoch 8/20
 - 0s - loss: 0.0812 - acc: 0.9739 - val_loss: 0.2703 - val_acc: 0.9215
Epoch 9/20
 - 0s - loss: 0.0510 - acc: 0.9861 - val_loss: 0.4492 - val_acc: 0.8745
Epoch 10/20
 - 0s - loss: 0.0699 - acc: 0.9781 - val_loss: 0.2786 - val_acc: 0.9198
Epoch 11/20
 - 0s - loss: 0.0238 - acc: 0.9952 - val_loss: 0.3621 - val_acc: 0.9062
Epoch 12/20
 - 0s - loss: 0.0369 - acc: 0.9904 - val_loss: 0.3371 - val_acc: 0.9120
Epoch 13/20
 - 0s - loss: 0.0260 - acc: 0.9925 - val_loss: 0.3240 - val_acc: 0.9167
Epoch 14/20
 - 0s - loss: 0.0121 - acc: 0.9979 - val_loss: 0.3626 - val_acc: 0.9093
Epoch 15/20
 - 0s - loss: 0.0279 - acc: 0.9931 - val_loss: 0.3248 - val_acc: 0.9229
Epoch 16/20
 - 0s - loss: 0.0150 - acc: 0.9968 - val_loss: 0.5267 - val_acc: 0.8791
Epoch 17/20
 - 0s - loss: 0.0146 - acc: 0.9968 - val_loss: 0.3239 - val_acc: 0.9254
Epoch 18/20
 - 0s - loss: 0.0112 - acc: 0.9979 - val_loss: 0.3749 - val_acc: 0.9166
Epoch 19/20
 - 0s - loss: 0.0058 - acc: 0.9995 - val_loss: 0.3450 - val_acc: 0.9249
Epoch 20/20
 - 0s - loss: 0.0066 - acc: 0.9979 - val_loss: 0.3540 - val_acc: 0.9248
Test loss: 0.35398514204306414
Test accuracy: 0.9248
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.0306 - acc: 0.1808 - val_loss: 1.9898 - val_acc: 0.3119
Epoch 2/20
 - 1s - loss: 1.9830 - acc: 0.3253 - val_loss: 1.8624 - val_acc: 0.2335
Epoch 3/20
 - 1s - loss: 1.7229 - acc: 0.4288 - val_loss: 1.6082 - val_acc: 0.4342
Epoch 4/20
 - 1s - loss: 1.4866 - acc: 0.5253 - val_loss: 1.5511 - val_acc: 0.4186
Epoch 5/20
 - 1s - loss: 1.2846 - acc: 0.5680 - val_loss: 1.0957 - val_acc: 0.6378
Epoch 6/20
 - 1s - loss: 1.1195 - acc: 0.6261 - val_loss: 1.0219 - val_acc: 0.6532
Epoch 7/20
 - 1s - loss: 1.0598 - acc: 0.6491 - val_loss: 0.9971 - val_acc: 0.7066
Epoch 8/20
 - 1s - loss: 1.0310 - acc: 0.6517 - val_loss: 0.7914 - val_acc: 0.7323
Epoch 9/20
 - 1s - loss: 0.9366 - acc: 0.6944 - val_loss: 1.4314 - val_acc: 0.5193
Epoch 10/20
 - 1s - loss: 0.8375 - acc: 0.7275 - val_loss: 1.2904 - val_acc: 0.5613
Epoch 11/20
 - 1s - loss: 0.8140 - acc: 0.7328 - val_loss: 0.5711 - val_acc: 0.8168
Epoch 12/20
 - 1s - loss: 0.8544 - acc: 0.7216 - val_loss: 0.8901 - val_acc: 0.6976
Epoch 13/20
 - 1s - loss: 0.7426 - acc: 0.7675 - val_loss: 0.5856 - val_acc: 0.7889
Epoch 14/20
 - 1s - loss: 0.7345 - acc: 0.7600 - val_loss: 0.6401 - val_acc: 0.7927
Epoch 15/20
 - 1s - loss: 0.6617 - acc: 0.7856 - val_loss: 0.7439 - val_acc: 0.7386
Epoch 16/20
 - 1s - loss: 0.6830 - acc: 0.7712 - val_loss: 1.0572 - val_acc: 0.6577
Epoch 17/20
 - 1s - loss: 0.6983 - acc: 0.7765 - val_loss: 0.8583 - val_acc: 0.7162
Epoch 18/20
 - 1s - loss: 0.5776 - acc: 0.8101 - val_loss: 0.5444 - val_acc: 0.8035
Epoch 19/20
 - 1s - loss: 0.5764 - acc: 0.8032 - val_loss: 0.7298 - val_acc: 0.7690
Epoch 20/20
 - 1s - loss: 0.5257 - acc: 0.8352 - val_loss: 0.7867 - val_acc: 0.7314
Test loss: 0.7875536708831787
Test accuracy: 0.7309
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5575 - acc: 0.4877 - val_loss: 0.7586 - val_acc: 0.7976
Epoch 2/20
 - 0s - loss: 0.6352 - acc: 0.8047 - val_loss: 0.5767 - val_acc: 0.8157
Epoch 3/20
 - 0s - loss: 0.4001 - acc: 0.8890 - val_loss: 0.5450 - val_acc: 0.8208
Epoch 4/20
 - 0s - loss: 0.3348 - acc: 0.9007 - val_loss: 0.4865 - val_acc: 0.8495
Epoch 5/20
 - 0s - loss: 0.2701 - acc: 0.9200 - val_loss: 0.4748 - val_acc: 0.8469
Epoch 6/20
 - 0s - loss: 0.1819 - acc: 0.9541 - val_loss: 0.5255 - val_acc: 0.8298
Epoch 7/20
 - 0s - loss: 0.1759 - acc: 0.9445 - val_loss: 0.4045 - val_acc: 0.8817
Epoch 8/20
 - 0s - loss: 0.1144 - acc: 0.9691 - val_loss: 0.3466 - val_acc: 0.8986
Epoch 9/20
 - 0s - loss: 0.0765 - acc: 0.9829 - val_loss: 0.4605 - val_acc: 0.8676
Epoch 10/20
 - 0s - loss: 0.0734 - acc: 0.9776 - val_loss: 0.5285 - val_acc: 0.8521
Epoch 11/20
 - 0s - loss: 0.0526 - acc: 0.9904 - val_loss: 0.4570 - val_acc: 0.8744
Epoch 12/20
 - 0s - loss: 0.0330 - acc: 0.9947 - val_loss: 0.3997 - val_acc: 0.8882
Epoch 13/20
 - 0s - loss: 0.0321 - acc: 0.9947 - val_loss: 0.8528 - val_acc: 0.8072
Epoch 14/20
 - 0s - loss: 0.0659 - acc: 0.9840 - val_loss: 0.3715 - val_acc: 0.8979
Epoch 15/20
 - 0s - loss: 0.0114 - acc: 1.0000 - val_loss: 0.4408 - val_acc: 0.8802
Epoch 16/20
 - 0s - loss: 0.0115 - acc: 1.0000 - val_loss: 0.4477 - val_acc: 0.8878
Epoch 17/20
 - 0s - loss: 0.0084 - acc: 1.0000 - val_loss: 0.4003 - val_acc: 0.8998
Epoch 18/20
 - 0s - loss: 0.0288 - acc: 0.9925 - val_loss: 0.4438 - val_acc: 0.8907
Epoch 19/20
 - 0s - loss: 0.0109 - acc: 0.9989 - val_loss: 0.4064 - val_acc: 0.9008
Epoch 20/20
 - 0s - loss: 0.0064 - acc: 1.0000 - val_loss: 0.4079 - val_acc: 0.9036
Test loss: 0.40786132761901245
Test accuracy: 0.9036
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.2737 - acc: 0.1206 - val_loss: 2.2469 - val_acc: 0.1258
Epoch 2/20
 - 0s - loss: 2.1975 - acc: 0.1932 - val_loss: 2.0266 - val_acc: 0.2754
Epoch 3/20
 - 0s - loss: 2.0125 - acc: 0.2978 - val_loss: 1.9331 - val_acc: 0.3224
Epoch 4/20
 - 0s - loss: 1.9220 - acc: 0.3501 - val_loss: 1.7272 - val_acc: 0.3792
Epoch 5/20
 - 0s - loss: 1.7544 - acc: 0.4045 - val_loss: 2.1793 - val_acc: 0.2276
Epoch 6/20
 - 0s - loss: 1.6094 - acc: 0.4696 - val_loss: 1.7759 - val_acc: 0.3901
Epoch 7/20
 - 0s - loss: 1.4592 - acc: 0.5411 - val_loss: 1.4823 - val_acc: 0.5307
Epoch 8/20
 - 0s - loss: 1.3512 - acc: 0.5710 - val_loss: 1.0752 - val_acc: 0.6625
Epoch 9/20
 - 0s - loss: 1.4223 - acc: 0.5528 - val_loss: 1.1978 - val_acc: 0.6226
Epoch 10/20
 - 0s - loss: 1.1167 - acc: 0.6478 - val_loss: 1.4457 - val_acc: 0.5309
Epoch 11/20
 - 0s - loss: 1.1092 - acc: 0.6382 - val_loss: 0.9513 - val_acc: 0.6800
Epoch 12/20
 - 0s - loss: 1.0589 - acc: 0.6756 - val_loss: 1.1294 - val_acc: 0.6298
Epoch 13/20
 - 0s - loss: 0.9980 - acc: 0.6681 - val_loss: 1.1420 - val_acc: 0.5447
Epoch 14/20
 - 0s - loss: 0.9221 - acc: 0.7001 - val_loss: 1.0574 - val_acc: 0.6162
Epoch 15/20
 - 0s - loss: 0.9978 - acc: 0.6606 - val_loss: 0.8180 - val_acc: 0.7258
Epoch 16/20
 - 0s - loss: 0.8758 - acc: 0.7012 - val_loss: 1.3359 - val_acc: 0.5697
Epoch 17/20
 - 0s - loss: 0.8932 - acc: 0.7204 - val_loss: 0.9402 - val_acc: 0.6665
Epoch 18/20
 - 0s - loss: 0.8345 - acc: 0.7236 - val_loss: 0.7910 - val_acc: 0.7319
Epoch 19/20
 - 0s - loss: 0.7510 - acc: 0.7471 - val_loss: 1.1125 - val_acc: 0.6220
Epoch 20/20
 - 0s - loss: 0.7991 - acc: 0.7332 - val_loss: 0.9367 - val_acc: 0.6933
Test loss: 0.9371973091125488
Test accuracy: 0.6918
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8720 - acc: 0.3868 - val_loss: 1.2192 - val_acc: 0.6274
Epoch 2/20
 - 0s - loss: 0.8155 - acc: 0.7585 - val_loss: 0.8107 - val_acc: 0.7386
Epoch 3/20
 - 0s - loss: 0.4878 - acc: 0.8547 - val_loss: 0.6738 - val_acc: 0.7879
Epoch 4/20
 - 0s - loss: 0.3090 - acc: 0.9252 - val_loss: 0.6088 - val_acc: 0.8091
Epoch 5/20
 - 0s - loss: 0.2869 - acc: 0.9209 - val_loss: 0.6089 - val_acc: 0.7992
Epoch 6/20
 - 0s - loss: 0.1928 - acc: 0.9487 - val_loss: 0.6632 - val_acc: 0.7954
Epoch 7/20
 - 0s - loss: 0.1468 - acc: 0.9679 - val_loss: 0.5255 - val_acc: 0.8391
Epoch 8/20
 - 0s - loss: 0.0936 - acc: 0.9850 - val_loss: 0.7193 - val_acc: 0.7858
Epoch 9/20
 - 0s - loss: 0.1359 - acc: 0.9551 - val_loss: 0.6356 - val_acc: 0.8125
Epoch 10/20
 - 0s - loss: 0.0654 - acc: 0.9893 - val_loss: 0.5300 - val_acc: 0.8457
Epoch 11/20
 - 0s - loss: 0.0365 - acc: 1.0000 - val_loss: 0.5167 - val_acc: 0.8459
Epoch 12/20
 - 0s - loss: 0.0354 - acc: 0.9979 - val_loss: 0.5092 - val_acc: 0.8534
Epoch 13/20
 - 0s - loss: 0.0388 - acc: 0.9979 - val_loss: 0.5824 - val_acc: 0.8396
Epoch 14/20
 - 0s - loss: 0.0237 - acc: 1.0000 - val_loss: 0.5766 - val_acc: 0.8412
Epoch 15/20
 - 0s - loss: 0.0154 - acc: 1.0000 - val_loss: 0.5420 - val_acc: 0.8482
Epoch 16/20
 - 0s - loss: 0.0110 - acc: 1.0000 - val_loss: 0.5786 - val_acc: 0.8497
Epoch 17/20
 - 0s - loss: 0.0088 - acc: 1.0000 - val_loss: 0.5796 - val_acc: 0.8495
Epoch 18/20
 - 0s - loss: 0.0080 - acc: 1.0000 - val_loss: 0.6923 - val_acc: 0.8289
Epoch 19/20
 - 0s - loss: 0.0157 - acc: 1.0000 - val_loss: 0.7210 - val_acc: 0.8165
Epoch 20/20
 - 0s - loss: 0.1854 - acc: 0.9402 - val_loss: 0.6555 - val_acc: 0.8357
Test loss: 0.655516893774271
Test accuracy: 0.8357
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.2243 - acc: 0.1004 - val_loss: 5.8013 - val_acc: 0.1032
Epoch 2/20
 - 0s - loss: 3.7556 - acc: 0.1453 - val_loss: 2.1286 - val_acc: 0.2249
Epoch 3/20
 - 0s - loss: 2.0747 - acc: 0.2799 - val_loss: 1.9923 - val_acc: 0.2972
Epoch 4/20
 - 0s - loss: 2.1237 - acc: 0.2650 - val_loss: 1.8839 - val_acc: 0.5161
Epoch 5/20
 - 0s - loss: 1.9677 - acc: 0.3291 - val_loss: 2.0369 - val_acc: 0.2681
Epoch 6/20
 - 0s - loss: 1.7772 - acc: 0.4380 - val_loss: 1.6539 - val_acc: 0.4713
Epoch 7/20
 - 0s - loss: 1.8143 - acc: 0.3718 - val_loss: 2.4934 - val_acc: 0.1265
Epoch 8/20
 - 0s - loss: 1.8244 - acc: 0.4209 - val_loss: 1.4160 - val_acc: 0.6245
Epoch 9/20
 - 0s - loss: 1.6529 - acc: 0.4786 - val_loss: 1.5787 - val_acc: 0.4579
Epoch 10/20
 - 0s - loss: 1.4530 - acc: 0.5620 - val_loss: 1.7931 - val_acc: 0.3601
Epoch 11/20
 - 0s - loss: 1.4774 - acc: 0.5021 - val_loss: 1.6204 - val_acc: 0.4368
Epoch 12/20
 - 0s - loss: 1.3497 - acc: 0.5214 - val_loss: 1.4121 - val_acc: 0.5085
Epoch 13/20
 - 0s - loss: 1.1835 - acc: 0.6004 - val_loss: 1.6263 - val_acc: 0.4370
Epoch 14/20
 - 0s - loss: 1.2969 - acc: 0.5705 - val_loss: 1.5117 - val_acc: 0.5300
Epoch 15/20
 - 0s - loss: 1.3085 - acc: 0.6026 - val_loss: 1.3599 - val_acc: 0.5489
Epoch 16/20
 - 0s - loss: 0.9501 - acc: 0.7222 - val_loss: 1.2845 - val_acc: 0.5366
Epoch 17/20
 - 0s - loss: 1.4726 - acc: 0.5085 - val_loss: 1.1403 - val_acc: 0.6658
Epoch 18/20
 - 0s - loss: 0.8778 - acc: 0.7436 - val_loss: 1.3229 - val_acc: 0.5470
Epoch 19/20
 - 0s - loss: 0.8700 - acc: 0.7350 - val_loss: 1.3008 - val_acc: 0.5620
Epoch 20/20
 - 0s - loss: 0.9436 - acc: 0.6987 - val_loss: 1.1447 - val_acc: 0.6079
Test loss: 1.144172437095642
Test accuracy: 0.6077
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0653 - acc: 0.2906 - val_loss: 1.5870 - val_acc: 0.4909
Epoch 2/20
 - 0s - loss: 1.2295 - acc: 0.6239 - val_loss: 1.5760 - val_acc: 0.4969
Epoch 3/20
 - 0s - loss: 1.0496 - acc: 0.6496 - val_loss: 1.0940 - val_acc: 0.6323
Epoch 4/20
 - 0s - loss: 0.5376 - acc: 0.8590 - val_loss: 0.9868 - val_acc: 0.6836
Epoch 5/20
 - 0s - loss: 0.3647 - acc: 0.9359 - val_loss: 0.8829 - val_acc: 0.7282
Epoch 6/20
 - 0s - loss: 0.3055 - acc: 0.9231 - val_loss: 0.9160 - val_acc: 0.7174
Epoch 7/20
 - 0s - loss: 0.2428 - acc: 0.9359 - val_loss: 0.7625 - val_acc: 0.7618
Epoch 8/20
 - 0s - loss: 0.1546 - acc: 0.9872 - val_loss: 0.7588 - val_acc: 0.7681
Epoch 9/20
 - 0s - loss: 0.1130 - acc: 0.9829 - val_loss: 0.7546 - val_acc: 0.7730
Epoch 10/20
 - 0s - loss: 0.0785 - acc: 1.0000 - val_loss: 0.7649 - val_acc: 0.7702
Epoch 11/20
 - 0s - loss: 0.0655 - acc: 1.0000 - val_loss: 0.7815 - val_acc: 0.7674
Epoch 12/20
 - 0s - loss: 0.0519 - acc: 1.0000 - val_loss: 0.7954 - val_acc: 0.7635
Epoch 13/20
 - 0s - loss: 0.0445 - acc: 1.0000 - val_loss: 0.7542 - val_acc: 0.7745
Epoch 14/20
 - 0s - loss: 0.0345 - acc: 1.0000 - val_loss: 0.7796 - val_acc: 0.7760
Epoch 15/20
 - 0s - loss: 0.0279 - acc: 1.0000 - val_loss: 0.7876 - val_acc: 0.7736
Epoch 16/20
 - 0s - loss: 0.0213 - acc: 1.0000 - val_loss: 0.8049 - val_acc: 0.7686
Epoch 17/20
 - 0s - loss: 0.0199 - acc: 1.0000 - val_loss: 0.7773 - val_acc: 0.7828
Epoch 18/20
 - 0s - loss: 0.0164 - acc: 1.0000 - val_loss: 0.8026 - val_acc: 0.7789
Epoch 19/20
 - 0s - loss: 0.0189 - acc: 1.0000 - val_loss: 0.8597 - val_acc: 0.7649
Epoch 20/20
 - 0s - loss: 0.0989 - acc: 0.9701 - val_loss: 1.1505 - val_acc: 0.7089
Test loss: 1.1504603291511535
Test accuracy: 0.7089
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.9709 - acc: 0.0812 - val_loss: 4.0277 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 3.8066 - acc: 0.1197 - val_loss: 2.4811 - val_acc: 0.1278
Epoch 3/20
 - 0s - loss: 2.4565 - acc: 0.1282 - val_loss: 2.3101 - val_acc: 0.1135
Epoch 4/20
 - 0s - loss: 2.3148 - acc: 0.1538 - val_loss: 2.2325 - val_acc: 0.2255
Epoch 5/20
 - 0s - loss: 2.1286 - acc: 0.2564 - val_loss: 2.0204 - val_acc: 0.3099
Epoch 6/20
 - 0s - loss: 1.9730 - acc: 0.3120 - val_loss: 2.0943 - val_acc: 0.3301
Epoch 7/20
 - 0s - loss: 1.9944 - acc: 0.3376 - val_loss: 1.9848 - val_acc: 0.3726
Epoch 8/20
 - 0s - loss: 1.8699 - acc: 0.4316 - val_loss: 1.9273 - val_acc: 0.3279
Epoch 9/20
 - 0s - loss: 1.7067 - acc: 0.4573 - val_loss: 1.7721 - val_acc: 0.4161
Epoch 10/20
 - 0s - loss: 1.6697 - acc: 0.4359 - val_loss: 2.6777 - val_acc: 0.2290
Epoch 11/20
 - 0s - loss: 2.3627 - acc: 0.2863 - val_loss: 1.8403 - val_acc: 0.2909
Epoch 12/20
 - 0s - loss: 1.9272 - acc: 0.3504 - val_loss: 2.0199 - val_acc: 0.3084
Epoch 13/20
 - 0s - loss: 1.7556 - acc: 0.4188 - val_loss: 1.6241 - val_acc: 0.5557
Epoch 14/20
 - 0s - loss: 1.5182 - acc: 0.5470 - val_loss: 1.8616 - val_acc: 0.3073
Epoch 15/20
 - 0s - loss: 1.6107 - acc: 0.4530 - val_loss: 1.7688 - val_acc: 0.3016
Epoch 16/20
 - 0s - loss: 1.6527 - acc: 0.4487 - val_loss: 1.5520 - val_acc: 0.5133
Epoch 17/20
 - 0s - loss: 1.2986 - acc: 0.6239 - val_loss: 1.5866 - val_acc: 0.5019
Epoch 18/20
 - 0s - loss: 1.3960 - acc: 0.5897 - val_loss: 1.8558 - val_acc: 0.2923
Epoch 19/20
 - 0s - loss: 1.5006 - acc: 0.5342 - val_loss: 1.4376 - val_acc: 0.5747
Epoch 20/20
 - 0s - loss: 1.2712 - acc: 0.5983 - val_loss: 1.9876 - val_acc: 0.3155
Test loss: 1.9873280652999878
Test accuracy: 0.3166
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3387 - acc: 0.1282 - val_loss: 2.1266 - val_acc: 0.2167
Epoch 2/20
 - 0s - loss: 1.6711 - acc: 0.3333 - val_loss: 1.8883 - val_acc: 0.4635
Epoch 3/20
 - 0s - loss: 1.5158 - acc: 0.6325 - val_loss: 1.3216 - val_acc: 0.6647
Epoch 4/20
 - 0s - loss: 0.7786 - acc: 0.9060 - val_loss: 1.2668 - val_acc: 0.5899
Epoch 5/20
 - 0s - loss: 0.5009 - acc: 0.9060 - val_loss: 1.2420 - val_acc: 0.5855
Epoch 6/20
 - 0s - loss: 0.5045 - acc: 0.8376 - val_loss: 1.3443 - val_acc: 0.6172
Epoch 7/20
 - 0s - loss: 0.4779 - acc: 0.8547 - val_loss: 1.0394 - val_acc: 0.6641
Epoch 8/20
 - 0s - loss: 0.2562 - acc: 0.9658 - val_loss: 1.0709 - val_acc: 0.6841
Epoch 9/20
 - 0s - loss: 0.1922 - acc: 0.9573 - val_loss: 0.9842 - val_acc: 0.6917
Epoch 10/20
 - 0s - loss: 0.1377 - acc: 1.0000 - val_loss: 0.9796 - val_acc: 0.7056
Epoch 11/20
 - 0s - loss: 0.0861 - acc: 1.0000 - val_loss: 0.8875 - val_acc: 0.7284
Epoch 12/20
 - 0s - loss: 0.0638 - acc: 1.0000 - val_loss: 0.9214 - val_acc: 0.7178
Epoch 13/20
 - 0s - loss: 0.0522 - acc: 1.0000 - val_loss: 0.9036 - val_acc: 0.7257
Epoch 14/20
 - 0s - loss: 0.0436 - acc: 1.0000 - val_loss: 0.9084 - val_acc: 0.7291
Epoch 15/20
 - 0s - loss: 0.0426 - acc: 1.0000 - val_loss: 0.9509 - val_acc: 0.7166
Epoch 16/20
 - 0s - loss: 0.0338 - acc: 1.0000 - val_loss: 0.9131 - val_acc: 0.7325
Epoch 17/20
 - 0s - loss: 0.0276 - acc: 1.0000 - val_loss: 0.9309 - val_acc: 0.7257
Epoch 18/20
 - 0s - loss: 0.0213 - acc: 1.0000 - val_loss: 0.9244 - val_acc: 0.7292
Epoch 19/20
 - 0s - loss: 0.0224 - acc: 1.0000 - val_loss: 0.9489 - val_acc: 0.7234
Epoch 20/20
 - 0s - loss: 0.0190 - acc: 1.0000 - val_loss: 0.9561 - val_acc: 0.7269
Test loss: 0.9560691762208938
Test accuracy: 0.7269
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5688 - acc: 0.1282 - val_loss: 7.2507 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 7.3360 - acc: 0.1453 - val_loss: 6.5845 - val_acc: 0.0958
Epoch 3/20
 - 0s - loss: 7.3750 - acc: 0.1282 - val_loss: 5.6974 - val_acc: 0.1009
Epoch 4/20
 - 0s - loss: 6.4184 - acc: 0.1111 - val_loss: 4.2972 - val_acc: 0.1135
Epoch 5/20
 - 0s - loss: 4.4767 - acc: 0.1538 - val_loss: 2.7067 - val_acc: 0.1731
Epoch 6/20
 - 0s - loss: 3.0705 - acc: 0.0513 - val_loss: 2.3017 - val_acc: 0.1356
Epoch 7/20
 - 0s - loss: 2.3045 - acc: 0.1368 - val_loss: 2.1961 - val_acc: 0.2049
Epoch 8/20
 - 0s - loss: 2.0836 - acc: 0.2821 - val_loss: 2.1500 - val_acc: 0.2560
Epoch 9/20
 - 0s - loss: 2.0193 - acc: 0.2821 - val_loss: 2.1021 - val_acc: 0.4017
Epoch 10/20
 - 0s - loss: 1.9442 - acc: 0.3846 - val_loss: 2.0643 - val_acc: 0.3189
Epoch 11/20
 - 0s - loss: 1.9091 - acc: 0.3846 - val_loss: 2.0205 - val_acc: 0.4072
Epoch 12/20
 - 0s - loss: 1.8530 - acc: 0.4615 - val_loss: 2.1148 - val_acc: 0.3262
Epoch 13/20
 - 0s - loss: 1.8852 - acc: 0.3932 - val_loss: 2.1369 - val_acc: 0.1758
Epoch 14/20
 - 0s - loss: 1.9161 - acc: 0.2650 - val_loss: 2.2165 - val_acc: 0.2962
Epoch 15/20
 - 0s - loss: 1.9572 - acc: 0.4017 - val_loss: 1.9449 - val_acc: 0.2579
Epoch 16/20
 - 0s - loss: 1.7837 - acc: 0.3846 - val_loss: 2.1547 - val_acc: 0.3136
Epoch 17/20
 - 0s - loss: 1.8133 - acc: 0.4359 - val_loss: 2.1184 - val_acc: 0.2402
Epoch 18/20
 - 0s - loss: 1.8696 - acc: 0.3846 - val_loss: 1.9811 - val_acc: 0.2987
Epoch 19/20
 - 0s - loss: 1.7455 - acc: 0.4017 - val_loss: 2.0649 - val_acc: 0.2489
Epoch 20/20
 - 0s - loss: 1.8179 - acc: 0.3675 - val_loss: 2.3458 - val_acc: 0.1345
Test loss: 2.3460180652618408
Test accuracy: 0.1344
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.2433 - acc: 0.9250 - val_loss: 0.1272 - val_acc: 0.9626
Epoch 2/20
 - 2s - loss: 0.0992 - acc: 0.9699 - val_loss: 0.0832 - val_acc: 0.9762
Epoch 3/20
 - 2s - loss: 0.0738 - acc: 0.9774 - val_loss: 0.0883 - val_acc: 0.9753
Epoch 4/20
 - 2s - loss: 0.0588 - acc: 0.9819 - val_loss: 0.0730 - val_acc: 0.9799
Epoch 5/20
 - 2s - loss: 0.0499 - acc: 0.9849 - val_loss: 0.0857 - val_acc: 0.9780
Epoch 6/20
 - 2s - loss: 0.0426 - acc: 0.9870 - val_loss: 0.0693 - val_acc: 0.9828
Epoch 7/20
 - 2s - loss: 0.0358 - acc: 0.9894 - val_loss: 0.0844 - val_acc: 0.9819
Epoch 8/20
 - 2s - loss: 0.0356 - acc: 0.9892 - val_loss: 0.0805 - val_acc: 0.9832
Epoch 9/20
 - 2s - loss: 0.0310 - acc: 0.9914 - val_loss: 0.0811 - val_acc: 0.9840
Epoch 10/20
 - 2s - loss: 0.0291 - acc: 0.9919 - val_loss: 0.0765 - val_acc: 0.9845
Epoch 11/20
 - 2s - loss: 0.0271 - acc: 0.9924 - val_loss: 0.0848 - val_acc: 0.9837
Epoch 12/20
 - 2s - loss: 0.0248 - acc: 0.9932 - val_loss: 0.1035 - val_acc: 0.9820
Epoch 13/20
 - 2s - loss: 0.0236 - acc: 0.9937 - val_loss: 0.0887 - val_acc: 0.9837
Epoch 14/20
 - 2s - loss: 0.0234 - acc: 0.9932 - val_loss: 0.0956 - val_acc: 0.9839
Epoch 15/20
 - 2s - loss: 0.0211 - acc: 0.9941 - val_loss: 0.0924 - val_acc: 0.9836
Epoch 16/20
 - 2s - loss: 0.0211 - acc: 0.9944 - val_loss: 0.0930 - val_acc: 0.9845
Epoch 17/20
 - 2s - loss: 0.0211 - acc: 0.9944 - val_loss: 0.1128 - val_acc: 0.9816
Epoch 18/20
 - 2s - loss: 0.0204 - acc: 0.9948 - val_loss: 0.1015 - val_acc: 0.9842
Epoch 19/20
 - 2s - loss: 0.0175 - acc: 0.9952 - val_loss: 0.1217 - val_acc: 0.9817
Epoch 20/20
 - 2s - loss: 0.0184 - acc: 0.9952 - val_loss: 0.1230 - val_acc: 0.9816
Test loss: 0.12297148011894976
Test accuracy: 0.9816
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9223 - acc: 0.6990 - val_loss: 0.5733 - val_acc: 0.8129
Epoch 2/20
 - 4s - loss: 0.4359 - acc: 0.8616 - val_loss: 0.2193 - val_acc: 0.9318
Epoch 3/20
 - 4s - loss: 0.3248 - acc: 0.8975 - val_loss: 0.2574 - val_acc: 0.9243
Epoch 4/20
 - 4s - loss: 0.2687 - acc: 0.9157 - val_loss: 0.1984 - val_acc: 0.9344
Epoch 5/20
 - 4s - loss: 0.2395 - acc: 0.9254 - val_loss: 0.2033 - val_acc: 0.9344
Epoch 6/20
 - 4s - loss: 0.2191 - acc: 0.9324 - val_loss: 0.1838 - val_acc: 0.9446
Epoch 7/20
 - 4s - loss: 0.2055 - acc: 0.9366 - val_loss: 0.1419 - val_acc: 0.9540
Epoch 8/20
 - 4s - loss: 0.1909 - acc: 0.9414 - val_loss: 0.1818 - val_acc: 0.9442
Epoch 9/20
 - 4s - loss: 0.1853 - acc: 0.9444 - val_loss: 0.1353 - val_acc: 0.9559
Epoch 10/20
 - 4s - loss: 0.1807 - acc: 0.9456 - val_loss: 0.1358 - val_acc: 0.9582
Epoch 11/20
 - 4s - loss: 0.1740 - acc: 0.9471 - val_loss: 0.1881 - val_acc: 0.9380
Epoch 12/20
 - 4s - loss: 0.1715 - acc: 0.9487 - val_loss: 0.1616 - val_acc: 0.9532
Epoch 13/20
 - 4s - loss: 0.1667 - acc: 0.9505 - val_loss: 0.1275 - val_acc: 0.9591
Epoch 14/20
 - 4s - loss: 0.1641 - acc: 0.9528 - val_loss: 0.1796 - val_acc: 0.9446
Epoch 15/20
 - 4s - loss: 0.1634 - acc: 0.9523 - val_loss: 0.1078 - val_acc: 0.9702
Epoch 16/20
 - 4s - loss: 0.1641 - acc: 0.9533 - val_loss: 0.1043 - val_acc: 0.9683
Epoch 17/20
 - 4s - loss: 0.1637 - acc: 0.9528 - val_loss: 0.0983 - val_acc: 0.9713
Epoch 18/20
 - 4s - loss: 0.1615 - acc: 0.9536 - val_loss: 0.1171 - val_acc: 0.9681
Epoch 19/20
 - 4s - loss: 0.1648 - acc: 0.9527 - val_loss: 0.1003 - val_acc: 0.9715
Epoch 20/20
 - 4s - loss: 0.1591 - acc: 0.9554 - val_loss: 0.0989 - val_acc: 0.9673
Test loss: 0.09892494266442954
Test accuracy: 0.9673
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3384 - acc: 0.8970 - val_loss: 0.1433 - val_acc: 0.9554
Epoch 2/20
 - 1s - loss: 0.1331 - acc: 0.9587 - val_loss: 0.1242 - val_acc: 0.9613
Epoch 3/20
 - 1s - loss: 0.0902 - acc: 0.9716 - val_loss: 0.0969 - val_acc: 0.9703
Epoch 4/20
 - 1s - loss: 0.0649 - acc: 0.9798 - val_loss: 0.0985 - val_acc: 0.9726
Epoch 5/20
 - 1s - loss: 0.0520 - acc: 0.9845 - val_loss: 0.1039 - val_acc: 0.9719
Epoch 6/20
 - 1s - loss: 0.0422 - acc: 0.9862 - val_loss: 0.0933 - val_acc: 0.9754
Epoch 7/20
 - 1s - loss: 0.0327 - acc: 0.9891 - val_loss: 0.0989 - val_acc: 0.9777
Epoch 8/20
 - 1s - loss: 0.0315 - acc: 0.9903 - val_loss: 0.1102 - val_acc: 0.9740
Epoch 9/20
 - 1s - loss: 0.0246 - acc: 0.9927 - val_loss: 0.1131 - val_acc: 0.9743
Epoch 10/20
 - 1s - loss: 0.0244 - acc: 0.9917 - val_loss: 0.1086 - val_acc: 0.9784
Epoch 11/20
 - 1s - loss: 0.0210 - acc: 0.9938 - val_loss: 0.1167 - val_acc: 0.9775
Epoch 12/20
 - 1s - loss: 0.0199 - acc: 0.9937 - val_loss: 0.1446 - val_acc: 0.9739
Epoch 13/20
 - 1s - loss: 0.0177 - acc: 0.9944 - val_loss: 0.1300 - val_acc: 0.9766
Epoch 14/20
 - 1s - loss: 0.0159 - acc: 0.9948 - val_loss: 0.1269 - val_acc: 0.9769
Epoch 15/20
 - 1s - loss: 0.0170 - acc: 0.9945 - val_loss: 0.1343 - val_acc: 0.9771
Epoch 16/20
 - 1s - loss: 0.0164 - acc: 0.9949 - val_loss: 0.1408 - val_acc: 0.9777
Epoch 17/20
 - 1s - loss: 0.0140 - acc: 0.9957 - val_loss: 0.1383 - val_acc: 0.9795
Epoch 18/20
 - 1s - loss: 0.0141 - acc: 0.9958 - val_loss: 0.1386 - val_acc: 0.9795
Epoch 19/20
 - 1s - loss: 0.0153 - acc: 0.9955 - val_loss: 0.1274 - val_acc: 0.9804
Epoch 20/20
 - 1s - loss: 0.0115 - acc: 0.9964 - val_loss: 0.1498 - val_acc: 0.9787
Test loss: 0.14981891943561285
Test accuracy: 0.9787
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2814 - acc: 0.5947 - val_loss: 0.8615 - val_acc: 0.7106
Epoch 2/20
 - 2s - loss: 0.6154 - acc: 0.8000 - val_loss: 0.6411 - val_acc: 0.7855
Epoch 3/20
 - 2s - loss: 0.4536 - acc: 0.8546 - val_loss: 0.7201 - val_acc: 0.7730
Epoch 4/20
 - 2s - loss: 0.3763 - acc: 0.8812 - val_loss: 0.5968 - val_acc: 0.7967
Epoch 5/20
 - 2s - loss: 0.3285 - acc: 0.8984 - val_loss: 0.2345 - val_acc: 0.9241
Epoch 6/20
 - 2s - loss: 0.2883 - acc: 0.9085 - val_loss: 0.4194 - val_acc: 0.8813
Epoch 7/20
 - 2s - loss: 0.2633 - acc: 0.9166 - val_loss: 0.5578 - val_acc: 0.8147
Epoch 8/20
 - 2s - loss: 0.2472 - acc: 0.9237 - val_loss: 0.2030 - val_acc: 0.9345
Epoch 9/20
 - 2s - loss: 0.2252 - acc: 0.9303 - val_loss: 0.2590 - val_acc: 0.9157
Epoch 10/20
 - 2s - loss: 0.2193 - acc: 0.9309 - val_loss: 0.1518 - val_acc: 0.9530
Epoch 11/20
 - 2s - loss: 0.2014 - acc: 0.9368 - val_loss: 0.3407 - val_acc: 0.9021
Epoch 12/20
 - 2s - loss: 0.1889 - acc: 0.9413 - val_loss: 0.2395 - val_acc: 0.9235
Epoch 13/20
 - 2s - loss: 0.1928 - acc: 0.9402 - val_loss: 0.2106 - val_acc: 0.9362
Epoch 14/20
 - 2s - loss: 0.1796 - acc: 0.9448 - val_loss: 0.1319 - val_acc: 0.9586
Epoch 15/20
 - 2s - loss: 0.1752 - acc: 0.9449 - val_loss: 0.2251 - val_acc: 0.9376
Epoch 16/20
 - 2s - loss: 0.1669 - acc: 0.9483 - val_loss: 0.2319 - val_acc: 0.9273
Epoch 17/20
 - 2s - loss: 0.1687 - acc: 0.9488 - val_loss: 0.1316 - val_acc: 0.9626
Epoch 18/20
 - 2s - loss: 0.1620 - acc: 0.9502 - val_loss: 0.1468 - val_acc: 0.9602
Epoch 19/20
 - 2s - loss: 0.1605 - acc: 0.9519 - val_loss: 0.1530 - val_acc: 0.9556
Epoch 20/20
 - 2s - loss: 0.1561 - acc: 0.9513 - val_loss: 0.1236 - val_acc: 0.9631
Test loss: 0.12373894697523792
Test accuracy: 0.9634
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4700 - acc: 0.8537 - val_loss: 0.2669 - val_acc: 0.9186
Epoch 2/20
 - 1s - loss: 0.1822 - acc: 0.9461 - val_loss: 0.1653 - val_acc: 0.9474
Epoch 3/20
 - 1s - loss: 0.1209 - acc: 0.9637 - val_loss: 0.2385 - val_acc: 0.9289
Epoch 4/20
 - 1s - loss: 0.0833 - acc: 0.9735 - val_loss: 0.1420 - val_acc: 0.9603
Epoch 5/20
 - 1s - loss: 0.0618 - acc: 0.9802 - val_loss: 0.1479 - val_acc: 0.9597
Epoch 6/20
 - 1s - loss: 0.0488 - acc: 0.9837 - val_loss: 0.1459 - val_acc: 0.9610
Epoch 7/20
 - 1s - loss: 0.0379 - acc: 0.9876 - val_loss: 0.1323 - val_acc: 0.9676
Epoch 8/20
 - 1s - loss: 0.0297 - acc: 0.9899 - val_loss: 0.1349 - val_acc: 0.9676
Epoch 9/20
 - 1s - loss: 0.0230 - acc: 0.9918 - val_loss: 0.2118 - val_acc: 0.9511
Epoch 10/20
 - 1s - loss: 0.0224 - acc: 0.9923 - val_loss: 0.1441 - val_acc: 0.9705
Epoch 11/20
 - 1s - loss: 0.0195 - acc: 0.9940 - val_loss: 0.1727 - val_acc: 0.9640
Epoch 12/20
 - 1s - loss: 0.0150 - acc: 0.9955 - val_loss: 0.2313 - val_acc: 0.9561
Epoch 13/20
 - 1s - loss: 0.0206 - acc: 0.9930 - val_loss: 0.1648 - val_acc: 0.9660
Epoch 14/20
 - 1s - loss: 0.0129 - acc: 0.9955 - val_loss: 0.1752 - val_acc: 0.9682
Epoch 15/20
 - 1s - loss: 0.0140 - acc: 0.9951 - val_loss: 0.1661 - val_acc: 0.9694
Epoch 16/20
 - 1s - loss: 0.0104 - acc: 0.9968 - val_loss: 0.1799 - val_acc: 0.9686
Epoch 17/20
 - 1s - loss: 0.0097 - acc: 0.9967 - val_loss: 0.1858 - val_acc: 0.9682
Epoch 18/20
 - 1s - loss: 0.0089 - acc: 0.9972 - val_loss: 0.1762 - val_acc: 0.9699
Epoch 19/20
 - 1s - loss: 0.0151 - acc: 0.9954 - val_loss: 0.2039 - val_acc: 0.9687
Epoch 20/20
 - 1s - loss: 0.0087 - acc: 0.9972 - val_loss: 0.2106 - val_acc: 0.9674
Test loss: 0.21056484305512832
Test accuracy: 0.9674
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.7168 - acc: 0.4711 - val_loss: 0.7144 - val_acc: 0.7813
Epoch 2/20
 - 1s - loss: 0.8455 - acc: 0.7220 - val_loss: 0.8367 - val_acc: 0.7359
Epoch 3/20
 - 1s - loss: 0.6840 - acc: 0.7814 - val_loss: 0.9211 - val_acc: 0.6997
Epoch 4/20
 - 1s - loss: 0.5505 - acc: 0.8189 - val_loss: 0.5265 - val_acc: 0.8281
Epoch 5/20
 - 1s - loss: 0.4870 - acc: 0.8455 - val_loss: 0.3802 - val_acc: 0.8610
Epoch 6/20
 - 1s - loss: 0.4254 - acc: 0.8621 - val_loss: 0.5020 - val_acc: 0.8234
Epoch 7/20
 - 1s - loss: 0.3950 - acc: 0.8754 - val_loss: 0.4283 - val_acc: 0.8520
Epoch 8/20
 - 1s - loss: 0.3451 - acc: 0.8893 - val_loss: 0.5550 - val_acc: 0.8152
Epoch 9/20
 - 1s - loss: 0.3314 - acc: 0.8959 - val_loss: 0.5239 - val_acc: 0.8361
Epoch 10/20
 - 1s - loss: 0.3029 - acc: 0.9039 - val_loss: 0.4539 - val_acc: 0.8612
Epoch 11/20
 - 1s - loss: 0.2875 - acc: 0.9089 - val_loss: 0.3832 - val_acc: 0.8875
Epoch 12/20
 - 1s - loss: 0.2608 - acc: 0.9187 - val_loss: 0.2926 - val_acc: 0.9074
Epoch 13/20
 - 1s - loss: 0.2514 - acc: 0.9197 - val_loss: 0.2211 - val_acc: 0.9336
Epoch 14/20
 - 1s - loss: 0.2360 - acc: 0.9249 - val_loss: 0.5114 - val_acc: 0.8330
Epoch 15/20
 - 1s - loss: 0.2258 - acc: 0.9283 - val_loss: 0.3888 - val_acc: 0.8727
Epoch 16/20
 - 1s - loss: 0.2165 - acc: 0.9311 - val_loss: 0.2650 - val_acc: 0.9157
Epoch 17/20
 - 1s - loss: 0.2127 - acc: 0.9321 - val_loss: 0.3620 - val_acc: 0.8874
Epoch 18/20
 - 1s - loss: 0.2015 - acc: 0.9352 - val_loss: 0.2925 - val_acc: 0.9076
Epoch 19/20
 - 1s - loss: 0.2025 - acc: 0.9367 - val_loss: 0.2209 - val_acc: 0.9318
Epoch 20/20
 - 1s - loss: 0.1867 - acc: 0.9427 - val_loss: 0.3242 - val_acc: 0.8953
Test loss: 0.322945850931108
Test accuracy: 0.8956
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.5819 - acc: 0.8235 - val_loss: 0.3423 - val_acc: 0.8924
Epoch 2/20
 - 0s - loss: 0.2466 - acc: 0.9253 - val_loss: 0.3400 - val_acc: 0.8871
Epoch 3/20
 - 0s - loss: 0.1634 - acc: 0.9499 - val_loss: 0.1949 - val_acc: 0.9382
Epoch 4/20
 - 0s - loss: 0.1191 - acc: 0.9668 - val_loss: 0.2564 - val_acc: 0.9221
Epoch 5/20
 - 0s - loss: 0.0888 - acc: 0.9728 - val_loss: 0.2207 - val_acc: 0.9365
Epoch 6/20
 - 0s - loss: 0.0669 - acc: 0.9800 - val_loss: 0.1900 - val_acc: 0.9451
Epoch 7/20
 - 0s - loss: 0.0509 - acc: 0.9824 - val_loss: 0.1894 - val_acc: 0.9479
Epoch 8/20
 - 0s - loss: 0.0360 - acc: 0.9881 - val_loss: 0.1747 - val_acc: 0.9536
Epoch 9/20
 - 0s - loss: 0.0259 - acc: 0.9927 - val_loss: 0.2102 - val_acc: 0.9526
Epoch 10/20
 - 0s - loss: 0.0250 - acc: 0.9919 - val_loss: 0.2214 - val_acc: 0.9448
Epoch 11/20
 - 0s - loss: 0.0191 - acc: 0.9941 - val_loss: 0.2071 - val_acc: 0.9548
Epoch 12/20
 - 0s - loss: 0.0158 - acc: 0.9957 - val_loss: 0.2699 - val_acc: 0.9418
Epoch 13/20
 - 0s - loss: 0.0187 - acc: 0.9945 - val_loss: 0.2076 - val_acc: 0.9571
Epoch 14/20
 - 0s - loss: 0.0125 - acc: 0.9956 - val_loss: 0.2107 - val_acc: 0.9571
Epoch 15/20
 - 0s - loss: 0.0114 - acc: 0.9951 - val_loss: 0.2435 - val_acc: 0.9538
Epoch 16/20
 - 0s - loss: 0.0114 - acc: 0.9963 - val_loss: 0.3808 - val_acc: 0.9314
Epoch 17/20
 - 0s - loss: 0.0105 - acc: 0.9961 - val_loss: 0.2233 - val_acc: 0.9578
Epoch 18/20
 - 0s - loss: 0.0088 - acc: 0.9979 - val_loss: 0.2431 - val_acc: 0.9575
Epoch 19/20
 - 0s - loss: 0.0089 - acc: 0.9976 - val_loss: 0.2524 - val_acc: 0.9564
Epoch 20/20
 - 0s - loss: 0.0042 - acc: 0.9988 - val_loss: 0.2745 - val_acc: 0.9550
Test loss: 0.27450998816631433
Test accuracy: 0.955
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.1669 - acc: 0.3636 - val_loss: 1.3278 - val_acc: 0.5322
Epoch 2/20
 - 1s - loss: 1.1298 - acc: 0.6220 - val_loss: 0.8433 - val_acc: 0.7229
Epoch 3/20
 - 1s - loss: 0.9133 - acc: 0.6995 - val_loss: 0.6046 - val_acc: 0.8005
Epoch 4/20
 - 1s - loss: 0.7262 - acc: 0.7636 - val_loss: 0.7981 - val_acc: 0.7597
Epoch 5/20
 - 1s - loss: 0.6625 - acc: 0.7837 - val_loss: 0.7348 - val_acc: 0.7611
Epoch 6/20
 - 1s - loss: 0.5993 - acc: 0.8045 - val_loss: 0.5286 - val_acc: 0.8326
Epoch 7/20
 - 1s - loss: 0.5248 - acc: 0.8316 - val_loss: 0.6351 - val_acc: 0.7765
Epoch 8/20
 - 1s - loss: 0.4925 - acc: 0.8413 - val_loss: 0.3790 - val_acc: 0.8831
Epoch 9/20
 - 1s - loss: 0.4526 - acc: 0.8511 - val_loss: 0.4877 - val_acc: 0.8444
Epoch 10/20
 - 1s - loss: 0.4401 - acc: 0.8552 - val_loss: 0.5276 - val_acc: 0.8251
Epoch 11/20
 - 1s - loss: 0.4191 - acc: 0.8672 - val_loss: 0.4807 - val_acc: 0.8502
Epoch 12/20
 - 1s - loss: 0.3842 - acc: 0.8743 - val_loss: 0.4269 - val_acc: 0.8614
Epoch 13/20
 - 1s - loss: 0.3532 - acc: 0.8864 - val_loss: 0.6148 - val_acc: 0.8135
Epoch 14/20
 - 1s - loss: 0.3521 - acc: 0.8921 - val_loss: 0.2850 - val_acc: 0.9068
Epoch 15/20
 - 1s - loss: 0.3324 - acc: 0.8944 - val_loss: 0.2797 - val_acc: 0.9126
Epoch 16/20
 - 1s - loss: 0.3373 - acc: 0.8956 - val_loss: 0.3175 - val_acc: 0.8986
Epoch 17/20
 - 1s - loss: 0.3040 - acc: 0.9037 - val_loss: 0.3524 - val_acc: 0.8867
Epoch 18/20
 - 1s - loss: 0.2860 - acc: 0.9069 - val_loss: 0.3021 - val_acc: 0.9033
Epoch 19/20
 - 1s - loss: 0.2700 - acc: 0.9156 - val_loss: 0.2507 - val_acc: 0.9210
Epoch 20/20
 - 1s - loss: 0.2788 - acc: 0.9115 - val_loss: 0.2396 - val_acc: 0.9241
Test loss: 0.2402768473301083
Test accuracy: 0.9244
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8420 - acc: 0.7293 - val_loss: 0.5798 - val_acc: 0.7955
Epoch 2/20
 - 0s - loss: 0.3365 - acc: 0.8952 - val_loss: 0.4406 - val_acc: 0.8582
Epoch 3/20
 - 0s - loss: 0.2373 - acc: 0.9288 - val_loss: 0.2923 - val_acc: 0.9105
Epoch 4/20
 - 0s - loss: 0.1706 - acc: 0.9469 - val_loss: 0.2682 - val_acc: 0.9165
Epoch 5/20
 - 0s - loss: 0.1242 - acc: 0.9611 - val_loss: 0.4422 - val_acc: 0.8642
Epoch 6/20
 - 0s - loss: 0.0885 - acc: 0.9733 - val_loss: 0.2496 - val_acc: 0.9244
Epoch 7/20
 - 0s - loss: 0.0719 - acc: 0.9792 - val_loss: 0.2301 - val_acc: 0.9338
Epoch 8/20
 - 0s - loss: 0.0491 - acc: 0.9861 - val_loss: 0.2647 - val_acc: 0.9260
Epoch 9/20
 - 0s - loss: 0.0450 - acc: 0.9872 - val_loss: 0.2614 - val_acc: 0.9265
Epoch 10/20
 - 0s - loss: 0.0241 - acc: 0.9941 - val_loss: 0.2643 - val_acc: 0.9353
Epoch 11/20
 - 0s - loss: 0.0367 - acc: 0.9896 - val_loss: 0.2306 - val_acc: 0.9404
Epoch 12/20
 - 0s - loss: 0.0152 - acc: 0.9965 - val_loss: 0.2510 - val_acc: 0.9403
Epoch 13/20
 - 0s - loss: 0.0147 - acc: 0.9949 - val_loss: 0.3342 - val_acc: 0.9223
Epoch 14/20
 - 0s - loss: 0.0151 - acc: 0.9949 - val_loss: 0.3960 - val_acc: 0.9122
Epoch 15/20
 - 0s - loss: 0.0137 - acc: 0.9957 - val_loss: 0.2648 - val_acc: 0.9408
Epoch 16/20
 - 0s - loss: 0.0107 - acc: 0.9973 - val_loss: 0.2729 - val_acc: 0.9420
Epoch 17/20
 - 0s - loss: 0.0084 - acc: 0.9965 - val_loss: 0.3132 - val_acc: 0.9351
Epoch 18/20
 - 0s - loss: 0.0051 - acc: 0.9987 - val_loss: 0.2855 - val_acc: 0.9436
Epoch 19/20
 - 0s - loss: 0.0133 - acc: 0.9957 - val_loss: 0.3339 - val_acc: 0.9365
Epoch 20/20
 - 0s - loss: 0.0035 - acc: 0.9997 - val_loss: 0.2795 - val_acc: 0.9474
Test loss: 0.27953318018538886
Test accuracy: 0.9474
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5268 - acc: 0.2635 - val_loss: 2.3460 - val_acc: 0.3149
Epoch 2/20
 - 1s - loss: 1.5760 - acc: 0.4827 - val_loss: 1.5279 - val_acc: 0.4928
Epoch 3/20
 - 1s - loss: 1.1991 - acc: 0.6043 - val_loss: 1.4330 - val_acc: 0.5086
Epoch 4/20
 - 1s - loss: 1.0168 - acc: 0.6664 - val_loss: 1.8468 - val_acc: 0.5108
Epoch 5/20
 - 1s - loss: 0.9396 - acc: 0.6976 - val_loss: 0.6457 - val_acc: 0.7731
Epoch 6/20
 - 1s - loss: 0.8019 - acc: 0.7363 - val_loss: 0.6775 - val_acc: 0.7801
Epoch 7/20
 - 1s - loss: 0.7544 - acc: 0.7445 - val_loss: 0.7144 - val_acc: 0.7656
Epoch 8/20
 - 1s - loss: 0.7172 - acc: 0.7723 - val_loss: 0.5342 - val_acc: 0.8209
Epoch 9/20
 - 1s - loss: 0.6657 - acc: 0.7912 - val_loss: 0.7635 - val_acc: 0.7423
Epoch 10/20
 - 1s - loss: 0.6301 - acc: 0.8000 - val_loss: 0.6865 - val_acc: 0.7595
Epoch 11/20
 - 1s - loss: 0.5987 - acc: 0.8005 - val_loss: 1.1081 - val_acc: 0.6058
Epoch 12/20
 - 1s - loss: 0.5462 - acc: 0.8176 - val_loss: 0.6654 - val_acc: 0.7951
Epoch 13/20
 - 1s - loss: 0.5204 - acc: 0.8376 - val_loss: 1.2013 - val_acc: 0.6875
Epoch 14/20
 - 1s - loss: 0.4800 - acc: 0.8515 - val_loss: 1.4609 - val_acc: 0.5780
Epoch 15/20
 - 1s - loss: 0.5250 - acc: 0.8264 - val_loss: 0.5446 - val_acc: 0.8323
Epoch 16/20
 - 1s - loss: 0.4019 - acc: 0.8677 - val_loss: 0.6114 - val_acc: 0.8097
Epoch 17/20
 - 1s - loss: 0.4652 - acc: 0.8472 - val_loss: 1.0229 - val_acc: 0.7359
Epoch 18/20
 - 1s - loss: 0.4179 - acc: 0.8637 - val_loss: 1.4147 - val_acc: 0.5843
Epoch 19/20
 - 1s - loss: 0.4120 - acc: 0.8725 - val_loss: 0.6535 - val_acc: 0.7665
Epoch 20/20
 - 1s - loss: 0.4169 - acc: 0.8683 - val_loss: 0.5580 - val_acc: 0.8142
Test loss: 0.5582589481115341
Test accuracy: 0.8129
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1248 - acc: 0.6357 - val_loss: 0.5951 - val_acc: 0.7938
Epoch 2/20
 - 0s - loss: 0.4725 - acc: 0.8544 - val_loss: 0.3760 - val_acc: 0.8856
Epoch 3/20
 - 0s - loss: 0.3488 - acc: 0.8965 - val_loss: 0.3974 - val_acc: 0.8783
Epoch 4/20
 - 0s - loss: 0.2256 - acc: 0.9403 - val_loss: 0.3926 - val_acc: 0.8782
Epoch 5/20
 - 0s - loss: 0.1932 - acc: 0.9467 - val_loss: 0.3230 - val_acc: 0.9014
Epoch 6/20
 - 0s - loss: 0.1309 - acc: 0.9675 - val_loss: 0.4070 - val_acc: 0.8820
Epoch 7/20
 - 0s - loss: 0.1050 - acc: 0.9723 - val_loss: 0.2770 - val_acc: 0.9184
Epoch 8/20
 - 0s - loss: 0.0933 - acc: 0.9739 - val_loss: 0.2974 - val_acc: 0.9135
Epoch 9/20
 - 0s - loss: 0.0570 - acc: 0.9845 - val_loss: 0.3899 - val_acc: 0.8865
Epoch 10/20
 - 0s - loss: 0.0509 - acc: 0.9861 - val_loss: 0.4434 - val_acc: 0.8815
Epoch 11/20
 - 0s - loss: 0.0302 - acc: 0.9931 - val_loss: 0.2912 - val_acc: 0.9204
Epoch 12/20
 - 0s - loss: 0.0385 - acc: 0.9899 - val_loss: 0.3114 - val_acc: 0.9194
Epoch 13/20
 - 0s - loss: 0.0172 - acc: 0.9957 - val_loss: 0.3108 - val_acc: 0.9202
Epoch 14/20
 - 0s - loss: 0.0121 - acc: 0.9973 - val_loss: 0.5678 - val_acc: 0.8708
Epoch 15/20
 - 0s - loss: 0.0152 - acc: 0.9963 - val_loss: 0.3295 - val_acc: 0.9204
Epoch 16/20
 - 0s - loss: 0.0045 - acc: 1.0000 - val_loss: 0.3722 - val_acc: 0.9157
Epoch 17/20
 - 0s - loss: 0.0137 - acc: 0.9957 - val_loss: 0.3683 - val_acc: 0.9199
Epoch 18/20
 - 0s - loss: 0.0037 - acc: 0.9989 - val_loss: 0.4125 - val_acc: 0.9122
Epoch 19/20
 - 0s - loss: 0.0140 - acc: 0.9963 - val_loss: 0.6171 - val_acc: 0.8779
Epoch 20/20
 - 0s - loss: 0.0105 - acc: 0.9973 - val_loss: 0.3447 - val_acc: 0.9246
Test loss: 0.3447092997254949
Test accuracy: 0.9246
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2163 - acc: 0.1765 - val_loss: 2.1211 - val_acc: 0.3378
Epoch 2/20
 - 1s - loss: 1.9757 - acc: 0.3152 - val_loss: 1.7055 - val_acc: 0.3452
Epoch 3/20
 - 1s - loss: 1.7793 - acc: 0.3851 - val_loss: 1.5169 - val_acc: 0.4651
Epoch 4/20
 - 1s - loss: 1.4647 - acc: 0.5291 - val_loss: 1.2735 - val_acc: 0.5706
Epoch 5/20
 - 1s - loss: 1.3417 - acc: 0.5648 - val_loss: 1.1140 - val_acc: 0.6320
Epoch 6/20
 - 1s - loss: 1.1047 - acc: 0.6512 - val_loss: 1.4353 - val_acc: 0.5911
Epoch 7/20
 - 1s - loss: 1.0839 - acc: 0.6437 - val_loss: 0.8503 - val_acc: 0.7250
Epoch 8/20
 - 1s - loss: 0.9549 - acc: 0.6917 - val_loss: 0.9942 - val_acc: 0.6760
Epoch 9/20
 - 1s - loss: 0.9296 - acc: 0.6933 - val_loss: 0.8834 - val_acc: 0.6977
Epoch 10/20
 - 1s - loss: 0.8798 - acc: 0.6997 - val_loss: 0.6370 - val_acc: 0.7851
Epoch 11/20
 - 1s - loss: 0.8877 - acc: 0.7205 - val_loss: 0.6345 - val_acc: 0.8083
Epoch 12/20
 - 1s - loss: 0.7872 - acc: 0.7573 - val_loss: 1.0867 - val_acc: 0.6358
Epoch 13/20
 - 1s - loss: 0.7090 - acc: 0.7664 - val_loss: 1.1164 - val_acc: 0.6472
Epoch 14/20
 - 1s - loss: 0.8148 - acc: 0.7435 - val_loss: 0.7012 - val_acc: 0.7717
Epoch 15/20
 - 1s - loss: 0.6555 - acc: 0.7925 - val_loss: 1.0887 - val_acc: 0.6988
Epoch 16/20
 - 1s - loss: 0.6902 - acc: 0.7733 - val_loss: 0.8591 - val_acc: 0.7132
Epoch 17/20
 - 1s - loss: 0.6409 - acc: 0.7968 - val_loss: 0.5849 - val_acc: 0.7960
Epoch 18/20
 - 1s - loss: 0.7083 - acc: 0.7675 - val_loss: 0.5673 - val_acc: 0.8071
Epoch 19/20
 - 1s - loss: 0.6188 - acc: 0.7984 - val_loss: 0.4496 - val_acc: 0.8585
Epoch 20/20
 - 1s - loss: 0.5926 - acc: 0.8101 - val_loss: 0.5429 - val_acc: 0.8237
Test loss: 0.5430259122848511
Test accuracy: 0.8242
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.4570 - acc: 0.5187 - val_loss: 0.9122 - val_acc: 0.6796
Epoch 2/20
 - 0s - loss: 0.6395 - acc: 0.7994 - val_loss: 0.7376 - val_acc: 0.7674
Epoch 3/20
 - 0s - loss: 0.4075 - acc: 0.8762 - val_loss: 0.5456 - val_acc: 0.8186
Epoch 4/20
 - 0s - loss: 0.3063 - acc: 0.9168 - val_loss: 0.5057 - val_acc: 0.8510
Epoch 5/20
 - 0s - loss: 0.2837 - acc: 0.9189 - val_loss: 0.7123 - val_acc: 0.7831
Epoch 6/20
 - 0s - loss: 0.1949 - acc: 0.9413 - val_loss: 0.5192 - val_acc: 0.8416
Epoch 7/20
 - 0s - loss: 0.1386 - acc: 0.9733 - val_loss: 0.5591 - val_acc: 0.8290
Epoch 8/20
 - 0s - loss: 0.1066 - acc: 0.9733 - val_loss: 0.4808 - val_acc: 0.8599
Epoch 9/20
 - 0s - loss: 0.0695 - acc: 0.9872 - val_loss: 0.4187 - val_acc: 0.8693
Epoch 10/20
 - 0s - loss: 0.0581 - acc: 0.9915 - val_loss: 0.4457 - val_acc: 0.8741
Epoch 11/20
 - 0s - loss: 0.1144 - acc: 0.9605 - val_loss: 0.3697 - val_acc: 0.8904
Epoch 12/20
 - 0s - loss: 0.0252 - acc: 0.9979 - val_loss: 0.4014 - val_acc: 0.8861
Epoch 13/20
 - 0s - loss: 0.0185 - acc: 0.9979 - val_loss: 0.4758 - val_acc: 0.8754
Epoch 14/20
 - 0s - loss: 0.0193 - acc: 0.9989 - val_loss: 0.4561 - val_acc: 0.8825
Epoch 15/20
 - 0s - loss: 0.0709 - acc: 0.9744 - val_loss: 0.3908 - val_acc: 0.8963
Epoch 16/20
 - 0s - loss: 0.0084 - acc: 1.0000 - val_loss: 0.4073 - val_acc: 0.8974
Epoch 17/20
 - 0s - loss: 0.0117 - acc: 0.9968 - val_loss: 0.4308 - val_acc: 0.8924
Epoch 18/20
 - 0s - loss: 0.0059 - acc: 1.0000 - val_loss: 0.4177 - val_acc: 0.8971
Epoch 19/20
 - 0s - loss: 0.0037 - acc: 1.0000 - val_loss: 0.4678 - val_acc: 0.8891
Epoch 20/20
 - 0s - loss: 0.0063 - acc: 0.9989 - val_loss: 0.5739 - val_acc: 0.8786
Test loss: 0.573940576298628
Test accuracy: 0.8786
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.0603 - acc: 0.1217 - val_loss: 2.1881 - val_acc: 0.2206
Epoch 2/20
 - 0s - loss: 2.1001 - acc: 0.2593 - val_loss: 2.1941 - val_acc: 0.2226
Epoch 3/20
 - 0s - loss: 1.9416 - acc: 0.3618 - val_loss: 2.1605 - val_acc: 0.1838
Epoch 4/20
 - 0s - loss: 1.8265 - acc: 0.3970 - val_loss: 2.3618 - val_acc: 0.2029
Epoch 5/20
 - 0s - loss: 1.7953 - acc: 0.4023 - val_loss: 1.4699 - val_acc: 0.5521
Epoch 6/20
 - 0s - loss: 1.5262 - acc: 0.4856 - val_loss: 1.7565 - val_acc: 0.4930
Epoch 7/20
 - 0s - loss: 1.3993 - acc: 0.5422 - val_loss: 1.7340 - val_acc: 0.3538
Epoch 8/20
 - 0s - loss: 1.3483 - acc: 0.5646 - val_loss: 1.3301 - val_acc: 0.5156
Epoch 9/20
 - 0s - loss: 1.1241 - acc: 0.6243 - val_loss: 1.2935 - val_acc: 0.5184
Epoch 10/20
 - 0s - loss: 1.3060 - acc: 0.5656 - val_loss: 1.1070 - val_acc: 0.6647
Epoch 11/20
 - 0s - loss: 1.0714 - acc: 0.6286 - val_loss: 1.4620 - val_acc: 0.4923
Epoch 12/20
 - 0s - loss: 1.0352 - acc: 0.6478 - val_loss: 0.7922 - val_acc: 0.7350
Epoch 13/20
 - 0s - loss: 1.0397 - acc: 0.6414 - val_loss: 1.0257 - val_acc: 0.6115
Epoch 14/20
 - 0s - loss: 0.8791 - acc: 0.7097 - val_loss: 1.0987 - val_acc: 0.6954
Epoch 15/20
 - 0s - loss: 0.8577 - acc: 0.7215 - val_loss: 1.0875 - val_acc: 0.6707
Epoch 16/20
 - 0s - loss: 0.7702 - acc: 0.7577 - val_loss: 0.9289 - val_acc: 0.6791
Epoch 17/20
 - 0s - loss: 0.9791 - acc: 0.6777 - val_loss: 1.1583 - val_acc: 0.6327
Epoch 18/20
 - 0s - loss: 0.7924 - acc: 0.7439 - val_loss: 1.0098 - val_acc: 0.6227
Epoch 19/20
 - 0s - loss: 0.8204 - acc: 0.7236 - val_loss: 0.9781 - val_acc: 0.6884
Epoch 20/20
 - 0s - loss: 0.7886 - acc: 0.7513 - val_loss: 0.8420 - val_acc: 0.7226
Test loss: 0.8412579111099243
Test accuracy: 0.723
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.7845 - acc: 0.4209 - val_loss: 1.2020 - val_acc: 0.6222
Epoch 2/20
 - 0s - loss: 0.7882 - acc: 0.7735 - val_loss: 1.1514 - val_acc: 0.6543
Epoch 3/20
 - 0s - loss: 0.6248 - acc: 0.8013 - val_loss: 0.6751 - val_acc: 0.7866
Epoch 4/20
 - 0s - loss: 0.3387 - acc: 0.9103 - val_loss: 0.6691 - val_acc: 0.7768
Epoch 5/20
 - 0s - loss: 0.2575 - acc: 0.9231 - val_loss: 0.5893 - val_acc: 0.8065
Epoch 6/20
 - 0s - loss: 0.1947 - acc: 0.9509 - val_loss: 0.6500 - val_acc: 0.7967
Epoch 7/20
 - 0s - loss: 0.1859 - acc: 0.9615 - val_loss: 0.5721 - val_acc: 0.8260
Epoch 8/20
 - 0s - loss: 0.0982 - acc: 0.9872 - val_loss: 0.5681 - val_acc: 0.8197
Epoch 9/20
 - 0s - loss: 0.0760 - acc: 0.9915 - val_loss: 0.5005 - val_acc: 0.8435
Epoch 10/20
 - 0s - loss: 0.0657 - acc: 0.9893 - val_loss: 0.5854 - val_acc: 0.8323
Epoch 11/20
 - 0s - loss: 0.0675 - acc: 0.9893 - val_loss: 0.5805 - val_acc: 0.8325
Epoch 12/20
 - 0s - loss: 0.0316 - acc: 0.9979 - val_loss: 0.6060 - val_acc: 0.8247
Epoch 13/20
 - 0s - loss: 0.1364 - acc: 0.9551 - val_loss: 0.5740 - val_acc: 0.8242
Epoch 14/20
 - 0s - loss: 0.0327 - acc: 0.9936 - val_loss: 0.5794 - val_acc: 0.8276
Epoch 15/20
 - 0s - loss: 0.0214 - acc: 1.0000 - val_loss: 0.5538 - val_acc: 0.8428
Epoch 16/20
 - 0s - loss: 0.0122 - acc: 1.0000 - val_loss: 0.5395 - val_acc: 0.8515
Epoch 17/20
 - 0s - loss: 0.0101 - acc: 1.0000 - val_loss: 0.5445 - val_acc: 0.8482
Epoch 18/20
 - 0s - loss: 0.0155 - acc: 0.9979 - val_loss: 0.5852 - val_acc: 0.8426
Epoch 19/20
 - 0s - loss: 0.0089 - acc: 1.0000 - val_loss: 0.6514 - val_acc: 0.8393
Epoch 20/20
 - 0s - loss: 0.0073 - acc: 1.0000 - val_loss: 0.6557 - val_acc: 0.8389
Test loss: 0.6557212443623692
Test accuracy: 0.8389
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.0828 - acc: 0.1197 - val_loss: 3.2992 - val_acc: 0.0974
Epoch 2/20
 - 0s - loss: 2.6076 - acc: 0.1496 - val_loss: 2.1380 - val_acc: 0.1586
Epoch 3/20
 - 0s - loss: 2.0748 - acc: 0.2756 - val_loss: 2.2349 - val_acc: 0.1672
Epoch 4/20
 - 0s - loss: 2.1199 - acc: 0.2564 - val_loss: 1.9628 - val_acc: 0.3585
Epoch 5/20
 - 0s - loss: 1.9055 - acc: 0.3504 - val_loss: 1.8777 - val_acc: 0.3952
Epoch 6/20
 - 0s - loss: 1.9398 - acc: 0.3205 - val_loss: 1.8830 - val_acc: 0.4905
Epoch 7/20
 - 0s - loss: 1.5983 - acc: 0.5278 - val_loss: 1.9162 - val_acc: 0.2260
Epoch 8/20
 - 0s - loss: 1.8551 - acc: 0.3675 - val_loss: 1.7123 - val_acc: 0.4042
Epoch 9/20
 - 0s - loss: 1.6898 - acc: 0.4167 - val_loss: 1.7676 - val_acc: 0.3255
Epoch 10/20
 - 0s - loss: 1.4427 - acc: 0.5192 - val_loss: 1.6136 - val_acc: 0.5029
Epoch 11/20
 - 0s - loss: 1.3653 - acc: 0.5662 - val_loss: 1.5162 - val_acc: 0.4791
Epoch 12/20
 - 0s - loss: 1.1623 - acc: 0.6325 - val_loss: 1.4044 - val_acc: 0.5235
Epoch 13/20
 - 0s - loss: 1.3876 - acc: 0.5406 - val_loss: 1.3711 - val_acc: 0.5339
Epoch 14/20
 - 0s - loss: 1.1743 - acc: 0.6154 - val_loss: 1.6632 - val_acc: 0.4957
Epoch 15/20
 - 0s - loss: 1.2552 - acc: 0.6111 - val_loss: 1.0843 - val_acc: 0.6208
Epoch 16/20
 - 0s - loss: 1.1516 - acc: 0.6368 - val_loss: 1.3144 - val_acc: 0.5155
Epoch 17/20
 - 0s - loss: 0.9452 - acc: 0.6795 - val_loss: 1.1911 - val_acc: 0.5992
Epoch 18/20
 - 0s - loss: 1.0612 - acc: 0.6731 - val_loss: 1.2047 - val_acc: 0.6405
Epoch 19/20
 - 0s - loss: 0.8961 - acc: 0.7393 - val_loss: 1.2640 - val_acc: 0.6565
Epoch 20/20
 - 0s - loss: 0.9790 - acc: 0.7051 - val_loss: 1.0077 - val_acc: 0.6631
Test loss: 1.0079607438087463
Test accuracy: 0.6632
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1619 - acc: 0.1667 - val_loss: 1.8216 - val_acc: 0.4856
Epoch 2/20
 - 0s - loss: 1.4343 - acc: 0.6068 - val_loss: 1.3166 - val_acc: 0.5871
Epoch 3/20
 - 0s - loss: 0.8182 - acc: 0.7949 - val_loss: 1.0090 - val_acc: 0.6977
Epoch 4/20
 - 0s - loss: 0.4845 - acc: 0.8718 - val_loss: 1.1296 - val_acc: 0.6013
Epoch 5/20
 - 0s - loss: 0.5198 - acc: 0.8291 - val_loss: 0.8582 - val_acc: 0.7104
Epoch 6/20
 - 0s - loss: 0.2605 - acc: 0.9487 - val_loss: 0.7377 - val_acc: 0.7677
Epoch 7/20
 - 0s - loss: 0.1811 - acc: 0.9744 - val_loss: 0.7833 - val_acc: 0.7525
Epoch 8/20
 - 0s - loss: 0.1434 - acc: 0.9701 - val_loss: 0.7479 - val_acc: 0.7677
Epoch 9/20
 - 0s - loss: 0.1255 - acc: 0.9915 - val_loss: 0.7985 - val_acc: 0.7504
Epoch 10/20
 - 0s - loss: 0.0789 - acc: 0.9957 - val_loss: 0.7885 - val_acc: 0.7619
Epoch 11/20
 - 0s - loss: 0.0734 - acc: 0.9872 - val_loss: 0.8324 - val_acc: 0.7655
Epoch 12/20
 - 0s - loss: 0.0609 - acc: 0.9957 - val_loss: 0.8383 - val_acc: 0.7579
Epoch 13/20
 - 0s - loss: 0.0511 - acc: 1.0000 - val_loss: 0.8066 - val_acc: 0.7723
Epoch 14/20
 - 0s - loss: 0.0312 - acc: 1.0000 - val_loss: 0.7282 - val_acc: 0.7881
Epoch 15/20
 - 0s - loss: 0.0266 - acc: 1.0000 - val_loss: 0.7777 - val_acc: 0.7804
Epoch 16/20
 - 0s - loss: 0.0241 - acc: 1.0000 - val_loss: 0.7590 - val_acc: 0.7844
Epoch 17/20
 - 0s - loss: 0.0159 - acc: 1.0000 - val_loss: 0.8244 - val_acc: 0.7762
Epoch 18/20
 - 0s - loss: 0.0220 - acc: 0.9957 - val_loss: 0.9138 - val_acc: 0.7625
Epoch 19/20
 - 0s - loss: 0.1060 - acc: 0.9530 - val_loss: 1.8063 - val_acc: 0.6798
Epoch 20/20
 - 0s - loss: 0.2801 - acc: 0.9530 - val_loss: 0.8084 - val_acc: 0.7782
Test loss: 0.8084490072488785
Test accuracy: 0.7782
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.1533 - acc: 0.1111 - val_loss: 5.5067 - val_acc: 0.1009
Epoch 2/20
 - 0s - loss: 5.3005 - acc: 0.1111 - val_loss: 3.6579 - val_acc: 0.0980
Epoch 3/20
 - 0s - loss: 3.2095 - acc: 0.1111 - val_loss: 2.2368 - val_acc: 0.2661
Epoch 4/20
 - 0s - loss: 2.2134 - acc: 0.2564 - val_loss: 2.1446 - val_acc: 0.3122
Epoch 5/20
 - 0s - loss: 2.1531 - acc: 0.2436 - val_loss: 2.1949 - val_acc: 0.3458
Epoch 6/20
 - 0s - loss: 2.1386 - acc: 0.2692 - val_loss: 2.0932 - val_acc: 0.3993
Epoch 7/20
 - 0s - loss: 2.0070 - acc: 0.3376 - val_loss: 2.2147 - val_acc: 0.1635
Epoch 8/20
 - 0s - loss: 2.0854 - acc: 0.2479 - val_loss: 2.0121 - val_acc: 0.3397
Epoch 9/20
 - 0s - loss: 1.9756 - acc: 0.3761 - val_loss: 1.9898 - val_acc: 0.2911
Epoch 10/20
 - 0s - loss: 1.8312 - acc: 0.3932 - val_loss: 2.0578 - val_acc: 0.3476
Epoch 11/20
 - 0s - loss: 1.7716 - acc: 0.4530 - val_loss: 2.0101 - val_acc: 0.3166
Epoch 12/20
 - 0s - loss: 1.9195 - acc: 0.3675 - val_loss: 1.8458 - val_acc: 0.3762
Epoch 13/20
 - 0s - loss: 1.8410 - acc: 0.4316 - val_loss: 1.9533 - val_acc: 0.4429
Epoch 14/20
 - 0s - loss: 1.6780 - acc: 0.4786 - val_loss: 1.8117 - val_acc: 0.3352
Epoch 15/20
 - 0s - loss: 1.7256 - acc: 0.3761 - val_loss: 1.9664 - val_acc: 0.4007
Epoch 16/20
 - 0s - loss: 1.6497 - acc: 0.4701 - val_loss: 1.5981 - val_acc: 0.4934
Epoch 17/20
 - 0s - loss: 1.4112 - acc: 0.5726 - val_loss: 1.9692 - val_acc: 0.2773
Epoch 18/20
 - 0s - loss: 1.7006 - acc: 0.4274 - val_loss: 1.8363 - val_acc: 0.4140
Epoch 19/20
 - 0s - loss: 1.5384 - acc: 0.4957 - val_loss: 1.7444 - val_acc: 0.4269
Epoch 20/20
 - 0s - loss: 1.4169 - acc: 0.4957 - val_loss: 1.5862 - val_acc: 0.4949
Test loss: 1.585964260864258
Test accuracy: 0.4969
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3828 - acc: 0.0684 - val_loss: 2.1065 - val_acc: 0.2766
Epoch 2/20
 - 0s - loss: 1.6521 - acc: 0.4872 - val_loss: 1.7724 - val_acc: 0.4130
Epoch 3/20
 - 0s - loss: 1.4080 - acc: 0.5897 - val_loss: 1.5115 - val_acc: 0.5393
Epoch 4/20
 - 0s - loss: 0.9323 - acc: 0.8462 - val_loss: 1.3520 - val_acc: 0.5573
Epoch 5/20
 - 0s - loss: 0.5977 - acc: 0.7949 - val_loss: 1.1693 - val_acc: 0.6270
Epoch 6/20
 - 0s - loss: 0.4576 - acc: 0.8974 - val_loss: 1.3287 - val_acc: 0.5614
Epoch 7/20
 - 0s - loss: 0.4135 - acc: 0.8632 - val_loss: 1.1281 - val_acc: 0.6409
Epoch 8/20
 - 0s - loss: 0.3227 - acc: 0.9316 - val_loss: 1.0708 - val_acc: 0.6573
Epoch 9/20
 - 0s - loss: 0.2007 - acc: 0.9744 - val_loss: 1.0537 - val_acc: 0.6796
Epoch 10/20
 - 0s - loss: 0.1427 - acc: 0.9658 - val_loss: 1.0130 - val_acc: 0.6694
Epoch 11/20
 - 0s - loss: 0.1035 - acc: 0.9915 - val_loss: 0.9631 - val_acc: 0.7181
Epoch 12/20
 - 0s - loss: 0.0777 - acc: 0.9829 - val_loss: 0.9692 - val_acc: 0.6992
Epoch 13/20
 - 0s - loss: 0.0654 - acc: 1.0000 - val_loss: 0.9671 - val_acc: 0.7182
Epoch 14/20
 - 0s - loss: 0.0511 - acc: 1.0000 - val_loss: 0.9495 - val_acc: 0.7155
Epoch 15/20
 - 0s - loss: 0.0393 - acc: 1.0000 - val_loss: 0.9428 - val_acc: 0.7246
Epoch 16/20
 - 0s - loss: 0.0306 - acc: 1.0000 - val_loss: 0.9345 - val_acc: 0.7275
Epoch 17/20
 - 0s - loss: 0.0283 - acc: 1.0000 - val_loss: 0.9607 - val_acc: 0.7207
Epoch 18/20
 - 0s - loss: 0.0258 - acc: 1.0000 - val_loss: 0.9490 - val_acc: 0.7224
Epoch 19/20
 - 0s - loss: 0.0253 - acc: 1.0000 - val_loss: 0.9732 - val_acc: 0.7226
Epoch 20/20
 - 0s - loss: 0.0211 - acc: 1.0000 - val_loss: 0.9619 - val_acc: 0.7250
Test loss: 0.961948192691803
Test accuracy: 0.725
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7317 - acc: 0.1282 - val_loss: 5.5837 - val_acc: 0.1327
Epoch 2/20
 - 0s - loss: 5.5438 - acc: 0.1282 - val_loss: 5.6869 - val_acc: 0.0982
Epoch 3/20
 - 0s - loss: 5.3856 - acc: 0.1197 - val_loss: 4.1452 - val_acc: 0.1334
Epoch 4/20
 - 0s - loss: 4.1117 - acc: 0.1453 - val_loss: 2.5663 - val_acc: 0.1950
Epoch 5/20
 - 0s - loss: 2.5067 - acc: 0.2051 - val_loss: 2.2600 - val_acc: 0.1505
Epoch 6/20
 - 0s - loss: 2.2235 - acc: 0.2137 - val_loss: 2.1623 - val_acc: 0.2570
Epoch 7/20
 - 0s - loss: 2.0656 - acc: 0.3761 - val_loss: 2.1868 - val_acc: 0.1935
Epoch 8/20
 - 0s - loss: 2.0284 - acc: 0.2393 - val_loss: 2.3940 - val_acc: 0.1010
Epoch 9/20
 - 0s - loss: 2.2508 - acc: 0.1538 - val_loss: 2.3564 - val_acc: 0.1441
Epoch 10/20
 - 0s - loss: 2.1605 - acc: 0.2137 - val_loss: 2.0790 - val_acc: 0.2133
Epoch 11/20
 - 0s - loss: 1.9524 - acc: 0.3419 - val_loss: 2.0334 - val_acc: 0.3183
Epoch 12/20
 - 0s - loss: 1.8069 - acc: 0.4359 - val_loss: 1.9374 - val_acc: 0.3434
Epoch 13/20
 - 0s - loss: 1.7444 - acc: 0.4957 - val_loss: 2.0101 - val_acc: 0.3239
Epoch 14/20
 - 0s - loss: 1.7254 - acc: 0.4444 - val_loss: 1.9094 - val_acc: 0.3320
Epoch 15/20
 - 0s - loss: 1.6901 - acc: 0.4530 - val_loss: 1.9714 - val_acc: 0.2657
Epoch 16/20
 - 0s - loss: 1.6766 - acc: 0.4274 - val_loss: 2.2931 - val_acc: 0.1568
Epoch 17/20
 - 0s - loss: 2.0271 - acc: 0.2564 - val_loss: 2.2462 - val_acc: 0.2929
Epoch 18/20
 - 0s - loss: 2.0520 - acc: 0.3248 - val_loss: 1.9792 - val_acc: 0.3125
Epoch 19/20
 - 0s - loss: 1.7323 - acc: 0.3761 - val_loss: 2.0076 - val_acc: 0.3002
Epoch 20/20
 - 0s - loss: 1.7097 - acc: 0.4274 - val_loss: 1.9132 - val_acc: 0.3837
Test loss: 1.913226273536682
Test accuracy: 0.3851
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.2507 - acc: 0.9227 - val_loss: 0.1019 - val_acc: 0.9669
Epoch 2/20
 - 2s - loss: 0.1035 - acc: 0.9684 - val_loss: 0.0764 - val_acc: 0.9788
Epoch 3/20
 - 2s - loss: 0.0759 - acc: 0.9773 - val_loss: 0.0783 - val_acc: 0.9778
Epoch 4/20
 - 2s - loss: 0.0619 - acc: 0.9810 - val_loss: 0.0785 - val_acc: 0.9779
Epoch 5/20
 - 2s - loss: 0.0538 - acc: 0.9841 - val_loss: 0.0691 - val_acc: 0.9809
Epoch 6/20
 - 2s - loss: 0.0435 - acc: 0.9868 - val_loss: 0.0817 - val_acc: 0.9798
Epoch 7/20
 - 2s - loss: 0.0412 - acc: 0.9881 - val_loss: 0.0823 - val_acc: 0.9809
Epoch 8/20
 - 2s - loss: 0.0343 - acc: 0.9899 - val_loss: 0.0895 - val_acc: 0.9805
Epoch 9/20
 - 2s - loss: 0.0312 - acc: 0.9904 - val_loss: 0.0916 - val_acc: 0.9811
Epoch 10/20
 - 2s - loss: 0.0307 - acc: 0.9911 - val_loss: 0.0876 - val_acc: 0.9831
Epoch 11/20
 - 2s - loss: 0.0272 - acc: 0.9923 - val_loss: 0.1058 - val_acc: 0.9799
Epoch 12/20
 - 2s - loss: 0.0253 - acc: 0.9931 - val_loss: 0.1058 - val_acc: 0.9803
Epoch 13/20
 - 2s - loss: 0.0231 - acc: 0.9935 - val_loss: 0.0883 - val_acc: 0.9850
Epoch 14/20
 - 2s - loss: 0.0234 - acc: 0.9935 - val_loss: 0.0839 - val_acc: 0.9851
Epoch 15/20
 - 2s - loss: 0.0227 - acc: 0.9939 - val_loss: 0.1127 - val_acc: 0.9807
Epoch 16/20
 - 2s - loss: 0.0214 - acc: 0.9944 - val_loss: 0.1033 - val_acc: 0.9827
Epoch 17/20
 - 2s - loss: 0.0228 - acc: 0.9941 - val_loss: 0.1058 - val_acc: 0.9833
Epoch 18/20
 - 2s - loss: 0.0215 - acc: 0.9943 - val_loss: 0.1078 - val_acc: 0.9826
Epoch 19/20
 - 2s - loss: 0.0189 - acc: 0.9951 - val_loss: 0.1117 - val_acc: 0.9838
Epoch 20/20
 - 2s - loss: 0.0190 - acc: 0.9949 - val_loss: 0.1212 - val_acc: 0.9824
Test loss: 0.12118819393242942
Test accuracy: 0.9824
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9398 - acc: 0.6991 - val_loss: 0.3443 - val_acc: 0.8920
Epoch 2/20
 - 4s - loss: 0.4314 - acc: 0.8633 - val_loss: 0.4574 - val_acc: 0.8493
Epoch 3/20
 - 4s - loss: 0.3186 - acc: 0.9004 - val_loss: 0.2705 - val_acc: 0.9098
Epoch 4/20
 - 4s - loss: 0.2663 - acc: 0.9173 - val_loss: 0.3666 - val_acc: 0.8858
Epoch 5/20
 - 4s - loss: 0.2385 - acc: 0.9259 - val_loss: 0.1770 - val_acc: 0.9437
Epoch 6/20
 - 4s - loss: 0.2153 - acc: 0.9337 - val_loss: 0.2292 - val_acc: 0.9261
Epoch 7/20
 - 4s - loss: 0.2007 - acc: 0.9393 - val_loss: 0.1355 - val_acc: 0.9567
Epoch 8/20
 - 4s - loss: 0.1897 - acc: 0.9428 - val_loss: 0.1123 - val_acc: 0.9647
Epoch 9/20
 - 4s - loss: 0.1848 - acc: 0.9443 - val_loss: 0.1056 - val_acc: 0.9669
Epoch 10/20
 - 4s - loss: 0.1798 - acc: 0.9474 - val_loss: 0.1482 - val_acc: 0.9522
Epoch 11/20
 - 4s - loss: 0.1705 - acc: 0.9485 - val_loss: 0.1960 - val_acc: 0.9429
Epoch 12/20
 - 4s - loss: 0.1692 - acc: 0.9500 - val_loss: 0.1272 - val_acc: 0.9627
Epoch 13/20
 - 4s - loss: 0.1685 - acc: 0.9514 - val_loss: 0.1042 - val_acc: 0.9700
Epoch 14/20
 - 4s - loss: 0.1670 - acc: 0.9522 - val_loss: 0.1222 - val_acc: 0.9654
Epoch 15/20
 - 4s - loss: 0.1634 - acc: 0.9521 - val_loss: 0.1124 - val_acc: 0.9656
Epoch 16/20
 - 4s - loss: 0.1607 - acc: 0.9535 - val_loss: 0.1262 - val_acc: 0.9662
Epoch 17/20
 - 4s - loss: 0.1614 - acc: 0.9546 - val_loss: 0.1586 - val_acc: 0.9542
Epoch 18/20
 - 4s - loss: 0.1604 - acc: 0.9545 - val_loss: 0.0935 - val_acc: 0.9711
Epoch 19/20
 - 4s - loss: 0.1624 - acc: 0.9547 - val_loss: 0.1094 - val_acc: 0.9711
Epoch 20/20
 - 4s - loss: 0.1694 - acc: 0.9535 - val_loss: 0.1433 - val_acc: 0.9632
Test loss: 0.14129629641504143
Test accuracy: 0.9638
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3377 - acc: 0.8989 - val_loss: 0.1701 - val_acc: 0.9488
Epoch 2/20
 - 1s - loss: 0.1344 - acc: 0.9584 - val_loss: 0.1202 - val_acc: 0.9621
Epoch 3/20
 - 1s - loss: 0.0924 - acc: 0.9705 - val_loss: 0.0936 - val_acc: 0.9716
Epoch 4/20
 - 1s - loss: 0.0648 - acc: 0.9796 - val_loss: 0.0912 - val_acc: 0.9731
Epoch 5/20
 - 1s - loss: 0.0556 - acc: 0.9824 - val_loss: 0.0991 - val_acc: 0.9730
Epoch 6/20
 - 1s - loss: 0.0426 - acc: 0.9864 - val_loss: 0.1023 - val_acc: 0.9729
Epoch 7/20
 - 1s - loss: 0.0373 - acc: 0.9878 - val_loss: 0.0960 - val_acc: 0.9764
Epoch 8/20
 - 1s - loss: 0.0309 - acc: 0.9907 - val_loss: 0.0933 - val_acc: 0.9783
Epoch 9/20
 - 1s - loss: 0.0277 - acc: 0.9911 - val_loss: 0.1117 - val_acc: 0.9752
Epoch 10/20
 - 1s - loss: 0.0247 - acc: 0.9920 - val_loss: 0.1150 - val_acc: 0.9784
Epoch 11/20
 - 1s - loss: 0.0216 - acc: 0.9930 - val_loss: 0.1279 - val_acc: 0.9757
Epoch 12/20
 - 1s - loss: 0.0207 - acc: 0.9936 - val_loss: 0.1156 - val_acc: 0.9781
Epoch 13/20
 - 1s - loss: 0.0193 - acc: 0.9942 - val_loss: 0.1515 - val_acc: 0.9722
Epoch 14/20
 - 1s - loss: 0.0206 - acc: 0.9942 - val_loss: 0.1225 - val_acc: 0.9781
Epoch 15/20
 - 1s - loss: 0.0166 - acc: 0.9947 - val_loss: 0.1259 - val_acc: 0.9786
Epoch 16/20
 - 1s - loss: 0.0153 - acc: 0.9951 - val_loss: 0.1333 - val_acc: 0.9774
Epoch 17/20
 - 1s - loss: 0.0147 - acc: 0.9954 - val_loss: 0.1250 - val_acc: 0.9800
Epoch 18/20
 - 1s - loss: 0.0133 - acc: 0.9960 - val_loss: 0.1456 - val_acc: 0.9776
Epoch 19/20
 - 1s - loss: 0.0134 - acc: 0.9959 - val_loss: 0.1349 - val_acc: 0.9790
Epoch 20/20
 - 1s - loss: 0.0131 - acc: 0.9962 - val_loss: 0.1334 - val_acc: 0.9785
Test loss: 0.13344312786954246
Test accuracy: 0.9785
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2798 - acc: 0.5925 - val_loss: 1.0388 - val_acc: 0.6784
Epoch 2/20
 - 2s - loss: 0.6246 - acc: 0.7988 - val_loss: 0.5311 - val_acc: 0.8235
Epoch 3/20
 - 2s - loss: 0.4638 - acc: 0.8512 - val_loss: 0.4907 - val_acc: 0.8386
Epoch 4/20
 - 2s - loss: 0.3792 - acc: 0.8797 - val_loss: 0.5103 - val_acc: 0.8432
Epoch 5/20
 - 2s - loss: 0.3313 - acc: 0.8954 - val_loss: 0.2937 - val_acc: 0.8899
Epoch 6/20
 - 2s - loss: 0.2884 - acc: 0.9096 - val_loss: 0.3506 - val_acc: 0.8932
Epoch 7/20
 - 2s - loss: 0.2617 - acc: 0.9173 - val_loss: 0.2993 - val_acc: 0.9030
Epoch 8/20
 - 2s - loss: 0.2452 - acc: 0.9229 - val_loss: 0.1927 - val_acc: 0.9408
Epoch 9/20
 - 2s - loss: 0.2347 - acc: 0.9269 - val_loss: 0.2120 - val_acc: 0.9315
Epoch 10/20
 - 2s - loss: 0.2137 - acc: 0.9337 - val_loss: 0.2226 - val_acc: 0.9239
Epoch 11/20
 - 2s - loss: 0.2057 - acc: 0.9364 - val_loss: 0.2591 - val_acc: 0.9121
Epoch 12/20
 - 2s - loss: 0.1926 - acc: 0.9407 - val_loss: 0.1428 - val_acc: 0.9533
Epoch 13/20
 - 2s - loss: 0.1888 - acc: 0.9420 - val_loss: 0.1524 - val_acc: 0.9535
Epoch 14/20
 - 2s - loss: 0.1790 - acc: 0.9451 - val_loss: 0.2164 - val_acc: 0.9338
Epoch 15/20
 - 2s - loss: 0.1711 - acc: 0.9464 - val_loss: 0.1422 - val_acc: 0.9552
Epoch 16/20
 - 2s - loss: 0.1643 - acc: 0.9496 - val_loss: 0.1408 - val_acc: 0.9573
Epoch 17/20
 - 2s - loss: 0.1670 - acc: 0.9476 - val_loss: 0.1965 - val_acc: 0.9422
Epoch 18/20
 - 2s - loss: 0.1628 - acc: 0.9510 - val_loss: 0.1541 - val_acc: 0.9562
Epoch 19/20
 - 2s - loss: 0.1548 - acc: 0.9529 - val_loss: 0.1852 - val_acc: 0.9450
Epoch 20/20
 - 2s - loss: 0.1535 - acc: 0.9534 - val_loss: 0.2285 - val_acc: 0.9329
Test loss: 0.23116970432139933
Test accuracy: 0.9327
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4658 - acc: 0.8535 - val_loss: 0.2260 - val_acc: 0.9273
Epoch 2/20
 - 1s - loss: 0.1826 - acc: 0.9447 - val_loss: 0.1691 - val_acc: 0.9481
Epoch 3/20
 - 1s - loss: 0.1182 - acc: 0.9631 - val_loss: 0.1941 - val_acc: 0.9383
Epoch 4/20
 - 1s - loss: 0.0890 - acc: 0.9705 - val_loss: 0.1788 - val_acc: 0.9485
Epoch 5/20
 - 1s - loss: 0.0627 - acc: 0.9795 - val_loss: 0.1858 - val_acc: 0.9475
Epoch 6/20
 - 1s - loss: 0.0510 - acc: 0.9838 - val_loss: 0.1293 - val_acc: 0.9634
Epoch 7/20
 - 1s - loss: 0.0395 - acc: 0.9873 - val_loss: 0.1168 - val_acc: 0.9691
Epoch 8/20
 - 1s - loss: 0.0340 - acc: 0.9883 - val_loss: 0.1377 - val_acc: 0.9649
Epoch 9/20
 - 1s - loss: 0.0275 - acc: 0.9907 - val_loss: 0.1466 - val_acc: 0.9672
Epoch 10/20
 - 1s - loss: 0.0238 - acc: 0.9922 - val_loss: 0.1389 - val_acc: 0.9689
Epoch 11/20
 - 1s - loss: 0.0198 - acc: 0.9935 - val_loss: 0.1669 - val_acc: 0.9656
Epoch 12/20
 - 1s - loss: 0.0166 - acc: 0.9942 - val_loss: 0.1590 - val_acc: 0.9699
Epoch 13/20
 - 1s - loss: 0.0143 - acc: 0.9947 - val_loss: 0.1539 - val_acc: 0.9705
Epoch 14/20
 - 1s - loss: 0.0148 - acc: 0.9953 - val_loss: 0.1723 - val_acc: 0.9694
Epoch 15/20
 - 1s - loss: 0.0113 - acc: 0.9967 - val_loss: 0.1768 - val_acc: 0.9694
Epoch 16/20
 - 1s - loss: 0.0138 - acc: 0.9956 - val_loss: 0.2089 - val_acc: 0.9644
Epoch 17/20
 - 1s - loss: 0.0130 - acc: 0.9960 - val_loss: 0.1684 - val_acc: 0.9711
Epoch 18/20
 - 1s - loss: 0.0086 - acc: 0.9971 - val_loss: 0.1668 - val_acc: 0.9718
Epoch 19/20
 - 1s - loss: 0.0093 - acc: 0.9968 - val_loss: 0.1722 - val_acc: 0.9718
Epoch 20/20
 - 1s - loss: 0.0091 - acc: 0.9975 - val_loss: 0.1773 - val_acc: 0.9717
Test loss: 0.17728944050567452
Test accuracy: 0.9717
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6050 - acc: 0.4835 - val_loss: 1.0746 - val_acc: 0.5956
Epoch 2/20
 - 1s - loss: 0.8323 - acc: 0.7281 - val_loss: 0.9297 - val_acc: 0.6736
Epoch 3/20
 - 1s - loss: 0.6735 - acc: 0.7854 - val_loss: 0.8076 - val_acc: 0.7525
Epoch 4/20
 - 1s - loss: 0.5592 - acc: 0.8202 - val_loss: 1.2820 - val_acc: 0.6258
Epoch 5/20
 - 1s - loss: 0.4956 - acc: 0.8399 - val_loss: 0.7525 - val_acc: 0.7510
Epoch 6/20
 - 1s - loss: 0.4307 - acc: 0.8665 - val_loss: 0.5910 - val_acc: 0.8011
Epoch 7/20
 - 1s - loss: 0.3855 - acc: 0.8777 - val_loss: 0.3181 - val_acc: 0.8992
Epoch 8/20
 - 1s - loss: 0.3549 - acc: 0.8855 - val_loss: 0.4368 - val_acc: 0.8451
Epoch 9/20
 - 1s - loss: 0.3273 - acc: 0.8966 - val_loss: 0.2592 - val_acc: 0.9167
Epoch 10/20
 - 1s - loss: 0.2970 - acc: 0.9079 - val_loss: 0.3754 - val_acc: 0.8804
Epoch 11/20
 - 1s - loss: 0.2816 - acc: 0.9116 - val_loss: 0.4149 - val_acc: 0.8684
Epoch 12/20
 - 1s - loss: 0.2717 - acc: 0.9151 - val_loss: 0.3146 - val_acc: 0.9009
Epoch 13/20
 - 1s - loss: 0.2415 - acc: 0.9237 - val_loss: 0.2760 - val_acc: 0.9166
Epoch 14/20
 - 1s - loss: 0.2363 - acc: 0.9250 - val_loss: 0.3979 - val_acc: 0.8883
Epoch 15/20
 - 1s - loss: 0.2267 - acc: 0.9257 - val_loss: 0.2122 - val_acc: 0.9344
Epoch 16/20
 - 1s - loss: 0.2046 - acc: 0.9343 - val_loss: 0.2927 - val_acc: 0.9148
Epoch 17/20
 - 1s - loss: 0.2104 - acc: 0.9339 - val_loss: 0.2548 - val_acc: 0.9229
Epoch 18/20
 - 1s - loss: 0.2001 - acc: 0.9379 - val_loss: 0.2021 - val_acc: 0.9386
Epoch 19/20
 - 1s - loss: 0.1853 - acc: 0.9417 - val_loss: 0.1695 - val_acc: 0.9485
Epoch 20/20
 - 1s - loss: 0.1792 - acc: 0.9429 - val_loss: 0.1646 - val_acc: 0.9491
Test loss: 0.16337988682035356
Test accuracy: 0.9504
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.6063 - acc: 0.8132 - val_loss: 0.3161 - val_acc: 0.9072
Epoch 2/20
 - 0s - loss: 0.2551 - acc: 0.9236 - val_loss: 0.2638 - val_acc: 0.9178
Epoch 3/20
 - 0s - loss: 0.1726 - acc: 0.9468 - val_loss: 0.2209 - val_acc: 0.9310
Epoch 4/20
 - 0s - loss: 0.1213 - acc: 0.9629 - val_loss: 0.1797 - val_acc: 0.9461
Epoch 5/20
 - 0s - loss: 0.0804 - acc: 0.9765 - val_loss: 0.1687 - val_acc: 0.9512
Epoch 6/20
 - 0s - loss: 0.0679 - acc: 0.9779 - val_loss: 0.1806 - val_acc: 0.9499
Epoch 7/20
 - 0s - loss: 0.0460 - acc: 0.9855 - val_loss: 0.2252 - val_acc: 0.9397
Epoch 8/20
 - 0s - loss: 0.0346 - acc: 0.9879 - val_loss: 0.1723 - val_acc: 0.9549
Epoch 9/20
 - 0s - loss: 0.0294 - acc: 0.9895 - val_loss: 0.2120 - val_acc: 0.9475
Epoch 10/20
 - 0s - loss: 0.0248 - acc: 0.9917 - val_loss: 0.2026 - val_acc: 0.9534
Epoch 11/20
 - 0s - loss: 0.0183 - acc: 0.9939 - val_loss: 0.3249 - val_acc: 0.9290
Epoch 12/20
 - 0s - loss: 0.0138 - acc: 0.9952 - val_loss: 0.2577 - val_acc: 0.9450
Epoch 13/20
 - 0s - loss: 0.0169 - acc: 0.9936 - val_loss: 0.2134 - val_acc: 0.9555
Epoch 14/20
 - 0s - loss: 0.0120 - acc: 0.9963 - val_loss: 0.2350 - val_acc: 0.9536
Epoch 15/20
 - 0s - loss: 0.0120 - acc: 0.9961 - val_loss: 0.2618 - val_acc: 0.9496
Epoch 16/20
 - 0s - loss: 0.0103 - acc: 0.9969 - val_loss: 0.2266 - val_acc: 0.9557
Epoch 17/20
 - 0s - loss: 0.0086 - acc: 0.9980 - val_loss: 0.2621 - val_acc: 0.9505
Epoch 18/20
 - 0s - loss: 0.0082 - acc: 0.9976 - val_loss: 0.2551 - val_acc: 0.9548
Epoch 19/20
 - 0s - loss: 0.0058 - acc: 0.9979 - val_loss: 0.2502 - val_acc: 0.9578
Epoch 20/20
 - 0s - loss: 0.0045 - acc: 0.9985 - val_loss: 0.2699 - val_acc: 0.9557
Test loss: 0.2699221296037966
Test accuracy: 0.9557
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0366 - acc: 0.3563 - val_loss: 1.1863 - val_acc: 0.5655
Epoch 2/20
 - 1s - loss: 1.1522 - acc: 0.6175 - val_loss: 0.9050 - val_acc: 0.6755
Epoch 3/20
 - 1s - loss: 0.8727 - acc: 0.7111 - val_loss: 0.8661 - val_acc: 0.6923
Epoch 4/20
 - 1s - loss: 0.7269 - acc: 0.7629 - val_loss: 0.7740 - val_acc: 0.7483
Epoch 5/20
 - 1s - loss: 0.6666 - acc: 0.7847 - val_loss: 0.7507 - val_acc: 0.7349
Epoch 6/20
 - 1s - loss: 0.6019 - acc: 0.8132 - val_loss: 0.5941 - val_acc: 0.8031
Epoch 7/20
 - 1s - loss: 0.5253 - acc: 0.8289 - val_loss: 0.5278 - val_acc: 0.8155
Epoch 8/20
 - 1s - loss: 0.4887 - acc: 0.8448 - val_loss: 0.3352 - val_acc: 0.9003
Epoch 9/20
 - 1s - loss: 0.4801 - acc: 0.8461 - val_loss: 0.5027 - val_acc: 0.8440
Epoch 10/20
 - 1s - loss: 0.4196 - acc: 0.8663 - val_loss: 0.3754 - val_acc: 0.8766
Epoch 11/20
 - 1s - loss: 0.4126 - acc: 0.8664 - val_loss: 0.3701 - val_acc: 0.8766
Epoch 12/20
 - 1s - loss: 0.3790 - acc: 0.8776 - val_loss: 0.4890 - val_acc: 0.8458
Epoch 13/20
 - 1s - loss: 0.3745 - acc: 0.8780 - val_loss: 0.2829 - val_acc: 0.9092
Epoch 14/20
 - 1s - loss: 0.3372 - acc: 0.8968 - val_loss: 0.2423 - val_acc: 0.9227
Epoch 15/20
 - 1s - loss: 0.3321 - acc: 0.8993 - val_loss: 0.3897 - val_acc: 0.8725
Epoch 16/20
 - 1s - loss: 0.3122 - acc: 0.8984 - val_loss: 0.7196 - val_acc: 0.8107
Epoch 17/20
 - 1s - loss: 0.3035 - acc: 0.9057 - val_loss: 0.5437 - val_acc: 0.8121
Epoch 18/20
 - 1s - loss: 0.2900 - acc: 0.9040 - val_loss: 0.5201 - val_acc: 0.8402
Epoch 19/20
 - 1s - loss: 0.2765 - acc: 0.9113 - val_loss: 0.3120 - val_acc: 0.9012
Epoch 20/20
 - 1s - loss: 0.2954 - acc: 0.9125 - val_loss: 0.3101 - val_acc: 0.9026
Test loss: 0.3108043070733547
Test accuracy: 0.905
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8286 - acc: 0.7347 - val_loss: 0.6601 - val_acc: 0.7921
Epoch 2/20
 - 0s - loss: 0.3452 - acc: 0.8997 - val_loss: 0.5279 - val_acc: 0.8272
Epoch 3/20
 - 0s - loss: 0.2236 - acc: 0.9320 - val_loss: 0.3588 - val_acc: 0.8926
Epoch 4/20
 - 0s - loss: 0.1701 - acc: 0.9493 - val_loss: 0.2858 - val_acc: 0.9129
Epoch 5/20
 - 0s - loss: 0.1258 - acc: 0.9629 - val_loss: 0.2719 - val_acc: 0.9192
Epoch 6/20
 - 0s - loss: 0.0961 - acc: 0.9683 - val_loss: 0.2156 - val_acc: 0.9372
Epoch 7/20
 - 0s - loss: 0.0613 - acc: 0.9816 - val_loss: 0.2561 - val_acc: 0.9279
Epoch 8/20
 - 0s - loss: 0.0533 - acc: 0.9840 - val_loss: 0.2433 - val_acc: 0.9308
Epoch 9/20
 - 0s - loss: 0.0420 - acc: 0.9864 - val_loss: 0.2582 - val_acc: 0.9296
Epoch 10/20
 - 0s - loss: 0.0384 - acc: 0.9872 - val_loss: 0.2703 - val_acc: 0.9280
Epoch 11/20
 - 0s - loss: 0.0223 - acc: 0.9939 - val_loss: 0.3688 - val_acc: 0.9067
Epoch 12/20
 - 0s - loss: 0.0283 - acc: 0.9925 - val_loss: 0.2903 - val_acc: 0.9268
Epoch 13/20
 - 0s - loss: 0.0123 - acc: 0.9973 - val_loss: 0.3900 - val_acc: 0.9115
Epoch 14/20
 - 0s - loss: 0.0170 - acc: 0.9949 - val_loss: 0.2551 - val_acc: 0.9425
Epoch 15/20
 - 0s - loss: 0.0154 - acc: 0.9957 - val_loss: 0.2830 - val_acc: 0.9386
Epoch 16/20
 - 0s - loss: 0.0149 - acc: 0.9960 - val_loss: 0.2808 - val_acc: 0.9387
Epoch 17/20
 - 0s - loss: 0.0087 - acc: 0.9973 - val_loss: 0.2778 - val_acc: 0.9423
Epoch 18/20
 - 0s - loss: 0.0089 - acc: 0.9971 - val_loss: 0.3301 - val_acc: 0.9318
Epoch 19/20
 - 0s - loss: 0.0152 - acc: 0.9957 - val_loss: 0.3793 - val_acc: 0.9253
Epoch 20/20
 - 0s - loss: 0.0052 - acc: 0.9989 - val_loss: 0.2853 - val_acc: 0.9414
Test loss: 0.28531463624625175
Test accuracy: 0.9414
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7451 - acc: 0.2477 - val_loss: 1.8006 - val_acc: 0.3860
Epoch 2/20
 - 1s - loss: 1.6287 - acc: 0.4459 - val_loss: 1.3974 - val_acc: 0.5486
Epoch 3/20
 - 1s - loss: 1.2346 - acc: 0.5875 - val_loss: 1.1771 - val_acc: 0.6098
Epoch 4/20
 - 1s - loss: 1.0323 - acc: 0.6597 - val_loss: 1.6013 - val_acc: 0.5095
Epoch 5/20
 - 1s - loss: 0.9475 - acc: 0.6912 - val_loss: 0.7521 - val_acc: 0.7581
Epoch 6/20
 - 1s - loss: 0.8287 - acc: 0.7211 - val_loss: 1.0395 - val_acc: 0.6651
Epoch 7/20
 - 1s - loss: 0.8276 - acc: 0.7304 - val_loss: 0.5664 - val_acc: 0.8083
Epoch 8/20
 - 1s - loss: 0.6976 - acc: 0.7787 - val_loss: 0.8112 - val_acc: 0.7294
Epoch 9/20
 - 1s - loss: 0.6839 - acc: 0.7720 - val_loss: 0.7665 - val_acc: 0.7552
Epoch 10/20
 - 1s - loss: 0.6242 - acc: 0.8005 - val_loss: 1.7063 - val_acc: 0.5371
Epoch 11/20
 - 1s - loss: 0.6128 - acc: 0.8056 - val_loss: 1.0739 - val_acc: 0.6717
Epoch 12/20
 - 1s - loss: 0.5786 - acc: 0.8136 - val_loss: 0.4296 - val_acc: 0.8579
Epoch 13/20
 - 1s - loss: 0.5424 - acc: 0.8309 - val_loss: 0.9381 - val_acc: 0.6950
Epoch 14/20
 - 1s - loss: 0.5703 - acc: 0.8267 - val_loss: 0.5209 - val_acc: 0.8262
Epoch 15/20
 - 1s - loss: 0.4604 - acc: 0.8485 - val_loss: 1.3986 - val_acc: 0.5681
Epoch 16/20
 - 1s - loss: 0.4423 - acc: 0.8595 - val_loss: 0.4819 - val_acc: 0.8417
Epoch 17/20
 - 1s - loss: 0.4721 - acc: 0.8419 - val_loss: 0.6108 - val_acc: 0.8217
Epoch 18/20
 - 1s - loss: 0.3911 - acc: 0.8693 - val_loss: 0.6084 - val_acc: 0.8108
Epoch 19/20
 - 1s - loss: 0.4345 - acc: 0.8669 - val_loss: 0.3923 - val_acc: 0.8747
Epoch 20/20
 - 1s - loss: 0.4212 - acc: 0.8701 - val_loss: 0.4158 - val_acc: 0.8686
Test loss: 0.41620832628011706
Test accuracy: 0.8687
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1595 - acc: 0.6272 - val_loss: 0.5014 - val_acc: 0.8621
Epoch 2/20
 - 0s - loss: 0.4802 - acc: 0.8587 - val_loss: 0.4171 - val_acc: 0.8690
Epoch 3/20
 - 0s - loss: 0.3195 - acc: 0.8992 - val_loss: 0.5768 - val_acc: 0.8193
Epoch 4/20
 - 0s - loss: 0.2551 - acc: 0.9227 - val_loss: 0.3162 - val_acc: 0.9050
Epoch 5/20
 - 0s - loss: 0.2000 - acc: 0.9461 - val_loss: 0.3648 - val_acc: 0.8858
Epoch 6/20
 - 0s - loss: 0.1543 - acc: 0.9531 - val_loss: 0.3955 - val_acc: 0.8843
Epoch 7/20
 - 0s - loss: 0.1104 - acc: 0.9659 - val_loss: 0.3404 - val_acc: 0.8991
Epoch 8/20
 - 0s - loss: 0.0912 - acc: 0.9696 - val_loss: 0.3716 - val_acc: 0.8965
Epoch 9/20
 - 0s - loss: 0.0586 - acc: 0.9867 - val_loss: 0.3167 - val_acc: 0.9124
Epoch 10/20
 - 0s - loss: 0.0678 - acc: 0.9781 - val_loss: 0.2884 - val_acc: 0.9203
Epoch 11/20
 - 0s - loss: 0.0222 - acc: 0.9963 - val_loss: 0.3342 - val_acc: 0.9118
Epoch 12/20
 - 0s - loss: 0.0701 - acc: 0.9776 - val_loss: 0.5869 - val_acc: 0.8487
Epoch 13/20
 - 0s - loss: 0.0225 - acc: 0.9963 - val_loss: 0.2980 - val_acc: 0.9198
Epoch 14/20
 - 0s - loss: 0.0144 - acc: 0.9952 - val_loss: 0.5085 - val_acc: 0.8830
Epoch 15/20
 - 0s - loss: 0.0289 - acc: 0.9909 - val_loss: 0.3123 - val_acc: 0.9233
Epoch 16/20
 - 0s - loss: 0.0124 - acc: 0.9963 - val_loss: 0.3369 - val_acc: 0.9214
Epoch 17/20
 - 0s - loss: 0.0100 - acc: 0.9968 - val_loss: 0.4047 - val_acc: 0.9087
Epoch 18/20
 - 0s - loss: 0.0101 - acc: 0.9968 - val_loss: 0.3705 - val_acc: 0.9181
Epoch 19/20
 - 0s - loss: 0.0081 - acc: 0.9989 - val_loss: 0.3535 - val_acc: 0.9216
Epoch 20/20
 - 0s - loss: 0.0352 - acc: 0.9920 - val_loss: 0.4703 - val_acc: 0.8998
Test loss: 0.47032497447256466
Test accuracy: 0.8998
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.4795 - acc: 0.1819 - val_loss: 1.9906 - val_acc: 0.3699
Epoch 2/20
 - 1s - loss: 2.0009 - acc: 0.2960 - val_loss: 1.6809 - val_acc: 0.4830
Epoch 3/20
 - 1s - loss: 1.7760 - acc: 0.4048 - val_loss: 1.4087 - val_acc: 0.6550
Epoch 4/20
 - 1s - loss: 1.4026 - acc: 0.5477 - val_loss: 1.2959 - val_acc: 0.6585
Epoch 5/20
 - 1s - loss: 1.3450 - acc: 0.5435 - val_loss: 0.9909 - val_acc: 0.6434
Epoch 6/20
 - 1s - loss: 1.2394 - acc: 0.6000 - val_loss: 0.9540 - val_acc: 0.6916
Epoch 7/20
 - 1s - loss: 1.0477 - acc: 0.6645 - val_loss: 0.7926 - val_acc: 0.7381
Epoch 8/20
 - 1s - loss: 1.0399 - acc: 0.6480 - val_loss: 0.7912 - val_acc: 0.7397
Epoch 9/20
 - 1s - loss: 0.9090 - acc: 0.7051 - val_loss: 0.9516 - val_acc: 0.6632
Epoch 10/20
 - 1s - loss: 0.9504 - acc: 0.6928 - val_loss: 0.8492 - val_acc: 0.7326
Epoch 11/20
 - 1s - loss: 0.8162 - acc: 0.7387 - val_loss: 0.7315 - val_acc: 0.7581
Epoch 12/20
 - 1s - loss: 0.8147 - acc: 0.7296 - val_loss: 1.1956 - val_acc: 0.6512
Epoch 13/20
 - 1s - loss: 0.8067 - acc: 0.7397 - val_loss: 0.8186 - val_acc: 0.7238
Epoch 14/20
 - 1s - loss: 0.6955 - acc: 0.7680 - val_loss: 0.8467 - val_acc: 0.7116
Epoch 15/20
 - 1s - loss: 0.6528 - acc: 0.7888 - val_loss: 0.6168 - val_acc: 0.8152
Epoch 16/20
 - 1s - loss: 0.7049 - acc: 0.7755 - val_loss: 0.9450 - val_acc: 0.6910
Epoch 17/20
 - 1s - loss: 0.6407 - acc: 0.7968 - val_loss: 0.6940 - val_acc: 0.7762
Epoch 18/20
 - 1s - loss: 0.6305 - acc: 0.7989 - val_loss: 0.5947 - val_acc: 0.8073
Epoch 19/20
 - 1s - loss: 0.5796 - acc: 0.8283 - val_loss: 0.6647 - val_acc: 0.7812
Epoch 20/20
 - 1s - loss: 0.6104 - acc: 0.8027 - val_loss: 0.5326 - val_acc: 0.8253
Test loss: 0.5314952614188194
Test accuracy: 0.8244
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5687 - acc: 0.4931 - val_loss: 0.8873 - val_acc: 0.7446
Epoch 2/20
 - 0s - loss: 0.6175 - acc: 0.8260 - val_loss: 0.5577 - val_acc: 0.8345
Epoch 3/20
 - 0s - loss: 0.3784 - acc: 0.8922 - val_loss: 0.7441 - val_acc: 0.7708
Epoch 4/20
 - 0s - loss: 0.3439 - acc: 0.8879 - val_loss: 0.4784 - val_acc: 0.8533
Epoch 5/20
 - 0s - loss: 0.2396 - acc: 0.9360 - val_loss: 0.4264 - val_acc: 0.8688
Epoch 6/20
 - 0s - loss: 0.1805 - acc: 0.9466 - val_loss: 0.5424 - val_acc: 0.8285
Epoch 7/20
 - 0s - loss: 0.1610 - acc: 0.9562 - val_loss: 0.4561 - val_acc: 0.8597
Epoch 8/20
 - 0s - loss: 0.1101 - acc: 0.9744 - val_loss: 0.4213 - val_acc: 0.8732
Epoch 9/20
 - 0s - loss: 0.1146 - acc: 0.9669 - val_loss: 0.4949 - val_acc: 0.8504
Epoch 10/20
 - 0s - loss: 0.0733 - acc: 0.9829 - val_loss: 0.4339 - val_acc: 0.8771
Epoch 11/20
 - 0s - loss: 0.0529 - acc: 0.9883 - val_loss: 0.5760 - val_acc: 0.8464
Epoch 12/20
 - 0s - loss: 0.0400 - acc: 0.9968 - val_loss: 0.5812 - val_acc: 0.8359
Epoch 13/20
 - 0s - loss: 0.0861 - acc: 0.9733 - val_loss: 0.4148 - val_acc: 0.8847
Epoch 14/20
 - 0s - loss: 0.0148 - acc: 1.0000 - val_loss: 0.4300 - val_acc: 0.8887
Epoch 15/20
 - 0s - loss: 0.0113 - acc: 1.0000 - val_loss: 0.6425 - val_acc: 0.8406
Epoch 16/20
 - 0s - loss: 0.0428 - acc: 0.9915 - val_loss: 0.4079 - val_acc: 0.8974
Epoch 17/20
 - 0s - loss: 0.0065 - acc: 1.0000 - val_loss: 0.4170 - val_acc: 0.8981
Epoch 18/20
 - 0s - loss: 0.0070 - acc: 1.0000 - val_loss: 0.4726 - val_acc: 0.8897
Epoch 19/20
 - 0s - loss: 0.0104 - acc: 0.9989 - val_loss: 0.5955 - val_acc: 0.8662
Epoch 20/20
 - 0s - loss: 0.0686 - acc: 0.9797 - val_loss: 0.4060 - val_acc: 0.9012
Test loss: 0.4060293495086022
Test accuracy: 0.9012
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.4134 - acc: 0.1217 - val_loss: 2.2915 - val_acc: 0.1795
Epoch 2/20
 - 0s - loss: 2.1264 - acc: 0.2476 - val_loss: 2.0912 - val_acc: 0.1279
Epoch 3/20
 - 0s - loss: 1.9865 - acc: 0.3394 - val_loss: 1.9373 - val_acc: 0.2990
Epoch 4/20
 - 0s - loss: 1.9143 - acc: 0.3469 - val_loss: 1.7582 - val_acc: 0.2765
Epoch 5/20
 - 0s - loss: 1.7183 - acc: 0.4248 - val_loss: 1.9881 - val_acc: 0.1965
Epoch 6/20
 - 0s - loss: 1.6536 - acc: 0.4216 - val_loss: 1.4050 - val_acc: 0.5154
Epoch 7/20
 - 0s - loss: 1.5215 - acc: 0.4835 - val_loss: 1.3428 - val_acc: 0.5472
Epoch 8/20
 - 1s - loss: 1.3254 - acc: 0.5560 - val_loss: 1.0339 - val_acc: 0.6943
Epoch 9/20
 - 0s - loss: 1.2903 - acc: 0.5977 - val_loss: 1.1937 - val_acc: 0.5282
Epoch 10/20
 - 0s - loss: 1.1732 - acc: 0.6275 - val_loss: 1.0578 - val_acc: 0.6257
Epoch 11/20
 - 0s - loss: 1.0018 - acc: 0.6628 - val_loss: 1.0821 - val_acc: 0.6364
Epoch 12/20
 - 0s - loss: 1.0924 - acc: 0.6393 - val_loss: 0.9903 - val_acc: 0.6614
Epoch 13/20
 - 0s - loss: 1.0016 - acc: 0.6788 - val_loss: 0.7367 - val_acc: 0.7677
Epoch 14/20
 - 0s - loss: 0.9705 - acc: 0.6798 - val_loss: 0.9827 - val_acc: 0.6639
Epoch 15/20
 - 1s - loss: 0.9732 - acc: 0.6724 - val_loss: 1.0082 - val_acc: 0.6303
Epoch 16/20
 - 0s - loss: 0.8520 - acc: 0.7332 - val_loss: 1.7577 - val_acc: 0.4643
Epoch 17/20
 - 0s - loss: 0.9451 - acc: 0.7118 - val_loss: 1.3712 - val_acc: 0.5154
Epoch 18/20
 - 0s - loss: 0.8495 - acc: 0.7086 - val_loss: 1.0196 - val_acc: 0.6812
Epoch 19/20
 - 0s - loss: 0.7305 - acc: 0.7417 - val_loss: 1.0276 - val_acc: 0.6575
Epoch 20/20
 - 0s - loss: 0.7885 - acc: 0.7332 - val_loss: 0.8291 - val_acc: 0.7137
Test loss: 0.8296747497081757
Test accuracy: 0.7125
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8669 - acc: 0.3291 - val_loss: 1.1871 - val_acc: 0.6166
Epoch 2/20
 - 0s - loss: 0.7527 - acc: 0.8184 - val_loss: 0.9276 - val_acc: 0.7025
Epoch 3/20
 - 0s - loss: 0.5630 - acc: 0.8504 - val_loss: 0.7687 - val_acc: 0.7419
Epoch 4/20
 - 0s - loss: 0.3379 - acc: 0.9038 - val_loss: 0.7053 - val_acc: 0.7681
Epoch 5/20
 - 0s - loss: 0.2361 - acc: 0.9466 - val_loss: 0.7669 - val_acc: 0.7540
Epoch 6/20
 - 0s - loss: 0.2353 - acc: 0.9380 - val_loss: 0.5085 - val_acc: 0.8399
Epoch 7/20
 - 0s - loss: 0.1304 - acc: 0.9786 - val_loss: 0.5740 - val_acc: 0.8194
Epoch 8/20
 - 0s - loss: 0.1061 - acc: 0.9808 - val_loss: 0.5309 - val_acc: 0.8303
Epoch 9/20
 - 0s - loss: 0.1121 - acc: 0.9744 - val_loss: 0.9958 - val_acc: 0.6990
Epoch 10/20
 - 0s - loss: 0.1772 - acc: 0.9444 - val_loss: 0.5336 - val_acc: 0.8400
Epoch 11/20
 - 0s - loss: 0.0373 - acc: 1.0000 - val_loss: 0.5615 - val_acc: 0.8330
Epoch 12/20
 - 0s - loss: 0.0295 - acc: 0.9979 - val_loss: 0.5253 - val_acc: 0.8496
Epoch 13/20
 - 0s - loss: 0.0221 - acc: 1.0000 - val_loss: 0.5413 - val_acc: 0.8482
Epoch 14/20
 - 0s - loss: 0.0217 - acc: 0.9979 - val_loss: 0.6202 - val_acc: 0.8290
Epoch 15/20
 - 0s - loss: 0.0184 - acc: 1.0000 - val_loss: 0.5818 - val_acc: 0.8407
Epoch 16/20
 - 0s - loss: 0.0221 - acc: 0.9957 - val_loss: 0.8489 - val_acc: 0.7913
Epoch 17/20
 - 0s - loss: 0.1039 - acc: 0.9701 - val_loss: 0.5503 - val_acc: 0.8500
Epoch 18/20
 - 0s - loss: 0.0087 - acc: 1.0000 - val_loss: 0.5909 - val_acc: 0.8474
Epoch 19/20
 - 0s - loss: 0.0071 - acc: 1.0000 - val_loss: 0.5959 - val_acc: 0.8504
Epoch 20/20
 - 0s - loss: 0.0057 - acc: 1.0000 - val_loss: 0.5995 - val_acc: 0.8479
Test loss: 0.5994909114971757
Test accuracy: 0.8479
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.2087 - acc: 0.1197 - val_loss: 4.7276 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 3.3106 - acc: 0.1474 - val_loss: 2.1663 - val_acc: 0.2816
Epoch 3/20
 - 0s - loss: 2.1446 - acc: 0.2457 - val_loss: 2.0594 - val_acc: 0.2247
Epoch 4/20
 - 0s - loss: 2.0123 - acc: 0.3141 - val_loss: 2.2083 - val_acc: 0.2483
Epoch 5/20
 - 0s - loss: 2.0585 - acc: 0.2863 - val_loss: 2.0044 - val_acc: 0.2361
Epoch 6/20
 - 0s - loss: 1.8329 - acc: 0.3846 - val_loss: 1.8464 - val_acc: 0.3838
Epoch 7/20
 - 0s - loss: 1.8340 - acc: 0.4103 - val_loss: 1.6141 - val_acc: 0.4870
Epoch 8/20
 - 0s - loss: 1.5991 - acc: 0.5000 - val_loss: 2.1361 - val_acc: 0.3192
Epoch 9/20
 - 0s - loss: 1.7898 - acc: 0.4444 - val_loss: 1.9013 - val_acc: 0.3990
Epoch 10/20
 - 0s - loss: 1.5611 - acc: 0.4786 - val_loss: 1.6616 - val_acc: 0.4447
Epoch 11/20
 - 0s - loss: 1.4813 - acc: 0.5299 - val_loss: 2.3158 - val_acc: 0.2721
Epoch 12/20
 - 0s - loss: 1.4807 - acc: 0.5235 - val_loss: 1.2597 - val_acc: 0.5836
Epoch 13/20
 - 0s - loss: 1.2728 - acc: 0.6154 - val_loss: 1.3393 - val_acc: 0.5251
Epoch 14/20
 - 0s - loss: 1.0599 - acc: 0.6752 - val_loss: 1.1392 - val_acc: 0.6259
Epoch 15/20
 - 0s - loss: 0.9833 - acc: 0.6859 - val_loss: 1.3339 - val_acc: 0.5618
Epoch 16/20
 - 0s - loss: 1.0588 - acc: 0.6709 - val_loss: 1.6912 - val_acc: 0.4738
Epoch 17/20
 - 0s - loss: 1.2219 - acc: 0.5962 - val_loss: 1.1904 - val_acc: 0.6197
Epoch 18/20
 - 0s - loss: 0.9846 - acc: 0.6709 - val_loss: 1.4911 - val_acc: 0.4389
Epoch 19/20
 - 0s - loss: 1.2543 - acc: 0.5748 - val_loss: 1.4280 - val_acc: 0.5682
Epoch 20/20
 - 0s - loss: 0.8654 - acc: 0.7265 - val_loss: 0.9207 - val_acc: 0.6853
Test loss: 0.920388585281372
Test accuracy: 0.689
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1778 - acc: 0.2436 - val_loss: 1.7297 - val_acc: 0.4176
Epoch 2/20
 - 0s - loss: 1.2258 - acc: 0.6923 - val_loss: 1.3394 - val_acc: 0.5953
Epoch 3/20
 - 0s - loss: 0.9835 - acc: 0.7179 - val_loss: 1.2340 - val_acc: 0.6281
Epoch 4/20
 - 0s - loss: 0.6044 - acc: 0.8376 - val_loss: 1.1337 - val_acc: 0.6110
Epoch 5/20
 - 0s - loss: 0.4530 - acc: 0.8718 - val_loss: 0.8190 - val_acc: 0.7410
Epoch 6/20
 - 0s - loss: 0.2528 - acc: 0.9573 - val_loss: 0.8095 - val_acc: 0.7397
Epoch 7/20
 - 0s - loss: 0.1905 - acc: 0.9701 - val_loss: 0.7418 - val_acc: 0.7610
Epoch 8/20
 - 0s - loss: 0.1518 - acc: 0.9701 - val_loss: 0.7724 - val_acc: 0.7445
Epoch 9/20
 - 0s - loss: 0.1105 - acc: 0.9872 - val_loss: 0.7643 - val_acc: 0.7616
Epoch 10/20
 - 0s - loss: 0.0897 - acc: 0.9957 - val_loss: 0.8051 - val_acc: 0.7605
Epoch 11/20
 - 0s - loss: 0.0653 - acc: 0.9957 - val_loss: 0.7204 - val_acc: 0.7748
Epoch 12/20
 - 0s - loss: 0.0531 - acc: 0.9957 - val_loss: 0.8283 - val_acc: 0.7618
Epoch 13/20
 - 0s - loss: 0.0444 - acc: 1.0000 - val_loss: 0.7386 - val_acc: 0.7825
Epoch 14/20
 - 0s - loss: 0.0264 - acc: 1.0000 - val_loss: 0.7447 - val_acc: 0.7835
Epoch 15/20
 - 0s - loss: 0.0217 - acc: 1.0000 - val_loss: 0.7684 - val_acc: 0.7819
Epoch 16/20
 - 0s - loss: 0.0375 - acc: 1.0000 - val_loss: 0.9580 - val_acc: 0.7552
Epoch 17/20
 - 0s - loss: 0.1179 - acc: 0.9615 - val_loss: 1.2623 - val_acc: 0.7189
Epoch 18/20
 - 0s - loss: 0.1481 - acc: 0.9487 - val_loss: 0.7455 - val_acc: 0.7911
Epoch 19/20
 - 0s - loss: 0.0208 - acc: 1.0000 - val_loss: 0.7758 - val_acc: 0.7877
Epoch 20/20
 - 0s - loss: 0.0125 - acc: 1.0000 - val_loss: 0.7768 - val_acc: 0.7883
Test loss: 0.7768196430921555
Test accuracy: 0.7883
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.5930 - acc: 0.0983 - val_loss: 6.2469 - val_acc: 0.1032
Epoch 2/20
 - 0s - loss: 5.5262 - acc: 0.1453 - val_loss: 3.1393 - val_acc: 0.1708
Epoch 3/20
 - 0s - loss: 3.0981 - acc: 0.1667 - val_loss: 2.2642 - val_acc: 0.1262
Epoch 4/20
 - 0s - loss: 2.2464 - acc: 0.1667 - val_loss: 2.1299 - val_acc: 0.1990
Epoch 5/20
 - 0s - loss: 2.0716 - acc: 0.2650 - val_loss: 2.1607 - val_acc: 0.2193
Epoch 6/20
 - 0s - loss: 2.1756 - acc: 0.2308 - val_loss: 2.0901 - val_acc: 0.2750
Epoch 7/20
 - 0s - loss: 2.0226 - acc: 0.3120 - val_loss: 1.9649 - val_acc: 0.3872
Epoch 8/20
 - 0s - loss: 1.8660 - acc: 0.3761 - val_loss: 2.1409 - val_acc: 0.1571
Epoch 9/20
 - 0s - loss: 1.9546 - acc: 0.3291 - val_loss: 1.9269 - val_acc: 0.3605
Epoch 10/20
 - 0s - loss: 1.8031 - acc: 0.4017 - val_loss: 1.8970 - val_acc: 0.3421
Epoch 11/20
 - 0s - loss: 1.7962 - acc: 0.3974 - val_loss: 1.9984 - val_acc: 0.3142
Epoch 12/20
 - 0s - loss: 1.7243 - acc: 0.4231 - val_loss: 1.8846 - val_acc: 0.2981
Epoch 13/20
 - 0s - loss: 1.8191 - acc: 0.3761 - val_loss: 1.7871 - val_acc: 0.3488
Epoch 14/20
 - 0s - loss: 1.5461 - acc: 0.4872 - val_loss: 1.8942 - val_acc: 0.2910
Epoch 15/20
 - 0s - loss: 1.9273 - acc: 0.3248 - val_loss: 1.8310 - val_acc: 0.4249
Epoch 16/20
 - 0s - loss: 1.4522 - acc: 0.5427 - val_loss: 1.6472 - val_acc: 0.4265
Epoch 17/20
 - 0s - loss: 1.4709 - acc: 0.5470 - val_loss: 1.6715 - val_acc: 0.4294
Epoch 18/20
 - 0s - loss: 1.3077 - acc: 0.5855 - val_loss: 1.7504 - val_acc: 0.4508
Epoch 19/20
 - 0s - loss: 1.8451 - acc: 0.3889 - val_loss: 2.0868 - val_acc: 0.3838
Epoch 20/20
 - 0s - loss: 1.7809 - acc: 0.4145 - val_loss: 1.6876 - val_acc: 0.3583
Test loss: 1.687511798095703
Test accuracy: 0.3586
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3314 - acc: 0.1282 - val_loss: 2.0091 - val_acc: 0.3784
Epoch 2/20
 - 0s - loss: 1.5854 - acc: 0.5897 - val_loss: 1.6750 - val_acc: 0.4657
Epoch 3/20
 - 0s - loss: 1.1782 - acc: 0.7009 - val_loss: 1.6454 - val_acc: 0.4510
Epoch 4/20
 - 0s - loss: 0.9110 - acc: 0.7521 - val_loss: 1.4473 - val_acc: 0.5252
Epoch 5/20
 - 0s - loss: 0.7283 - acc: 0.8205 - val_loss: 1.2287 - val_acc: 0.6209
Epoch 6/20
 - 0s - loss: 0.4740 - acc: 0.8974 - val_loss: 1.1564 - val_acc: 0.6137
Epoch 7/20
 - 0s - loss: 0.3223 - acc: 0.8974 - val_loss: 1.0584 - val_acc: 0.6733
Epoch 8/20
 - 0s - loss: 0.2356 - acc: 0.9487 - val_loss: 1.0204 - val_acc: 0.6574
Epoch 9/20
 - 0s - loss: 0.1652 - acc: 0.9829 - val_loss: 0.9782 - val_acc: 0.7022
Epoch 10/20
 - 0s - loss: 0.1130 - acc: 0.9915 - val_loss: 0.9353 - val_acc: 0.7000
Epoch 11/20
 - 0s - loss: 0.0831 - acc: 1.0000 - val_loss: 0.9289 - val_acc: 0.7214
Epoch 12/20
 - 0s - loss: 0.0649 - acc: 1.0000 - val_loss: 0.9020 - val_acc: 0.7177
Epoch 13/20
 - 0s - loss: 0.0508 - acc: 1.0000 - val_loss: 0.9212 - val_acc: 0.7285
Epoch 14/20
 - 0s - loss: 0.0413 - acc: 1.0000 - val_loss: 0.9332 - val_acc: 0.7194
Epoch 15/20
 - 0s - loss: 0.0374 - acc: 1.0000 - val_loss: 0.9338 - val_acc: 0.7247
Epoch 16/20
 - 0s - loss: 0.0257 - acc: 1.0000 - val_loss: 0.9432 - val_acc: 0.7235
Epoch 17/20
 - 0s - loss: 0.0266 - acc: 1.0000 - val_loss: 0.9275 - val_acc: 0.7284
Epoch 18/20
 - 0s - loss: 0.0210 - acc: 1.0000 - val_loss: 0.9425 - val_acc: 0.7277
Epoch 19/20
 - 0s - loss: 0.0197 - acc: 1.0000 - val_loss: 0.9285 - val_acc: 0.7313
Epoch 20/20
 - 0s - loss: 0.0183 - acc: 1.0000 - val_loss: 0.9270 - val_acc: 0.7356
Test loss: 0.9269938241243363
Test accuracy: 0.7356
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.8420 - acc: 0.0598 - val_loss: 7.2724 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 6.4607 - acc: 0.1538 - val_loss: 6.6525 - val_acc: 0.0980
Epoch 3/20
 - 0s - loss: 6.7451 - acc: 0.1538 - val_loss: 3.3913 - val_acc: 0.0958
Epoch 4/20
 - 0s - loss: 3.4389 - acc: 0.1368 - val_loss: 2.3858 - val_acc: 0.1220
Epoch 5/20
 - 0s - loss: 2.3532 - acc: 0.0855 - val_loss: 2.2644 - val_acc: 0.1602
Epoch 6/20
 - 0s - loss: 2.1662 - acc: 0.2308 - val_loss: 2.1980 - val_acc: 0.2704
Epoch 7/20
 - 0s - loss: 2.1423 - acc: 0.2821 - val_loss: 2.2199 - val_acc: 0.2485
Epoch 8/20
 - 0s - loss: 2.0849 - acc: 0.3077 - val_loss: 2.1558 - val_acc: 0.3219
Epoch 9/20
 - 0s - loss: 2.0526 - acc: 0.3162 - val_loss: 2.2023 - val_acc: 0.2358
Epoch 10/20
 - 0s - loss: 2.0103 - acc: 0.2991 - val_loss: 2.0875 - val_acc: 0.2068
Epoch 11/20
 - 0s - loss: 1.9466 - acc: 0.2564 - val_loss: 2.1104 - val_acc: 0.2839
Epoch 12/20
 - 0s - loss: 1.9541 - acc: 0.3419 - val_loss: 2.0314 - val_acc: 0.2851
Epoch 13/20
 - 0s - loss: 1.8280 - acc: 0.4359 - val_loss: 2.0602 - val_acc: 0.2934
Epoch 14/20
 - 0s - loss: 1.7802 - acc: 0.4359 - val_loss: 1.9851 - val_acc: 0.2416
Epoch 15/20
 - 0s - loss: 1.7143 - acc: 0.4274 - val_loss: 2.1220 - val_acc: 0.3145
Epoch 16/20
 - 0s - loss: 1.9171 - acc: 0.4103 - val_loss: 2.0627 - val_acc: 0.3346
Epoch 17/20
 - 0s - loss: 1.7866 - acc: 0.4444 - val_loss: 2.0368 - val_acc: 0.1572
Epoch 18/20
 - 0s - loss: 1.7569 - acc: 0.2821 - val_loss: 2.3486 - val_acc: 0.1421
Epoch 19/20
 - 0s - loss: 2.0638 - acc: 0.2222 - val_loss: 1.9901 - val_acc: 0.3976
Epoch 20/20
 - 0s - loss: 1.7823 - acc: 0.5641 - val_loss: 1.8843 - val_acc: 0.3288
Test loss: 1.8842490678787231
Test accuracy: 0.3282
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.2449 - acc: 0.9267 - val_loss: 0.1167 - val_acc: 0.9641
Epoch 2/20
 - 2s - loss: 0.1014 - acc: 0.9688 - val_loss: 0.0794 - val_acc: 0.9770
Epoch 3/20
 - 2s - loss: 0.0725 - acc: 0.9782 - val_loss: 0.0850 - val_acc: 0.9765
Epoch 4/20
 - 2s - loss: 0.0605 - acc: 0.9822 - val_loss: 0.0826 - val_acc: 0.9771
Epoch 5/20
 - 2s - loss: 0.0510 - acc: 0.9849 - val_loss: 0.0872 - val_acc: 0.9792
Epoch 6/20
 - 2s - loss: 0.0451 - acc: 0.9871 - val_loss: 0.0821 - val_acc: 0.9789
Epoch 7/20
 - 2s - loss: 0.0382 - acc: 0.9885 - val_loss: 0.0749 - val_acc: 0.9814
Epoch 8/20
 - 2s - loss: 0.0346 - acc: 0.9901 - val_loss: 0.0777 - val_acc: 0.9819
Epoch 9/20
 - 2s - loss: 0.0315 - acc: 0.9913 - val_loss: 0.0735 - val_acc: 0.9830
Epoch 10/20
 - 2s - loss: 0.0298 - acc: 0.9917 - val_loss: 0.0870 - val_acc: 0.9821
Epoch 11/20
 - 2s - loss: 0.0258 - acc: 0.9924 - val_loss: 0.0855 - val_acc: 0.9826
Epoch 12/20
 - 2s - loss: 0.0250 - acc: 0.9925 - val_loss: 0.0875 - val_acc: 0.9818
Epoch 13/20
 - 2s - loss: 0.0234 - acc: 0.9935 - val_loss: 0.0882 - val_acc: 0.9843
Epoch 14/20
 - 2s - loss: 0.0238 - acc: 0.9934 - val_loss: 0.0883 - val_acc: 0.9831
Epoch 15/20
 - 2s - loss: 0.0208 - acc: 0.9945 - val_loss: 0.1027 - val_acc: 0.9819
Epoch 16/20
 - 2s - loss: 0.0202 - acc: 0.9938 - val_loss: 0.1000 - val_acc: 0.9830
Epoch 17/20
 - 2s - loss: 0.0188 - acc: 0.9945 - val_loss: 0.0952 - val_acc: 0.9839
Epoch 18/20
 - 2s - loss: 0.0193 - acc: 0.9950 - val_loss: 0.0892 - val_acc: 0.9846
Epoch 19/20
 - 2s - loss: 0.0193 - acc: 0.9953 - val_loss: 0.0988 - val_acc: 0.9847
Epoch 20/20
 - 2s - loss: 0.0150 - acc: 0.9956 - val_loss: 0.1175 - val_acc: 0.9816
Test loss: 0.11753231650846649
Test accuracy: 0.9816
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9301 - acc: 0.7022 - val_loss: 0.3833 - val_acc: 0.8721
Epoch 2/20
 - 4s - loss: 0.4315 - acc: 0.8616 - val_loss: 0.3192 - val_acc: 0.8984
Epoch 3/20
 - 4s - loss: 0.3206 - acc: 0.8979 - val_loss: 0.2394 - val_acc: 0.9210
Epoch 4/20
 - 5s - loss: 0.2691 - acc: 0.9165 - val_loss: 0.2301 - val_acc: 0.9294
Epoch 5/20
 - 5s - loss: 0.2377 - acc: 0.9256 - val_loss: 0.2158 - val_acc: 0.9336
Epoch 6/20
 - 5s - loss: 0.2126 - acc: 0.9344 - val_loss: 0.2760 - val_acc: 0.9124
Epoch 7/20
 - 6s - loss: 0.2011 - acc: 0.9380 - val_loss: 0.1160 - val_acc: 0.9638
Epoch 8/20
 - 4s - loss: 0.1929 - acc: 0.9411 - val_loss: 0.2501 - val_acc: 0.9273
Epoch 9/20
 - 5s - loss: 0.1851 - acc: 0.9443 - val_loss: 0.1209 - val_acc: 0.9639
Epoch 10/20
 - 5s - loss: 0.1772 - acc: 0.9480 - val_loss: 0.1395 - val_acc: 0.9615
Epoch 11/20
 - 5s - loss: 0.1698 - acc: 0.9482 - val_loss: 0.1140 - val_acc: 0.9677
Epoch 12/20
 - 5s - loss: 0.1737 - acc: 0.9501 - val_loss: 0.1083 - val_acc: 0.9679
Epoch 13/20
 - 4s - loss: 0.1675 - acc: 0.9516 - val_loss: 0.1074 - val_acc: 0.9688
Epoch 14/20
 - 5s - loss: 0.1669 - acc: 0.9524 - val_loss: 0.1145 - val_acc: 0.9668
Epoch 15/20
 - 5s - loss: 0.1625 - acc: 0.9531 - val_loss: 0.1242 - val_acc: 0.9649
Epoch 16/20
 - 5s - loss: 0.1637 - acc: 0.9534 - val_loss: 0.1487 - val_acc: 0.9590
Epoch 17/20
 - 5s - loss: 0.1655 - acc: 0.9541 - val_loss: 0.1122 - val_acc: 0.9667
Epoch 18/20
 - 4s - loss: 0.1647 - acc: 0.9535 - val_loss: 0.1067 - val_acc: 0.9706
Epoch 19/20
 - 5s - loss: 0.1657 - acc: 0.9544 - val_loss: 0.1109 - val_acc: 0.9685
Epoch 20/20
 - 5s - loss: 0.1637 - acc: 0.9541 - val_loss: 0.1085 - val_acc: 0.9701
Test loss: 0.10898059101804847
Test accuracy: 0.9696
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.3364 - acc: 0.8972 - val_loss: 0.1428 - val_acc: 0.9564
Epoch 2/20
 - 1s - loss: 0.1329 - acc: 0.9590 - val_loss: 0.1134 - val_acc: 0.9641
Epoch 3/20
 - 1s - loss: 0.0933 - acc: 0.9712 - val_loss: 0.0921 - val_acc: 0.9697
Epoch 4/20
 - 1s - loss: 0.0670 - acc: 0.9788 - val_loss: 0.1091 - val_acc: 0.9683
Epoch 5/20
 - 1s - loss: 0.0568 - acc: 0.9819 - val_loss: 0.1047 - val_acc: 0.9723
Epoch 6/20
 - 1s - loss: 0.0446 - acc: 0.9862 - val_loss: 0.1112 - val_acc: 0.9717
Epoch 7/20
 - 1s - loss: 0.0382 - acc: 0.9874 - val_loss: 0.0934 - val_acc: 0.9769
Epoch 8/20
 - 1s - loss: 0.0297 - acc: 0.9902 - val_loss: 0.0983 - val_acc: 0.9774
Epoch 9/20
 - 1s - loss: 0.0302 - acc: 0.9908 - val_loss: 0.1157 - val_acc: 0.9733
Epoch 10/20
 - 1s - loss: 0.0235 - acc: 0.9926 - val_loss: 0.1107 - val_acc: 0.9774
Epoch 11/20
 - 1s - loss: 0.0230 - acc: 0.9925 - val_loss: 0.1084 - val_acc: 0.9770
Epoch 12/20
 - 1s - loss: 0.0197 - acc: 0.9931 - val_loss: 0.1228 - val_acc: 0.9776
Epoch 13/20
 - 1s - loss: 0.0185 - acc: 0.9942 - val_loss: 0.1301 - val_acc: 0.9783
Epoch 14/20
 - 1s - loss: 0.0174 - acc: 0.9949 - val_loss: 0.1189 - val_acc: 0.9771
Epoch 15/20
 - 1s - loss: 0.0160 - acc: 0.9956 - val_loss: 0.1209 - val_acc: 0.9764
Epoch 16/20
 - 1s - loss: 0.0135 - acc: 0.9958 - val_loss: 0.1156 - val_acc: 0.9804
Epoch 17/20
 - 1s - loss: 0.0153 - acc: 0.9956 - val_loss: 0.1152 - val_acc: 0.9804
Epoch 18/20
 - 1s - loss: 0.0140 - acc: 0.9960 - val_loss: 0.1318 - val_acc: 0.9786
Epoch 19/20
 - 1s - loss: 0.0136 - acc: 0.9963 - val_loss: 0.1332 - val_acc: 0.9777
Epoch 20/20
 - 1s - loss: 0.0126 - acc: 0.9963 - val_loss: 0.1255 - val_acc: 0.9789
Test loss: 0.12547158145221105
Test accuracy: 0.9789
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2884 - acc: 0.5940 - val_loss: 0.8429 - val_acc: 0.7448
Epoch 2/20
 - 2s - loss: 0.6193 - acc: 0.8006 - val_loss: 0.3969 - val_acc: 0.8639
Epoch 3/20
 - 2s - loss: 0.4678 - acc: 0.8517 - val_loss: 0.4053 - val_acc: 0.8715
Epoch 4/20
 - 2s - loss: 0.3821 - acc: 0.8787 - val_loss: 0.4311 - val_acc: 0.8542
Epoch 5/20
 - 2s - loss: 0.3306 - acc: 0.8960 - val_loss: 0.4144 - val_acc: 0.8591
Epoch 6/20
 - 2s - loss: 0.2925 - acc: 0.9079 - val_loss: 0.2631 - val_acc: 0.9156
Epoch 7/20
 - 2s - loss: 0.2620 - acc: 0.9186 - val_loss: 0.2324 - val_acc: 0.9239
Epoch 8/20
 - 2s - loss: 0.2369 - acc: 0.9244 - val_loss: 0.2986 - val_acc: 0.9056
Epoch 9/20
 - 2s - loss: 0.2299 - acc: 0.9285 - val_loss: 0.1492 - val_acc: 0.9515
Epoch 10/20
 - 2s - loss: 0.2139 - acc: 0.9327 - val_loss: 0.2088 - val_acc: 0.9335
Epoch 11/20
 - 2s - loss: 0.2048 - acc: 0.9357 - val_loss: 0.1445 - val_acc: 0.9555
Epoch 12/20
 - 2s - loss: 0.1945 - acc: 0.9390 - val_loss: 0.2317 - val_acc: 0.9313
Epoch 13/20
 - 2s - loss: 0.1865 - acc: 0.9426 - val_loss: 0.1400 - val_acc: 0.9566
Epoch 14/20
 - 2s - loss: 0.1786 - acc: 0.9445 - val_loss: 0.3724 - val_acc: 0.8819
Epoch 15/20
 - 2s - loss: 0.1724 - acc: 0.9466 - val_loss: 0.1617 - val_acc: 0.9495
Epoch 16/20
 - 2s - loss: 0.1705 - acc: 0.9490 - val_loss: 0.1680 - val_acc: 0.9460
Epoch 17/20
 - 2s - loss: 0.1616 - acc: 0.9495 - val_loss: 0.1484 - val_acc: 0.9549
Epoch 18/20
 - 2s - loss: 0.1611 - acc: 0.9503 - val_loss: 0.1415 - val_acc: 0.9572
Epoch 19/20
 - 2s - loss: 0.1573 - acc: 0.9511 - val_loss: 0.1407 - val_acc: 0.9607
Epoch 20/20
 - 2s - loss: 0.1527 - acc: 0.9538 - val_loss: 0.1486 - val_acc: 0.9533
Test loss: 0.1486212918186793
Test accuracy: 0.9531
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4545 - acc: 0.8597 - val_loss: 0.2300 - val_acc: 0.9258
Epoch 2/20
 - 1s - loss: 0.1800 - acc: 0.9447 - val_loss: 0.1430 - val_acc: 0.9559
Epoch 3/20
 - 1s - loss: 0.1198 - acc: 0.9626 - val_loss: 0.1505 - val_acc: 0.9539
Epoch 4/20
 - 1s - loss: 0.0843 - acc: 0.9735 - val_loss: 0.1314 - val_acc: 0.9617
Epoch 5/20
 - 1s - loss: 0.0584 - acc: 0.9814 - val_loss: 0.1449 - val_acc: 0.9606
Epoch 6/20
 - 1s - loss: 0.0486 - acc: 0.9847 - val_loss: 0.1391 - val_acc: 0.9641
Epoch 7/20
 - 1s - loss: 0.0373 - acc: 0.9881 - val_loss: 0.1369 - val_acc: 0.9660
Epoch 8/20
 - 1s - loss: 0.0304 - acc: 0.9895 - val_loss: 0.1388 - val_acc: 0.9665
Epoch 9/20
 - 1s - loss: 0.0275 - acc: 0.9900 - val_loss: 0.1408 - val_acc: 0.9654
Epoch 10/20
 - 1s - loss: 0.0227 - acc: 0.9923 - val_loss: 0.1455 - val_acc: 0.9702
Epoch 11/20
 - 1s - loss: 0.0177 - acc: 0.9940 - val_loss: 0.1518 - val_acc: 0.9671
Epoch 12/20
 - 1s - loss: 0.0177 - acc: 0.9935 - val_loss: 0.1640 - val_acc: 0.9665
Epoch 13/20
 - 1s - loss: 0.0126 - acc: 0.9951 - val_loss: 0.1839 - val_acc: 0.9647
Epoch 14/20
 - 1s - loss: 0.0146 - acc: 0.9952 - val_loss: 0.1765 - val_acc: 0.9656
Epoch 15/20
 - 1s - loss: 0.0153 - acc: 0.9957 - val_loss: 0.1968 - val_acc: 0.9634
Epoch 16/20
 - 1s - loss: 0.0110 - acc: 0.9963 - val_loss: 0.1847 - val_acc: 0.9691
Epoch 17/20
 - 1s - loss: 0.0112 - acc: 0.9965 - val_loss: 0.1635 - val_acc: 0.9728
Epoch 18/20
 - 1s - loss: 0.0114 - acc: 0.9965 - val_loss: 0.1833 - val_acc: 0.9728
Epoch 19/20
 - 1s - loss: 0.0105 - acc: 0.9969 - val_loss: 0.1969 - val_acc: 0.9682
Epoch 20/20
 - 1s - loss: 0.0098 - acc: 0.9969 - val_loss: 0.1888 - val_acc: 0.9697
Test loss: 0.18879102216344476
Test accuracy: 0.9697
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6211 - acc: 0.4849 - val_loss: 1.3247 - val_acc: 0.5404
Epoch 2/20
 - 1s - loss: 0.8460 - acc: 0.7249 - val_loss: 0.6178 - val_acc: 0.7884
Epoch 3/20
 - 1s - loss: 0.6661 - acc: 0.7838 - val_loss: 0.7511 - val_acc: 0.7479
Epoch 4/20
 - 1s - loss: 0.5541 - acc: 0.8203 - val_loss: 0.8975 - val_acc: 0.7191
Epoch 5/20
 - 1s - loss: 0.4859 - acc: 0.8465 - val_loss: 0.7282 - val_acc: 0.7679
Epoch 6/20
 - 1s - loss: 0.4287 - acc: 0.8649 - val_loss: 0.7414 - val_acc: 0.7761
Epoch 7/20
 - 1s - loss: 0.3947 - acc: 0.8747 - val_loss: 0.4149 - val_acc: 0.8691
Epoch 8/20
 - 1s - loss: 0.3439 - acc: 0.8918 - val_loss: 0.5438 - val_acc: 0.8368
Epoch 9/20
 - 1s - loss: 0.3217 - acc: 0.8987 - val_loss: 0.6110 - val_acc: 0.8129
Epoch 10/20
 - 1s - loss: 0.2980 - acc: 0.9054 - val_loss: 0.4169 - val_acc: 0.8646
Epoch 11/20
 - 1s - loss: 0.2779 - acc: 0.9119 - val_loss: 0.4735 - val_acc: 0.8509
Epoch 12/20
 - 1s - loss: 0.2692 - acc: 0.9160 - val_loss: 0.6328 - val_acc: 0.8017
Epoch 13/20
 - 1s - loss: 0.2550 - acc: 0.9188 - val_loss: 0.2718 - val_acc: 0.9141
Epoch 14/20
 - 1s - loss: 0.2364 - acc: 0.9248 - val_loss: 0.6294 - val_acc: 0.8201
Epoch 15/20
 - 1s - loss: 0.2386 - acc: 0.9238 - val_loss: 0.2192 - val_acc: 0.9342
Epoch 16/20
 - 1s - loss: 0.2152 - acc: 0.9307 - val_loss: 0.3724 - val_acc: 0.9000
Epoch 17/20
 - 1s - loss: 0.2120 - acc: 0.9335 - val_loss: 0.1629 - val_acc: 0.9508
Epoch 18/20
 - 1s - loss: 0.2142 - acc: 0.9326 - val_loss: 0.1967 - val_acc: 0.9415
Epoch 19/20
 - 1s - loss: 0.1830 - acc: 0.9431 - val_loss: 0.1796 - val_acc: 0.9415
Epoch 20/20
 - 1s - loss: 0.1896 - acc: 0.9429 - val_loss: 0.3039 - val_acc: 0.9025
Test loss: 0.30450512954741715
Test accuracy: 0.9035
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6239 - acc: 0.8085 - val_loss: 0.3026 - val_acc: 0.9093
Epoch 2/20
 - 0s - loss: 0.2531 - acc: 0.9239 - val_loss: 0.2488 - val_acc: 0.9181
Epoch 3/20
 - 0s - loss: 0.1691 - acc: 0.9488 - val_loss: 0.2087 - val_acc: 0.9343
Epoch 4/20
 - 0s - loss: 0.1196 - acc: 0.9635 - val_loss: 0.2986 - val_acc: 0.9113
Epoch 5/20
 - 0s - loss: 0.0876 - acc: 0.9732 - val_loss: 0.1846 - val_acc: 0.9442
Epoch 6/20
 - 0s - loss: 0.0671 - acc: 0.9787 - val_loss: 0.2101 - val_acc: 0.9393
Epoch 7/20
 - 0s - loss: 0.0501 - acc: 0.9843 - val_loss: 0.1647 - val_acc: 0.9556
Epoch 8/20
 - 0s - loss: 0.0353 - acc: 0.9888 - val_loss: 0.2181 - val_acc: 0.9460
Epoch 9/20
 - 0s - loss: 0.0306 - acc: 0.9908 - val_loss: 0.2191 - val_acc: 0.9473
Epoch 10/20
 - 0s - loss: 0.0229 - acc: 0.9928 - val_loss: 0.1989 - val_acc: 0.9558
Epoch 11/20
 - 0s - loss: 0.0180 - acc: 0.9940 - val_loss: 0.2074 - val_acc: 0.9533
Epoch 12/20
 - 0s - loss: 0.0129 - acc: 0.9963 - val_loss: 0.2213 - val_acc: 0.9562
Epoch 13/20
 - 0s - loss: 0.0169 - acc: 0.9945 - val_loss: 0.2440 - val_acc: 0.9499
Epoch 14/20
 - 0s - loss: 0.0111 - acc: 0.9960 - val_loss: 0.2352 - val_acc: 0.9572
Epoch 15/20
 - 0s - loss: 0.0086 - acc: 0.9977 - val_loss: 0.2610 - val_acc: 0.9500
Epoch 16/20
 - 0s - loss: 0.0105 - acc: 0.9963 - val_loss: 0.2747 - val_acc: 0.9497
Epoch 17/20
 - 0s - loss: 0.0081 - acc: 0.9972 - val_loss: 0.2495 - val_acc: 0.9559
Epoch 18/20
 - 0s - loss: 0.0049 - acc: 0.9991 - val_loss: 0.2676 - val_acc: 0.9537
Epoch 19/20
 - 0s - loss: 0.0069 - acc: 0.9975 - val_loss: 0.2676 - val_acc: 0.9565
Epoch 20/20
 - 0s - loss: 0.0085 - acc: 0.9976 - val_loss: 0.2738 - val_acc: 0.9565
Test loss: 0.27384498597144513
Test accuracy: 0.9565
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0248 - acc: 0.3557 - val_loss: 1.8134 - val_acc: 0.3317
Epoch 2/20
 - 1s - loss: 1.1375 - acc: 0.6204 - val_loss: 0.8019 - val_acc: 0.7559
Epoch 3/20
 - 1s - loss: 0.8527 - acc: 0.7193 - val_loss: 0.6353 - val_acc: 0.7994
Epoch 4/20
 - 1s - loss: 0.7452 - acc: 0.7536 - val_loss: 1.0068 - val_acc: 0.6512
Epoch 5/20
 - 1s - loss: 0.6517 - acc: 0.7877 - val_loss: 0.4251 - val_acc: 0.8629
Epoch 6/20
 - 1s - loss: 0.5859 - acc: 0.8072 - val_loss: 0.6971 - val_acc: 0.7565
Epoch 7/20
 - 1s - loss: 0.5367 - acc: 0.8249 - val_loss: 0.7236 - val_acc: 0.7700
Epoch 8/20
 - 1s - loss: 0.5121 - acc: 0.8384 - val_loss: 0.3501 - val_acc: 0.8940
Epoch 9/20
 - 1s - loss: 0.4501 - acc: 0.8576 - val_loss: 0.5275 - val_acc: 0.8218
Epoch 10/20
 - 1s - loss: 0.4353 - acc: 0.8593 - val_loss: 0.3958 - val_acc: 0.8760
Epoch 11/20
 - 1s - loss: 0.3845 - acc: 0.8787 - val_loss: 0.3643 - val_acc: 0.8798
Epoch 12/20
 - 1s - loss: 0.3731 - acc: 0.8783 - val_loss: 0.3220 - val_acc: 0.8921
Epoch 13/20
 - 1s - loss: 0.3578 - acc: 0.8856 - val_loss: 0.3375 - val_acc: 0.8944
Epoch 14/20
 - 1s - loss: 0.3461 - acc: 0.8881 - val_loss: 0.4325 - val_acc: 0.8625
Epoch 15/20
 - 1s - loss: 0.3300 - acc: 0.8959 - val_loss: 0.5007 - val_acc: 0.8374
Epoch 16/20
 - 1s - loss: 0.3175 - acc: 0.8991 - val_loss: 0.2524 - val_acc: 0.9213
Epoch 17/20
 - 1s - loss: 0.2789 - acc: 0.9111 - val_loss: 0.4334 - val_acc: 0.8741
Epoch 18/20
 - 1s - loss: 0.2869 - acc: 0.9096 - val_loss: 0.5074 - val_acc: 0.8431
Epoch 19/20
 - 1s - loss: 0.2712 - acc: 0.9149 - val_loss: 0.3347 - val_acc: 0.8971
Epoch 20/20
 - 1s - loss: 0.2709 - acc: 0.9132 - val_loss: 0.2989 - val_acc: 0.9076
Test loss: 0.297544221021235
Test accuracy: 0.9073
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8121 - acc: 0.7373 - val_loss: 0.5788 - val_acc: 0.8133
Epoch 2/20
 - 0s - loss: 0.3373 - acc: 0.9011 - val_loss: 0.3692 - val_acc: 0.8875
Epoch 3/20
 - 0s - loss: 0.2312 - acc: 0.9304 - val_loss: 0.4176 - val_acc: 0.8664
Epoch 4/20
 - 0s - loss: 0.1689 - acc: 0.9525 - val_loss: 0.2606 - val_acc: 0.9207
Epoch 5/20
 - 0s - loss: 0.1187 - acc: 0.9653 - val_loss: 0.3005 - val_acc: 0.9066
Epoch 6/20
 - 0s - loss: 0.0843 - acc: 0.9741 - val_loss: 0.2425 - val_acc: 0.9261
Epoch 7/20
 - 0s - loss: 0.0681 - acc: 0.9811 - val_loss: 0.2214 - val_acc: 0.9347
Epoch 8/20
 - 0s - loss: 0.0491 - acc: 0.9872 - val_loss: 0.2469 - val_acc: 0.9314
Epoch 9/20
 - 0s - loss: 0.0425 - acc: 0.9861 - val_loss: 0.2942 - val_acc: 0.9222
Epoch 10/20
 - 0s - loss: 0.0274 - acc: 0.9920 - val_loss: 0.2469 - val_acc: 0.9348
Epoch 11/20
 - 0s - loss: 0.0207 - acc: 0.9936 - val_loss: 0.3045 - val_acc: 0.9227
Epoch 12/20
 - 0s - loss: 0.0206 - acc: 0.9941 - val_loss: 0.2998 - val_acc: 0.9272
Epoch 13/20
 - 0s - loss: 0.0146 - acc: 0.9949 - val_loss: 0.2583 - val_acc: 0.9408
Epoch 14/20
 - 0s - loss: 0.0126 - acc: 0.9968 - val_loss: 0.3467 - val_acc: 0.9274
Epoch 15/20
 - 0s - loss: 0.0095 - acc: 0.9976 - val_loss: 0.3102 - val_acc: 0.9339
Epoch 16/20
 - 0s - loss: 0.0154 - acc: 0.9944 - val_loss: 0.2601 - val_acc: 0.9435
Epoch 17/20
 - 0s - loss: 0.0053 - acc: 0.9989 - val_loss: 0.2643 - val_acc: 0.9449
Epoch 18/20
 - 0s - loss: 0.0088 - acc: 0.9973 - val_loss: 0.3153 - val_acc: 0.9397
Epoch 19/20
 - 0s - loss: 0.0065 - acc: 0.9989 - val_loss: 0.3545 - val_acc: 0.9359
Epoch 20/20
 - 0s - loss: 0.0090 - acc: 0.9973 - val_loss: 0.3098 - val_acc: 0.9424
Test loss: 0.3098287071336925
Test accuracy: 0.9424
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5870 - acc: 0.2504 - val_loss: 1.6117 - val_acc: 0.4431
Epoch 2/20
 - 1s - loss: 1.5844 - acc: 0.4517 - val_loss: 1.4548 - val_acc: 0.4924
Epoch 3/20
 - 1s - loss: 1.2253 - acc: 0.5952 - val_loss: 1.2569 - val_acc: 0.5970
Epoch 4/20
 - 1s - loss: 1.0580 - acc: 0.6459 - val_loss: 0.7502 - val_acc: 0.7224
Epoch 5/20
 - 1s - loss: 0.9099 - acc: 0.6955 - val_loss: 0.8918 - val_acc: 0.6908
Epoch 6/20
 - 1s - loss: 0.8199 - acc: 0.7280 - val_loss: 0.6969 - val_acc: 0.7748
Epoch 7/20
 - 1s - loss: 0.7956 - acc: 0.7445 - val_loss: 0.6873 - val_acc: 0.7700
Epoch 8/20
 - 1s - loss: 0.6909 - acc: 0.7643 - val_loss: 0.7395 - val_acc: 0.7562
Epoch 9/20
 - 1s - loss: 0.6494 - acc: 0.7981 - val_loss: 1.0189 - val_acc: 0.6548
Epoch 10/20
 - 1s - loss: 0.6286 - acc: 0.7947 - val_loss: 0.8187 - val_acc: 0.7283
Epoch 11/20
 - 1s - loss: 0.6017 - acc: 0.8093 - val_loss: 0.7980 - val_acc: 0.7473
Epoch 12/20
 - 1s - loss: 0.5519 - acc: 0.8211 - val_loss: 0.8204 - val_acc: 0.7117
Epoch 13/20
 - 1s - loss: 0.5374 - acc: 0.8264 - val_loss: 0.4716 - val_acc: 0.8556
Epoch 14/20
 - 1s - loss: 0.5254 - acc: 0.8413 - val_loss: 0.5959 - val_acc: 0.8015
Epoch 15/20
 - 1s - loss: 0.5150 - acc: 0.8256 - val_loss: 0.5405 - val_acc: 0.8166
Epoch 16/20
 - 1s - loss: 0.4526 - acc: 0.8565 - val_loss: 0.5174 - val_acc: 0.8251
Epoch 17/20
 - 1s - loss: 0.4530 - acc: 0.8480 - val_loss: 0.5918 - val_acc: 0.8135
Epoch 18/20
 - 1s - loss: 0.4207 - acc: 0.8664 - val_loss: 0.5967 - val_acc: 0.7962
Epoch 19/20
 - 1s - loss: 0.4156 - acc: 0.8587 - val_loss: 0.5283 - val_acc: 0.8261
Epoch 20/20
 - 1s - loss: 0.3869 - acc: 0.8768 - val_loss: 0.3609 - val_acc: 0.8818
Test loss: 0.3599798543483019
Test accuracy: 0.8825
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1966 - acc: 0.6219 - val_loss: 0.5410 - val_acc: 0.8420
Epoch 2/20
 - 0s - loss: 0.4839 - acc: 0.8565 - val_loss: 0.5449 - val_acc: 0.8262
Epoch 3/20
 - 0s - loss: 0.3426 - acc: 0.9013 - val_loss: 0.3771 - val_acc: 0.8801
Epoch 4/20
 - 0s - loss: 0.2432 - acc: 0.9291 - val_loss: 0.3790 - val_acc: 0.8875
Epoch 5/20
 - 0s - loss: 0.2019 - acc: 0.9371 - val_loss: 0.3749 - val_acc: 0.8854
Epoch 6/20
 - 0s - loss: 0.1614 - acc: 0.9531 - val_loss: 0.3147 - val_acc: 0.9024
Epoch 7/20
 - 0s - loss: 0.0957 - acc: 0.9707 - val_loss: 0.3236 - val_acc: 0.9033
Epoch 8/20
 - 0s - loss: 0.0763 - acc: 0.9792 - val_loss: 0.3069 - val_acc: 0.9124
Epoch 9/20
 - 0s - loss: 0.0753 - acc: 0.9776 - val_loss: 0.2864 - val_acc: 0.9172
Epoch 10/20
 - 0s - loss: 0.0406 - acc: 0.9877 - val_loss: 0.3665 - val_acc: 0.8980
Epoch 11/20
 - 0s - loss: 0.0390 - acc: 0.9915 - val_loss: 0.3088 - val_acc: 0.9139
Epoch 12/20
 - 0s - loss: 0.0176 - acc: 0.9968 - val_loss: 0.3030 - val_acc: 0.9199
Epoch 13/20
 - 0s - loss: 0.0501 - acc: 0.9851 - val_loss: 0.2937 - val_acc: 0.9225
Epoch 14/20
 - 0s - loss: 0.0080 - acc: 0.9989 - val_loss: 0.2977 - val_acc: 0.9225
Epoch 15/20
 - 0s - loss: 0.0208 - acc: 0.9941 - val_loss: 0.3963 - val_acc: 0.9026
Epoch 16/20
 - 0s - loss: 0.0074 - acc: 0.9989 - val_loss: 0.3352 - val_acc: 0.9214
Epoch 17/20
 - 0s - loss: 0.0187 - acc: 0.9936 - val_loss: 0.3556 - val_acc: 0.9140
Epoch 18/20
 - 0s - loss: 0.0037 - acc: 1.0000 - val_loss: 0.3239 - val_acc: 0.9249
Epoch 19/20
 - 0s - loss: 0.0048 - acc: 0.9995 - val_loss: 0.3635 - val_acc: 0.9224
Epoch 20/20
 - 0s - loss: 0.0320 - acc: 0.9899 - val_loss: 0.3279 - val_acc: 0.9246
Test loss: 0.3279346733684186
Test accuracy: 0.9246
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.1677 - acc: 0.1744 - val_loss: 2.4888 - val_acc: 0.0980
Epoch 2/20
 - 1s - loss: 1.9991 - acc: 0.3104 - val_loss: 2.1380 - val_acc: 0.1642
Epoch 3/20
 - 1s - loss: 1.7084 - acc: 0.4144 - val_loss: 1.8902 - val_acc: 0.3308
Epoch 4/20
 - 1s - loss: 1.5059 - acc: 0.5093 - val_loss: 1.2504 - val_acc: 0.5605
Epoch 5/20
 - 1s - loss: 1.2863 - acc: 0.5685 - val_loss: 1.1287 - val_acc: 0.6339
Epoch 6/20
 - 1s - loss: 1.2011 - acc: 0.6107 - val_loss: 0.8980 - val_acc: 0.7112
Epoch 7/20
 - 1s - loss: 1.0748 - acc: 0.6421 - val_loss: 1.1777 - val_acc: 0.5755
Epoch 8/20
 - 1s - loss: 1.0214 - acc: 0.6523 - val_loss: 1.2040 - val_acc: 0.6107
Epoch 9/20
 - 1s - loss: 0.8955 - acc: 0.7104 - val_loss: 0.5903 - val_acc: 0.8111
Epoch 10/20
 - 1s - loss: 0.8300 - acc: 0.7141 - val_loss: 1.1135 - val_acc: 0.6566
Epoch 11/20
 - 1s - loss: 0.7899 - acc: 0.7499 - val_loss: 1.0588 - val_acc: 0.6554
Epoch 12/20
 - 1s - loss: 0.8097 - acc: 0.7323 - val_loss: 1.2294 - val_acc: 0.6005
Epoch 13/20
 - 1s - loss: 0.7652 - acc: 0.7557 - val_loss: 0.7792 - val_acc: 0.7015
Epoch 14/20
 - 1s - loss: 0.7287 - acc: 0.7728 - val_loss: 0.8465 - val_acc: 0.6961
Epoch 15/20
 - 1s - loss: 0.6688 - acc: 0.7771 - val_loss: 0.5471 - val_acc: 0.8268
Epoch 16/20
 - 1s - loss: 0.6928 - acc: 0.7723 - val_loss: 0.5696 - val_acc: 0.8092
Epoch 17/20
 - 1s - loss: 0.5896 - acc: 0.8155 - val_loss: 0.6421 - val_acc: 0.7766
Epoch 18/20
 - 1s - loss: 0.6379 - acc: 0.7861 - val_loss: 0.4945 - val_acc: 0.8375
Epoch 19/20
 - 1s - loss: 0.6062 - acc: 0.8208 - val_loss: 0.5313 - val_acc: 0.8371
Epoch 20/20
 - 1s - loss: 0.6188 - acc: 0.8027 - val_loss: 0.4415 - val_acc: 0.8605
Test loss: 0.4415262652039528
Test accuracy: 0.8607
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5571 - acc: 0.4845 - val_loss: 1.1043 - val_acc: 0.6154
Epoch 2/20
 - 0s - loss: 0.6549 - acc: 0.8004 - val_loss: 0.6435 - val_acc: 0.7940
Epoch 3/20
 - 0s - loss: 0.4037 - acc: 0.8869 - val_loss: 0.5925 - val_acc: 0.8058
Epoch 4/20
 - 0s - loss: 0.3179 - acc: 0.9029 - val_loss: 0.6402 - val_acc: 0.7864
Epoch 5/20
 - 0s - loss: 0.2673 - acc: 0.9253 - val_loss: 0.4394 - val_acc: 0.8625
Epoch 6/20
 - 0s - loss: 0.1535 - acc: 0.9658 - val_loss: 0.5126 - val_acc: 0.8419
Epoch 7/20
 - 0s - loss: 0.1385 - acc: 0.9712 - val_loss: 0.4149 - val_acc: 0.8742
Epoch 8/20
 - 0s - loss: 0.1156 - acc: 0.9669 - val_loss: 0.4153 - val_acc: 0.8792
Epoch 9/20
 - 0s - loss: 0.0877 - acc: 0.9808 - val_loss: 0.4336 - val_acc: 0.8782
Epoch 10/20
 - 0s - loss: 0.0538 - acc: 0.9904 - val_loss: 0.4004 - val_acc: 0.8866
Epoch 11/20
 - 0s - loss: 0.0326 - acc: 0.9936 - val_loss: 0.4998 - val_acc: 0.8618
Epoch 12/20
 - 0s - loss: 0.0700 - acc: 0.9840 - val_loss: 0.4542 - val_acc: 0.8800
Epoch 13/20
 - 0s - loss: 0.0216 - acc: 0.9968 - val_loss: 0.4974 - val_acc: 0.8709
Epoch 14/20
 - 0s - loss: 0.0243 - acc: 0.9968 - val_loss: 0.4452 - val_acc: 0.8824
Epoch 15/20
 - 0s - loss: 0.1501 - acc: 0.9648 - val_loss: 0.3738 - val_acc: 0.8972
Epoch 16/20
 - 0s - loss: 0.0102 - acc: 0.9989 - val_loss: 0.3948 - val_acc: 0.8942
Epoch 17/20
 - 0s - loss: 0.0075 - acc: 1.0000 - val_loss: 0.3934 - val_acc: 0.8968
Epoch 18/20
 - 0s - loss: 0.0044 - acc: 1.0000 - val_loss: 0.3968 - val_acc: 0.8987
Epoch 19/20
 - 0s - loss: 0.0064 - acc: 1.0000 - val_loss: 0.4607 - val_acc: 0.8845
Epoch 20/20
 - 0s - loss: 0.0044 - acc: 1.0000 - val_loss: 0.4406 - val_acc: 0.8959
Test loss: 0.44057816105159
Test accuracy: 0.8959
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.0432 - acc: 0.1441 - val_loss: 2.4542 - val_acc: 0.1136
Epoch 2/20
 - 1s - loss: 2.1135 - acc: 0.2519 - val_loss: 1.9422 - val_acc: 0.4090
Epoch 3/20
 - 1s - loss: 1.9385 - acc: 0.3522 - val_loss: 2.1643 - val_acc: 0.2253
Epoch 4/20
 - 1s - loss: 1.8851 - acc: 0.3372 - val_loss: 2.0722 - val_acc: 0.2403
Epoch 5/20
 - 1s - loss: 1.6939 - acc: 0.4461 - val_loss: 1.6025 - val_acc: 0.4850
Epoch 6/20
 - 1s - loss: 1.5433 - acc: 0.5016 - val_loss: 1.3982 - val_acc: 0.5995
Epoch 7/20
 - 0s - loss: 1.4958 - acc: 0.4973 - val_loss: 1.3956 - val_acc: 0.5950
Epoch 8/20
 - 1s - loss: 1.3181 - acc: 0.5795 - val_loss: 1.7650 - val_acc: 0.2993
Epoch 9/20
 - 1s - loss: 1.3093 - acc: 0.5752 - val_loss: 1.3382 - val_acc: 0.4824
Epoch 10/20
 - 0s - loss: 1.0563 - acc: 0.6318 - val_loss: 1.1830 - val_acc: 0.5781
Epoch 11/20
 - 1s - loss: 1.0879 - acc: 0.6361 - val_loss: 1.2467 - val_acc: 0.5943
Epoch 12/20
 - 1s - loss: 1.2031 - acc: 0.6083 - val_loss: 0.8486 - val_acc: 0.7192
Epoch 13/20
 - 1s - loss: 0.9110 - acc: 0.7086 - val_loss: 1.4260 - val_acc: 0.5190
Epoch 14/20
 - 1s - loss: 0.9316 - acc: 0.6958 - val_loss: 1.3881 - val_acc: 0.5662
Epoch 15/20
 - 1s - loss: 1.0089 - acc: 0.6564 - val_loss: 0.9228 - val_acc: 0.6967
Epoch 16/20
 - 1s - loss: 0.9968 - acc: 0.6884 - val_loss: 1.2648 - val_acc: 0.5268
Epoch 17/20
 - 1s - loss: 0.8097 - acc: 0.7193 - val_loss: 0.9570 - val_acc: 0.6817
Epoch 18/20
 - 1s - loss: 0.8460 - acc: 0.7279 - val_loss: 0.8014 - val_acc: 0.7175
Epoch 19/20
 - 1s - loss: 0.9114 - acc: 0.7108 - val_loss: 0.9723 - val_acc: 0.6773
Epoch 20/20
 - 1s - loss: 0.8088 - acc: 0.7321 - val_loss: 1.3716 - val_acc: 0.5615
Test loss: 1.371460928440094
Test accuracy: 0.5617
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8572 - acc: 0.4017 - val_loss: 1.2273 - val_acc: 0.6076
Epoch 2/20
 - 0s - loss: 0.8588 - acc: 0.7372 - val_loss: 0.8295 - val_acc: 0.7375
Epoch 3/20
 - 0s - loss: 0.5164 - acc: 0.8355 - val_loss: 0.8230 - val_acc: 0.7471
Epoch 4/20
 - 0s - loss: 0.3427 - acc: 0.9060 - val_loss: 0.5913 - val_acc: 0.8077
Epoch 5/20
 - 0s - loss: 0.2335 - acc: 0.9338 - val_loss: 0.6305 - val_acc: 0.8122
Epoch 6/20
 - 0s - loss: 0.1908 - acc: 0.9573 - val_loss: 0.6334 - val_acc: 0.7939
Epoch 7/20
 - 0s - loss: 0.1638 - acc: 0.9551 - val_loss: 0.5978 - val_acc: 0.8031
Epoch 8/20
 - 0s - loss: 0.1148 - acc: 0.9701 - val_loss: 0.5677 - val_acc: 0.8245
Epoch 9/20
 - 0s - loss: 0.0681 - acc: 0.9872 - val_loss: 0.5648 - val_acc: 0.8307
Epoch 10/20
 - 0s - loss: 0.0710 - acc: 0.9872 - val_loss: 0.5509 - val_acc: 0.8388
Epoch 11/20
 - 0s - loss: 0.0456 - acc: 0.9979 - val_loss: 0.6976 - val_acc: 0.8067
Epoch 12/20
 - 0s - loss: 0.2293 - acc: 0.9380 - val_loss: 0.5503 - val_acc: 0.8320
Epoch 13/20
 - 0s - loss: 0.0329 - acc: 0.9957 - val_loss: 0.5196 - val_acc: 0.8479
Epoch 14/20
 - 0s - loss: 0.0196 - acc: 1.0000 - val_loss: 0.5269 - val_acc: 0.8484
Epoch 15/20
 - 0s - loss: 0.0159 - acc: 1.0000 - val_loss: 0.5564 - val_acc: 0.8454
Epoch 16/20
 - 0s - loss: 0.0111 - acc: 1.0000 - val_loss: 0.5646 - val_acc: 0.8441
Epoch 17/20
 - 0s - loss: 0.0087 - acc: 1.0000 - val_loss: 0.5650 - val_acc: 0.8503
Epoch 18/20
 - 0s - loss: 0.0066 - acc: 1.0000 - val_loss: 0.5878 - val_acc: 0.8484
Epoch 19/20
 - 0s - loss: 0.0095 - acc: 0.9979 - val_loss: 1.0521 - val_acc: 0.7598
Epoch 20/20
 - 0s - loss: 0.1903 - acc: 0.9338 - val_loss: 0.6200 - val_acc: 0.8415
Test loss: 0.6200274100109935
Test accuracy: 0.8415
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.3034 - acc: 0.1047 - val_loss: 3.1774 - val_acc: 0.1137
Epoch 2/20
 - 0s - loss: 2.7308 - acc: 0.1795 - val_loss: 2.0920 - val_acc: 0.3110
Epoch 3/20
 - 0s - loss: 2.1719 - acc: 0.1944 - val_loss: 2.0899 - val_acc: 0.1387
Epoch 4/20
 - 0s - loss: 1.9372 - acc: 0.3568 - val_loss: 1.8553 - val_acc: 0.2877
Epoch 5/20
 - 0s - loss: 1.9830 - acc: 0.3248 - val_loss: 1.8683 - val_acc: 0.3716
Epoch 6/20
 - 0s - loss: 1.8064 - acc: 0.4017 - val_loss: 2.2420 - val_acc: 0.1675
Epoch 7/20
 - 0s - loss: 1.8139 - acc: 0.4231 - val_loss: 1.8765 - val_acc: 0.3306
Epoch 8/20
 - 0s - loss: 1.7399 - acc: 0.4017 - val_loss: 1.9216 - val_acc: 0.3699
Epoch 9/20
 - 0s - loss: 1.4975 - acc: 0.5021 - val_loss: 1.7663 - val_acc: 0.4005
Epoch 10/20
 - 0s - loss: 1.6389 - acc: 0.4359 - val_loss: 1.4214 - val_acc: 0.5085
Epoch 11/20
 - 0s - loss: 1.2412 - acc: 0.5919 - val_loss: 1.5764 - val_acc: 0.4828
Epoch 12/20
 - 0s - loss: 1.3057 - acc: 0.5641 - val_loss: 1.6450 - val_acc: 0.4392
Epoch 13/20
 - 0s - loss: 1.2968 - acc: 0.5406 - val_loss: 1.4268 - val_acc: 0.5232
Epoch 14/20
 - 0s - loss: 1.1928 - acc: 0.6090 - val_loss: 1.5066 - val_acc: 0.4946
Epoch 15/20
 - 0s - loss: 1.3450 - acc: 0.5684 - val_loss: 1.2068 - val_acc: 0.6097
Epoch 16/20
 - 0s - loss: 0.8852 - acc: 0.7372 - val_loss: 1.2946 - val_acc: 0.5786
Epoch 17/20
 - 0s - loss: 1.1075 - acc: 0.6496 - val_loss: 1.0493 - val_acc: 0.6749
Epoch 18/20
 - 0s - loss: 1.0312 - acc: 0.6432 - val_loss: 1.4443 - val_acc: 0.5318
Epoch 19/20
 - 0s - loss: 0.9812 - acc: 0.6496 - val_loss: 1.2072 - val_acc: 0.5872
Epoch 20/20
 - 0s - loss: 1.0476 - acc: 0.6667 - val_loss: 0.9033 - val_acc: 0.7066
Test loss: 0.9028823253631592
Test accuracy: 0.7073
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1066 - acc: 0.2778 - val_loss: 1.7964 - val_acc: 0.4671
Epoch 2/20
 - 0s - loss: 1.2593 - acc: 0.6239 - val_loss: 1.5160 - val_acc: 0.5434
Epoch 3/20
 - 0s - loss: 0.9179 - acc: 0.7179 - val_loss: 0.9746 - val_acc: 0.7208
Epoch 4/20
 - 0s - loss: 0.5058 - acc: 0.8932 - val_loss: 0.8887 - val_acc: 0.7255
Epoch 5/20
 - 0s - loss: 0.3172 - acc: 0.9444 - val_loss: 0.8366 - val_acc: 0.7370
Epoch 6/20
 - 0s - loss: 0.2894 - acc: 0.9316 - val_loss: 0.9535 - val_acc: 0.7101
Epoch 7/20
 - 0s - loss: 0.2645 - acc: 0.9359 - val_loss: 1.0334 - val_acc: 0.6841
Epoch 8/20
 - 0s - loss: 0.3207 - acc: 0.8889 - val_loss: 0.9137 - val_acc: 0.7273
Epoch 9/20
 - 0s - loss: 0.1387 - acc: 0.9658 - val_loss: 0.7240 - val_acc: 0.7724
Epoch 10/20
 - 0s - loss: 0.0904 - acc: 0.9872 - val_loss: 0.7161 - val_acc: 0.7785
Epoch 11/20
 - 0s - loss: 0.0709 - acc: 1.0000 - val_loss: 0.7840 - val_acc: 0.7664
Epoch 12/20
 - 0s - loss: 0.0597 - acc: 0.9957 - val_loss: 0.7679 - val_acc: 0.7713
Epoch 13/20
 - 0s - loss: 0.0829 - acc: 0.9786 - val_loss: 0.7734 - val_acc: 0.7789
Epoch 14/20
 - 0s - loss: 0.0547 - acc: 1.0000 - val_loss: 0.7393 - val_acc: 0.7808
Epoch 15/20
 - 0s - loss: 0.0264 - acc: 1.0000 - val_loss: 0.7418 - val_acc: 0.7848
Epoch 16/20
 - 0s - loss: 0.0250 - acc: 1.0000 - val_loss: 0.7601 - val_acc: 0.7854
Epoch 17/20
 - 0s - loss: 0.0186 - acc: 1.0000 - val_loss: 0.7596 - val_acc: 0.7852
Epoch 18/20
 - 0s - loss: 0.0214 - acc: 1.0000 - val_loss: 0.8037 - val_acc: 0.7737
Epoch 19/20
 - 0s - loss: 0.0167 - acc: 1.0000 - val_loss: 0.8056 - val_acc: 0.7821
Epoch 20/20
 - 0s - loss: 0.0130 - acc: 1.0000 - val_loss: 0.7920 - val_acc: 0.7812
Test loss: 0.7919791124463081
Test accuracy: 0.7812
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.0422 - acc: 0.1068 - val_loss: 6.5368 - val_acc: 0.1034
Epoch 2/20
 - 0s - loss: 7.2646 - acc: 0.0769 - val_loss: 4.5720 - val_acc: 0.1177
Epoch 3/20
 - 0s - loss: 4.0161 - acc: 0.1197 - val_loss: 2.4720 - val_acc: 0.2723
Epoch 4/20
 - 0s - loss: 2.3737 - acc: 0.2137 - val_loss: 2.2302 - val_acc: 0.0985
Epoch 5/20
 - 0s - loss: 2.1500 - acc: 0.2137 - val_loss: 2.0909 - val_acc: 0.3118
Epoch 6/20
 - 0s - loss: 2.0698 - acc: 0.2436 - val_loss: 2.2372 - val_acc: 0.1846
Epoch 7/20
 - 0s - loss: 2.0360 - acc: 0.2735 - val_loss: 1.9812 - val_acc: 0.3850
Epoch 8/20
 - 0s - loss: 1.9013 - acc: 0.3761 - val_loss: 1.9508 - val_acc: 0.4456
Epoch 9/20
 - 0s - loss: 1.9097 - acc: 0.3889 - val_loss: 2.0066 - val_acc: 0.2702
Epoch 10/20
 - 0s - loss: 1.9152 - acc: 0.3761 - val_loss: 1.8564 - val_acc: 0.4588
Epoch 11/20
 - 0s - loss: 1.6929 - acc: 0.4615 - val_loss: 2.1363 - val_acc: 0.4224
Epoch 12/20
 - 0s - loss: 1.9444 - acc: 0.3974 - val_loss: 2.2399 - val_acc: 0.2749
Epoch 13/20
 - 0s - loss: 1.9419 - acc: 0.3846 - val_loss: 2.0010 - val_acc: 0.2560
Epoch 14/20
 - 0s - loss: 1.7790 - acc: 0.4017 - val_loss: 1.7402 - val_acc: 0.3986
Epoch 15/20
 - 0s - loss: 1.5311 - acc: 0.5556 - val_loss: 1.7611 - val_acc: 0.3959
Epoch 16/20
 - 0s - loss: 1.5887 - acc: 0.4444 - val_loss: 2.0002 - val_acc: 0.3863
Epoch 17/20
 - 0s - loss: 1.6996 - acc: 0.4872 - val_loss: 1.7329 - val_acc: 0.4138
Epoch 18/20
 - 0s - loss: 1.4902 - acc: 0.4957 - val_loss: 1.7195 - val_acc: 0.4489
Epoch 19/20
 - 0s - loss: 1.3943 - acc: 0.6154 - val_loss: 1.2394 - val_acc: 0.6117
Epoch 20/20
 - 0s - loss: 1.0272 - acc: 0.7308 - val_loss: 1.4560 - val_acc: 0.5466
Test loss: 1.4554490392684936
Test accuracy: 0.5456
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3046 - acc: 0.1538 - val_loss: 1.9871 - val_acc: 0.2845
Epoch 2/20
 - 0s - loss: 1.5544 - acc: 0.4188 - val_loss: 1.6376 - val_acc: 0.5087
Epoch 3/20
 - 0s - loss: 1.1716 - acc: 0.7863 - val_loss: 1.4732 - val_acc: 0.5283
Epoch 4/20
 - 0s - loss: 0.7553 - acc: 0.8547 - val_loss: 1.2465 - val_acc: 0.5860
Epoch 5/20
 - 0s - loss: 0.5125 - acc: 0.9231 - val_loss: 1.3047 - val_acc: 0.5660
Epoch 6/20
 - 0s - loss: 0.4510 - acc: 0.8974 - val_loss: 1.3152 - val_acc: 0.5793
Epoch 7/20
 - 0s - loss: 0.4032 - acc: 0.8718 - val_loss: 1.1059 - val_acc: 0.6459
Epoch 8/20
 - 0s - loss: 0.2389 - acc: 0.9658 - val_loss: 1.0881 - val_acc: 0.6390
Epoch 9/20
 - 0s - loss: 0.1350 - acc: 1.0000 - val_loss: 0.9635 - val_acc: 0.7170
Epoch 10/20
 - 0s - loss: 0.0989 - acc: 1.0000 - val_loss: 0.9590 - val_acc: 0.7002
Epoch 11/20
 - 0s - loss: 0.0739 - acc: 1.0000 - val_loss: 0.9612 - val_acc: 0.7131
Epoch 12/20
 - 0s - loss: 0.0495 - acc: 1.0000 - val_loss: 0.9785 - val_acc: 0.7092
Epoch 13/20
 - 0s - loss: 0.0448 - acc: 1.0000 - val_loss: 0.9874 - val_acc: 0.7066
Epoch 14/20
 - 0s - loss: 0.0359 - acc: 1.0000 - val_loss: 0.9878 - val_acc: 0.7100
Epoch 15/20
 - 0s - loss: 0.0302 - acc: 1.0000 - val_loss: 0.9746 - val_acc: 0.7126
Epoch 16/20
 - 0s - loss: 0.0322 - acc: 1.0000 - val_loss: 1.0124 - val_acc: 0.7104
Epoch 17/20
 - 0s - loss: 0.0231 - acc: 1.0000 - val_loss: 1.0001 - val_acc: 0.7173
Epoch 18/20
 - 0s - loss: 0.0184 - acc: 1.0000 - val_loss: 1.0227 - val_acc: 0.7133
Epoch 19/20
 - 0s - loss: 0.0184 - acc: 1.0000 - val_loss: 1.0406 - val_acc: 0.7077
Epoch 20/20
 - 0s - loss: 0.0157 - acc: 1.0000 - val_loss: 1.0563 - val_acc: 0.7069
Test loss: 1.0563430649280547
Test accuracy: 0.7069
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.8356 - acc: 0.0342 - val_loss: 6.9387 - val_acc: 0.1009
Epoch 2/20
 - 0s - loss: 6.4965 - acc: 0.1282 - val_loss: 5.1604 - val_acc: 0.0982
Epoch 3/20
 - 0s - loss: 5.0642 - acc: 0.0769 - val_loss: 5.2716 - val_acc: 0.2129
Epoch 4/20
 - 0s - loss: 5.1278 - acc: 0.1453 - val_loss: 3.8434 - val_acc: 0.1620
Epoch 5/20
 - 0s - loss: 4.1197 - acc: 0.1795 - val_loss: 2.8369 - val_acc: 0.1162
Epoch 6/20
 - 0s - loss: 2.8754 - acc: 0.2137 - val_loss: 2.3209 - val_acc: 0.2199
Epoch 7/20
 - 0s - loss: 2.2390 - acc: 0.2650 - val_loss: 2.2662 - val_acc: 0.1280
Epoch 8/20
 - 0s - loss: 2.1613 - acc: 0.2393 - val_loss: 2.1795 - val_acc: 0.2584
Epoch 9/20
 - 0s - loss: 2.0635 - acc: 0.2735 - val_loss: 2.0999 - val_acc: 0.1847
Epoch 10/20
 - 0s - loss: 1.9320 - acc: 0.3504 - val_loss: 2.1073 - val_acc: 0.1663
Epoch 11/20
 - 0s - loss: 1.9769 - acc: 0.2650 - val_loss: 2.2769 - val_acc: 0.1587
Epoch 12/20
 - 0s - loss: 2.0522 - acc: 0.2821 - val_loss: 2.0028 - val_acc: 0.3773
Epoch 13/20
 - 0s - loss: 1.8323 - acc: 0.4188 - val_loss: 1.9883 - val_acc: 0.2774
Epoch 14/20
 - 0s - loss: 1.6930 - acc: 0.4274 - val_loss: 2.0341 - val_acc: 0.2624
Epoch 15/20
 - 0s - loss: 1.8069 - acc: 0.3419 - val_loss: 2.1230 - val_acc: 0.3226
Epoch 16/20
 - 0s - loss: 1.8784 - acc: 0.4359 - val_loss: 1.9103 - val_acc: 0.4422
Epoch 17/20
 - 0s - loss: 1.6229 - acc: 0.5470 - val_loss: 1.8509 - val_acc: 0.3642
Epoch 18/20
 - 0s - loss: 1.4895 - acc: 0.4872 - val_loss: 1.8803 - val_acc: 0.2436
Epoch 19/20
 - 0s - loss: 1.5779 - acc: 0.4274 - val_loss: 2.1796 - val_acc: 0.3774
Epoch 20/20
 - 0s - loss: 1.8369 - acc: 0.4786 - val_loss: 1.9616 - val_acc: 0.3120
Test loss: 1.9615602432250976
Test accuracy: 0.3121
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2424 - acc: 0.9254 - val_loss: 0.1261 - val_acc: 0.9617
Epoch 2/20
 - 3s - loss: 0.1037 - acc: 0.9693 - val_loss: 0.0866 - val_acc: 0.9725
Epoch 3/20
 - 3s - loss: 0.0742 - acc: 0.9773 - val_loss: 0.0709 - val_acc: 0.9792
Epoch 4/20
 - 3s - loss: 0.0612 - acc: 0.9818 - val_loss: 0.0608 - val_acc: 0.9827
Epoch 5/20
 - 3s - loss: 0.0504 - acc: 0.9851 - val_loss: 0.0691 - val_acc: 0.9827
Epoch 6/20
 - 3s - loss: 0.0434 - acc: 0.9873 - val_loss: 0.0765 - val_acc: 0.9822
Epoch 7/20
 - 3s - loss: 0.0400 - acc: 0.9884 - val_loss: 0.0855 - val_acc: 0.9800
Epoch 8/20
 - 3s - loss: 0.0327 - acc: 0.9903 - val_loss: 0.0910 - val_acc: 0.9795
Epoch 9/20
 - 3s - loss: 0.0322 - acc: 0.9907 - val_loss: 0.0807 - val_acc: 0.9822
Epoch 10/20
 - 3s - loss: 0.0279 - acc: 0.9918 - val_loss: 0.0852 - val_acc: 0.9827
Epoch 11/20
 - 3s - loss: 0.0259 - acc: 0.9929 - val_loss: 0.0861 - val_acc: 0.9840
Epoch 12/20
 - 3s - loss: 0.0257 - acc: 0.9924 - val_loss: 0.0819 - val_acc: 0.9850
Epoch 13/20
 - 3s - loss: 0.0249 - acc: 0.9930 - val_loss: 0.0929 - val_acc: 0.9822
Epoch 14/20
 - 3s - loss: 0.0205 - acc: 0.9943 - val_loss: 0.0955 - val_acc: 0.9835
Epoch 15/20
 - 3s - loss: 0.0215 - acc: 0.9944 - val_loss: 0.0917 - val_acc: 0.9832
Epoch 16/20
 - 3s - loss: 0.0221 - acc: 0.9940 - val_loss: 0.0901 - val_acc: 0.9838
Epoch 17/20
 - 3s - loss: 0.0205 - acc: 0.9947 - val_loss: 0.0962 - val_acc: 0.9834
Epoch 18/20
 - 3s - loss: 0.0180 - acc: 0.9952 - val_loss: 0.1115 - val_acc: 0.9822
Epoch 19/20
 - 3s - loss: 0.0155 - acc: 0.9958 - val_loss: 0.1075 - val_acc: 0.9835
Epoch 20/20
 - 3s - loss: 0.0162 - acc: 0.9957 - val_loss: 0.0976 - val_acc: 0.9867
Test loss: 0.09756149132570567
Test accuracy: 0.9867
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9382 - acc: 0.6946 - val_loss: 0.3590 - val_acc: 0.8864
Epoch 2/20
 - 5s - loss: 0.4303 - acc: 0.8614 - val_loss: 0.3059 - val_acc: 0.9034
Epoch 3/20
 - 5s - loss: 0.3235 - acc: 0.8993 - val_loss: 0.1996 - val_acc: 0.9378
Epoch 4/20
 - 5s - loss: 0.2670 - acc: 0.9169 - val_loss: 0.2753 - val_acc: 0.9054
Epoch 5/20
 - 5s - loss: 0.2409 - acc: 0.9253 - val_loss: 0.2140 - val_acc: 0.9334
Epoch 6/20
 - 5s - loss: 0.2148 - acc: 0.9344 - val_loss: 0.1912 - val_acc: 0.9377
Epoch 7/20
 - 5s - loss: 0.2026 - acc: 0.9376 - val_loss: 0.1404 - val_acc: 0.9567
Epoch 8/20
 - 5s - loss: 0.1955 - acc: 0.9404 - val_loss: 0.1584 - val_acc: 0.9549
Epoch 9/20
 - 4s - loss: 0.1847 - acc: 0.9446 - val_loss: 0.1314 - val_acc: 0.9598
Epoch 10/20
 - 5s - loss: 0.1788 - acc: 0.9455 - val_loss: 0.1175 - val_acc: 0.9657
Epoch 11/20
 - 5s - loss: 0.1730 - acc: 0.9495 - val_loss: 0.1087 - val_acc: 0.9667
Epoch 12/20
 - 5s - loss: 0.1725 - acc: 0.9486 - val_loss: 0.1365 - val_acc: 0.9566
Epoch 13/20
 - 5s - loss: 0.1692 - acc: 0.9503 - val_loss: 0.0999 - val_acc: 0.9699
Epoch 14/20
 - 5s - loss: 0.1643 - acc: 0.9514 - val_loss: 0.1166 - val_acc: 0.9636
Epoch 15/20
 - 5s - loss: 0.1678 - acc: 0.9520 - val_loss: 0.1320 - val_acc: 0.9637
Epoch 16/20
 - 5s - loss: 0.1637 - acc: 0.9533 - val_loss: 0.1124 - val_acc: 0.9681
Epoch 17/20
 - 5s - loss: 0.1691 - acc: 0.9520 - val_loss: 0.1467 - val_acc: 0.9590
Epoch 18/20
 - 5s - loss: 0.1657 - acc: 0.9529 - val_loss: 0.1165 - val_acc: 0.9702
Epoch 19/20
 - 5s - loss: 0.1676 - acc: 0.9527 - val_loss: 0.1022 - val_acc: 0.9717
Epoch 20/20
 - 5s - loss: 0.1649 - acc: 0.9543 - val_loss: 0.1028 - val_acc: 0.9709
Test loss: 0.1022803298778832
Test accuracy: 0.9705
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.3402 - acc: 0.8956 - val_loss: 0.1586 - val_acc: 0.9515
Epoch 2/20
 - 1s - loss: 0.1327 - acc: 0.9590 - val_loss: 0.1140 - val_acc: 0.9647
Epoch 3/20
 - 1s - loss: 0.0881 - acc: 0.9725 - val_loss: 0.0894 - val_acc: 0.9744
Epoch 4/20
 - 1s - loss: 0.0674 - acc: 0.9794 - val_loss: 0.0847 - val_acc: 0.9760
Epoch 5/20
 - 1s - loss: 0.0525 - acc: 0.9830 - val_loss: 0.1046 - val_acc: 0.9739
Epoch 6/20
 - 1s - loss: 0.0448 - acc: 0.9863 - val_loss: 0.0931 - val_acc: 0.9756
Epoch 7/20
 - 1s - loss: 0.0340 - acc: 0.9891 - val_loss: 0.0904 - val_acc: 0.9794
Epoch 8/20
 - 1s - loss: 0.0315 - acc: 0.9898 - val_loss: 0.1041 - val_acc: 0.9758
Epoch 9/20
 - 1s - loss: 0.0285 - acc: 0.9911 - val_loss: 0.1271 - val_acc: 0.9722
Epoch 10/20
 - 1s - loss: 0.0234 - acc: 0.9928 - val_loss: 0.1162 - val_acc: 0.9771
Epoch 11/20
 - 1s - loss: 0.0203 - acc: 0.9934 - val_loss: 0.1147 - val_acc: 0.9771
Epoch 12/20
 - 1s - loss: 0.0211 - acc: 0.9934 - val_loss: 0.1201 - val_acc: 0.9785
Epoch 13/20
 - 1s - loss: 0.0194 - acc: 0.9940 - val_loss: 0.1366 - val_acc: 0.9758
Epoch 14/20
 - 1s - loss: 0.0170 - acc: 0.9948 - val_loss: 0.1308 - val_acc: 0.9788
Epoch 15/20
 - 1s - loss: 0.0155 - acc: 0.9948 - val_loss: 0.1370 - val_acc: 0.9775
Epoch 16/20
 - 1s - loss: 0.0140 - acc: 0.9955 - val_loss: 0.1373 - val_acc: 0.9796
Epoch 17/20
 - 1s - loss: 0.0150 - acc: 0.9951 - val_loss: 0.1350 - val_acc: 0.9785
Epoch 18/20
 - 1s - loss: 0.0127 - acc: 0.9961 - val_loss: 0.1445 - val_acc: 0.9784
Epoch 19/20
 - 1s - loss: 0.0134 - acc: 0.9963 - val_loss: 0.1424 - val_acc: 0.9791
Epoch 20/20
 - 1s - loss: 0.0140 - acc: 0.9959 - val_loss: 0.1332 - val_acc: 0.9798
Test loss: 0.1332125388532221
Test accuracy: 0.9798
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2631 - acc: 0.5934 - val_loss: 0.6200 - val_acc: 0.7910
Epoch 2/20
 - 2s - loss: 0.6235 - acc: 0.7996 - val_loss: 0.4523 - val_acc: 0.8517
Epoch 3/20
 - 2s - loss: 0.4695 - acc: 0.8482 - val_loss: 0.4487 - val_acc: 0.8450
Epoch 4/20
 - 2s - loss: 0.3907 - acc: 0.8782 - val_loss: 0.5165 - val_acc: 0.8523
Epoch 5/20
 - 2s - loss: 0.3386 - acc: 0.8947 - val_loss: 0.2397 - val_acc: 0.9268
Epoch 6/20
 - 2s - loss: 0.2910 - acc: 0.9068 - val_loss: 0.1893 - val_acc: 0.9424
Epoch 7/20
 - 2s - loss: 0.2707 - acc: 0.9150 - val_loss: 0.4203 - val_acc: 0.8643
Epoch 8/20
 - 2s - loss: 0.2518 - acc: 0.9195 - val_loss: 0.2618 - val_acc: 0.9174
Epoch 9/20
 - 2s - loss: 0.2283 - acc: 0.9295 - val_loss: 0.1774 - val_acc: 0.9437
Epoch 10/20
 - 2s - loss: 0.2186 - acc: 0.9312 - val_loss: 0.1552 - val_acc: 0.9494
Epoch 11/20
 - 2s - loss: 0.2037 - acc: 0.9362 - val_loss: 0.1420 - val_acc: 0.9551
Epoch 12/20
 - 2s - loss: 0.2014 - acc: 0.9365 - val_loss: 0.3506 - val_acc: 0.8900
Epoch 13/20
 - 2s - loss: 0.1957 - acc: 0.9392 - val_loss: 0.1962 - val_acc: 0.9424
Epoch 14/20
 - 2s - loss: 0.1826 - acc: 0.9431 - val_loss: 0.1504 - val_acc: 0.9531
Epoch 15/20
 - 2s - loss: 0.1816 - acc: 0.9447 - val_loss: 0.1253 - val_acc: 0.9603
Epoch 16/20
 - 3s - loss: 0.1704 - acc: 0.9468 - val_loss: 0.1403 - val_acc: 0.9596
Epoch 17/20
 - 2s - loss: 0.1694 - acc: 0.9468 - val_loss: 0.1674 - val_acc: 0.9472
Epoch 18/20
 - 2s - loss: 0.1657 - acc: 0.9484 - val_loss: 0.1233 - val_acc: 0.9621
Epoch 19/20
 - 2s - loss: 0.1597 - acc: 0.9507 - val_loss: 0.1717 - val_acc: 0.9500
Epoch 20/20
 - 2s - loss: 0.1554 - acc: 0.9527 - val_loss: 0.1955 - val_acc: 0.9485
Test loss: 0.19580475614792667
Test accuracy: 0.9488
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4566 - acc: 0.8602 - val_loss: 0.2667 - val_acc: 0.9159
Epoch 2/20
 - 1s - loss: 0.1811 - acc: 0.9445 - val_loss: 0.1481 - val_acc: 0.9533
Epoch 3/20
 - 1s - loss: 0.1223 - acc: 0.9633 - val_loss: 0.2105 - val_acc: 0.9322
Epoch 4/20
 - 1s - loss: 0.0832 - acc: 0.9735 - val_loss: 0.1375 - val_acc: 0.9592
Epoch 5/20
 - 1s - loss: 0.0628 - acc: 0.9794 - val_loss: 0.1460 - val_acc: 0.9607
Epoch 6/20
 - 1s - loss: 0.0476 - acc: 0.9841 - val_loss: 0.1303 - val_acc: 0.9672
Epoch 7/20
 - 1s - loss: 0.0402 - acc: 0.9865 - val_loss: 0.1330 - val_acc: 0.9658
Epoch 8/20
 - 1s - loss: 0.0338 - acc: 0.9888 - val_loss: 0.1288 - val_acc: 0.9684
Epoch 9/20
 - 1s - loss: 0.0247 - acc: 0.9918 - val_loss: 0.1383 - val_acc: 0.9697
Epoch 10/20
 - 1s - loss: 0.0235 - acc: 0.9921 - val_loss: 0.1410 - val_acc: 0.9686
Epoch 11/20
 - 1s - loss: 0.0200 - acc: 0.9933 - val_loss: 0.1471 - val_acc: 0.9668
Epoch 12/20
 - 1s - loss: 0.0154 - acc: 0.9942 - val_loss: 0.1564 - val_acc: 0.9710
Epoch 13/20
 - 1s - loss: 0.0149 - acc: 0.9948 - val_loss: 0.1600 - val_acc: 0.9692
Epoch 14/20
 - 1s - loss: 0.0138 - acc: 0.9952 - val_loss: 0.1730 - val_acc: 0.9694
Epoch 15/20
 - 1s - loss: 0.0150 - acc: 0.9956 - val_loss: 0.1771 - val_acc: 0.9685
Epoch 16/20
 - 1s - loss: 0.0099 - acc: 0.9969 - val_loss: 0.1719 - val_acc: 0.9718
Epoch 17/20
 - 1s - loss: 0.0105 - acc: 0.9966 - val_loss: 0.1561 - val_acc: 0.9717
Epoch 18/20
 - 1s - loss: 0.0115 - acc: 0.9963 - val_loss: 0.2224 - val_acc: 0.9638
Epoch 19/20
 - 1s - loss: 0.0096 - acc: 0.9965 - val_loss: 0.2274 - val_acc: 0.9653
Epoch 20/20
 - 1s - loss: 0.0106 - acc: 0.9969 - val_loss: 0.1960 - val_acc: 0.9698
Test loss: 0.19596084775535647
Test accuracy: 0.9698
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6212 - acc: 0.4933 - val_loss: 1.4181 - val_acc: 0.5524
Epoch 2/20
 - 1s - loss: 0.8374 - acc: 0.7239 - val_loss: 1.0826 - val_acc: 0.6725
Epoch 3/20
 - 1s - loss: 0.6565 - acc: 0.7855 - val_loss: 0.5962 - val_acc: 0.7820
Epoch 4/20
 - 1s - loss: 0.5423 - acc: 0.8268 - val_loss: 0.7107 - val_acc: 0.7778
Epoch 5/20
 - 1s - loss: 0.4807 - acc: 0.8480 - val_loss: 1.1019 - val_acc: 0.6684
Epoch 6/20
 - 1s - loss: 0.4284 - acc: 0.8634 - val_loss: 0.4721 - val_acc: 0.8388
Epoch 7/20
 - 1s - loss: 0.3881 - acc: 0.8766 - val_loss: 0.5958 - val_acc: 0.7930
Epoch 8/20
 - 1s - loss: 0.3458 - acc: 0.8917 - val_loss: 0.7139 - val_acc: 0.7957
Epoch 9/20
 - 1s - loss: 0.3174 - acc: 0.9001 - val_loss: 0.6874 - val_acc: 0.7948
Epoch 10/20
 - 1s - loss: 0.3022 - acc: 0.9046 - val_loss: 0.5560 - val_acc: 0.8137
Epoch 11/20
 - 1s - loss: 0.2805 - acc: 0.9095 - val_loss: 0.7233 - val_acc: 0.7848
Epoch 12/20
 - 1s - loss: 0.2632 - acc: 0.9158 - val_loss: 0.2237 - val_acc: 0.9317
Epoch 13/20
 - 1s - loss: 0.2544 - acc: 0.9198 - val_loss: 0.2495 - val_acc: 0.9212
Epoch 14/20
 - 1s - loss: 0.2342 - acc: 0.9265 - val_loss: 0.1709 - val_acc: 0.9480
Epoch 15/20
 - 1s - loss: 0.2359 - acc: 0.9265 - val_loss: 0.2916 - val_acc: 0.9039
Epoch 16/20
 - 1s - loss: 0.2260 - acc: 0.9303 - val_loss: 0.4515 - val_acc: 0.8680
Epoch 17/20
 - 1s - loss: 0.2082 - acc: 0.9328 - val_loss: 0.3846 - val_acc: 0.8866
Epoch 18/20
 - 1s - loss: 0.2089 - acc: 0.9334 - val_loss: 0.1994 - val_acc: 0.9397
Epoch 19/20
 - 1s - loss: 0.1933 - acc: 0.9389 - val_loss: 0.3099 - val_acc: 0.9005
Epoch 20/20
 - 1s - loss: 0.1896 - acc: 0.9435 - val_loss: 0.2612 - val_acc: 0.9217
Test loss: 0.261398593980819
Test accuracy: 0.9219
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.5930 - acc: 0.8147 - val_loss: 0.3521 - val_acc: 0.8911
Epoch 2/20
 - 0s - loss: 0.2534 - acc: 0.9244 - val_loss: 0.3394 - val_acc: 0.8868
Epoch 3/20
 - 0s - loss: 0.1660 - acc: 0.9471 - val_loss: 0.2708 - val_acc: 0.9138
Epoch 4/20
 - 0s - loss: 0.1175 - acc: 0.9647 - val_loss: 0.1921 - val_acc: 0.9442
Epoch 5/20
 - 0s - loss: 0.0891 - acc: 0.9717 - val_loss: 0.1744 - val_acc: 0.9446
Epoch 6/20
 - 0s - loss: 0.0628 - acc: 0.9800 - val_loss: 0.1587 - val_acc: 0.9539
Epoch 7/20
 - 0s - loss: 0.0439 - acc: 0.9875 - val_loss: 0.1869 - val_acc: 0.9497
Epoch 8/20
 - 0s - loss: 0.0346 - acc: 0.9908 - val_loss: 0.2047 - val_acc: 0.9460
Epoch 9/20
 - 0s - loss: 0.0312 - acc: 0.9907 - val_loss: 0.1790 - val_acc: 0.9554
Epoch 10/20
 - 0s - loss: 0.0204 - acc: 0.9936 - val_loss: 0.2176 - val_acc: 0.9514
Epoch 11/20
 - 0s - loss: 0.0176 - acc: 0.9945 - val_loss: 0.2100 - val_acc: 0.9534
Epoch 12/20
 - 0s - loss: 0.0136 - acc: 0.9956 - val_loss: 0.2482 - val_acc: 0.9502
Epoch 13/20
 - 0s - loss: 0.0140 - acc: 0.9961 - val_loss: 0.2310 - val_acc: 0.9538
Epoch 14/20
 - 0s - loss: 0.0114 - acc: 0.9965 - val_loss: 0.2360 - val_acc: 0.9550
Epoch 15/20
 - 0s - loss: 0.0132 - acc: 0.9960 - val_loss: 0.2117 - val_acc: 0.9580
Epoch 16/20
 - 0s - loss: 0.0131 - acc: 0.9957 - val_loss: 0.2278 - val_acc: 0.9550
Epoch 17/20
 - 0s - loss: 0.0102 - acc: 0.9969 - val_loss: 0.2428 - val_acc: 0.9537
Epoch 18/20
 - 0s - loss: 0.0073 - acc: 0.9973 - val_loss: 0.2484 - val_acc: 0.9577
Epoch 19/20
 - 0s - loss: 0.0083 - acc: 0.9980 - val_loss: 0.2881 - val_acc: 0.9513
Epoch 20/20
 - 0s - loss: 0.0105 - acc: 0.9969 - val_loss: 0.2558 - val_acc: 0.9562
Test loss: 0.25580396731424054
Test accuracy: 0.9562
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0212 - acc: 0.3604 - val_loss: 1.1815 - val_acc: 0.6061
Epoch 2/20
 - 1s - loss: 1.0977 - acc: 0.6369 - val_loss: 0.7721 - val_acc: 0.7539
Epoch 3/20
 - 1s - loss: 0.8721 - acc: 0.7160 - val_loss: 0.7226 - val_acc: 0.7399
Epoch 4/20
 - 1s - loss: 0.7445 - acc: 0.7508 - val_loss: 0.5679 - val_acc: 0.8216
Epoch 5/20
 - 1s - loss: 0.6385 - acc: 0.7949 - val_loss: 0.4815 - val_acc: 0.8421
Epoch 6/20
 - 1s - loss: 0.5926 - acc: 0.8073 - val_loss: 0.4082 - val_acc: 0.8681
Epoch 7/20
 - 1s - loss: 0.5322 - acc: 0.8272 - val_loss: 0.5796 - val_acc: 0.7968
Epoch 8/20
 - 1s - loss: 0.4814 - acc: 0.8381 - val_loss: 0.3856 - val_acc: 0.8789
Epoch 9/20
 - 1s - loss: 0.4694 - acc: 0.8535 - val_loss: 0.8411 - val_acc: 0.7155
Epoch 10/20
 - 1s - loss: 0.3976 - acc: 0.8708 - val_loss: 0.2796 - val_acc: 0.9138
Epoch 11/20
 - 1s - loss: 0.4227 - acc: 0.8657 - val_loss: 0.3071 - val_acc: 0.9048
Epoch 12/20
 - 1s - loss: 0.3623 - acc: 0.8857 - val_loss: 0.2880 - val_acc: 0.9139
Epoch 13/20
 - 1s - loss: 0.3482 - acc: 0.8921 - val_loss: 0.3455 - val_acc: 0.8899
Epoch 14/20
 - 1s - loss: 0.3392 - acc: 0.8895 - val_loss: 0.3100 - val_acc: 0.9010
Epoch 15/20
 - 1s - loss: 0.3051 - acc: 0.8992 - val_loss: 0.5313 - val_acc: 0.8351
Epoch 16/20
 - 1s - loss: 0.2975 - acc: 0.9065 - val_loss: 0.8769 - val_acc: 0.7322
Epoch 17/20
 - 1s - loss: 0.2899 - acc: 0.9056 - val_loss: 0.2521 - val_acc: 0.9220
Epoch 18/20
 - 1s - loss: 0.2896 - acc: 0.9079 - val_loss: 0.5038 - val_acc: 0.8503
Epoch 19/20
 - 1s - loss: 0.2616 - acc: 0.9120 - val_loss: 0.2616 - val_acc: 0.9182
Epoch 20/20
 - 1s - loss: 0.2463 - acc: 0.9211 - val_loss: 0.6996 - val_acc: 0.7992
Test loss: 0.6994598669454455
Test accuracy: 0.8011
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.8373 - acc: 0.7341 - val_loss: 0.5617 - val_acc: 0.8130
Epoch 2/20
 - 0s - loss: 0.3500 - acc: 0.8963 - val_loss: 0.4243 - val_acc: 0.8606
Epoch 3/20
 - 0s - loss: 0.2287 - acc: 0.9320 - val_loss: 0.3452 - val_acc: 0.8954
Epoch 4/20
 - 0s - loss: 0.1712 - acc: 0.9501 - val_loss: 0.3363 - val_acc: 0.8963
Epoch 5/20
 - 0s - loss: 0.1240 - acc: 0.9648 - val_loss: 0.2694 - val_acc: 0.9174
Epoch 6/20
 - 0s - loss: 0.0954 - acc: 0.9723 - val_loss: 0.2178 - val_acc: 0.9361
Epoch 7/20
 - 0s - loss: 0.0763 - acc: 0.9763 - val_loss: 0.2795 - val_acc: 0.9167
Epoch 8/20
 - 0s - loss: 0.0539 - acc: 0.9835 - val_loss: 0.2028 - val_acc: 0.9427
Epoch 9/20
 - 0s - loss: 0.0395 - acc: 0.9883 - val_loss: 0.2470 - val_acc: 0.9283
Epoch 10/20
 - 0s - loss: 0.0322 - acc: 0.9904 - val_loss: 0.2352 - val_acc: 0.9381
Epoch 11/20
 - 0s - loss: 0.0216 - acc: 0.9949 - val_loss: 0.2432 - val_acc: 0.9361
Epoch 12/20
 - 0s - loss: 0.0259 - acc: 0.9920 - val_loss: 0.2654 - val_acc: 0.9323
Epoch 13/20
 - 0s - loss: 0.0115 - acc: 0.9976 - val_loss: 0.2572 - val_acc: 0.9394
Epoch 14/20
 - 0s - loss: 0.0088 - acc: 0.9987 - val_loss: 0.2784 - val_acc: 0.9389
Epoch 15/20
 - 0s - loss: 0.0272 - acc: 0.9904 - val_loss: 0.2580 - val_acc: 0.9418
Epoch 16/20
 - 0s - loss: 0.0038 - acc: 0.9989 - val_loss: 0.2550 - val_acc: 0.9446
Epoch 17/20
 - 0s - loss: 0.0029 - acc: 1.0000 - val_loss: 0.4582 - val_acc: 0.9103
Epoch 18/20
 - 0s - loss: 0.0124 - acc: 0.9971 - val_loss: 0.2738 - val_acc: 0.9447
Epoch 19/20
 - 0s - loss: 0.0076 - acc: 0.9981 - val_loss: 0.3136 - val_acc: 0.9362
Epoch 20/20
 - 0s - loss: 0.0046 - acc: 0.9987 - val_loss: 0.3584 - val_acc: 0.9332
Test loss: 0.35839438282395714
Test accuracy: 0.9332
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6147 - acc: 0.2891 - val_loss: 1.8871 - val_acc: 0.2801
Epoch 2/20
 - 1s - loss: 1.6693 - acc: 0.4445 - val_loss: 1.2558 - val_acc: 0.5775
Epoch 3/20
 - 1s - loss: 1.2146 - acc: 0.5824 - val_loss: 1.2250 - val_acc: 0.5664
Epoch 4/20
 - 1s - loss: 1.0258 - acc: 0.6611 - val_loss: 1.2523 - val_acc: 0.5904
Epoch 5/20
 - 1s - loss: 0.8917 - acc: 0.7112 - val_loss: 0.9289 - val_acc: 0.6716
Epoch 6/20
 - 1s - loss: 0.8515 - acc: 0.7211 - val_loss: 0.8940 - val_acc: 0.6820
Epoch 7/20
 - 1s - loss: 0.7497 - acc: 0.7563 - val_loss: 0.7161 - val_acc: 0.7320
Epoch 8/20
 - 1s - loss: 0.7478 - acc: 0.7616 - val_loss: 0.5915 - val_acc: 0.8085
Epoch 9/20
 - 1s - loss: 0.6618 - acc: 0.7893 - val_loss: 0.7610 - val_acc: 0.7471
Epoch 10/20
 - 1s - loss: 0.6634 - acc: 0.7829 - val_loss: 0.7532 - val_acc: 0.7306
Epoch 11/20
 - 1s - loss: 0.6029 - acc: 0.8040 - val_loss: 0.8951 - val_acc: 0.7069
Epoch 12/20
 - 1s - loss: 0.5234 - acc: 0.8293 - val_loss: 0.7381 - val_acc: 0.7553
Epoch 13/20
 - 1s - loss: 0.5215 - acc: 0.8251 - val_loss: 0.6581 - val_acc: 0.7750
Epoch 14/20
 - 1s - loss: 0.5315 - acc: 0.8347 - val_loss: 0.6115 - val_acc: 0.8029
Epoch 15/20
 - 1s - loss: 0.4961 - acc: 0.8363 - val_loss: 0.6877 - val_acc: 0.7634
Epoch 16/20
 - 1s - loss: 0.4708 - acc: 0.8459 - val_loss: 0.7974 - val_acc: 0.7684
Epoch 17/20
 - 1s - loss: 0.4765 - acc: 0.8480 - val_loss: 0.5026 - val_acc: 0.8432
Epoch 18/20
 - 1s - loss: 0.4117 - acc: 0.8632 - val_loss: 0.4762 - val_acc: 0.8442
Epoch 19/20
 - 1s - loss: 0.4279 - acc: 0.8571 - val_loss: 0.4353 - val_acc: 0.8555
Epoch 20/20
 - 1s - loss: 0.3972 - acc: 0.8709 - val_loss: 0.3980 - val_acc: 0.8713
Test loss: 0.3976531064018607
Test accuracy: 0.87
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1468 - acc: 0.6320 - val_loss: 0.5449 - val_acc: 0.8390
Epoch 2/20
 - 0s - loss: 0.4301 - acc: 0.8773 - val_loss: 0.6205 - val_acc: 0.8104
Epoch 3/20
 - 0s - loss: 0.3592 - acc: 0.8811 - val_loss: 0.3642 - val_acc: 0.8911
Epoch 4/20
 - 0s - loss: 0.2372 - acc: 0.9221 - val_loss: 0.4443 - val_acc: 0.8605
Epoch 5/20
 - 0s - loss: 0.1891 - acc: 0.9435 - val_loss: 0.3323 - val_acc: 0.9004
Epoch 6/20
 - 0s - loss: 0.1649 - acc: 0.9520 - val_loss: 0.3011 - val_acc: 0.9081
Epoch 7/20
 - 0s - loss: 0.0963 - acc: 0.9760 - val_loss: 0.2929 - val_acc: 0.9099
Epoch 8/20
 - 0s - loss: 0.0775 - acc: 0.9813 - val_loss: 0.3925 - val_acc: 0.8911
Epoch 9/20
 - 0s - loss: 0.0527 - acc: 0.9861 - val_loss: 0.4729 - val_acc: 0.8687
Epoch 10/20
 - 0s - loss: 0.0644 - acc: 0.9835 - val_loss: 0.3460 - val_acc: 0.9049
Epoch 11/20
 - 0s - loss: 0.0426 - acc: 0.9872 - val_loss: 0.2877 - val_acc: 0.9214
Epoch 12/20
 - 0s - loss: 0.0355 - acc: 0.9893 - val_loss: 0.3334 - val_acc: 0.9126
Epoch 13/20
 - 0s - loss: 0.0116 - acc: 0.9984 - val_loss: 0.4036 - val_acc: 0.9012
Epoch 14/20
 - 0s - loss: 0.0258 - acc: 0.9920 - val_loss: 0.3251 - val_acc: 0.9205
Epoch 15/20
 - 0s - loss: 0.0216 - acc: 0.9947 - val_loss: 0.3828 - val_acc: 0.9094
Epoch 16/20
 - 0s - loss: 0.0089 - acc: 0.9989 - val_loss: 0.3551 - val_acc: 0.9104
Epoch 17/20
 - 0s - loss: 0.0076 - acc: 0.9989 - val_loss: 0.3929 - val_acc: 0.9086
Epoch 18/20
 - 0s - loss: 0.0421 - acc: 0.9888 - val_loss: 0.3612 - val_acc: 0.9158
Epoch 19/20
 - 0s - loss: 0.0035 - acc: 1.0000 - val_loss: 0.3326 - val_acc: 0.9248
Epoch 20/20
 - 0s - loss: 0.0015 - acc: 1.0000 - val_loss: 0.3486 - val_acc: 0.9253
Test loss: 0.3486244113873545
Test accuracy: 0.9253
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2920 - acc: 0.1829 - val_loss: 2.1305 - val_acc: 0.2923
Epoch 2/20
 - 1s - loss: 1.9371 - acc: 0.3483 - val_loss: 1.6479 - val_acc: 0.4894
Epoch 3/20
 - 1s - loss: 1.6752 - acc: 0.4368 - val_loss: 1.6221 - val_acc: 0.4531
Epoch 4/20
 - 1s - loss: 1.4737 - acc: 0.5163 - val_loss: 1.7104 - val_acc: 0.3773
Epoch 5/20
 - 1s - loss: 1.2852 - acc: 0.5739 - val_loss: 0.9793 - val_acc: 0.6812
Epoch 6/20
 - 1s - loss: 1.0960 - acc: 0.6400 - val_loss: 1.1309 - val_acc: 0.6410
Epoch 7/20
 - 1s - loss: 1.1055 - acc: 0.6592 - val_loss: 1.5469 - val_acc: 0.5568
Epoch 8/20
 - 1s - loss: 1.0098 - acc: 0.6651 - val_loss: 0.9964 - val_acc: 0.6420
Epoch 9/20
 - 1s - loss: 0.9005 - acc: 0.6981 - val_loss: 0.8494 - val_acc: 0.7410
Epoch 10/20
 - 1s - loss: 0.8224 - acc: 0.7232 - val_loss: 0.7239 - val_acc: 0.7552
Epoch 11/20
 - 1s - loss: 0.7979 - acc: 0.7408 - val_loss: 0.8641 - val_acc: 0.6956
Epoch 12/20
 - 1s - loss: 0.7531 - acc: 0.7451 - val_loss: 0.6221 - val_acc: 0.7980
Epoch 13/20
 - 1s - loss: 0.7849 - acc: 0.7557 - val_loss: 0.5606 - val_acc: 0.8141
Epoch 14/20
 - 1s - loss: 0.6818 - acc: 0.7792 - val_loss: 0.7031 - val_acc: 0.7700
Epoch 15/20
 - 1s - loss: 0.6902 - acc: 0.7728 - val_loss: 0.5391 - val_acc: 0.8290
Epoch 16/20
 - 1s - loss: 0.7216 - acc: 0.7685 - val_loss: 0.4472 - val_acc: 0.8626
Epoch 17/20
 - 1s - loss: 0.6230 - acc: 0.8016 - val_loss: 0.6006 - val_acc: 0.8046
Epoch 18/20
 - 1s - loss: 0.5714 - acc: 0.8096 - val_loss: 0.4650 - val_acc: 0.8485
Epoch 19/20
 - 1s - loss: 0.6117 - acc: 0.8005 - val_loss: 0.9392 - val_acc: 0.6808
Epoch 20/20
 - 1s - loss: 0.5754 - acc: 0.8064 - val_loss: 0.4242 - val_acc: 0.8546
Test loss: 0.4234418308436871
Test accuracy: 0.8556
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5719 - acc: 0.5208 - val_loss: 0.8996 - val_acc: 0.7081
Epoch 2/20
 - 0s - loss: 0.6353 - acc: 0.8164 - val_loss: 0.7297 - val_acc: 0.7525
Epoch 3/20
 - 0s - loss: 0.4198 - acc: 0.8655 - val_loss: 0.6367 - val_acc: 0.7895
Epoch 4/20
 - 0s - loss: 0.3322 - acc: 0.9072 - val_loss: 0.6539 - val_acc: 0.7916
Epoch 5/20
 - 0s - loss: 0.2490 - acc: 0.9296 - val_loss: 0.4467 - val_acc: 0.8563
Epoch 6/20
 - 0s - loss: 0.1822 - acc: 0.9573 - val_loss: 0.6132 - val_acc: 0.8141
Epoch 7/20
 - 0s - loss: 0.1839 - acc: 0.9466 - val_loss: 0.4394 - val_acc: 0.8653
Epoch 8/20
 - 0s - loss: 0.1044 - acc: 0.9776 - val_loss: 0.4368 - val_acc: 0.8689
Epoch 9/20
 - 0s - loss: 0.1146 - acc: 0.9637 - val_loss: 0.5243 - val_acc: 0.8463
Epoch 10/20
 - 0s - loss: 0.0740 - acc: 0.9883 - val_loss: 0.4282 - val_acc: 0.8733
Epoch 11/20
 - 0s - loss: 0.0447 - acc: 0.9915 - val_loss: 0.4244 - val_acc: 0.8849
Epoch 12/20
 - 0s - loss: 0.0447 - acc: 0.9872 - val_loss: 0.4820 - val_acc: 0.8720
Epoch 13/20
 - 0s - loss: 0.0281 - acc: 0.9947 - val_loss: 0.7892 - val_acc: 0.8054
Epoch 14/20
 - 0s - loss: 0.0510 - acc: 0.9872 - val_loss: 0.4068 - val_acc: 0.8874
Epoch 15/20
 - 0s - loss: 0.0101 - acc: 1.0000 - val_loss: 0.3966 - val_acc: 0.8984
Epoch 16/20
 - 0s - loss: 0.0070 - acc: 1.0000 - val_loss: 0.4351 - val_acc: 0.8918
Epoch 17/20
 - 0s - loss: 0.0073 - acc: 1.0000 - val_loss: 0.4148 - val_acc: 0.8994
Epoch 18/20
 - 0s - loss: 0.0058 - acc: 1.0000 - val_loss: 0.6413 - val_acc: 0.8501
Epoch 19/20
 - 0s - loss: 0.0836 - acc: 0.9701 - val_loss: 0.4125 - val_acc: 0.8986
Epoch 20/20
 - 0s - loss: 0.0061 - acc: 1.0000 - val_loss: 0.4237 - val_acc: 0.8958
Test loss: 0.4236775776501745
Test accuracy: 0.8958
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.4237 - acc: 0.1345 - val_loss: 2.3520 - val_acc: 0.1032
Epoch 2/20
 - 1s - loss: 2.1462 - acc: 0.2465 - val_loss: 2.3134 - val_acc: 0.2974
Epoch 3/20
 - 1s - loss: 1.9580 - acc: 0.3522 - val_loss: 2.1471 - val_acc: 0.2524
Epoch 4/20
 - 1s - loss: 1.9393 - acc: 0.3554 - val_loss: 1.9228 - val_acc: 0.2197
Epoch 5/20
 - 0s - loss: 1.7251 - acc: 0.4290 - val_loss: 1.8569 - val_acc: 0.3264
Epoch 6/20
 - 1s - loss: 1.5619 - acc: 0.5187 - val_loss: 1.7860 - val_acc: 0.4586
Epoch 7/20
 - 1s - loss: 1.4429 - acc: 0.5464 - val_loss: 1.7117 - val_acc: 0.3748
Epoch 8/20
 - 1s - loss: 1.3668 - acc: 0.5518 - val_loss: 1.5093 - val_acc: 0.4919
Epoch 9/20
 - 1s - loss: 1.2765 - acc: 0.5955 - val_loss: 1.4747 - val_acc: 0.5416
Epoch 10/20
 - 1s - loss: 1.1382 - acc: 0.6201 - val_loss: 1.6272 - val_acc: 0.4923
Epoch 11/20
 - 1s - loss: 1.2688 - acc: 0.6041 - val_loss: 1.1575 - val_acc: 0.5741
Epoch 12/20
 - 1s - loss: 0.8641 - acc: 0.7247 - val_loss: 1.5409 - val_acc: 0.5396
Epoch 13/20
 - 1s - loss: 1.2627 - acc: 0.6147 - val_loss: 1.0651 - val_acc: 0.6098
Epoch 14/20
 - 1s - loss: 0.8837 - acc: 0.7236 - val_loss: 0.8652 - val_acc: 0.6794
Epoch 15/20
 - 1s - loss: 0.9484 - acc: 0.6873 - val_loss: 0.8585 - val_acc: 0.7160
Epoch 16/20
 - 0s - loss: 0.9515 - acc: 0.7022 - val_loss: 0.9232 - val_acc: 0.6832
Epoch 17/20
 - 1s - loss: 0.8474 - acc: 0.7204 - val_loss: 0.8093 - val_acc: 0.6965
Epoch 18/20
 - 1s - loss: 0.8428 - acc: 0.7140 - val_loss: 0.7834 - val_acc: 0.7480
Epoch 19/20
 - 1s - loss: 0.7925 - acc: 0.7268 - val_loss: 0.7348 - val_acc: 0.7540
Epoch 20/20
 - 1s - loss: 0.7677 - acc: 0.7407 - val_loss: 1.2870 - val_acc: 0.6036
Test loss: 1.2864440383911133
Test accuracy: 0.6041
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 1.8796 - acc: 0.3654 - val_loss: 1.3367 - val_acc: 0.5604
Epoch 2/20
 - 0s - loss: 0.7723 - acc: 0.8184 - val_loss: 0.8550 - val_acc: 0.7305
Epoch 3/20
 - 0s - loss: 0.4373 - acc: 0.8846 - val_loss: 0.7904 - val_acc: 0.7232
Epoch 4/20
 - 0s - loss: 0.3868 - acc: 0.8782 - val_loss: 0.6302 - val_acc: 0.8002
Epoch 5/20
 - 0s - loss: 0.2172 - acc: 0.9509 - val_loss: 0.5448 - val_acc: 0.8228
Epoch 6/20
 - 0s - loss: 0.1581 - acc: 0.9701 - val_loss: 0.6323 - val_acc: 0.7991
Epoch 7/20
 - 0s - loss: 0.1608 - acc: 0.9530 - val_loss: 0.6466 - val_acc: 0.7890
Epoch 8/20
 - 0s - loss: 0.0992 - acc: 0.9744 - val_loss: 0.5510 - val_acc: 0.8253
Epoch 9/20
 - 0s - loss: 0.0782 - acc: 0.9850 - val_loss: 0.5490 - val_acc: 0.8384
Epoch 10/20
 - 0s - loss: 0.0514 - acc: 0.9957 - val_loss: 0.5442 - val_acc: 0.8360
Epoch 11/20
 - 0s - loss: 0.0493 - acc: 0.9915 - val_loss: 0.6347 - val_acc: 0.8194
Epoch 12/20
 - 0s - loss: 0.0541 - acc: 0.9893 - val_loss: 0.5191 - val_acc: 0.8466
Epoch 13/20
 - 0s - loss: 0.0204 - acc: 1.0000 - val_loss: 0.5388 - val_acc: 0.8464
Epoch 14/20
 - 0s - loss: 0.0221 - acc: 0.9979 - val_loss: 0.6748 - val_acc: 0.8230
Epoch 15/20
 - 0s - loss: 0.0498 - acc: 0.9915 - val_loss: 0.5569 - val_acc: 0.8532
Epoch 16/20
 - 0s - loss: 0.0107 - acc: 1.0000 - val_loss: 0.5565 - val_acc: 0.8516
Epoch 17/20
 - 0s - loss: 0.0073 - acc: 1.0000 - val_loss: 0.5401 - val_acc: 0.8586
Epoch 18/20
 - 0s - loss: 0.0069 - acc: 1.0000 - val_loss: 0.5612 - val_acc: 0.8561
Epoch 19/20
 - 0s - loss: 0.0086 - acc: 1.0000 - val_loss: 0.5614 - val_acc: 0.8491
Epoch 20/20
 - 0s - loss: 0.0044 - acc: 1.0000 - val_loss: 0.5884 - val_acc: 0.8562
Test loss: 0.5884063540905714
Test accuracy: 0.8562
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.1834 - acc: 0.1111 - val_loss: 2.4102 - val_acc: 0.1977
Epoch 2/20
 - 0s - loss: 2.2779 - acc: 0.2051 - val_loss: 2.4343 - val_acc: 0.1146
Epoch 3/20
 - 0s - loss: 2.1930 - acc: 0.2372 - val_loss: 2.0088 - val_acc: 0.2641
Epoch 4/20
 - 0s - loss: 1.8899 - acc: 0.3632 - val_loss: 2.2341 - val_acc: 0.1812
Epoch 5/20
 - 0s - loss: 2.1377 - acc: 0.2799 - val_loss: 2.0297 - val_acc: 0.2009
Epoch 6/20
 - 0s - loss: 1.8986 - acc: 0.3269 - val_loss: 1.7266 - val_acc: 0.4203
Epoch 7/20
 - 0s - loss: 1.7739 - acc: 0.4274 - val_loss: 2.0824 - val_acc: 0.2287
Epoch 8/20
 - 0s - loss: 1.7517 - acc: 0.3632 - val_loss: 1.6448 - val_acc: 0.5476
Epoch 9/20
 - 0s - loss: 1.6734 - acc: 0.4209 - val_loss: 1.8710 - val_acc: 0.4484
Epoch 10/20
 - 0s - loss: 1.4247 - acc: 0.5705 - val_loss: 1.3434 - val_acc: 0.5877
Epoch 11/20
 - 0s - loss: 1.6139 - acc: 0.5064 - val_loss: 1.7540 - val_acc: 0.3286
Epoch 12/20
 - 0s - loss: 1.3025 - acc: 0.5876 - val_loss: 1.3874 - val_acc: 0.5334
Epoch 13/20
 - 0s - loss: 1.3667 - acc: 0.5064 - val_loss: 1.3132 - val_acc: 0.5467
Epoch 14/20
 - 0s - loss: 1.1676 - acc: 0.6132 - val_loss: 1.6380 - val_acc: 0.5314
Epoch 15/20
 - 0s - loss: 1.1771 - acc: 0.6239 - val_loss: 1.4180 - val_acc: 0.4947
Epoch 16/20
 - 0s - loss: 1.2860 - acc: 0.5513 - val_loss: 1.4771 - val_acc: 0.4563
Epoch 17/20
 - 0s - loss: 1.0489 - acc: 0.6645 - val_loss: 1.3917 - val_acc: 0.5293
Epoch 18/20
 - 0s - loss: 1.2867 - acc: 0.5791 - val_loss: 1.1128 - val_acc: 0.6310
Epoch 19/20
 - 0s - loss: 0.8532 - acc: 0.7222 - val_loss: 1.0641 - val_acc: 0.6236
Epoch 20/20
 - 0s - loss: 0.9653 - acc: 0.6731 - val_loss: 1.1871 - val_acc: 0.5946
Test loss: 1.1876623794555663
Test accuracy: 0.5956
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1243 - acc: 0.2137 - val_loss: 1.8015 - val_acc: 0.3671
Epoch 2/20
 - 0s - loss: 1.3550 - acc: 0.6068 - val_loss: 1.3457 - val_acc: 0.5776
Epoch 3/20
 - 0s - loss: 0.8005 - acc: 0.8162 - val_loss: 1.0721 - val_acc: 0.6532
Epoch 4/20
 - 0s - loss: 0.5635 - acc: 0.8675 - val_loss: 1.1227 - val_acc: 0.6287
Epoch 5/20
 - 0s - loss: 0.4515 - acc: 0.8846 - val_loss: 0.8294 - val_acc: 0.7240
Epoch 6/20
 - 0s - loss: 0.2683 - acc: 0.9444 - val_loss: 0.9124 - val_acc: 0.6769
Epoch 7/20
 - 0s - loss: 0.2966 - acc: 0.9145 - val_loss: 0.8738 - val_acc: 0.7284
Epoch 8/20
 - 0s - loss: 0.1572 - acc: 0.9701 - val_loss: 0.7517 - val_acc: 0.7732
Epoch 9/20
 - 0s - loss: 0.1189 - acc: 0.9915 - val_loss: 0.7334 - val_acc: 0.7768
Epoch 10/20
 - 0s - loss: 0.0871 - acc: 0.9957 - val_loss: 0.7737 - val_acc: 0.7718
Epoch 11/20
 - 0s - loss: 0.0796 - acc: 0.9915 - val_loss: 0.8959 - val_acc: 0.7557
Epoch 12/20
 - 0s - loss: 0.1140 - acc: 0.9744 - val_loss: 1.2050 - val_acc: 0.7036
Epoch 13/20
 - 0s - loss: 0.1341 - acc: 0.9573 - val_loss: 0.7486 - val_acc: 0.7823
Epoch 14/20
 - 0s - loss: 0.0411 - acc: 1.0000 - val_loss: 0.7315 - val_acc: 0.7885
Epoch 15/20
 - 0s - loss: 0.0261 - acc: 1.0000 - val_loss: 0.7466 - val_acc: 0.7864
Epoch 16/20
 - 0s - loss: 0.0232 - acc: 1.0000 - val_loss: 0.7541 - val_acc: 0.7875
Epoch 17/20
 - 0s - loss: 0.0184 - acc: 1.0000 - val_loss: 0.7580 - val_acc: 0.7878
Epoch 18/20
 - 0s - loss: 0.0136 - acc: 1.0000 - val_loss: 0.7375 - val_acc: 0.7933
Epoch 19/20
 - 0s - loss: 0.0157 - acc: 1.0000 - val_loss: 0.8160 - val_acc: 0.7832
Epoch 20/20
 - 0s - loss: 0.0119 - acc: 1.0000 - val_loss: 0.7965 - val_acc: 0.7844
Test loss: 0.7964770673573017
Test accuracy: 0.7844
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.5566 - acc: 0.0983 - val_loss: 5.7271 - val_acc: 0.1032
Epoch 2/20
 - 0s - loss: 5.7000 - acc: 0.1453 - val_loss: 3.5599 - val_acc: 0.0982
Epoch 3/20
 - 0s - loss: 3.1211 - acc: 0.1410 - val_loss: 2.2713 - val_acc: 0.2188
Epoch 4/20
 - 0s - loss: 2.3208 - acc: 0.1795 - val_loss: 2.1549 - val_acc: 0.2123
Epoch 5/20
 - 0s - loss: 2.1397 - acc: 0.2179 - val_loss: 2.1759 - val_acc: 0.2320
Epoch 6/20
 - 0s - loss: 2.0568 - acc: 0.2778 - val_loss: 1.9827 - val_acc: 0.3700
Epoch 7/20
 - 0s - loss: 1.9583 - acc: 0.3504 - val_loss: 2.1412 - val_acc: 0.2417
Epoch 8/20
 - 0s - loss: 1.9230 - acc: 0.3675 - val_loss: 1.8436 - val_acc: 0.3486
Epoch 9/20
 - 0s - loss: 1.7850 - acc: 0.4274 - val_loss: 1.9604 - val_acc: 0.3037
Epoch 10/20
 - 0s - loss: 1.8701 - acc: 0.3889 - val_loss: 1.9855 - val_acc: 0.3805
Epoch 11/20
 - 0s - loss: 1.9203 - acc: 0.2821 - val_loss: 2.3068 - val_acc: 0.2197
Epoch 12/20
 - 0s - loss: 2.0979 - acc: 0.2863 - val_loss: 1.8650 - val_acc: 0.3806
Epoch 13/20
 - 0s - loss: 1.6424 - acc: 0.4744 - val_loss: 1.6799 - val_acc: 0.4231
Epoch 14/20
 - 0s - loss: 1.5378 - acc: 0.5085 - val_loss: 1.7509 - val_acc: 0.3661
Epoch 15/20
 - 0s - loss: 1.6746 - acc: 0.4444 - val_loss: 1.6513 - val_acc: 0.3997
Epoch 16/20
 - 0s - loss: 1.6118 - acc: 0.4829 - val_loss: 2.1351 - val_acc: 0.3246
Epoch 17/20
 - 0s - loss: 2.0235 - acc: 0.3034 - val_loss: 1.8463 - val_acc: 0.4278
Epoch 18/20
 - 0s - loss: 1.5683 - acc: 0.5085 - val_loss: 1.8283 - val_acc: 0.3178
Epoch 19/20
 - 0s - loss: 1.7143 - acc: 0.4017 - val_loss: 1.4767 - val_acc: 0.5763
Epoch 20/20
 - 0s - loss: 1.2566 - acc: 0.6368 - val_loss: 1.4073 - val_acc: 0.5682
Test loss: 1.4077741855621337
Test accuracy: 0.5695
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3295 - acc: 0.0684 - val_loss: 1.9831 - val_acc: 0.3490
Epoch 2/20
 - 0s - loss: 1.5751 - acc: 0.5470 - val_loss: 1.5947 - val_acc: 0.5092
Epoch 3/20
 - 0s - loss: 1.0714 - acc: 0.7863 - val_loss: 1.7342 - val_acc: 0.3731
Epoch 4/20
 - 0s - loss: 0.8908 - acc: 0.7094 - val_loss: 1.6642 - val_acc: 0.4867
Epoch 5/20
 - 0s - loss: 0.9287 - acc: 0.7607 - val_loss: 1.1158 - val_acc: 0.6562
Epoch 6/20
 - 0s - loss: 0.4777 - acc: 0.9231 - val_loss: 1.2093 - val_acc: 0.6154
Epoch 7/20
 - 0s - loss: 0.3088 - acc: 0.9402 - val_loss: 1.0557 - val_acc: 0.6712
Epoch 8/20
 - 0s - loss: 0.2298 - acc: 0.9573 - val_loss: 1.0852 - val_acc: 0.6387
Epoch 9/20
 - 0s - loss: 0.1838 - acc: 0.9744 - val_loss: 1.1106 - val_acc: 0.6625
Epoch 10/20
 - 0s - loss: 0.1932 - acc: 0.9487 - val_loss: 1.0668 - val_acc: 0.6452
Epoch 11/20
 - 0s - loss: 0.1303 - acc: 0.9915 - val_loss: 0.9958 - val_acc: 0.7106
Epoch 12/20
 - 0s - loss: 0.0783 - acc: 1.0000 - val_loss: 0.9774 - val_acc: 0.7061
Epoch 13/20
 - 0s - loss: 0.0649 - acc: 1.0000 - val_loss: 0.9816 - val_acc: 0.7202
Epoch 14/20
 - 0s - loss: 0.0521 - acc: 1.0000 - val_loss: 0.9735 - val_acc: 0.7238
Epoch 15/20
 - 0s - loss: 0.0431 - acc: 1.0000 - val_loss: 0.9852 - val_acc: 0.7169
Epoch 16/20
 - 0s - loss: 0.0384 - acc: 1.0000 - val_loss: 0.9761 - val_acc: 0.7182
Epoch 17/20
 - 0s - loss: 0.0283 - acc: 1.0000 - val_loss: 1.0021 - val_acc: 0.7190
Epoch 18/20
 - 0s - loss: 0.0241 - acc: 1.0000 - val_loss: 1.0093 - val_acc: 0.7204
Epoch 19/20
 - 0s - loss: 0.0234 - acc: 1.0000 - val_loss: 1.0045 - val_acc: 0.7232
Epoch 20/20
 - 0s - loss: 0.0220 - acc: 1.0000 - val_loss: 1.0333 - val_acc: 0.7135
Test loss: 1.0332585626125335
Test accuracy: 0.7135
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5708 - acc: 0.1111 - val_loss: 5.5560 - val_acc: 0.1579
Epoch 2/20
 - 0s - loss: 5.2963 - acc: 0.1709 - val_loss: 7.7833 - val_acc: 0.1135
Epoch 3/20
 - 0s - loss: 7.5275 - acc: 0.1453 - val_loss: 6.8893 - val_acc: 0.1569
Epoch 4/20
 - 0s - loss: 7.1395 - acc: 0.1197 - val_loss: 4.2587 - val_acc: 0.1593
Epoch 5/20
 - 0s - loss: 4.4137 - acc: 0.1111 - val_loss: 2.8498 - val_acc: 0.1301
Epoch 6/20
 - 0s - loss: 2.7031 - acc: 0.1880 - val_loss: 2.3238 - val_acc: 0.1261
Epoch 7/20
 - 0s - loss: 2.2889 - acc: 0.1966 - val_loss: 2.2410 - val_acc: 0.2652
Epoch 8/20
 - 0s - loss: 2.1025 - acc: 0.3162 - val_loss: 2.1358 - val_acc: 0.3311
Epoch 9/20
 - 0s - loss: 2.0504 - acc: 0.3419 - val_loss: 2.1029 - val_acc: 0.2925
Epoch 10/20
 - 0s - loss: 1.9278 - acc: 0.3932 - val_loss: 2.0321 - val_acc: 0.4334
Epoch 11/20
 - 0s - loss: 1.8709 - acc: 0.4615 - val_loss: 2.0721 - val_acc: 0.2706
Epoch 12/20
 - 0s - loss: 1.8047 - acc: 0.4017 - val_loss: 2.0694 - val_acc: 0.2135
Epoch 13/20
 - 0s - loss: 1.9399 - acc: 0.3248 - val_loss: 2.0866 - val_acc: 0.3326
Epoch 14/20
 - 0s - loss: 1.8306 - acc: 0.4444 - val_loss: 2.0239 - val_acc: 0.3137
Epoch 15/20
 - 0s - loss: 1.8033 - acc: 0.4017 - val_loss: 2.3329 - val_acc: 0.2318
Epoch 16/20
 - 0s - loss: 2.0876 - acc: 0.2991 - val_loss: 2.5632 - val_acc: 0.1980
Epoch 17/20
 - 0s - loss: 2.3758 - acc: 0.2564 - val_loss: 2.0649 - val_acc: 0.2680
Epoch 18/20
 - 0s - loss: 1.9005 - acc: 0.3504 - val_loss: 1.9024 - val_acc: 0.3185
Epoch 19/20
 - 0s - loss: 1.5466 - acc: 0.5214 - val_loss: 1.8871 - val_acc: 0.4730
Epoch 20/20
 - 0s - loss: 1.4919 - acc: 0.5641 - val_loss: 2.3507 - val_acc: 0.2225
Test loss: 2.350518886566162
Test accuracy: 0.222
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2483 - acc: 0.9245 - val_loss: 0.1081 - val_acc: 0.9658
Epoch 2/20
 - 3s - loss: 0.1027 - acc: 0.9690 - val_loss: 0.0816 - val_acc: 0.9762
Epoch 3/20
 - 3s - loss: 0.0756 - acc: 0.9767 - val_loss: 0.0780 - val_acc: 0.9784
Epoch 4/20
 - 3s - loss: 0.0600 - acc: 0.9819 - val_loss: 0.0804 - val_acc: 0.9789
Epoch 5/20
 - 3s - loss: 0.0500 - acc: 0.9853 - val_loss: 0.0844 - val_acc: 0.9787
Epoch 6/20
 - 3s - loss: 0.0441 - acc: 0.9866 - val_loss: 0.0783 - val_acc: 0.9813
Epoch 7/20
 - 3s - loss: 0.0397 - acc: 0.9884 - val_loss: 0.0796 - val_acc: 0.9830
Epoch 8/20
 - 3s - loss: 0.0344 - acc: 0.9898 - val_loss: 0.1091 - val_acc: 0.9771
Epoch 9/20
 - 3s - loss: 0.0313 - acc: 0.9908 - val_loss: 0.0994 - val_acc: 0.9806
Epoch 10/20
 - 3s - loss: 0.0267 - acc: 0.9919 - val_loss: 0.1007 - val_acc: 0.9823
Epoch 11/20
 - 3s - loss: 0.0289 - acc: 0.9917 - val_loss: 0.0862 - val_acc: 0.9835
Epoch 12/20
 - 3s - loss: 0.0247 - acc: 0.9926 - val_loss: 0.0969 - val_acc: 0.9828
Epoch 13/20
 - 3s - loss: 0.0243 - acc: 0.9936 - val_loss: 0.0922 - val_acc: 0.9832
Epoch 14/20
 - 3s - loss: 0.0226 - acc: 0.9934 - val_loss: 0.0964 - val_acc: 0.9826
Epoch 15/20
 - 3s - loss: 0.0202 - acc: 0.9942 - val_loss: 0.0955 - val_acc: 0.9835
Epoch 16/20
 - 3s - loss: 0.0208 - acc: 0.9945 - val_loss: 0.1031 - val_acc: 0.9837
Epoch 17/20
 - 3s - loss: 0.0197 - acc: 0.9950 - val_loss: 0.1068 - val_acc: 0.9836
Epoch 18/20
 - 3s - loss: 0.0205 - acc: 0.9945 - val_loss: 0.0999 - val_acc: 0.9837
Epoch 19/20
 - 3s - loss: 0.0181 - acc: 0.9949 - val_loss: 0.1049 - val_acc: 0.9819
Epoch 20/20
 - 3s - loss: 0.0177 - acc: 0.9953 - val_loss: 0.1082 - val_acc: 0.9819
Test loss: 0.10817918176245764
Test accuracy: 0.9819
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9439 - acc: 0.6942 - val_loss: 0.5457 - val_acc: 0.8140
Epoch 2/20
 - 5s - loss: 0.4408 - acc: 0.8603 - val_loss: 0.3369 - val_acc: 0.8877
Epoch 3/20
 - 5s - loss: 0.3246 - acc: 0.8971 - val_loss: 0.2514 - val_acc: 0.9176
Epoch 4/20
 - 5s - loss: 0.2704 - acc: 0.9161 - val_loss: 0.1700 - val_acc: 0.9452
Epoch 5/20
 - 5s - loss: 0.2380 - acc: 0.9266 - val_loss: 0.1487 - val_acc: 0.9536
Epoch 6/20
 - 5s - loss: 0.2161 - acc: 0.9337 - val_loss: 0.1774 - val_acc: 0.9447
Epoch 7/20
 - 5s - loss: 0.2014 - acc: 0.9381 - val_loss: 0.1496 - val_acc: 0.9557
Epoch 8/20
 - 5s - loss: 0.1912 - acc: 0.9419 - val_loss: 0.1268 - val_acc: 0.9625
Epoch 9/20
 - 5s - loss: 0.1870 - acc: 0.9437 - val_loss: 0.1191 - val_acc: 0.9615
Epoch 10/20
 - 5s - loss: 0.1799 - acc: 0.9468 - val_loss: 0.1446 - val_acc: 0.9558
Epoch 11/20
 - 5s - loss: 0.1760 - acc: 0.9464 - val_loss: 0.1278 - val_acc: 0.9599
Epoch 12/20
 - 5s - loss: 0.1718 - acc: 0.9502 - val_loss: 0.1092 - val_acc: 0.9650
Epoch 13/20
 - 5s - loss: 0.1692 - acc: 0.9506 - val_loss: 0.1650 - val_acc: 0.9510
Epoch 14/20
 - 5s - loss: 0.1656 - acc: 0.9514 - val_loss: 0.0958 - val_acc: 0.9711
Epoch 15/20
 - 5s - loss: 0.1640 - acc: 0.9525 - val_loss: 0.0970 - val_acc: 0.9727
Epoch 16/20
 - 5s - loss: 0.1655 - acc: 0.9528 - val_loss: 0.1499 - val_acc: 0.9590
Epoch 17/20
 - 5s - loss: 0.1644 - acc: 0.9523 - val_loss: 0.0989 - val_acc: 0.9719
Epoch 18/20
 - 5s - loss: 0.1620 - acc: 0.9541 - val_loss: 0.0828 - val_acc: 0.9726
Epoch 19/20
 - 5s - loss: 0.1611 - acc: 0.9552 - val_loss: 0.1060 - val_acc: 0.9676
Epoch 20/20
 - 5s - loss: 0.1629 - acc: 0.9544 - val_loss: 0.1319 - val_acc: 0.9591
Test loss: 0.13260025076419116
Test accuracy: 0.9585
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.3365 - acc: 0.8961 - val_loss: 0.1501 - val_acc: 0.9530
Epoch 2/20
 - 1s - loss: 0.1339 - acc: 0.9598 - val_loss: 0.1378 - val_acc: 0.9559
Epoch 3/20
 - 1s - loss: 0.0894 - acc: 0.9717 - val_loss: 0.1542 - val_acc: 0.9540
Epoch 4/20
 - 1s - loss: 0.0690 - acc: 0.9778 - val_loss: 0.1227 - val_acc: 0.9648
Epoch 5/20
 - 1s - loss: 0.0513 - acc: 0.9832 - val_loss: 0.0993 - val_acc: 0.9713
Epoch 6/20
 - 1s - loss: 0.0450 - acc: 0.9862 - val_loss: 0.0870 - val_acc: 0.9771
Epoch 7/20
 - 1s - loss: 0.0358 - acc: 0.9880 - val_loss: 0.1138 - val_acc: 0.9738
Epoch 8/20
 - 1s - loss: 0.0316 - acc: 0.9898 - val_loss: 0.0974 - val_acc: 0.9776
Epoch 9/20
 - 1s - loss: 0.0277 - acc: 0.9912 - val_loss: 0.0996 - val_acc: 0.9796
Epoch 10/20
 - 1s - loss: 0.0248 - acc: 0.9924 - val_loss: 0.1035 - val_acc: 0.9780
Epoch 11/20
 - 1s - loss: 0.0214 - acc: 0.9930 - val_loss: 0.1066 - val_acc: 0.9782
Epoch 12/20
 - 1s - loss: 0.0223 - acc: 0.9930 - val_loss: 0.1155 - val_acc: 0.9769
Epoch 13/20
 - 1s - loss: 0.0186 - acc: 0.9944 - val_loss: 0.1271 - val_acc: 0.9774
Epoch 14/20
 - 1s - loss: 0.0187 - acc: 0.9944 - val_loss: 0.1051 - val_acc: 0.9798
Epoch 15/20
 - 1s - loss: 0.0175 - acc: 0.9942 - val_loss: 0.1176 - val_acc: 0.9790
Epoch 16/20
 - 1s - loss: 0.0150 - acc: 0.9958 - val_loss: 0.1163 - val_acc: 0.9803
Epoch 17/20
 - 1s - loss: 0.0141 - acc: 0.9960 - val_loss: 0.1401 - val_acc: 0.9788
Epoch 18/20
 - 1s - loss: 0.0131 - acc: 0.9961 - val_loss: 0.1450 - val_acc: 0.9779
Epoch 19/20
 - 1s - loss: 0.0148 - acc: 0.9958 - val_loss: 0.1263 - val_acc: 0.9787
Epoch 20/20
 - 1s - loss: 0.0105 - acc: 0.9966 - val_loss: 0.1634 - val_acc: 0.9763
Test loss: 0.16343238913449476
Test accuracy: 0.9763
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2511 - acc: 0.5993 - val_loss: 0.7278 - val_acc: 0.7465
Epoch 2/20
 - 2s - loss: 0.6168 - acc: 0.8040 - val_loss: 0.4875 - val_acc: 0.8381
Epoch 3/20
 - 2s - loss: 0.4730 - acc: 0.8497 - val_loss: 0.3232 - val_acc: 0.8982
Epoch 4/20
 - 2s - loss: 0.3900 - acc: 0.8770 - val_loss: 0.4026 - val_acc: 0.8755
Epoch 5/20
 - 2s - loss: 0.3358 - acc: 0.8946 - val_loss: 0.2642 - val_acc: 0.9148
Epoch 6/20
 - 2s - loss: 0.3035 - acc: 0.9049 - val_loss: 0.2449 - val_acc: 0.9188
Epoch 7/20
 - 2s - loss: 0.2695 - acc: 0.9154 - val_loss: 0.3849 - val_acc: 0.8713
Epoch 8/20
 - 2s - loss: 0.2485 - acc: 0.9213 - val_loss: 0.3561 - val_acc: 0.8953
Epoch 9/20
 - 2s - loss: 0.2332 - acc: 0.9270 - val_loss: 0.1772 - val_acc: 0.9488
Epoch 10/20
 - 2s - loss: 0.2183 - acc: 0.9312 - val_loss: 0.4694 - val_acc: 0.8598
Epoch 11/20
 - 2s - loss: 0.2174 - acc: 0.9332 - val_loss: 0.1449 - val_acc: 0.9554
Epoch 12/20
 - 2s - loss: 0.2030 - acc: 0.9365 - val_loss: 0.1450 - val_acc: 0.9553
Epoch 13/20
 - 2s - loss: 0.1882 - acc: 0.9406 - val_loss: 0.1449 - val_acc: 0.9529
Epoch 14/20
 - 2s - loss: 0.1851 - acc: 0.9428 - val_loss: 0.2285 - val_acc: 0.9279
Epoch 15/20
 - 2s - loss: 0.1779 - acc: 0.9460 - val_loss: 0.1542 - val_acc: 0.9569
Epoch 16/20
 - 2s - loss: 0.1728 - acc: 0.9474 - val_loss: 0.1335 - val_acc: 0.9583
Epoch 17/20
 - 2s - loss: 0.1689 - acc: 0.9484 - val_loss: 0.1304 - val_acc: 0.9597
Epoch 18/20
 - 2s - loss: 0.1680 - acc: 0.9491 - val_loss: 0.1321 - val_acc: 0.9602
Epoch 19/20
 - 2s - loss: 0.1635 - acc: 0.9504 - val_loss: 0.1687 - val_acc: 0.9489
Epoch 20/20
 - 2s - loss: 0.1577 - acc: 0.9520 - val_loss: 0.1704 - val_acc: 0.9500
Test loss: 0.17055159716991475
Test accuracy: 0.9489
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4591 - acc: 0.8579 - val_loss: 0.3322 - val_acc: 0.8960
Epoch 2/20
 - 1s - loss: 0.1832 - acc: 0.9464 - val_loss: 0.2325 - val_acc: 0.9270
Epoch 3/20
 - 1s - loss: 0.1234 - acc: 0.9635 - val_loss: 0.1652 - val_acc: 0.9502
Epoch 4/20
 - 1s - loss: 0.0877 - acc: 0.9720 - val_loss: 0.1643 - val_acc: 0.9511
Epoch 5/20
 - 1s - loss: 0.0642 - acc: 0.9793 - val_loss: 0.1290 - val_acc: 0.9646
Epoch 6/20
 - 1s - loss: 0.0489 - acc: 0.9843 - val_loss: 0.1254 - val_acc: 0.9667
Epoch 7/20
 - 1s - loss: 0.0390 - acc: 0.9861 - val_loss: 0.1293 - val_acc: 0.9671
Epoch 8/20
 - 1s - loss: 0.0343 - acc: 0.9890 - val_loss: 0.1855 - val_acc: 0.9521
Epoch 9/20
 - 1s - loss: 0.0240 - acc: 0.9923 - val_loss: 0.1472 - val_acc: 0.9673
Epoch 10/20
 - 1s - loss: 0.0213 - acc: 0.9925 - val_loss: 0.1663 - val_acc: 0.9634
Epoch 11/20
 - 1s - loss: 0.0179 - acc: 0.9933 - val_loss: 0.1650 - val_acc: 0.9668
Epoch 12/20
 - 1s - loss: 0.0176 - acc: 0.9951 - val_loss: 0.1513 - val_acc: 0.9689
Epoch 13/20
 - 1s - loss: 0.0153 - acc: 0.9955 - val_loss: 0.1488 - val_acc: 0.9704
Epoch 14/20
 - 1s - loss: 0.0131 - acc: 0.9951 - val_loss: 0.1706 - val_acc: 0.9709
Epoch 15/20
 - 1s - loss: 0.0148 - acc: 0.9947 - val_loss: 0.1545 - val_acc: 0.9712
Epoch 16/20
 - 1s - loss: 0.0114 - acc: 0.9961 - val_loss: 0.1833 - val_acc: 0.9689
Epoch 17/20
 - 1s - loss: 0.0129 - acc: 0.9960 - val_loss: 0.1797 - val_acc: 0.9689
Epoch 18/20
 - 1s - loss: 0.0101 - acc: 0.9964 - val_loss: 0.1858 - val_acc: 0.9698
Epoch 19/20
 - 1s - loss: 0.0116 - acc: 0.9958 - val_loss: 0.1745 - val_acc: 0.9728
Epoch 20/20
 - 1s - loss: 0.0081 - acc: 0.9972 - val_loss: 0.1719 - val_acc: 0.9718
Test loss: 0.17190675612468645
Test accuracy: 0.9718
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6425 - acc: 0.4773 - val_loss: 0.8675 - val_acc: 0.7120
Epoch 2/20
 - 1s - loss: 0.8532 - acc: 0.7178 - val_loss: 0.6385 - val_acc: 0.8073
Epoch 3/20
 - 1s - loss: 0.6587 - acc: 0.7874 - val_loss: 1.2560 - val_acc: 0.5954
Epoch 4/20
 - 1s - loss: 0.5576 - acc: 0.8224 - val_loss: 1.3241 - val_acc: 0.6720
Epoch 5/20
 - 1s - loss: 0.4805 - acc: 0.8463 - val_loss: 0.8236 - val_acc: 0.7244
Epoch 6/20
 - 1s - loss: 0.4319 - acc: 0.8642 - val_loss: 0.4413 - val_acc: 0.8472
Epoch 7/20
 - 1s - loss: 0.3894 - acc: 0.8768 - val_loss: 0.2759 - val_acc: 0.9136
Epoch 8/20
 - 1s - loss: 0.3512 - acc: 0.8896 - val_loss: 0.2826 - val_acc: 0.9098
Epoch 9/20
 - 1s - loss: 0.3201 - acc: 0.8979 - val_loss: 0.4169 - val_acc: 0.8681
Epoch 10/20
 - 1s - loss: 0.2903 - acc: 0.9067 - val_loss: 0.3399 - val_acc: 0.8932
Epoch 11/20
 - 1s - loss: 0.2848 - acc: 0.9073 - val_loss: 0.2055 - val_acc: 0.9370
Epoch 12/20
 - 1s - loss: 0.2632 - acc: 0.9191 - val_loss: 0.3577 - val_acc: 0.8839
Epoch 13/20
 - 1s - loss: 0.2607 - acc: 0.9198 - val_loss: 0.2006 - val_acc: 0.9369
Epoch 14/20
 - 1s - loss: 0.2361 - acc: 0.9231 - val_loss: 0.1962 - val_acc: 0.9369
Epoch 15/20
 - 1s - loss: 0.2235 - acc: 0.9299 - val_loss: 0.2713 - val_acc: 0.9217
Epoch 16/20
 - 1s - loss: 0.2129 - acc: 0.9305 - val_loss: 0.2777 - val_acc: 0.9134
Epoch 17/20
 - 1s - loss: 0.2065 - acc: 0.9345 - val_loss: 0.2515 - val_acc: 0.9259
Epoch 18/20
 - 1s - loss: 0.1999 - acc: 0.9371 - val_loss: 0.2201 - val_acc: 0.9341
Epoch 19/20
 - 1s - loss: 0.1968 - acc: 0.9375 - val_loss: 0.2441 - val_acc: 0.9228
Epoch 20/20
 - 1s - loss: 0.1845 - acc: 0.9418 - val_loss: 0.3598 - val_acc: 0.8958
Test loss: 0.358973714812845
Test accuracy: 0.8956
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6017 - acc: 0.8131 - val_loss: 0.3670 - val_acc: 0.8845
Epoch 2/20
 - 0s - loss: 0.2418 - acc: 0.9275 - val_loss: 0.2070 - val_acc: 0.9369
Epoch 3/20
 - 0s - loss: 0.1613 - acc: 0.9529 - val_loss: 0.2172 - val_acc: 0.9365
Epoch 4/20
 - 0s - loss: 0.1181 - acc: 0.9640 - val_loss: 0.2063 - val_acc: 0.9369
Epoch 5/20
 - 0s - loss: 0.0876 - acc: 0.9728 - val_loss: 0.1931 - val_acc: 0.9428
Epoch 6/20
 - 0s - loss: 0.0577 - acc: 0.9805 - val_loss: 0.1835 - val_acc: 0.9472
Epoch 7/20
 - 0s - loss: 0.0482 - acc: 0.9871 - val_loss: 0.1829 - val_acc: 0.9485
Epoch 8/20
 - 0s - loss: 0.0424 - acc: 0.9859 - val_loss: 0.1905 - val_acc: 0.9485
Epoch 9/20
 - 0s - loss: 0.0271 - acc: 0.9916 - val_loss: 0.1722 - val_acc: 0.9577
Epoch 10/20
 - 0s - loss: 0.0210 - acc: 0.9933 - val_loss: 0.2023 - val_acc: 0.9547
Epoch 11/20
 - 0s - loss: 0.0216 - acc: 0.9927 - val_loss: 0.1963 - val_acc: 0.9557
Epoch 12/20
 - 0s - loss: 0.0163 - acc: 0.9937 - val_loss: 0.2513 - val_acc: 0.9471
Epoch 13/20
 - 0s - loss: 0.0139 - acc: 0.9951 - val_loss: 0.2138 - val_acc: 0.9557
Epoch 14/20
 - 0s - loss: 0.0117 - acc: 0.9971 - val_loss: 0.2561 - val_acc: 0.9494
Epoch 15/20
 - 0s - loss: 0.0110 - acc: 0.9957 - val_loss: 0.2164 - val_acc: 0.9556
Epoch 16/20
 - 0s - loss: 0.0101 - acc: 0.9965 - val_loss: 0.2510 - val_acc: 0.9549
Epoch 17/20
 - 0s - loss: 0.0082 - acc: 0.9969 - val_loss: 0.2420 - val_acc: 0.9560
Epoch 18/20
 - 0s - loss: 0.0124 - acc: 0.9967 - val_loss: 0.2535 - val_acc: 0.9555
Epoch 19/20
 - 0s - loss: 0.0085 - acc: 0.9965 - val_loss: 0.2442 - val_acc: 0.9557
Epoch 20/20
 - 0s - loss: 0.0039 - acc: 0.9993 - val_loss: 0.2670 - val_acc: 0.9546
Test loss: 0.2669727227317515
Test accuracy: 0.9546
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.1190 - acc: 0.3483 - val_loss: 1.2772 - val_acc: 0.5286
Epoch 2/20
 - 1s - loss: 1.1225 - acc: 0.6224 - val_loss: 1.5404 - val_acc: 0.4910
Epoch 3/20
 - 1s - loss: 0.8743 - acc: 0.7059 - val_loss: 0.9808 - val_acc: 0.6729
Epoch 4/20
 - 1s - loss: 0.7241 - acc: 0.7636 - val_loss: 0.8010 - val_acc: 0.7502
Epoch 5/20
 - 1s - loss: 0.6587 - acc: 0.7833 - val_loss: 0.5553 - val_acc: 0.8069
Epoch 6/20
 - 1s - loss: 0.6133 - acc: 0.8057 - val_loss: 0.3670 - val_acc: 0.8906
Epoch 7/20
 - 1s - loss: 0.5240 - acc: 0.8265 - val_loss: 0.6459 - val_acc: 0.7815
Epoch 8/20
 - 1s - loss: 0.4860 - acc: 0.8392 - val_loss: 0.4400 - val_acc: 0.8589
Epoch 9/20
 - 1s - loss: 0.4372 - acc: 0.8595 - val_loss: 0.3828 - val_acc: 0.8817
Epoch 10/20
 - 1s - loss: 0.4272 - acc: 0.8677 - val_loss: 0.3863 - val_acc: 0.8679
Epoch 11/20
 - 1s - loss: 0.3967 - acc: 0.8716 - val_loss: 0.5260 - val_acc: 0.8346
Epoch 12/20
 - 1s - loss: 0.3657 - acc: 0.8837 - val_loss: 0.4108 - val_acc: 0.8654
Epoch 13/20
 - 1s - loss: 0.3704 - acc: 0.8869 - val_loss: 0.3642 - val_acc: 0.8805
Epoch 14/20
 - 1s - loss: 0.3610 - acc: 0.8875 - val_loss: 0.3110 - val_acc: 0.8973
Epoch 15/20
 - 1s - loss: 0.3012 - acc: 0.9035 - val_loss: 0.3628 - val_acc: 0.8884
Epoch 16/20
 - 1s - loss: 0.3225 - acc: 0.8959 - val_loss: 0.4082 - val_acc: 0.8718
Epoch 17/20
 - 1s - loss: 0.2965 - acc: 0.9045 - val_loss: 0.3937 - val_acc: 0.8714
Epoch 18/20
 - 1s - loss: 0.2843 - acc: 0.9043 - val_loss: 0.4746 - val_acc: 0.8599
Epoch 19/20
 - 1s - loss: 0.2676 - acc: 0.9149 - val_loss: 0.2601 - val_acc: 0.9217
Epoch 20/20
 - 1s - loss: 0.2682 - acc: 0.9159 - val_loss: 0.3030 - val_acc: 0.9041
Test loss: 0.30283420738875866
Test accuracy: 0.9045
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8147 - acc: 0.7424 - val_loss: 0.6226 - val_acc: 0.7852
Epoch 2/20
 - 0s - loss: 0.3349 - acc: 0.8981 - val_loss: 0.3413 - val_acc: 0.8935
Epoch 3/20
 - 0s - loss: 0.2391 - acc: 0.9272 - val_loss: 0.5063 - val_acc: 0.8443
Epoch 4/20
 - 0s - loss: 0.1738 - acc: 0.9493 - val_loss: 0.2961 - val_acc: 0.9065
Epoch 5/20
 - 0s - loss: 0.1269 - acc: 0.9629 - val_loss: 0.2520 - val_acc: 0.9215
Epoch 6/20
 - 0s - loss: 0.0895 - acc: 0.9739 - val_loss: 0.2586 - val_acc: 0.9231
Epoch 7/20
 - 0s - loss: 0.0728 - acc: 0.9805 - val_loss: 0.4045 - val_acc: 0.8870
Epoch 8/20
 - 0s - loss: 0.0562 - acc: 0.9856 - val_loss: 0.2677 - val_acc: 0.9212
Epoch 9/20
 - 0s - loss: 0.0361 - acc: 0.9859 - val_loss: 0.2327 - val_acc: 0.9343
Epoch 10/20
 - 0s - loss: 0.0321 - acc: 0.9888 - val_loss: 0.2651 - val_acc: 0.9318
Epoch 11/20
 - 0s - loss: 0.0190 - acc: 0.9955 - val_loss: 0.2546 - val_acc: 0.9364
Epoch 12/20
 - 0s - loss: 0.0176 - acc: 0.9949 - val_loss: 0.2735 - val_acc: 0.9364
Epoch 13/20
 - 0s - loss: 0.0144 - acc: 0.9955 - val_loss: 0.3452 - val_acc: 0.9202
Epoch 14/20
 - 0s - loss: 0.0136 - acc: 0.9965 - val_loss: 0.2733 - val_acc: 0.9349
Epoch 15/20
 - 0s - loss: 0.0142 - acc: 0.9960 - val_loss: 0.2685 - val_acc: 0.9416
Epoch 16/20
 - 0s - loss: 0.0069 - acc: 0.9981 - val_loss: 0.3054 - val_acc: 0.9364
Epoch 17/20
 - 0s - loss: 0.0183 - acc: 0.9931 - val_loss: 0.2676 - val_acc: 0.9423
Epoch 18/20
 - 0s - loss: 0.0097 - acc: 0.9981 - val_loss: 0.2893 - val_acc: 0.9412
Epoch 19/20
 - 0s - loss: 0.0066 - acc: 0.9984 - val_loss: 0.2713 - val_acc: 0.9422
Epoch 20/20
 - 0s - loss: 0.0098 - acc: 0.9957 - val_loss: 0.3071 - val_acc: 0.9381
Test loss: 0.3070572873538302
Test accuracy: 0.9381
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.9462 - acc: 0.2307 - val_loss: 1.9681 - val_acc: 0.3797
Epoch 2/20
 - 1s - loss: 1.6422 - acc: 0.4485 - val_loss: 1.5169 - val_acc: 0.4479
Epoch 3/20
 - 1s - loss: 1.2487 - acc: 0.5848 - val_loss: 0.8719 - val_acc: 0.7203
Epoch 4/20
 - 1s - loss: 1.0004 - acc: 0.6696 - val_loss: 0.8571 - val_acc: 0.6876
Epoch 5/20
 - 1s - loss: 0.8966 - acc: 0.6976 - val_loss: 0.9837 - val_acc: 0.6602
Epoch 6/20
 - 1s - loss: 0.8469 - acc: 0.7176 - val_loss: 0.6804 - val_acc: 0.7839
Epoch 7/20
 - 1s - loss: 0.7355 - acc: 0.7477 - val_loss: 0.7583 - val_acc: 0.7350
Epoch 8/20
 - 1s - loss: 0.7291 - acc: 0.7677 - val_loss: 0.8599 - val_acc: 0.7123
Epoch 9/20
 - 1s - loss: 0.6853 - acc: 0.7835 - val_loss: 0.5809 - val_acc: 0.8152
Epoch 10/20
 - 1s - loss: 0.6242 - acc: 0.7973 - val_loss: 0.8842 - val_acc: 0.6833
Epoch 11/20
 - 1s - loss: 0.6517 - acc: 0.7899 - val_loss: 0.6179 - val_acc: 0.8011
Epoch 12/20
 - 1s - loss: 0.5429 - acc: 0.8277 - val_loss: 0.9735 - val_acc: 0.6813
Epoch 13/20
 - 1s - loss: 0.6029 - acc: 0.8056 - val_loss: 0.4942 - val_acc: 0.8402
Epoch 14/20
 - 1s - loss: 0.4633 - acc: 0.8464 - val_loss: 0.9909 - val_acc: 0.7009
Epoch 15/20
 - 1s - loss: 0.5036 - acc: 0.8419 - val_loss: 0.4965 - val_acc: 0.8309
Epoch 16/20
 - 1s - loss: 0.4614 - acc: 0.8520 - val_loss: 0.7181 - val_acc: 0.7816
Epoch 17/20
 - 1s - loss: 0.4327 - acc: 0.8597 - val_loss: 0.3480 - val_acc: 0.8897
Epoch 18/20
 - 1s - loss: 0.3998 - acc: 0.8707 - val_loss: 1.7383 - val_acc: 0.5274
Epoch 19/20
 - 1s - loss: 0.4303 - acc: 0.8645 - val_loss: 0.5394 - val_acc: 0.8211
Epoch 20/20
 - 1s - loss: 0.3946 - acc: 0.8715 - val_loss: 0.7472 - val_acc: 0.7700
Test loss: 0.7468591171264648
Test accuracy: 0.7704
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1617 - acc: 0.6219 - val_loss: 0.6824 - val_acc: 0.7623
Epoch 2/20
 - 0s - loss: 0.4666 - acc: 0.8603 - val_loss: 0.4013 - val_acc: 0.8804
Epoch 3/20
 - 0s - loss: 0.3349 - acc: 0.9035 - val_loss: 0.4610 - val_acc: 0.8589
Epoch 4/20
 - 0s - loss: 0.2564 - acc: 0.9232 - val_loss: 0.4021 - val_acc: 0.8752
Epoch 5/20
 - 0s - loss: 0.1883 - acc: 0.9515 - val_loss: 0.4177 - val_acc: 0.8666
Epoch 6/20
 - 0s - loss: 0.1355 - acc: 0.9579 - val_loss: 0.3595 - val_acc: 0.8903
Epoch 7/20
 - 0s - loss: 0.1135 - acc: 0.9707 - val_loss: 0.3109 - val_acc: 0.9095
Epoch 8/20
 - 0s - loss: 0.0834 - acc: 0.9781 - val_loss: 0.3118 - val_acc: 0.9083
Epoch 9/20
 - 0s - loss: 0.0676 - acc: 0.9787 - val_loss: 0.2826 - val_acc: 0.9175
Epoch 10/20
 - 0s - loss: 0.0521 - acc: 0.9829 - val_loss: 0.3800 - val_acc: 0.8944
Epoch 11/20
 - 0s - loss: 0.0351 - acc: 0.9915 - val_loss: 0.2951 - val_acc: 0.9188
Epoch 12/20
 - 0s - loss: 0.0200 - acc: 0.9952 - val_loss: 0.3805 - val_acc: 0.9039
Epoch 13/20
 - 0s - loss: 0.0271 - acc: 0.9936 - val_loss: 0.3096 - val_acc: 0.9195
Epoch 14/20
 - 0s - loss: 0.0354 - acc: 0.9883 - val_loss: 0.3345 - val_acc: 0.9135
Epoch 15/20
 - 0s - loss: 0.0089 - acc: 0.9989 - val_loss: 0.3302 - val_acc: 0.9177
Epoch 16/20
 - 0s - loss: 0.0052 - acc: 0.9995 - val_loss: 0.3324 - val_acc: 0.9208
Epoch 17/20
 - 0s - loss: 0.0474 - acc: 0.9888 - val_loss: 0.3318 - val_acc: 0.9189
Epoch 18/20
 - 0s - loss: 0.0066 - acc: 0.9984 - val_loss: 0.3259 - val_acc: 0.9206
Epoch 19/20
 - 0s - loss: 0.0049 - acc: 0.9995 - val_loss: 0.3348 - val_acc: 0.9249
Epoch 20/20
 - 0s - loss: 0.0033 - acc: 1.0000 - val_loss: 0.3843 - val_acc: 0.9186
Test loss: 0.3842865713583189
Test accuracy: 0.9186
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2825 - acc: 0.1723 - val_loss: 2.0930 - val_acc: 0.3851
Epoch 2/20
 - 1s - loss: 1.9784 - acc: 0.3045 - val_loss: 1.8663 - val_acc: 0.2709
Epoch 3/20
 - 1s - loss: 1.7870 - acc: 0.4037 - val_loss: 1.3086 - val_acc: 0.5749
Epoch 4/20
 - 1s - loss: 1.4062 - acc: 0.5344 - val_loss: 1.4244 - val_acc: 0.5139
Epoch 5/20
 - 1s - loss: 1.2360 - acc: 0.5829 - val_loss: 1.5681 - val_acc: 0.4768
Epoch 6/20
 - 1s - loss: 1.1484 - acc: 0.6245 - val_loss: 0.9454 - val_acc: 0.6730
Epoch 7/20
 - 1s - loss: 1.1164 - acc: 0.6357 - val_loss: 1.0072 - val_acc: 0.6520
Epoch 8/20
 - 1s - loss: 0.9500 - acc: 0.6827 - val_loss: 0.9978 - val_acc: 0.6926
Epoch 9/20
 - 1s - loss: 0.8961 - acc: 0.7088 - val_loss: 0.8297 - val_acc: 0.7013
Epoch 10/20
 - 1s - loss: 0.8884 - acc: 0.7045 - val_loss: 0.9432 - val_acc: 0.6826
Epoch 11/20
 - 1s - loss: 0.8417 - acc: 0.7307 - val_loss: 0.6422 - val_acc: 0.7692
Epoch 12/20
 - 1s - loss: 0.8096 - acc: 0.7312 - val_loss: 0.5478 - val_acc: 0.8177
Epoch 13/20
 - 1s - loss: 0.7719 - acc: 0.7413 - val_loss: 0.8550 - val_acc: 0.7312
Epoch 14/20
 - 1s - loss: 0.7142 - acc: 0.7728 - val_loss: 0.5485 - val_acc: 0.8164
Epoch 15/20
 - 1s - loss: 0.6537 - acc: 0.7888 - val_loss: 1.2174 - val_acc: 0.6255
Epoch 16/20
 - 1s - loss: 0.7418 - acc: 0.7563 - val_loss: 0.5908 - val_acc: 0.8186
Epoch 17/20
 - 1s - loss: 0.6545 - acc: 0.7861 - val_loss: 0.4889 - val_acc: 0.8496
Epoch 18/20
 - 1s - loss: 0.5600 - acc: 0.8176 - val_loss: 0.7538 - val_acc: 0.7403
Epoch 19/20
 - 1s - loss: 0.6793 - acc: 0.7723 - val_loss: 0.4548 - val_acc: 0.8614
Epoch 20/20
 - 1s - loss: 0.5508 - acc: 0.8235 - val_loss: 0.5165 - val_acc: 0.8267
Test loss: 0.515893694126606
Test accuracy: 0.8272
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.4585 - acc: 0.5432 - val_loss: 0.8083 - val_acc: 0.7430
Epoch 2/20
 - 0s - loss: 0.5938 - acc: 0.8218 - val_loss: 0.8208 - val_acc: 0.7233
Epoch 3/20
 - 0s - loss: 0.4404 - acc: 0.8591 - val_loss: 0.6951 - val_acc: 0.7754
Epoch 4/20
 - 0s - loss: 0.3114 - acc: 0.9157 - val_loss: 0.4421 - val_acc: 0.8601
Epoch 5/20
 - 0s - loss: 0.2263 - acc: 0.9328 - val_loss: 0.6570 - val_acc: 0.7904
Epoch 6/20
 - 0s - loss: 0.1821 - acc: 0.9509 - val_loss: 0.3679 - val_acc: 0.8889
Epoch 7/20
 - 0s - loss: 0.1524 - acc: 0.9509 - val_loss: 0.3995 - val_acc: 0.8803
Epoch 8/20
 - 0s - loss: 0.1149 - acc: 0.9765 - val_loss: 0.3934 - val_acc: 0.8761
Epoch 9/20
 - 0s - loss: 0.0858 - acc: 0.9797 - val_loss: 0.4574 - val_acc: 0.8607
Epoch 10/20
 - 0s - loss: 0.1103 - acc: 0.9669 - val_loss: 0.3802 - val_acc: 0.8837
Epoch 11/20
 - 0s - loss: 0.0330 - acc: 0.9968 - val_loss: 0.3786 - val_acc: 0.8932
Epoch 12/20
 - 0s - loss: 0.0470 - acc: 0.9893 - val_loss: 0.5570 - val_acc: 0.8571
Epoch 13/20
 - 0s - loss: 0.0260 - acc: 0.9957 - val_loss: 0.4307 - val_acc: 0.8795
Epoch 14/20
 - 0s - loss: 0.0151 - acc: 1.0000 - val_loss: 0.5509 - val_acc: 0.8565
Epoch 15/20
 - 0s - loss: 0.1399 - acc: 0.9648 - val_loss: 0.4308 - val_acc: 0.8843
Epoch 16/20
 - 0s - loss: 0.0129 - acc: 0.9979 - val_loss: 0.4094 - val_acc: 0.8951
Epoch 17/20
 - 0s - loss: 0.0061 - acc: 1.0000 - val_loss: 0.4211 - val_acc: 0.8963
Epoch 18/20
 - 0s - loss: 0.0044 - acc: 1.0000 - val_loss: 0.4197 - val_acc: 0.8981
Epoch 19/20
 - 0s - loss: 0.0065 - acc: 0.9989 - val_loss: 0.5194 - val_acc: 0.8800
Epoch 20/20
 - 0s - loss: 0.0058 - acc: 0.9989 - val_loss: 0.4615 - val_acc: 0.8930
Test loss: 0.46150840652468617
Test accuracy: 0.893
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.3924 - acc: 0.1515 - val_loss: 2.4228 - val_acc: 0.1029
Epoch 2/20
 - 1s - loss: 2.2066 - acc: 0.2038 - val_loss: 2.3677 - val_acc: 0.2994
Epoch 3/20
 - 0s - loss: 1.9150 - acc: 0.3906 - val_loss: 3.0982 - val_acc: 0.1029
Epoch 4/20
 - 1s - loss: 2.0950 - acc: 0.3276 - val_loss: 1.8352 - val_acc: 0.3272
Epoch 5/20
 - 1s - loss: 1.7302 - acc: 0.4045 - val_loss: 1.6373 - val_acc: 0.2774
Epoch 6/20
 - 1s - loss: 1.6201 - acc: 0.4472 - val_loss: 1.2412 - val_acc: 0.6112
Epoch 7/20
 - 0s - loss: 1.3332 - acc: 0.5827 - val_loss: 1.2054 - val_acc: 0.6113
Epoch 8/20
 - 1s - loss: 1.3459 - acc: 0.5518 - val_loss: 1.2101 - val_acc: 0.5811
Epoch 9/20
 - 1s - loss: 1.3016 - acc: 0.5752 - val_loss: 1.1123 - val_acc: 0.6435
Epoch 10/20
 - 1s - loss: 1.1053 - acc: 0.6361 - val_loss: 1.5264 - val_acc: 0.4040
Epoch 11/20
 - 1s - loss: 1.2142 - acc: 0.6041 - val_loss: 1.3488 - val_acc: 0.5131
Epoch 12/20
 - 0s - loss: 1.0088 - acc: 0.6766 - val_loss: 1.3420 - val_acc: 0.5362
Epoch 13/20
 - 0s - loss: 0.9644 - acc: 0.7022 - val_loss: 0.7208 - val_acc: 0.7876
Epoch 14/20
 - 1s - loss: 0.9246 - acc: 0.6766 - val_loss: 1.0904 - val_acc: 0.5831
Epoch 15/20
 - 0s - loss: 0.8557 - acc: 0.7215 - val_loss: 1.3927 - val_acc: 0.5594
Epoch 16/20
 - 1s - loss: 0.9324 - acc: 0.7044 - val_loss: 1.1507 - val_acc: 0.6375
Epoch 17/20
 - 1s - loss: 0.8641 - acc: 0.7065 - val_loss: 0.9151 - val_acc: 0.6628
Epoch 18/20
 - 0s - loss: 0.8049 - acc: 0.7300 - val_loss: 0.9200 - val_acc: 0.7108
Epoch 19/20
 - 1s - loss: 0.8374 - acc: 0.7279 - val_loss: 1.7986 - val_acc: 0.5147
Epoch 20/20
 - 0s - loss: 0.8704 - acc: 0.7086 - val_loss: 0.8067 - val_acc: 0.7123
Test loss: 0.8076036535263061
Test accuracy: 0.7132
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8736 - acc: 0.4081 - val_loss: 1.2994 - val_acc: 0.5870
Epoch 2/20
 - 0s - loss: 0.8024 - acc: 0.7885 - val_loss: 0.7968 - val_acc: 0.7527
Epoch 3/20
 - 0s - loss: 0.5064 - acc: 0.8462 - val_loss: 0.6930 - val_acc: 0.7759
Epoch 4/20
 - 0s - loss: 0.3621 - acc: 0.9038 - val_loss: 0.9408 - val_acc: 0.6989
Epoch 5/20
 - 0s - loss: 0.3212 - acc: 0.9038 - val_loss: 0.5843 - val_acc: 0.8080
Epoch 6/20
 - 0s - loss: 0.2098 - acc: 0.9466 - val_loss: 0.9894 - val_acc: 0.6900
Epoch 7/20
 - 0s - loss: 0.1839 - acc: 0.9551 - val_loss: 0.5525 - val_acc: 0.8260
Epoch 8/20
 - 0s - loss: 0.1086 - acc: 0.9850 - val_loss: 0.5943 - val_acc: 0.8150
Epoch 9/20
 - 0s - loss: 0.0823 - acc: 0.9915 - val_loss: 0.5448 - val_acc: 0.8276
Epoch 10/20
 - 0s - loss: 0.0670 - acc: 0.9957 - val_loss: 0.5449 - val_acc: 0.8377
Epoch 11/20
 - 0s - loss: 0.0465 - acc: 0.9979 - val_loss: 0.6302 - val_acc: 0.8181
Epoch 12/20
 - 0s - loss: 0.0382 - acc: 0.9979 - val_loss: 0.5895 - val_acc: 0.8310
Epoch 13/20
 - 0s - loss: 0.0499 - acc: 0.9872 - val_loss: 0.8242 - val_acc: 0.7682
Epoch 14/20
 - 0s - loss: 0.0305 - acc: 0.9957 - val_loss: 0.5903 - val_acc: 0.8365
Epoch 15/20
 - 0s - loss: 0.0146 - acc: 1.0000 - val_loss: 0.5678 - val_acc: 0.8495
Epoch 16/20
 - 0s - loss: 0.0111 - acc: 1.0000 - val_loss: 0.5695 - val_acc: 0.8478
Epoch 17/20
 - 0s - loss: 0.0098 - acc: 1.0000 - val_loss: 0.6165 - val_acc: 0.8419
Epoch 18/20
 - 0s - loss: 0.0730 - acc: 0.9808 - val_loss: 0.7264 - val_acc: 0.8188
Epoch 19/20
 - 0s - loss: 0.0182 - acc: 0.9957 - val_loss: 0.5931 - val_acc: 0.8469
Epoch 20/20
 - 0s - loss: 0.0065 - acc: 1.0000 - val_loss: 0.5891 - val_acc: 0.8500
Test loss: 0.5891055178895592
Test accuracy: 0.85
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 6.9501 - acc: 0.0962 - val_loss: 6.8075 - val_acc: 0.0958
Epoch 2/20
 - 0s - loss: 4.4811 - acc: 0.0983 - val_loss: 2.2163 - val_acc: 0.2231
Epoch 3/20
 - 0s - loss: 2.2307 - acc: 0.1838 - val_loss: 2.0522 - val_acc: 0.2956
Epoch 4/20
 - 0s - loss: 2.0947 - acc: 0.2585 - val_loss: 2.0154 - val_acc: 0.3026
Epoch 5/20
 - 0s - loss: 1.9053 - acc: 0.3568 - val_loss: 1.9606 - val_acc: 0.3144
Epoch 6/20
 - 0s - loss: 1.9907 - acc: 0.2991 - val_loss: 1.8870 - val_acc: 0.3848
Epoch 7/20
 - 0s - loss: 1.7097 - acc: 0.4466 - val_loss: 1.7940 - val_acc: 0.4724
Epoch 8/20
 - 0s - loss: 1.6393 - acc: 0.4679 - val_loss: 2.1869 - val_acc: 0.2908
Epoch 9/20
 - 0s - loss: 1.9122 - acc: 0.3825 - val_loss: 1.3836 - val_acc: 0.6721
Epoch 10/20
 - 0s - loss: 1.5930 - acc: 0.4936 - val_loss: 1.7382 - val_acc: 0.3796
Epoch 11/20
 - 0s - loss: 1.5067 - acc: 0.5107 - val_loss: 1.3510 - val_acc: 0.5908
Epoch 12/20
 - 0s - loss: 1.3187 - acc: 0.5726 - val_loss: 1.4999 - val_acc: 0.4662
Epoch 13/20
 - 0s - loss: 1.2203 - acc: 0.6004 - val_loss: 1.6402 - val_acc: 0.4427
Epoch 14/20
 - 0s - loss: 1.6901 - acc: 0.4423 - val_loss: 1.4339 - val_acc: 0.5424
Epoch 15/20
 - 0s - loss: 1.1483 - acc: 0.6197 - val_loss: 1.1502 - val_acc: 0.6139
Epoch 16/20
 - 0s - loss: 1.1348 - acc: 0.6239 - val_loss: 1.4423 - val_acc: 0.4284
Epoch 17/20
 - 0s - loss: 1.1873 - acc: 0.6090 - val_loss: 0.9586 - val_acc: 0.7029
Epoch 18/20
 - 0s - loss: 0.8434 - acc: 0.7564 - val_loss: 1.2487 - val_acc: 0.5629
Epoch 19/20
 - 0s - loss: 1.0805 - acc: 0.6496 - val_loss: 1.0760 - val_acc: 0.6274
Epoch 20/20
 - 0s - loss: 0.8734 - acc: 0.7222 - val_loss: 1.4121 - val_acc: 0.5114
Test loss: 1.4115019205093384
Test accuracy: 0.5132
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0435 - acc: 0.3205 - val_loss: 1.6676 - val_acc: 0.4471
Epoch 2/20
 - 0s - loss: 1.3596 - acc: 0.5299 - val_loss: 1.2410 - val_acc: 0.5948
Epoch 3/20
 - 0s - loss: 0.7446 - acc: 0.7906 - val_loss: 1.0561 - val_acc: 0.6357
Epoch 4/20
 - 0s - loss: 0.5448 - acc: 0.8590 - val_loss: 0.9301 - val_acc: 0.6845
Epoch 5/20
 - 0s - loss: 0.3519 - acc: 0.9274 - val_loss: 0.8929 - val_acc: 0.7033
Epoch 6/20
 - 0s - loss: 0.2675 - acc: 0.9402 - val_loss: 0.8184 - val_acc: 0.7033
Epoch 7/20
 - 0s - loss: 0.2055 - acc: 0.9573 - val_loss: 0.7451 - val_acc: 0.7610
Epoch 8/20
 - 0s - loss: 0.1516 - acc: 0.9701 - val_loss: 0.7163 - val_acc: 0.7748
Epoch 9/20
 - 0s - loss: 0.0927 - acc: 0.9957 - val_loss: 0.7510 - val_acc: 0.7636
Epoch 10/20
 - 0s - loss: 0.0752 - acc: 1.0000 - val_loss: 0.8101 - val_acc: 0.7519
Epoch 11/20
 - 0s - loss: 0.0684 - acc: 1.0000 - val_loss: 0.8846 - val_acc: 0.7516
Epoch 12/20
 - 0s - loss: 0.0835 - acc: 0.9829 - val_loss: 0.9161 - val_acc: 0.7496
Epoch 13/20
 - 0s - loss: 0.0525 - acc: 1.0000 - val_loss: 0.7475 - val_acc: 0.7812
Epoch 14/20
 - 0s - loss: 0.0315 - acc: 1.0000 - val_loss: 0.7405 - val_acc: 0.7851
Epoch 15/20
 - 0s - loss: 0.0251 - acc: 1.0000 - val_loss: 0.7480 - val_acc: 0.7886
Epoch 16/20
 - 0s - loss: 0.0192 - acc: 1.0000 - val_loss: 0.7449 - val_acc: 0.7892
Epoch 17/20
 - 0s - loss: 0.0185 - acc: 1.0000 - val_loss: 0.7572 - val_acc: 0.7866
Epoch 18/20
 - 0s - loss: 0.0153 - acc: 1.0000 - val_loss: 0.8271 - val_acc: 0.7769
Epoch 19/20
 - 0s - loss: 0.0117 - acc: 1.0000 - val_loss: 0.7915 - val_acc: 0.7825
Epoch 20/20
 - 0s - loss: 0.0089 - acc: 1.0000 - val_loss: 0.7699 - val_acc: 0.7919
Test loss: 0.7698905545532704
Test accuracy: 0.7919
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.5279 - acc: 0.0983 - val_loss: 6.5417 - val_acc: 0.1036
Epoch 2/20
 - 0s - loss: 6.3295 - acc: 0.1410 - val_loss: 4.9832 - val_acc: 0.1135
Epoch 3/20
 - 0s - loss: 4.0659 - acc: 0.1154 - val_loss: 2.3029 - val_acc: 0.2102
Epoch 4/20
 - 0s - loss: 2.2367 - acc: 0.2137 - val_loss: 2.1505 - val_acc: 0.2517
Epoch 5/20
 - 0s - loss: 2.0722 - acc: 0.2350 - val_loss: 2.1763 - val_acc: 0.1948
Epoch 6/20
 - 0s - loss: 2.1866 - acc: 0.2265 - val_loss: 2.0520 - val_acc: 0.3065
Epoch 7/20
 - 0s - loss: 1.9556 - acc: 0.3376 - val_loss: 1.9752 - val_acc: 0.3323
Epoch 8/20
 - 0s - loss: 1.8161 - acc: 0.4487 - val_loss: 1.8833 - val_acc: 0.3934
Epoch 9/20
 - 0s - loss: 1.7708 - acc: 0.4487 - val_loss: 1.8989 - val_acc: 0.4226
Epoch 10/20
 - 0s - loss: 1.8667 - acc: 0.3590 - val_loss: 2.5031 - val_acc: 0.1763
Epoch 11/20
 - 0s - loss: 2.4273 - acc: 0.2222 - val_loss: 2.3142 - val_acc: 0.1423
Epoch 12/20
 - 0s - loss: 2.0789 - acc: 0.2821 - val_loss: 1.8042 - val_acc: 0.5446
Epoch 13/20
 - 0s - loss: 1.6147 - acc: 0.5983 - val_loss: 1.7207 - val_acc: 0.4690
Epoch 14/20
 - 0s - loss: 1.6977 - acc: 0.4573 - val_loss: 1.8648 - val_acc: 0.4507
Epoch 15/20
 - 0s - loss: 1.5924 - acc: 0.4872 - val_loss: 1.7221 - val_acc: 0.4874
Epoch 16/20
 - 0s - loss: 1.5719 - acc: 0.5128 - val_loss: 1.9619 - val_acc: 0.3746
Epoch 17/20
 - 0s - loss: 1.6828 - acc: 0.4359 - val_loss: 1.8397 - val_acc: 0.3861
Epoch 18/20
 - 0s - loss: 1.7012 - acc: 0.4017 - val_loss: 1.8236 - val_acc: 0.3784
Epoch 19/20
 - 0s - loss: 1.5052 - acc: 0.5513 - val_loss: 1.4035 - val_acc: 0.6153
Epoch 20/20
 - 0s - loss: 1.1730 - acc: 0.6880 - val_loss: 1.5108 - val_acc: 0.4912
Test loss: 1.5111608795166016
Test accuracy: 0.4911
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3684 - acc: 0.0855 - val_loss: 2.0146 - val_acc: 0.3661
Epoch 2/20
 - 0s - loss: 1.5824 - acc: 0.4957 - val_loss: 1.5980 - val_acc: 0.5163
Epoch 3/20
 - 0s - loss: 1.0852 - acc: 0.7692 - val_loss: 1.6256 - val_acc: 0.4611
Epoch 4/20
 - 0s - loss: 0.9044 - acc: 0.7350 - val_loss: 1.3468 - val_acc: 0.5524
Epoch 5/20
 - 0s - loss: 0.6610 - acc: 0.8205 - val_loss: 1.1906 - val_acc: 0.6213
Epoch 6/20
 - 0s - loss: 0.3965 - acc: 0.9402 - val_loss: 1.1636 - val_acc: 0.6083
Epoch 7/20
 - 0s - loss: 0.3123 - acc: 0.9316 - val_loss: 1.0434 - val_acc: 0.6699
Epoch 8/20
 - 0s - loss: 0.2653 - acc: 0.9573 - val_loss: 1.1413 - val_acc: 0.6026
Epoch 9/20
 - 0s - loss: 0.2033 - acc: 0.9658 - val_loss: 1.0275 - val_acc: 0.6828
Epoch 10/20
 - 0s - loss: 0.1616 - acc: 0.9829 - val_loss: 0.9856 - val_acc: 0.6858
Epoch 11/20
 - 0s - loss: 0.0881 - acc: 1.0000 - val_loss: 0.9268 - val_acc: 0.7226
Epoch 12/20
 - 0s - loss: 0.0779 - acc: 1.0000 - val_loss: 0.9679 - val_acc: 0.7050
Epoch 13/20
 - 0s - loss: 0.0555 - acc: 1.0000 - val_loss: 0.9677 - val_acc: 0.7152
Epoch 14/20
 - 0s - loss: 0.0410 - acc: 1.0000 - val_loss: 0.9630 - val_acc: 0.7138
Epoch 15/20
 - 0s - loss: 0.0421 - acc: 1.0000 - val_loss: 0.9396 - val_acc: 0.7249
Epoch 16/20
 - 0s - loss: 0.0318 - acc: 1.0000 - val_loss: 0.9543 - val_acc: 0.7214
Epoch 17/20
 - 0s - loss: 0.0259 - acc: 1.0000 - val_loss: 0.9541 - val_acc: 0.7252
Epoch 18/20
 - 0s - loss: 0.0222 - acc: 1.0000 - val_loss: 0.9684 - val_acc: 0.7235
Epoch 19/20
 - 0s - loss: 0.0221 - acc: 1.0000 - val_loss: 0.9783 - val_acc: 0.7212
Epoch 20/20
 - 0s - loss: 0.0217 - acc: 1.0000 - val_loss: 1.0071 - val_acc: 0.7169
Test loss: 1.0070949609279634
Test accuracy: 0.7169
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7194 - acc: 0.1709 - val_loss: 7.3476 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 7.3175 - acc: 0.1453 - val_loss: 7.3353 - val_acc: 0.0982
Epoch 3/20
 - 0s - loss: 8.0328 - acc: 0.1026 - val_loss: 6.1571 - val_acc: 0.1720
Epoch 4/20
 - 0s - loss: 7.2811 - acc: 0.1709 - val_loss: 4.1047 - val_acc: 0.1556
Epoch 5/20
 - 0s - loss: 4.6628 - acc: 0.1026 - val_loss: 2.7084 - val_acc: 0.1058
Epoch 6/20
 - 0s - loss: 2.8610 - acc: 0.1368 - val_loss: 2.3246 - val_acc: 0.1604
Epoch 7/20
 - 0s - loss: 2.3289 - acc: 0.1795 - val_loss: 2.1948 - val_acc: 0.3195
Epoch 8/20
 - 0s - loss: 2.1175 - acc: 0.2906 - val_loss: 2.1764 - val_acc: 0.1752
Epoch 9/20
 - 0s - loss: 2.0615 - acc: 0.2991 - val_loss: 2.1054 - val_acc: 0.4204
Epoch 10/20
 - 0s - loss: 2.0102 - acc: 0.3419 - val_loss: 2.1673 - val_acc: 0.1338
Epoch 11/20
 - 0s - loss: 1.9792 - acc: 0.2137 - val_loss: 2.1392 - val_acc: 0.2195
Epoch 12/20
 - 0s - loss: 2.1105 - acc: 0.2991 - val_loss: 2.0696 - val_acc: 0.3130
Epoch 13/20
 - 0s - loss: 1.8758 - acc: 0.3504 - val_loss: 2.0944 - val_acc: 0.3089
Epoch 14/20
 - 0s - loss: 1.8747 - acc: 0.3590 - val_loss: 2.1420 - val_acc: 0.3277
Epoch 15/20
 - 0s - loss: 1.8528 - acc: 0.4188 - val_loss: 2.0779 - val_acc: 0.1921
Epoch 16/20
 - 0s - loss: 1.8751 - acc: 0.2821 - val_loss: 2.1895 - val_acc: 0.2996
Epoch 17/20
 - 0s - loss: 1.9067 - acc: 0.4103 - val_loss: 1.8966 - val_acc: 0.3299
Epoch 18/20
 - 0s - loss: 1.6798 - acc: 0.4530 - val_loss: 2.1323 - val_acc: 0.3153
Epoch 19/20
 - 0s - loss: 1.8107 - acc: 0.4444 - val_loss: 1.9136 - val_acc: 0.2726
Epoch 20/20
 - 0s - loss: 1.6608 - acc: 0.4188 - val_loss: 2.0202 - val_acc: 0.2193
Test loss: 2.020188735961914
Test accuracy: 0.218
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2464 - acc: 0.9234 - val_loss: 0.1116 - val_acc: 0.9650
Epoch 2/20
 - 3s - loss: 0.1026 - acc: 0.9686 - val_loss: 0.0808 - val_acc: 0.9757
Epoch 3/20
 - 3s - loss: 0.0752 - acc: 0.9779 - val_loss: 0.0864 - val_acc: 0.9754
Epoch 4/20
 - 3s - loss: 0.0629 - acc: 0.9812 - val_loss: 0.0886 - val_acc: 0.9758
Epoch 5/20
 - 3s - loss: 0.0530 - acc: 0.9850 - val_loss: 0.0783 - val_acc: 0.9800
Epoch 6/20
 - 3s - loss: 0.0471 - acc: 0.9856 - val_loss: 0.0821 - val_acc: 0.9804
Epoch 7/20
 - 3s - loss: 0.0421 - acc: 0.9878 - val_loss: 0.0849 - val_acc: 0.9803
Epoch 8/20
 - 3s - loss: 0.0358 - acc: 0.9898 - val_loss: 0.0842 - val_acc: 0.9815
Epoch 9/20
 - 3s - loss: 0.0324 - acc: 0.9906 - val_loss: 0.0913 - val_acc: 0.9817
Epoch 10/20
 - 3s - loss: 0.0306 - acc: 0.9911 - val_loss: 0.0922 - val_acc: 0.9816
Epoch 11/20
 - 3s - loss: 0.0287 - acc: 0.9916 - val_loss: 0.0922 - val_acc: 0.9816
Epoch 12/20
 - 3s - loss: 0.0269 - acc: 0.9923 - val_loss: 0.0905 - val_acc: 0.9835
Epoch 13/20
 - 3s - loss: 0.0235 - acc: 0.9933 - val_loss: 0.1073 - val_acc: 0.9814
Epoch 14/20
 - 3s - loss: 0.0256 - acc: 0.9933 - val_loss: 0.1010 - val_acc: 0.9815
Epoch 15/20
 - 3s - loss: 0.0237 - acc: 0.9938 - val_loss: 0.0969 - val_acc: 0.9830
Epoch 16/20
 - 3s - loss: 0.0210 - acc: 0.9938 - val_loss: 0.0961 - val_acc: 0.9837
Epoch 17/20
 - 3s - loss: 0.0222 - acc: 0.9941 - val_loss: 0.1131 - val_acc: 0.9824
Epoch 18/20
 - 3s - loss: 0.0205 - acc: 0.9944 - val_loss: 0.1010 - val_acc: 0.9835
Epoch 19/20
 - 3s - loss: 0.0215 - acc: 0.9950 - val_loss: 0.1049 - val_acc: 0.9829
Epoch 20/20
 - 3s - loss: 0.0211 - acc: 0.9948 - val_loss: 0.1121 - val_acc: 0.9841
Test loss: 0.11208852580621144
Test accuracy: 0.9841
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9136 - acc: 0.7043 - val_loss: 0.3623 - val_acc: 0.8857
Epoch 2/20
 - 5s - loss: 0.4395 - acc: 0.8598 - val_loss: 0.4309 - val_acc: 0.8664
Epoch 3/20
 - 5s - loss: 0.3197 - acc: 0.8997 - val_loss: 0.2082 - val_acc: 0.9365
Epoch 4/20
 - 5s - loss: 0.2685 - acc: 0.9157 - val_loss: 0.1537 - val_acc: 0.9520
Epoch 5/20
 - 5s - loss: 0.2345 - acc: 0.9277 - val_loss: 0.1884 - val_acc: 0.9381
Epoch 6/20
 - 4s - loss: 0.2146 - acc: 0.9341 - val_loss: 0.1506 - val_acc: 0.9513
Epoch 7/20
 - 5s - loss: 0.1986 - acc: 0.9397 - val_loss: 0.1211 - val_acc: 0.9616
Epoch 8/20
 - 5s - loss: 0.1876 - acc: 0.9417 - val_loss: 0.1550 - val_acc: 0.9477
Epoch 9/20
 - 5s - loss: 0.1861 - acc: 0.9448 - val_loss: 0.1741 - val_acc: 0.9441
Epoch 10/20
 - 5s - loss: 0.1761 - acc: 0.9470 - val_loss: 0.1196 - val_acc: 0.9629
Epoch 11/20
 - 5s - loss: 0.1726 - acc: 0.9487 - val_loss: 0.1136 - val_acc: 0.9650
Epoch 12/20
 - 5s - loss: 0.1652 - acc: 0.9510 - val_loss: 0.1021 - val_acc: 0.9708
Epoch 13/20
 - 5s - loss: 0.1684 - acc: 0.9506 - val_loss: 0.1108 - val_acc: 0.9685
Epoch 14/20
 - 5s - loss: 0.1641 - acc: 0.9519 - val_loss: 0.1111 - val_acc: 0.9670
Epoch 15/20
 - 5s - loss: 0.1687 - acc: 0.9519 - val_loss: 0.1535 - val_acc: 0.9561
Epoch 16/20
 - 5s - loss: 0.1615 - acc: 0.9536 - val_loss: 0.1308 - val_acc: 0.9617
Epoch 17/20
 - 5s - loss: 0.1594 - acc: 0.9542 - val_loss: 0.1303 - val_acc: 0.9659
Epoch 18/20
 - 5s - loss: 0.1635 - acc: 0.9542 - val_loss: 0.1246 - val_acc: 0.9698
Epoch 19/20
 - 5s - loss: 0.1580 - acc: 0.9546 - val_loss: 0.0991 - val_acc: 0.9711
Epoch 20/20
 - 5s - loss: 0.1626 - acc: 0.9549 - val_loss: 0.1098 - val_acc: 0.9681
Test loss: 0.11164294672321412
Test accuracy: 0.9683
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.3341 - acc: 0.8977 - val_loss: 0.1452 - val_acc: 0.9539
Epoch 2/20
 - 1s - loss: 0.1307 - acc: 0.9592 - val_loss: 0.1227 - val_acc: 0.9628
Epoch 3/20
 - 1s - loss: 0.0897 - acc: 0.9722 - val_loss: 0.1030 - val_acc: 0.9675
Epoch 4/20
 - 1s - loss: 0.0636 - acc: 0.9794 - val_loss: 0.1139 - val_acc: 0.9670
Epoch 5/20
 - 1s - loss: 0.0523 - acc: 0.9831 - val_loss: 0.0897 - val_acc: 0.9756
Epoch 6/20
 - 1s - loss: 0.0399 - acc: 0.9873 - val_loss: 0.0866 - val_acc: 0.9776
Epoch 7/20
 - 1s - loss: 0.0358 - acc: 0.9882 - val_loss: 0.1000 - val_acc: 0.9754
Epoch 8/20
 - 1s - loss: 0.0318 - acc: 0.9890 - val_loss: 0.1065 - val_acc: 0.9767
Epoch 9/20
 - 1s - loss: 0.0291 - acc: 0.9905 - val_loss: 0.1062 - val_acc: 0.9764
Epoch 10/20
 - 1s - loss: 0.0237 - acc: 0.9924 - val_loss: 0.1064 - val_acc: 0.9776
Epoch 11/20
 - 1s - loss: 0.0205 - acc: 0.9933 - val_loss: 0.1157 - val_acc: 0.9784
Epoch 12/20
 - 1s - loss: 0.0218 - acc: 0.9933 - val_loss: 0.1331 - val_acc: 0.9746
Epoch 13/20
 - 1s - loss: 0.0195 - acc: 0.9947 - val_loss: 0.1208 - val_acc: 0.9785
Epoch 14/20
 - 1s - loss: 0.0189 - acc: 0.9947 - val_loss: 0.1283 - val_acc: 0.9776
Epoch 15/20
 - 1s - loss: 0.0156 - acc: 0.9951 - val_loss: 0.1229 - val_acc: 0.9801
Epoch 16/20
 - 1s - loss: 0.0153 - acc: 0.9953 - val_loss: 0.1263 - val_acc: 0.9777
Epoch 17/20
 - 1s - loss: 0.0110 - acc: 0.9966 - val_loss: 0.1637 - val_acc: 0.9758
Epoch 18/20
 - 1s - loss: 0.0152 - acc: 0.9959 - val_loss: 0.1403 - val_acc: 0.9778
Epoch 19/20
 - 1s - loss: 0.0131 - acc: 0.9960 - val_loss: 0.1458 - val_acc: 0.9760
Epoch 20/20
 - 1s - loss: 0.0129 - acc: 0.9963 - val_loss: 0.1492 - val_acc: 0.9779
Test loss: 0.14922819401181495
Test accuracy: 0.9779
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2376 - acc: 0.6009 - val_loss: 0.6196 - val_acc: 0.7835
Epoch 2/20
 - 2s - loss: 0.6073 - acc: 0.8027 - val_loss: 0.7623 - val_acc: 0.7284
Epoch 3/20
 - 2s - loss: 0.4727 - acc: 0.8501 - val_loss: 0.6338 - val_acc: 0.7997
Epoch 4/20
 - 2s - loss: 0.3810 - acc: 0.8783 - val_loss: 0.3943 - val_acc: 0.8688
Epoch 5/20
 - 2s - loss: 0.3298 - acc: 0.8976 - val_loss: 0.2308 - val_acc: 0.9274
Epoch 6/20
 - 2s - loss: 0.2902 - acc: 0.9100 - val_loss: 0.2004 - val_acc: 0.9349
Epoch 7/20
 - 2s - loss: 0.2656 - acc: 0.9170 - val_loss: 0.2065 - val_acc: 0.9327
Epoch 8/20
 - 2s - loss: 0.2421 - acc: 0.9241 - val_loss: 0.3123 - val_acc: 0.8981
Epoch 9/20
 - 2s - loss: 0.2329 - acc: 0.9278 - val_loss: 0.2065 - val_acc: 0.9344
Epoch 10/20
 - 2s - loss: 0.2151 - acc: 0.9326 - val_loss: 0.1745 - val_acc: 0.9468
Epoch 11/20
 - 2s - loss: 0.2066 - acc: 0.9359 - val_loss: 0.2382 - val_acc: 0.9228
Epoch 12/20
 - 2s - loss: 0.1953 - acc: 0.9387 - val_loss: 0.2291 - val_acc: 0.9327
Epoch 13/20
 - 2s - loss: 0.1897 - acc: 0.9420 - val_loss: 0.2333 - val_acc: 0.9284
Epoch 14/20
 - 2s - loss: 0.1819 - acc: 0.9438 - val_loss: 0.2360 - val_acc: 0.9263
Epoch 15/20
 - 2s - loss: 0.1716 - acc: 0.9468 - val_loss: 0.3039 - val_acc: 0.9062
Epoch 16/20
 - 2s - loss: 0.1690 - acc: 0.9477 - val_loss: 0.2288 - val_acc: 0.9349
Epoch 17/20
 - 2s - loss: 0.1648 - acc: 0.9496 - val_loss: 0.1312 - val_acc: 0.9615
Epoch 18/20
 - 2s - loss: 0.1600 - acc: 0.9519 - val_loss: 0.1440 - val_acc: 0.9601
Epoch 19/20
 - 2s - loss: 0.1586 - acc: 0.9525 - val_loss: 0.1468 - val_acc: 0.9586
Epoch 20/20
 - 2s - loss: 0.1507 - acc: 0.9552 - val_loss: 0.2394 - val_acc: 0.9305
Test loss: 0.24113148214379326
Test accuracy: 0.9306
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4513 - acc: 0.8621 - val_loss: 0.3853 - val_acc: 0.8778
Epoch 2/20
 - 1s - loss: 0.1864 - acc: 0.9439 - val_loss: 0.2023 - val_acc: 0.9365
Epoch 3/20
 - 1s - loss: 0.1201 - acc: 0.9644 - val_loss: 0.1244 - val_acc: 0.9622
Epoch 4/20
 - 1s - loss: 0.0843 - acc: 0.9746 - val_loss: 0.2824 - val_acc: 0.9126
Epoch 5/20
 - 1s - loss: 0.0629 - acc: 0.9795 - val_loss: 0.1097 - val_acc: 0.9679
Epoch 6/20
 - 1s - loss: 0.0507 - acc: 0.9820 - val_loss: 0.1264 - val_acc: 0.9645
Epoch 7/20
 - 1s - loss: 0.0385 - acc: 0.9885 - val_loss: 0.1170 - val_acc: 0.9689
Epoch 8/20
 - 1s - loss: 0.0351 - acc: 0.9889 - val_loss: 0.1254 - val_acc: 0.9683
Epoch 9/20
 - 1s - loss: 0.0275 - acc: 0.9899 - val_loss: 0.1347 - val_acc: 0.9690
Epoch 10/20
 - 1s - loss: 0.0248 - acc: 0.9923 - val_loss: 0.1981 - val_acc: 0.9551
Epoch 11/20
 - 1s - loss: 0.0207 - acc: 0.9933 - val_loss: 0.1522 - val_acc: 0.9680
Epoch 12/20
 - 1s - loss: 0.0192 - acc: 0.9930 - val_loss: 0.1582 - val_acc: 0.9678
Epoch 13/20
 - 1s - loss: 0.0137 - acc: 0.9948 - val_loss: 0.1723 - val_acc: 0.9661
Epoch 14/20
 - 1s - loss: 0.0121 - acc: 0.9955 - val_loss: 0.1565 - val_acc: 0.9707
Epoch 15/20
 - 1s - loss: 0.0129 - acc: 0.9955 - val_loss: 0.1655 - val_acc: 0.9697
Epoch 16/20
 - 1s - loss: 0.0112 - acc: 0.9973 - val_loss: 0.1850 - val_acc: 0.9686
Epoch 17/20
 - 1s - loss: 0.0124 - acc: 0.9958 - val_loss: 0.2420 - val_acc: 0.9599
Epoch 18/20
 - 1s - loss: 0.0109 - acc: 0.9971 - val_loss: 0.1773 - val_acc: 0.9694
Epoch 19/20
 - 1s - loss: 0.0087 - acc: 0.9973 - val_loss: 0.1943 - val_acc: 0.9682
Epoch 20/20
 - 1s - loss: 0.0086 - acc: 0.9969 - val_loss: 0.1919 - val_acc: 0.9696
Test loss: 0.19192508878767178
Test accuracy: 0.9696
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6561 - acc: 0.4756 - val_loss: 0.7799 - val_acc: 0.7521
Epoch 2/20
 - 1s - loss: 0.8470 - acc: 0.7218 - val_loss: 1.2389 - val_acc: 0.5663
Epoch 3/20
 - 1s - loss: 0.6464 - acc: 0.7884 - val_loss: 0.6043 - val_acc: 0.7990
Epoch 4/20
 - 1s - loss: 0.5543 - acc: 0.8233 - val_loss: 1.1473 - val_acc: 0.6424
Epoch 5/20
 - 1s - loss: 0.4844 - acc: 0.8425 - val_loss: 0.8975 - val_acc: 0.7367
Epoch 6/20
 - 1s - loss: 0.4167 - acc: 0.8673 - val_loss: 0.3979 - val_acc: 0.8655
Epoch 7/20
 - 1s - loss: 0.3806 - acc: 0.8796 - val_loss: 0.3670 - val_acc: 0.8796
Epoch 8/20
 - 1s - loss: 0.3532 - acc: 0.8893 - val_loss: 0.6282 - val_acc: 0.8043
Epoch 9/20
 - 1s - loss: 0.3217 - acc: 0.8969 - val_loss: 0.3281 - val_acc: 0.8925
Epoch 10/20
 - 1s - loss: 0.2941 - acc: 0.9076 - val_loss: 0.5091 - val_acc: 0.8295
Epoch 11/20
 - 1s - loss: 0.2800 - acc: 0.9095 - val_loss: 0.2698 - val_acc: 0.9186
Epoch 12/20
 - 1s - loss: 0.2477 - acc: 0.9217 - val_loss: 0.5642 - val_acc: 0.8306
Epoch 13/20
 - 1s - loss: 0.2513 - acc: 0.9197 - val_loss: 0.3548 - val_acc: 0.8800
Epoch 14/20
 - 1s - loss: 0.2347 - acc: 0.9251 - val_loss: 0.1987 - val_acc: 0.9377
Epoch 15/20
 - 1s - loss: 0.2283 - acc: 0.9253 - val_loss: 0.1746 - val_acc: 0.9442
Epoch 16/20
 - 1s - loss: 0.2178 - acc: 0.9316 - val_loss: 0.4404 - val_acc: 0.8675
Epoch 17/20
 - 1s - loss: 0.2173 - acc: 0.9322 - val_loss: 0.2555 - val_acc: 0.9228
Epoch 18/20
 - 1s - loss: 0.1966 - acc: 0.9385 - val_loss: 0.2137 - val_acc: 0.9351
Epoch 19/20
 - 1s - loss: 0.1898 - acc: 0.9400 - val_loss: 0.3327 - val_acc: 0.9009
Epoch 20/20
 - 1s - loss: 0.1859 - acc: 0.9418 - val_loss: 0.8660 - val_acc: 0.7787
Test loss: 0.8671995775699616
Test accuracy: 0.7769
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6046 - acc: 0.8149 - val_loss: 0.3564 - val_acc: 0.8884
Epoch 2/20
 - 0s - loss: 0.2463 - acc: 0.9261 - val_loss: 0.2326 - val_acc: 0.9295
Epoch 3/20
 - 0s - loss: 0.1681 - acc: 0.9499 - val_loss: 0.2753 - val_acc: 0.9155
Epoch 4/20
 - 0s - loss: 0.1171 - acc: 0.9636 - val_loss: 0.2037 - val_acc: 0.9389
Epoch 5/20
 - 0s - loss: 0.0844 - acc: 0.9749 - val_loss: 0.1711 - val_acc: 0.9485
Epoch 6/20
 - 0s - loss: 0.0550 - acc: 0.9831 - val_loss: 0.1789 - val_acc: 0.9520
Epoch 7/20
 - 0s - loss: 0.0479 - acc: 0.9845 - val_loss: 0.1847 - val_acc: 0.9509
Epoch 8/20
 - 0s - loss: 0.0354 - acc: 0.9876 - val_loss: 0.1962 - val_acc: 0.9499
Epoch 9/20
 - 0s - loss: 0.0318 - acc: 0.9911 - val_loss: 0.1931 - val_acc: 0.9544
Epoch 10/20
 - 0s - loss: 0.0210 - acc: 0.9929 - val_loss: 0.1872 - val_acc: 0.9554
Epoch 11/20
 - 0s - loss: 0.0136 - acc: 0.9961 - val_loss: 0.2029 - val_acc: 0.9572
Epoch 12/20
 - 0s - loss: 0.0154 - acc: 0.9956 - val_loss: 0.2370 - val_acc: 0.9518
Epoch 13/20
 - 0s - loss: 0.0142 - acc: 0.9951 - val_loss: 0.2680 - val_acc: 0.9459
Epoch 14/20
 - 0s - loss: 0.0083 - acc: 0.9977 - val_loss: 0.2234 - val_acc: 0.9578
Epoch 15/20
 - 0s - loss: 0.0127 - acc: 0.9956 - val_loss: 0.2170 - val_acc: 0.9573
Epoch 16/20
 - 0s - loss: 0.0064 - acc: 0.9981 - val_loss: 0.2509 - val_acc: 0.9535
Epoch 17/20
 - 0s - loss: 0.0073 - acc: 0.9977 - val_loss: 0.3061 - val_acc: 0.9479
Epoch 18/20
 - 0s - loss: 0.0118 - acc: 0.9960 - val_loss: 0.2491 - val_acc: 0.9565
Epoch 19/20
 - 0s - loss: 0.0094 - acc: 0.9971 - val_loss: 0.2559 - val_acc: 0.9540
Epoch 20/20
 - 0s - loss: 0.0066 - acc: 0.9975 - val_loss: 0.2513 - val_acc: 0.9561
Test loss: 0.25132565903857074
Test accuracy: 0.9561
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.1058 - acc: 0.3497 - val_loss: 1.4353 - val_acc: 0.5049
Epoch 2/20
 - 1s - loss: 1.1344 - acc: 0.6169 - val_loss: 0.9027 - val_acc: 0.6984
Epoch 3/20
 - 1s - loss: 0.8900 - acc: 0.7093 - val_loss: 0.7004 - val_acc: 0.7730
Epoch 4/20
 - 1s - loss: 0.7390 - acc: 0.7612 - val_loss: 0.7491 - val_acc: 0.7614
Epoch 5/20
 - 1s - loss: 0.6472 - acc: 0.7915 - val_loss: 0.4874 - val_acc: 0.8351
Epoch 6/20
 - 1s - loss: 0.5927 - acc: 0.8121 - val_loss: 0.5160 - val_acc: 0.8407
Epoch 7/20
 - 1s - loss: 0.5533 - acc: 0.8256 - val_loss: 0.4886 - val_acc: 0.8345
Epoch 8/20
 - 1s - loss: 0.5284 - acc: 0.8324 - val_loss: 0.3365 - val_acc: 0.8951
Epoch 9/20
 - 1s - loss: 0.4430 - acc: 0.8591 - val_loss: 0.3970 - val_acc: 0.8736
Epoch 10/20
 - 1s - loss: 0.4203 - acc: 0.8623 - val_loss: 0.4372 - val_acc: 0.8600
Epoch 11/20
 - 1s - loss: 0.3959 - acc: 0.8760 - val_loss: 0.5264 - val_acc: 0.8311
Epoch 12/20
 - 1s - loss: 0.3698 - acc: 0.8847 - val_loss: 0.5977 - val_acc: 0.8094
Epoch 13/20
 - 1s - loss: 0.3954 - acc: 0.8761 - val_loss: 0.2616 - val_acc: 0.9181
Epoch 14/20
 - 1s - loss: 0.3320 - acc: 0.8952 - val_loss: 0.3993 - val_acc: 0.8707
Epoch 15/20
 - 1s - loss: 0.3209 - acc: 0.9005 - val_loss: 0.5557 - val_acc: 0.8214
Epoch 16/20
 - 1s - loss: 0.3060 - acc: 0.9027 - val_loss: 0.3922 - val_acc: 0.8835
Epoch 17/20
 - 1s - loss: 0.3006 - acc: 0.9067 - val_loss: 0.3753 - val_acc: 0.8839
Epoch 18/20
 - 1s - loss: 0.2679 - acc: 0.9084 - val_loss: 0.2403 - val_acc: 0.9259
Epoch 19/20
 - 1s - loss: 0.2823 - acc: 0.9105 - val_loss: 0.3057 - val_acc: 0.9126
Epoch 20/20
 - 1s - loss: 0.2600 - acc: 0.9199 - val_loss: 0.2609 - val_acc: 0.9194
Test loss: 0.2616645088825375
Test accuracy: 0.9193
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8056 - acc: 0.7421 - val_loss: 0.4141 - val_acc: 0.8758
Epoch 2/20
 - 0s - loss: 0.3287 - acc: 0.8979 - val_loss: 0.4396 - val_acc: 0.8692
Epoch 3/20
 - 0s - loss: 0.2414 - acc: 0.9272 - val_loss: 0.3216 - val_acc: 0.9022
Epoch 4/20
 - 0s - loss: 0.1609 - acc: 0.9525 - val_loss: 0.2778 - val_acc: 0.9178
Epoch 5/20
 - 0s - loss: 0.1386 - acc: 0.9587 - val_loss: 0.3122 - val_acc: 0.9031
Epoch 6/20
 - 0s - loss: 0.0954 - acc: 0.9723 - val_loss: 0.2399 - val_acc: 0.9281
Epoch 7/20
 - 0s - loss: 0.0637 - acc: 0.9827 - val_loss: 0.2526 - val_acc: 0.9274
Epoch 8/20
 - 0s - loss: 0.0549 - acc: 0.9845 - val_loss: 0.2334 - val_acc: 0.9368
Epoch 9/20
 - 0s - loss: 0.0374 - acc: 0.9901 - val_loss: 0.3110 - val_acc: 0.9217
Epoch 10/20
 - 0s - loss: 0.0374 - acc: 0.9899 - val_loss: 0.2406 - val_acc: 0.9335
Epoch 11/20
 - 0s - loss: 0.0216 - acc: 0.9944 - val_loss: 0.2391 - val_acc: 0.9389
Epoch 12/20
 - 0s - loss: 0.0173 - acc: 0.9949 - val_loss: 0.2944 - val_acc: 0.9286
Epoch 13/20
 - 0s - loss: 0.0228 - acc: 0.9947 - val_loss: 0.2535 - val_acc: 0.9396
Epoch 14/20
 - 0s - loss: 0.0107 - acc: 0.9976 - val_loss: 0.2764 - val_acc: 0.9384
Epoch 15/20
 - 0s - loss: 0.0184 - acc: 0.9936 - val_loss: 0.2914 - val_acc: 0.9395
Epoch 16/20
 - 0s - loss: 0.0048 - acc: 0.9995 - val_loss: 0.3119 - val_acc: 0.9348
Epoch 17/20
 - 0s - loss: 0.0115 - acc: 0.9965 - val_loss: 0.2877 - val_acc: 0.9411
Epoch 18/20
 - 0s - loss: 0.0184 - acc: 0.9949 - val_loss: 0.3170 - val_acc: 0.9379
Epoch 19/20
 - 0s - loss: 0.0084 - acc: 0.9979 - val_loss: 0.2846 - val_acc: 0.9422
Epoch 20/20
 - 0s - loss: 0.0022 - acc: 0.9997 - val_loss: 0.2942 - val_acc: 0.9429
Test loss: 0.2941812202812989
Test accuracy: 0.9429
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.3768 - acc: 0.2456 - val_loss: 1.9217 - val_acc: 0.2728
Epoch 2/20
 - 1s - loss: 1.5339 - acc: 0.4840 - val_loss: 1.6731 - val_acc: 0.3514
Epoch 3/20
 - 1s - loss: 1.2142 - acc: 0.5917 - val_loss: 1.0584 - val_acc: 0.6296
Epoch 4/20
 - 1s - loss: 0.9937 - acc: 0.6667 - val_loss: 1.4933 - val_acc: 0.4810
Epoch 5/20
 - 1s - loss: 0.9039 - acc: 0.7112 - val_loss: 1.4186 - val_acc: 0.5279
Epoch 6/20
 - 1s - loss: 0.8091 - acc: 0.7323 - val_loss: 0.7898 - val_acc: 0.7383
Epoch 7/20
 - 1s - loss: 0.7405 - acc: 0.7536 - val_loss: 0.9267 - val_acc: 0.6980
Epoch 8/20
 - 1s - loss: 0.6731 - acc: 0.7771 - val_loss: 0.8129 - val_acc: 0.7386
Epoch 9/20
 - 1s - loss: 0.6880 - acc: 0.7768 - val_loss: 0.6773 - val_acc: 0.7822
Epoch 10/20
 - 1s - loss: 0.5571 - acc: 0.8243 - val_loss: 0.8093 - val_acc: 0.7483
Epoch 11/20
 - 1s - loss: 0.6388 - acc: 0.7904 - val_loss: 0.6216 - val_acc: 0.7783
Epoch 12/20
 - 1s - loss: 0.5459 - acc: 0.8216 - val_loss: 0.5770 - val_acc: 0.8136
Epoch 13/20
 - 1s - loss: 0.5241 - acc: 0.8253 - val_loss: 0.5890 - val_acc: 0.7817
Epoch 14/20
 - 1s - loss: 0.4947 - acc: 0.8384 - val_loss: 0.7148 - val_acc: 0.7504
Epoch 15/20
 - 1s - loss: 0.5053 - acc: 0.8323 - val_loss: 0.5999 - val_acc: 0.7947
Epoch 16/20
 - 1s - loss: 0.4598 - acc: 0.8587 - val_loss: 0.5153 - val_acc: 0.8230
Epoch 17/20
 - 1s - loss: 0.4598 - acc: 0.8509 - val_loss: 0.4629 - val_acc: 0.8540
Epoch 18/20
 - 1s - loss: 0.3911 - acc: 0.8752 - val_loss: 0.5642 - val_acc: 0.8218
Epoch 19/20
 - 1s - loss: 0.3779 - acc: 0.8725 - val_loss: 0.5142 - val_acc: 0.8333
Epoch 20/20
 - 1s - loss: 0.4053 - acc: 0.8736 - val_loss: 0.3327 - val_acc: 0.8951
Test loss: 0.3330753343358636
Test accuracy: 0.8948
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1198 - acc: 0.6309 - val_loss: 0.5635 - val_acc: 0.8122
Epoch 2/20
 - 0s - loss: 0.4675 - acc: 0.8640 - val_loss: 0.4289 - val_acc: 0.8644
Epoch 3/20
 - 0s - loss: 0.3222 - acc: 0.8981 - val_loss: 0.4483 - val_acc: 0.8627
Epoch 4/20
 - 0s - loss: 0.2546 - acc: 0.9211 - val_loss: 0.3782 - val_acc: 0.8765
Epoch 5/20
 - 0s - loss: 0.1854 - acc: 0.9531 - val_loss: 0.5741 - val_acc: 0.8298
Epoch 6/20
 - 0s - loss: 0.1517 - acc: 0.9568 - val_loss: 0.3875 - val_acc: 0.8833
Epoch 7/20
 - 0s - loss: 0.1020 - acc: 0.9707 - val_loss: 0.3541 - val_acc: 0.8959
Epoch 8/20
 - 0s - loss: 0.0857 - acc: 0.9707 - val_loss: 0.2842 - val_acc: 0.9186
Epoch 9/20
 - 0s - loss: 0.0844 - acc: 0.9723 - val_loss: 0.2824 - val_acc: 0.9201
Epoch 10/20
 - 0s - loss: 0.0356 - acc: 0.9947 - val_loss: 0.3131 - val_acc: 0.9124
Epoch 11/20
 - 0s - loss: 0.0361 - acc: 0.9915 - val_loss: 0.3033 - val_acc: 0.9212
Epoch 12/20
 - 0s - loss: 0.0236 - acc: 0.9947 - val_loss: 0.3233 - val_acc: 0.9174
Epoch 13/20
 - 0s - loss: 0.0288 - acc: 0.9915 - val_loss: 0.3851 - val_acc: 0.9066
Epoch 14/20
 - 0s - loss: 0.0154 - acc: 0.9957 - val_loss: 0.3468 - val_acc: 0.9165
Epoch 15/20
 - 0s - loss: 0.0369 - acc: 0.9904 - val_loss: 0.3388 - val_acc: 0.9200
Epoch 16/20
 - 0s - loss: 0.0127 - acc: 0.9963 - val_loss: 0.3570 - val_acc: 0.9183
Epoch 17/20
 - 0s - loss: 0.0061 - acc: 0.9995 - val_loss: 0.3672 - val_acc: 0.9164
Epoch 18/20
 - 0s - loss: 0.0129 - acc: 0.9957 - val_loss: 0.3389 - val_acc: 0.9258
Epoch 19/20
 - 0s - loss: 0.0042 - acc: 1.0000 - val_loss: 0.3861 - val_acc: 0.9175
Epoch 20/20
 - 0s - loss: 0.0048 - acc: 0.9989 - val_loss: 0.3989 - val_acc: 0.9185
Test loss: 0.39889617677914213
Test accuracy: 0.9185
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2275 - acc: 0.1760 - val_loss: 2.3891 - val_acc: 0.1394
Epoch 2/20
 - 1s - loss: 1.9922 - acc: 0.3141 - val_loss: 1.6864 - val_acc: 0.3943
Epoch 3/20
 - 1s - loss: 1.7498 - acc: 0.4005 - val_loss: 1.4404 - val_acc: 0.5279
Epoch 4/20
 - 1s - loss: 1.4637 - acc: 0.5157 - val_loss: 1.4072 - val_acc: 0.4547
Epoch 5/20
 - 1s - loss: 1.3019 - acc: 0.5685 - val_loss: 1.4163 - val_acc: 0.4328
Epoch 6/20
 - 1s - loss: 1.1970 - acc: 0.5909 - val_loss: 0.7397 - val_acc: 0.7914
Epoch 7/20
 - 1s - loss: 1.0423 - acc: 0.6453 - val_loss: 0.8599 - val_acc: 0.7146
Epoch 8/20
 - 1s - loss: 0.8965 - acc: 0.7083 - val_loss: 0.7543 - val_acc: 0.7531
Epoch 9/20
 - 1s - loss: 1.0102 - acc: 0.6752 - val_loss: 1.1629 - val_acc: 0.6574
Epoch 10/20
 - 1s - loss: 0.8999 - acc: 0.7131 - val_loss: 1.0832 - val_acc: 0.6114
Epoch 11/20
 - 1s - loss: 0.7376 - acc: 0.7627 - val_loss: 1.1349 - val_acc: 0.6690
Epoch 12/20
 - 1s - loss: 0.8055 - acc: 0.7360 - val_loss: 0.8919 - val_acc: 0.7143
Epoch 13/20
 - 1s - loss: 0.7353 - acc: 0.7467 - val_loss: 0.6845 - val_acc: 0.7630
Epoch 14/20
 - 1s - loss: 0.7699 - acc: 0.7557 - val_loss: 0.7275 - val_acc: 0.7418
Epoch 15/20
 - 1s - loss: 0.7069 - acc: 0.7776 - val_loss: 0.8226 - val_acc: 0.7303
Epoch 16/20
 - 1s - loss: 0.6238 - acc: 0.7883 - val_loss: 1.0465 - val_acc: 0.6409
Epoch 17/20
 - 1s - loss: 0.7108 - acc: 0.7669 - val_loss: 0.5483 - val_acc: 0.8155
Epoch 18/20
 - 1s - loss: 0.5616 - acc: 0.8165 - val_loss: 0.5084 - val_acc: 0.8358
Epoch 19/20
 - 1s - loss: 0.6620 - acc: 0.7947 - val_loss: 0.4983 - val_acc: 0.8407
Epoch 20/20
 - 1s - loss: 0.5831 - acc: 0.8160 - val_loss: 0.6194 - val_acc: 0.7941
Test loss: 0.6178908792972565
Test accuracy: 0.7923
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5568 - acc: 0.4931 - val_loss: 0.8865 - val_acc: 0.6925
Epoch 2/20
 - 0s - loss: 0.5863 - acc: 0.8218 - val_loss: 0.6951 - val_acc: 0.7614
Epoch 3/20
 - 0s - loss: 0.3996 - acc: 0.8762 - val_loss: 0.4627 - val_acc: 0.8626
Epoch 4/20
 - 0s - loss: 0.3241 - acc: 0.9018 - val_loss: 0.4700 - val_acc: 0.8540
Epoch 5/20
 - 0s - loss: 0.2955 - acc: 0.9072 - val_loss: 0.4414 - val_acc: 0.8619
Epoch 6/20
 - 0s - loss: 0.2010 - acc: 0.9456 - val_loss: 0.4321 - val_acc: 0.8605
Epoch 7/20
 - 0s - loss: 0.1433 - acc: 0.9658 - val_loss: 0.4771 - val_acc: 0.8509
Epoch 8/20
 - 0s - loss: 0.1043 - acc: 0.9765 - val_loss: 0.4221 - val_acc: 0.8749
Epoch 9/20
 - 0s - loss: 0.1058 - acc: 0.9701 - val_loss: 0.5273 - val_acc: 0.8423
Epoch 10/20
 - 0s - loss: 0.0697 - acc: 0.9808 - val_loss: 0.4915 - val_acc: 0.8652
Epoch 11/20
 - 0s - loss: 0.0427 - acc: 0.9915 - val_loss: 0.4862 - val_acc: 0.8672
Epoch 12/20
 - 0s - loss: 0.0374 - acc: 0.9957 - val_loss: 0.4539 - val_acc: 0.8771
Epoch 13/20
 - 0s - loss: 0.0535 - acc: 0.9829 - val_loss: 0.5371 - val_acc: 0.8621
Epoch 14/20
 - 0s - loss: 0.0216 - acc: 0.9979 - val_loss: 0.3974 - val_acc: 0.8960
Epoch 15/20
 - 0s - loss: 0.0120 - acc: 0.9979 - val_loss: 0.7050 - val_acc: 0.8341
Epoch 16/20
 - 0s - loss: 0.0404 - acc: 0.9893 - val_loss: 0.4161 - val_acc: 0.8936
Epoch 17/20
 - 0s - loss: 0.0074 - acc: 1.0000 - val_loss: 0.5152 - val_acc: 0.8779
Epoch 18/20
 - 0s - loss: 0.0078 - acc: 0.9989 - val_loss: 0.4494 - val_acc: 0.8935
Epoch 19/20
 - 0s - loss: 0.0394 - acc: 0.9883 - val_loss: 0.7145 - val_acc: 0.8474
Epoch 20/20
 - 0s - loss: 0.0219 - acc: 0.9936 - val_loss: 0.4640 - val_acc: 0.8897
Test loss: 0.46399120140261946
Test accuracy: 0.8897
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.5022 - acc: 0.1217 - val_loss: 2.2874 - val_acc: 0.2247
Epoch 2/20
 - 1s - loss: 2.1993 - acc: 0.2113 - val_loss: 2.0573 - val_acc: 0.3094
Epoch 3/20
 - 0s - loss: 2.0476 - acc: 0.2807 - val_loss: 1.8741 - val_acc: 0.3298
Epoch 4/20
 - 1s - loss: 1.8604 - acc: 0.3565 - val_loss: 1.8648 - val_acc: 0.3282
Epoch 5/20
 - 1s - loss: 1.7298 - acc: 0.4098 - val_loss: 1.6473 - val_acc: 0.3792
Epoch 6/20
 - 1s - loss: 1.5247 - acc: 0.5005 - val_loss: 2.3327 - val_acc: 0.3076
Epoch 7/20
 - 1s - loss: 1.6197 - acc: 0.4749 - val_loss: 1.4745 - val_acc: 0.4265
Epoch 8/20
 - 1s - loss: 1.3138 - acc: 0.5518 - val_loss: 1.4232 - val_acc: 0.4710
Epoch 9/20
 - 1s - loss: 1.3554 - acc: 0.5518 - val_loss: 2.5583 - val_acc: 0.1644
Epoch 10/20
 - 1s - loss: 1.4462 - acc: 0.5667 - val_loss: 1.1415 - val_acc: 0.5835
Epoch 11/20
 - 1s - loss: 1.0041 - acc: 0.6713 - val_loss: 0.9696 - val_acc: 0.6845
Epoch 12/20
 - 1s - loss: 1.1145 - acc: 0.6009 - val_loss: 0.8841 - val_acc: 0.7328
Epoch 13/20
 - 1s - loss: 0.9394 - acc: 0.7054 - val_loss: 1.3970 - val_acc: 0.5451
Epoch 14/20
 - 1s - loss: 0.9503 - acc: 0.7097 - val_loss: 0.9209 - val_acc: 0.7007
Epoch 15/20
 - 1s - loss: 1.0160 - acc: 0.6681 - val_loss: 1.1168 - val_acc: 0.5927
Epoch 16/20
 - 1s - loss: 0.9257 - acc: 0.7012 - val_loss: 1.1367 - val_acc: 0.5702
Epoch 17/20
 - 0s - loss: 0.9276 - acc: 0.6873 - val_loss: 0.9791 - val_acc: 0.6637
Epoch 18/20
 - 1s - loss: 0.7532 - acc: 0.7503 - val_loss: 1.2387 - val_acc: 0.6262
Epoch 19/20
 - 1s - loss: 0.8731 - acc: 0.7172 - val_loss: 0.6757 - val_acc: 0.7794
Epoch 20/20
 - 1s - loss: 0.7840 - acc: 0.7471 - val_loss: 0.6724 - val_acc: 0.7829
Test loss: 0.6728278326511383
Test accuracy: 0.782
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.6997 - acc: 0.4679 - val_loss: 1.2345 - val_acc: 0.6234
Epoch 2/20
 - 0s - loss: 0.8138 - acc: 0.7692 - val_loss: 1.0131 - val_acc: 0.6881
Epoch 3/20
 - 0s - loss: 0.5187 - acc: 0.8462 - val_loss: 0.6185 - val_acc: 0.8121
Epoch 4/20
 - 0s - loss: 0.3010 - acc: 0.9188 - val_loss: 0.6878 - val_acc: 0.7724
Epoch 5/20
 - 0s - loss: 0.2400 - acc: 0.9252 - val_loss: 0.6827 - val_acc: 0.7778
Epoch 6/20
 - 0s - loss: 0.2306 - acc: 0.9359 - val_loss: 0.5689 - val_acc: 0.8136
Epoch 7/20
 - 0s - loss: 0.1284 - acc: 0.9744 - val_loss: 0.5064 - val_acc: 0.8449
Epoch 8/20
 - 0s - loss: 0.0989 - acc: 0.9808 - val_loss: 0.5815 - val_acc: 0.8274
Epoch 9/20
 - 0s - loss: 0.0727 - acc: 0.9979 - val_loss: 0.5436 - val_acc: 0.8397
Epoch 10/20
 - 0s - loss: 0.0538 - acc: 0.9957 - val_loss: 0.6067 - val_acc: 0.8245
Epoch 11/20
 - 0s - loss: 0.1888 - acc: 0.9274 - val_loss: 0.6895 - val_acc: 0.8010
Epoch 12/20
 - 0s - loss: 0.0569 - acc: 0.9915 - val_loss: 0.5151 - val_acc: 0.8511
Epoch 13/20
 - 0s - loss: 0.0269 - acc: 1.0000 - val_loss: 0.5319 - val_acc: 0.8487
Epoch 14/20
 - 0s - loss: 0.0192 - acc: 1.0000 - val_loss: 0.5560 - val_acc: 0.8458
Epoch 15/20
 - 0s - loss: 0.0116 - acc: 1.0000 - val_loss: 0.5385 - val_acc: 0.8527
Epoch 16/20
 - 0s - loss: 0.0119 - acc: 1.0000 - val_loss: 0.5747 - val_acc: 0.8460
Epoch 17/20
 - 0s - loss: 0.0114 - acc: 0.9979 - val_loss: 0.6274 - val_acc: 0.8405
Epoch 18/20
 - 0s - loss: 0.0099 - acc: 1.0000 - val_loss: 0.7228 - val_acc: 0.8220
Epoch 19/20
 - 0s - loss: 0.0072 - acc: 1.0000 - val_loss: 0.5859 - val_acc: 0.8510
Epoch 20/20
 - 0s - loss: 0.0469 - acc: 0.9850 - val_loss: 1.5099 - val_acc: 0.6784
Test loss: 1.5098677721977234
Test accuracy: 0.6784
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.3291 - acc: 0.1197 - val_loss: 4.2482 - val_acc: 0.1032
Epoch 2/20
 - 0s - loss: 3.0665 - acc: 0.1218 - val_loss: 2.1715 - val_acc: 0.2056
Epoch 3/20
 - 0s - loss: 2.1762 - acc: 0.2222 - val_loss: 2.1569 - val_acc: 0.1536
Epoch 4/20
 - 0s - loss: 2.1273 - acc: 0.2372 - val_loss: 2.0366 - val_acc: 0.2219
Epoch 5/20
 - 0s - loss: 2.0077 - acc: 0.3162 - val_loss: 1.9268 - val_acc: 0.3571
Epoch 6/20
 - 0s - loss: 1.9205 - acc: 0.3333 - val_loss: 1.8981 - val_acc: 0.2951
Epoch 7/20
 - 0s - loss: 1.8762 - acc: 0.3483 - val_loss: 1.7816 - val_acc: 0.4220
Epoch 8/20
 - 0s - loss: 1.7100 - acc: 0.4487 - val_loss: 1.8761 - val_acc: 0.2877
Epoch 9/20
 - 0s - loss: 1.6915 - acc: 0.4765 - val_loss: 1.3984 - val_acc: 0.6400
Epoch 10/20
 - 0s - loss: 1.4398 - acc: 0.5385 - val_loss: 1.7003 - val_acc: 0.3791
Epoch 11/20
 - 0s - loss: 1.4954 - acc: 0.5064 - val_loss: 1.6917 - val_acc: 0.4134
Epoch 12/20
 - 0s - loss: 1.4369 - acc: 0.5064 - val_loss: 1.6725 - val_acc: 0.3727
Epoch 13/20
 - 0s - loss: 1.2702 - acc: 0.5791 - val_loss: 1.9817 - val_acc: 0.2788
Epoch 14/20
 - 0s - loss: 1.8026 - acc: 0.4252 - val_loss: 1.4488 - val_acc: 0.4808
Epoch 15/20
 - 0s - loss: 1.2115 - acc: 0.5983 - val_loss: 1.0464 - val_acc: 0.6508
Epoch 16/20
 - 0s - loss: 1.0731 - acc: 0.6752 - val_loss: 1.4251 - val_acc: 0.4788
Epoch 17/20
 - 0s - loss: 1.1043 - acc: 0.6346 - val_loss: 1.4648 - val_acc: 0.5247
Epoch 18/20
 - 0s - loss: 1.1472 - acc: 0.5983 - val_loss: 1.4207 - val_acc: 0.5681
Epoch 19/20
 - 0s - loss: 0.9124 - acc: 0.7329 - val_loss: 1.2866 - val_acc: 0.5699
Epoch 20/20
 - 0s - loss: 1.0909 - acc: 0.6581 - val_loss: 1.0626 - val_acc: 0.6520
Test loss: 1.0624120408058166
Test accuracy: 0.6524
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0505 - acc: 0.3120 - val_loss: 1.7068 - val_acc: 0.4186
Epoch 2/20
 - 0s - loss: 1.3388 - acc: 0.5513 - val_loss: 1.3432 - val_acc: 0.5778
Epoch 3/20
 - 0s - loss: 0.8488 - acc: 0.7735 - val_loss: 1.1650 - val_acc: 0.6319
Epoch 4/20
 - 0s - loss: 0.5221 - acc: 0.8761 - val_loss: 0.9265 - val_acc: 0.6959
Epoch 5/20
 - 0s - loss: 0.3597 - acc: 0.9316 - val_loss: 0.8838 - val_acc: 0.7025
Epoch 6/20
 - 0s - loss: 0.3173 - acc: 0.9231 - val_loss: 1.0024 - val_acc: 0.6645
Epoch 7/20
 - 0s - loss: 0.2718 - acc: 0.9274 - val_loss: 0.7983 - val_acc: 0.7399
Epoch 8/20
 - 0s - loss: 0.1792 - acc: 0.9615 - val_loss: 0.7523 - val_acc: 0.7745
Epoch 9/20
 - 0s - loss: 0.1310 - acc: 0.9744 - val_loss: 0.7322 - val_acc: 0.7698
Epoch 10/20
 - 0s - loss: 0.0935 - acc: 0.9915 - val_loss: 0.7175 - val_acc: 0.7813
Epoch 11/20
 - 0s - loss: 0.0662 - acc: 0.9957 - val_loss: 0.7440 - val_acc: 0.7775
Epoch 12/20
 - 0s - loss: 0.0607 - acc: 0.9957 - val_loss: 0.8045 - val_acc: 0.7611
Epoch 13/20
 - 0s - loss: 0.0561 - acc: 0.9957 - val_loss: 0.7670 - val_acc: 0.7774
Epoch 14/20
 - 0s - loss: 0.0324 - acc: 1.0000 - val_loss: 0.7763 - val_acc: 0.7811
Epoch 15/20
 - 0s - loss: 0.0284 - acc: 1.0000 - val_loss: 0.8122 - val_acc: 0.7738
Epoch 16/20
 - 0s - loss: 0.0189 - acc: 1.0000 - val_loss: 0.7733 - val_acc: 0.7842
Epoch 17/20
 - 0s - loss: 0.0200 - acc: 1.0000 - val_loss: 0.7660 - val_acc: 0.7870
Epoch 18/20
 - 0s - loss: 0.0159 - acc: 1.0000 - val_loss: 0.7853 - val_acc: 0.7860
Epoch 19/20
 - 0s - loss: 0.0136 - acc: 1.0000 - val_loss: 0.8093 - val_acc: 0.7815
Epoch 20/20
 - 0s - loss: 0.0186 - acc: 1.0000 - val_loss: 0.8677 - val_acc: 0.7686
Test loss: 0.8677160022377968
Test accuracy: 0.7686
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.9488 - acc: 0.0940 - val_loss: 6.3932 - val_acc: 0.1348
Epoch 2/20
 - 0s - loss: 5.8706 - acc: 0.1368 - val_loss: 3.9380 - val_acc: 0.0988
Epoch 3/20
 - 0s - loss: 3.5137 - acc: 0.1368 - val_loss: 2.3883 - val_acc: 0.1135
Epoch 4/20
 - 0s - loss: 2.3973 - acc: 0.1410 - val_loss: 2.2344 - val_acc: 0.1229
Epoch 5/20
 - 0s - loss: 2.1772 - acc: 0.1795 - val_loss: 2.1270 - val_acc: 0.2811
Epoch 6/20
 - 0s - loss: 2.0650 - acc: 0.3077 - val_loss: 2.0813 - val_acc: 0.2156
Epoch 7/20
 - 0s - loss: 2.0452 - acc: 0.2222 - val_loss: 2.1317 - val_acc: 0.3279
Epoch 8/20
 - 0s - loss: 2.0088 - acc: 0.3974 - val_loss: 1.9440 - val_acc: 0.3884
Epoch 9/20
 - 0s - loss: 1.8046 - acc: 0.4487 - val_loss: 1.9504 - val_acc: 0.3378
Epoch 10/20
 - 0s - loss: 1.9274 - acc: 0.3590 - val_loss: 2.0360 - val_acc: 0.2355
Epoch 11/20
 - 0s - loss: 1.8095 - acc: 0.3675 - val_loss: 2.1629 - val_acc: 0.2263
Epoch 12/20
 - 0s - loss: 2.1373 - acc: 0.2735 - val_loss: 1.9586 - val_acc: 0.3680
Epoch 13/20
 - 0s - loss: 1.7871 - acc: 0.4145 - val_loss: 1.8146 - val_acc: 0.4571
Epoch 14/20
 - 0s - loss: 1.5886 - acc: 0.5726 - val_loss: 1.9065 - val_acc: 0.3361
Epoch 15/20
 - 0s - loss: 1.7672 - acc: 0.4060 - val_loss: 1.7453 - val_acc: 0.3957
Epoch 16/20
 - 0s - loss: 1.5989 - acc: 0.4786 - val_loss: 1.9530 - val_acc: 0.3445
Epoch 17/20
 - 0s - loss: 1.6921 - acc: 0.4615 - val_loss: 1.5979 - val_acc: 0.5100
Epoch 18/20
 - 0s - loss: 1.4460 - acc: 0.4957 - val_loss: 1.6876 - val_acc: 0.4426
Epoch 19/20
 - 0s - loss: 1.5692 - acc: 0.5000 - val_loss: 1.5677 - val_acc: 0.4836
Epoch 20/20
 - 0s - loss: 1.3332 - acc: 0.5983 - val_loss: 1.7875 - val_acc: 0.3965
Test loss: 1.787458351135254
Test accuracy: 0.3965
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3615 - acc: 0.1111 - val_loss: 1.9598 - val_acc: 0.3665
Epoch 2/20
 - 0s - loss: 1.5284 - acc: 0.6154 - val_loss: 1.5393 - val_acc: 0.5421
Epoch 3/20
 - 0s - loss: 0.9859 - acc: 0.8205 - val_loss: 1.6689 - val_acc: 0.4198
Epoch 4/20
 - 0s - loss: 0.8486 - acc: 0.7607 - val_loss: 1.5292 - val_acc: 0.5335
Epoch 5/20
 - 0s - loss: 0.8068 - acc: 0.8291 - val_loss: 1.1079 - val_acc: 0.6504
Epoch 6/20
 - 0s - loss: 0.4096 - acc: 0.9573 - val_loss: 1.2703 - val_acc: 0.6072
Epoch 7/20
 - 0s - loss: 0.3220 - acc: 0.8974 - val_loss: 1.1111 - val_acc: 0.6455
Epoch 8/20
 - 0s - loss: 0.2879 - acc: 0.9487 - val_loss: 1.1455 - val_acc: 0.6469
Epoch 9/20
 - 0s - loss: 0.2647 - acc: 0.8974 - val_loss: 1.0549 - val_acc: 0.6486
Epoch 10/20
 - 0s - loss: 0.1669 - acc: 0.9658 - val_loss: 0.9529 - val_acc: 0.7165
Epoch 11/20
 - 0s - loss: 0.0972 - acc: 0.9915 - val_loss: 0.9350 - val_acc: 0.7096
Epoch 12/20
 - 0s - loss: 0.0615 - acc: 1.0000 - val_loss: 0.9270 - val_acc: 0.7185
Epoch 13/20
 - 0s - loss: 0.0500 - acc: 1.0000 - val_loss: 0.9256 - val_acc: 0.7199
Epoch 14/20
 - 0s - loss: 0.0576 - acc: 1.0000 - val_loss: 0.9304 - val_acc: 0.7193
Epoch 15/20
 - 0s - loss: 0.0412 - acc: 1.0000 - val_loss: 0.9271 - val_acc: 0.7237
Epoch 16/20
 - 0s - loss: 0.0327 - acc: 1.0000 - val_loss: 0.9362 - val_acc: 0.7250
Epoch 17/20
 - 0s - loss: 0.0294 - acc: 1.0000 - val_loss: 0.9374 - val_acc: 0.7257
Epoch 18/20
 - 0s - loss: 0.0253 - acc: 1.0000 - val_loss: 0.9608 - val_acc: 0.7205
Epoch 19/20
 - 0s - loss: 0.0205 - acc: 1.0000 - val_loss: 0.9666 - val_acc: 0.7220
Epoch 20/20
 - 0s - loss: 0.0208 - acc: 1.0000 - val_loss: 0.9507 - val_acc: 0.7286
Test loss: 0.9507158442020416
Test accuracy: 0.7286
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.4528 - acc: 0.0940 - val_loss: 10.0813 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 8.8758 - acc: 0.1624 - val_loss: 7.6511 - val_acc: 0.1010
Epoch 3/20
 - 0s - loss: 7.8199 - acc: 0.1111 - val_loss: 5.6843 - val_acc: 0.0998
Epoch 4/20
 - 0s - loss: 6.4746 - acc: 0.1709 - val_loss: 4.3775 - val_acc: 0.1028
Epoch 5/20
 - 0s - loss: 4.9917 - acc: 0.1624 - val_loss: 3.0771 - val_acc: 0.0960
Epoch 6/20
 - 0s - loss: 3.3990 - acc: 0.1453 - val_loss: 2.4412 - val_acc: 0.1492
Epoch 7/20
 - 0s - loss: 2.4441 - acc: 0.2479 - val_loss: 2.2148 - val_acc: 0.2583
Epoch 8/20
 - 0s - loss: 2.1520 - acc: 0.2222 - val_loss: 2.0853 - val_acc: 0.3505
Epoch 9/20
 - 0s - loss: 1.9618 - acc: 0.4017 - val_loss: 2.0367 - val_acc: 0.2670
Epoch 10/20
 - 0s - loss: 1.8660 - acc: 0.3504 - val_loss: 2.0210 - val_acc: 0.2853
Epoch 11/20
 - 0s - loss: 1.8358 - acc: 0.3419 - val_loss: 2.1062 - val_acc: 0.2247
Epoch 12/20
 - 0s - loss: 1.8988 - acc: 0.2991 - val_loss: 2.2638 - val_acc: 0.1762
Epoch 13/20
 - 0s - loss: 2.0893 - acc: 0.2821 - val_loss: 1.9333 - val_acc: 0.4187
Epoch 14/20
 - 0s - loss: 1.7437 - acc: 0.4701 - val_loss: 1.8604 - val_acc: 0.4195
Epoch 15/20
 - 0s - loss: 1.6003 - acc: 0.4957 - val_loss: 1.8551 - val_acc: 0.4083
Epoch 16/20
 - 0s - loss: 1.6449 - acc: 0.4872 - val_loss: 1.8414 - val_acc: 0.4443
Epoch 17/20
 - 0s - loss: 1.5952 - acc: 0.5385 - val_loss: 1.9890 - val_acc: 0.3164
Epoch 18/20
 - 0s - loss: 1.7251 - acc: 0.4444 - val_loss: 1.9986 - val_acc: 0.3511
Epoch 19/20
 - 0s - loss: 1.8080 - acc: 0.4188 - val_loss: 1.8945 - val_acc: 0.3738
Epoch 20/20
 - 0s - loss: 1.5378 - acc: 0.4786 - val_loss: 2.0528 - val_acc: 0.2922
Test loss: 2.0528717880249023
Test accuracy: 0.2923
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2459 - acc: 0.9250 - val_loss: 0.1114 - val_acc: 0.9641
Epoch 2/20
 - 3s - loss: 0.1026 - acc: 0.9684 - val_loss: 0.0874 - val_acc: 0.9740
Epoch 3/20
 - 3s - loss: 0.0753 - acc: 0.9770 - val_loss: 0.0793 - val_acc: 0.9780
Epoch 4/20
 - 3s - loss: 0.0606 - acc: 0.9818 - val_loss: 0.0780 - val_acc: 0.9789
Epoch 5/20
 - 3s - loss: 0.0512 - acc: 0.9848 - val_loss: 0.0722 - val_acc: 0.9813
Epoch 6/20
 - 3s - loss: 0.0426 - acc: 0.9870 - val_loss: 0.0763 - val_acc: 0.9804
Epoch 7/20
 - 3s - loss: 0.0372 - acc: 0.9893 - val_loss: 0.0803 - val_acc: 0.9819
Epoch 8/20
 - 3s - loss: 0.0357 - acc: 0.9897 - val_loss: 0.0927 - val_acc: 0.9796
Epoch 9/20
 - 3s - loss: 0.0314 - acc: 0.9906 - val_loss: 0.0888 - val_acc: 0.9814
Epoch 10/20
 - 3s - loss: 0.0294 - acc: 0.9916 - val_loss: 0.0944 - val_acc: 0.9810
Epoch 11/20
 - 3s - loss: 0.0267 - acc: 0.9926 - val_loss: 0.0856 - val_acc: 0.9836
Epoch 12/20
 - 2s - loss: 0.0262 - acc: 0.9927 - val_loss: 0.1154 - val_acc: 0.9770
Epoch 13/20
 - 3s - loss: 0.0232 - acc: 0.9933 - val_loss: 0.0880 - val_acc: 0.9836
Epoch 14/20
 - 3s - loss: 0.0232 - acc: 0.9940 - val_loss: 0.1093 - val_acc: 0.9813
Epoch 15/20
 - 3s - loss: 0.0192 - acc: 0.9944 - val_loss: 0.0950 - val_acc: 0.9847
Epoch 16/20
 - 3s - loss: 0.0218 - acc: 0.9940 - val_loss: 0.1089 - val_acc: 0.9830
Epoch 17/20
 - 3s - loss: 0.0215 - acc: 0.9946 - val_loss: 0.1080 - val_acc: 0.9824
Epoch 18/20
 - 3s - loss: 0.0188 - acc: 0.9949 - val_loss: 0.1113 - val_acc: 0.9833
Epoch 19/20
 - 3s - loss: 0.0200 - acc: 0.9955 - val_loss: 0.1223 - val_acc: 0.9828
Epoch 20/20
 - 3s - loss: 0.0211 - acc: 0.9947 - val_loss: 0.1187 - val_acc: 0.9830
Test loss: 0.11867257010305507
Test accuracy: 0.983
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9248 - acc: 0.6994 - val_loss: 0.3279 - val_acc: 0.9018
Epoch 2/20
 - 5s - loss: 0.4289 - acc: 0.8638 - val_loss: 0.2192 - val_acc: 0.9295
Epoch 3/20
 - 5s - loss: 0.3190 - acc: 0.8998 - val_loss: 0.2885 - val_acc: 0.9073
Epoch 4/20
 - 5s - loss: 0.2657 - acc: 0.9174 - val_loss: 0.1631 - val_acc: 0.9473
Epoch 5/20
 - 5s - loss: 0.2379 - acc: 0.9261 - val_loss: 0.1677 - val_acc: 0.9479
Epoch 6/20
 - 4s - loss: 0.2176 - acc: 0.9327 - val_loss: 0.1481 - val_acc: 0.9542
Epoch 7/20
 - 5s - loss: 0.2002 - acc: 0.9384 - val_loss: 0.1450 - val_acc: 0.9573
Epoch 8/20
 - 5s - loss: 0.1932 - acc: 0.9410 - val_loss: 0.1261 - val_acc: 0.9596
Epoch 9/20
 - 5s - loss: 0.1838 - acc: 0.9435 - val_loss: 0.1334 - val_acc: 0.9578
Epoch 10/20
 - 5s - loss: 0.1799 - acc: 0.9469 - val_loss: 0.1638 - val_acc: 0.9448
Epoch 11/20
 - 5s - loss: 0.1725 - acc: 0.9484 - val_loss: 0.1353 - val_acc: 0.9586
Epoch 12/20
 - 5s - loss: 0.1723 - acc: 0.9487 - val_loss: 0.1020 - val_acc: 0.9683
Epoch 13/20
 - 5s - loss: 0.1695 - acc: 0.9504 - val_loss: 0.1324 - val_acc: 0.9585
Epoch 14/20
 - 5s - loss: 0.1686 - acc: 0.9514 - val_loss: 0.1388 - val_acc: 0.9588
Epoch 15/20
 - 5s - loss: 0.1665 - acc: 0.9508 - val_loss: 0.1347 - val_acc: 0.9608
Epoch 16/20
 - 5s - loss: 0.1697 - acc: 0.9513 - val_loss: 0.1292 - val_acc: 0.9651
Epoch 17/20
 - 5s - loss: 0.1670 - acc: 0.9521 - val_loss: 0.1200 - val_acc: 0.9673
Epoch 18/20
 - 5s - loss: 0.1673 - acc: 0.9533 - val_loss: 0.1010 - val_acc: 0.9713
Epoch 19/20
 - 5s - loss: 0.1661 - acc: 0.9533 - val_loss: 0.1069 - val_acc: 0.9691
Epoch 20/20
 - 5s - loss: 0.1661 - acc: 0.9544 - val_loss: 0.1629 - val_acc: 0.9604
Test loss: 0.16156681227466324
Test accuracy: 0.9611
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3407 - acc: 0.8969 - val_loss: 0.1518 - val_acc: 0.9552
Epoch 2/20
 - 1s - loss: 0.1329 - acc: 0.9585 - val_loss: 0.1159 - val_acc: 0.9647
Epoch 3/20
 - 1s - loss: 0.0886 - acc: 0.9727 - val_loss: 0.1229 - val_acc: 0.9625
Epoch 4/20
 - 1s - loss: 0.0678 - acc: 0.9788 - val_loss: 0.0894 - val_acc: 0.9746
Epoch 5/20
 - 1s - loss: 0.0509 - acc: 0.9839 - val_loss: 0.1285 - val_acc: 0.9680
Epoch 6/20
 - 1s - loss: 0.0425 - acc: 0.9859 - val_loss: 0.0931 - val_acc: 0.9763
Epoch 7/20
 - 1s - loss: 0.0342 - acc: 0.9894 - val_loss: 0.1006 - val_acc: 0.9756
Epoch 8/20
 - 1s - loss: 0.0307 - acc: 0.9896 - val_loss: 0.1147 - val_acc: 0.9758
Epoch 9/20
 - 1s - loss: 0.0287 - acc: 0.9912 - val_loss: 0.1064 - val_acc: 0.9767
Epoch 10/20
 - 1s - loss: 0.0242 - acc: 0.9915 - val_loss: 0.1086 - val_acc: 0.9777
Epoch 11/20
 - 1s - loss: 0.0225 - acc: 0.9923 - val_loss: 0.1186 - val_acc: 0.9769
Epoch 12/20
 - 1s - loss: 0.0203 - acc: 0.9939 - val_loss: 0.1306 - val_acc: 0.9781
Epoch 13/20
 - 1s - loss: 0.0183 - acc: 0.9945 - val_loss: 0.1226 - val_acc: 0.9769
Epoch 14/20
 - 1s - loss: 0.0166 - acc: 0.9953 - val_loss: 0.1389 - val_acc: 0.9754
Epoch 15/20
 - 1s - loss: 0.0176 - acc: 0.9952 - val_loss: 0.1437 - val_acc: 0.9749
Epoch 16/20
 - 1s - loss: 0.0154 - acc: 0.9948 - val_loss: 0.1347 - val_acc: 0.9776
Epoch 17/20
 - 1s - loss: 0.0117 - acc: 0.9966 - val_loss: 0.1478 - val_acc: 0.9760
Epoch 18/20
 - 1s - loss: 0.0139 - acc: 0.9958 - val_loss: 0.1511 - val_acc: 0.9775
Epoch 19/20
 - 1s - loss: 0.0120 - acc: 0.9965 - val_loss: 0.1471 - val_acc: 0.9779
Epoch 20/20
 - 1s - loss: 0.0149 - acc: 0.9957 - val_loss: 0.1269 - val_acc: 0.9804
Test loss: 0.12691355483679723
Test accuracy: 0.9804
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2179 - acc: 0.6019 - val_loss: 0.7759 - val_acc: 0.7305
Epoch 2/20
 - 2s - loss: 0.5999 - acc: 0.8045 - val_loss: 0.6648 - val_acc: 0.7798
Epoch 3/20
 - 2s - loss: 0.4560 - acc: 0.8533 - val_loss: 0.3867 - val_acc: 0.8743
Epoch 4/20
 - 2s - loss: 0.3813 - acc: 0.8788 - val_loss: 0.5161 - val_acc: 0.8213
Epoch 5/20
 - 2s - loss: 0.3310 - acc: 0.8947 - val_loss: 0.2862 - val_acc: 0.9090
Epoch 6/20
 - 2s - loss: 0.2927 - acc: 0.9088 - val_loss: 0.5136 - val_acc: 0.8483
Epoch 7/20
 - 2s - loss: 0.2702 - acc: 0.9157 - val_loss: 0.2937 - val_acc: 0.9045
Epoch 8/20
 - 2s - loss: 0.2435 - acc: 0.9221 - val_loss: 0.2347 - val_acc: 0.9250
Epoch 9/20
 - 2s - loss: 0.2320 - acc: 0.9281 - val_loss: 0.1789 - val_acc: 0.9445
Epoch 10/20
 - 2s - loss: 0.2171 - acc: 0.9319 - val_loss: 0.3057 - val_acc: 0.9013
Epoch 11/20
 - 2s - loss: 0.2087 - acc: 0.9349 - val_loss: 0.3137 - val_acc: 0.9163
Epoch 12/20
 - 2s - loss: 0.1992 - acc: 0.9381 - val_loss: 0.2081 - val_acc: 0.9310
Epoch 13/20
 - 2s - loss: 0.1956 - acc: 0.9386 - val_loss: 0.1932 - val_acc: 0.9443
Epoch 14/20
 - 2s - loss: 0.1852 - acc: 0.9439 - val_loss: 0.1923 - val_acc: 0.9421
Epoch 15/20
 - 2s - loss: 0.1754 - acc: 0.9443 - val_loss: 0.1423 - val_acc: 0.9584
Epoch 16/20
 - 3s - loss: 0.1678 - acc: 0.9485 - val_loss: 0.1299 - val_acc: 0.9616
Epoch 17/20
 - 2s - loss: 0.1620 - acc: 0.9499 - val_loss: 0.1409 - val_acc: 0.9575
Epoch 18/20
 - 2s - loss: 0.1633 - acc: 0.9496 - val_loss: 0.1116 - val_acc: 0.9658
Epoch 19/20
 - 2s - loss: 0.1532 - acc: 0.9539 - val_loss: 0.1196 - val_acc: 0.9646
Epoch 20/20
 - 2s - loss: 0.1569 - acc: 0.9518 - val_loss: 0.1188 - val_acc: 0.9636
Test loss: 0.11915231478060595
Test accuracy: 0.9639
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4728 - acc: 0.8551 - val_loss: 0.3659 - val_acc: 0.8828
Epoch 2/20
 - 1s - loss: 0.1841 - acc: 0.9437 - val_loss: 0.1486 - val_acc: 0.9534
Epoch 3/20
 - 1s - loss: 0.1238 - acc: 0.9624 - val_loss: 0.1810 - val_acc: 0.9423
Epoch 4/20
 - 1s - loss: 0.0868 - acc: 0.9739 - val_loss: 0.1248 - val_acc: 0.9616
Epoch 5/20
 - 1s - loss: 0.0634 - acc: 0.9803 - val_loss: 0.1501 - val_acc: 0.9572
Epoch 6/20
 - 1s - loss: 0.0479 - acc: 0.9840 - val_loss: 0.1322 - val_acc: 0.9654
Epoch 7/20
 - 1s - loss: 0.0413 - acc: 0.9872 - val_loss: 0.1365 - val_acc: 0.9657
Epoch 8/20
 - 1s - loss: 0.0288 - acc: 0.9897 - val_loss: 0.1309 - val_acc: 0.9682
Epoch 9/20
 - 1s - loss: 0.0277 - acc: 0.9908 - val_loss: 0.1252 - val_acc: 0.9715
Epoch 10/20
 - 1s - loss: 0.0220 - acc: 0.9919 - val_loss: 0.1431 - val_acc: 0.9698
Epoch 11/20
 - 1s - loss: 0.0197 - acc: 0.9933 - val_loss: 0.1626 - val_acc: 0.9649
Epoch 12/20
 - 1s - loss: 0.0183 - acc: 0.9947 - val_loss: 0.1474 - val_acc: 0.9690
Epoch 13/20
 - 1s - loss: 0.0144 - acc: 0.9955 - val_loss: 0.1708 - val_acc: 0.9681
Epoch 14/20
 - 1s - loss: 0.0140 - acc: 0.9954 - val_loss: 0.1563 - val_acc: 0.9720
Epoch 15/20
 - 1s - loss: 0.0140 - acc: 0.9951 - val_loss: 0.1636 - val_acc: 0.9701
Epoch 16/20
 - 1s - loss: 0.0132 - acc: 0.9959 - val_loss: 0.1951 - val_acc: 0.9654
Epoch 17/20
 - 1s - loss: 0.0127 - acc: 0.9964 - val_loss: 0.1609 - val_acc: 0.9724
Epoch 18/20
 - 1s - loss: 0.0095 - acc: 0.9962 - val_loss: 0.2032 - val_acc: 0.9663
Epoch 19/20
 - 1s - loss: 0.0098 - acc: 0.9969 - val_loss: 0.1733 - val_acc: 0.9709
Epoch 20/20
 - 1s - loss: 0.0123 - acc: 0.9962 - val_loss: 0.1792 - val_acc: 0.9700
Test loss: 0.17919762522734814
Test accuracy: 0.97
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6173 - acc: 0.4806 - val_loss: 1.0715 - val_acc: 0.6238
Epoch 2/20
 - 1s - loss: 0.8470 - acc: 0.7212 - val_loss: 0.5602 - val_acc: 0.8109
Epoch 3/20
 - 1s - loss: 0.6469 - acc: 0.7901 - val_loss: 0.8848 - val_acc: 0.6692
Epoch 4/20
 - 1s - loss: 0.5404 - acc: 0.8279 - val_loss: 0.6630 - val_acc: 0.7714
Epoch 5/20
 - 1s - loss: 0.4793 - acc: 0.8447 - val_loss: 1.4033 - val_acc: 0.6584
Epoch 6/20
 - 1s - loss: 0.4199 - acc: 0.8666 - val_loss: 0.3864 - val_acc: 0.8631
Epoch 7/20
 - 1s - loss: 0.3796 - acc: 0.8790 - val_loss: 0.4804 - val_acc: 0.8340
Epoch 8/20
 - 1s - loss: 0.3533 - acc: 0.8892 - val_loss: 0.4025 - val_acc: 0.8641
Epoch 9/20
 - 1s - loss: 0.3094 - acc: 0.9021 - val_loss: 0.3437 - val_acc: 0.8787
Epoch 10/20
 - 1s - loss: 0.2859 - acc: 0.9119 - val_loss: 0.5143 - val_acc: 0.8518
Epoch 11/20
 - 1s - loss: 0.2886 - acc: 0.9094 - val_loss: 0.2733 - val_acc: 0.9065
Epoch 12/20
 - 1s - loss: 0.2706 - acc: 0.9159 - val_loss: 0.3151 - val_acc: 0.9041
Epoch 13/20
 - 1s - loss: 0.2497 - acc: 0.9205 - val_loss: 0.2380 - val_acc: 0.9247
Epoch 14/20
 - 1s - loss: 0.2225 - acc: 0.9306 - val_loss: 0.1658 - val_acc: 0.9484
Epoch 15/20
 - 1s - loss: 0.2295 - acc: 0.9283 - val_loss: 0.2286 - val_acc: 0.9246
Epoch 16/20
 - 1s - loss: 0.2097 - acc: 0.9335 - val_loss: 0.3033 - val_acc: 0.9057
Epoch 17/20
 - 1s - loss: 0.2122 - acc: 0.9339 - val_loss: 0.4081 - val_acc: 0.8813
Epoch 18/20
 - 1s - loss: 0.1965 - acc: 0.9369 - val_loss: 0.1767 - val_acc: 0.9444
Epoch 19/20
 - 1s - loss: 0.1888 - acc: 0.9391 - val_loss: 0.2168 - val_acc: 0.9326
Epoch 20/20
 - 1s - loss: 0.1795 - acc: 0.9437 - val_loss: 0.3815 - val_acc: 0.8899
Test loss: 0.381245214535296
Test accuracy: 0.89
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6253 - acc: 0.8025 - val_loss: 0.3196 - val_acc: 0.9042
Epoch 2/20
 - 0s - loss: 0.2526 - acc: 0.9216 - val_loss: 0.2499 - val_acc: 0.9254
Epoch 3/20
 - 0s - loss: 0.1666 - acc: 0.9488 - val_loss: 0.2151 - val_acc: 0.9342
Epoch 4/20
 - 0s - loss: 0.1190 - acc: 0.9633 - val_loss: 0.1867 - val_acc: 0.9441
Epoch 5/20
 - 0s - loss: 0.0889 - acc: 0.9712 - val_loss: 0.1734 - val_acc: 0.9472
Epoch 6/20
 - 0s - loss: 0.0644 - acc: 0.9799 - val_loss: 0.1895 - val_acc: 0.9461
Epoch 7/20
 - 0s - loss: 0.0479 - acc: 0.9845 - val_loss: 0.1817 - val_acc: 0.9502
Epoch 8/20
 - 0s - loss: 0.0331 - acc: 0.9904 - val_loss: 0.2194 - val_acc: 0.9450
Epoch 9/20
 - 0s - loss: 0.0296 - acc: 0.9912 - val_loss: 0.1898 - val_acc: 0.9551
Epoch 10/20
 - 0s - loss: 0.0228 - acc: 0.9920 - val_loss: 0.2368 - val_acc: 0.9459
Epoch 11/20
 - 0s - loss: 0.0193 - acc: 0.9931 - val_loss: 0.2545 - val_acc: 0.9449
Epoch 12/20
 - 0s - loss: 0.0140 - acc: 0.9961 - val_loss: 0.2612 - val_acc: 0.9477
Epoch 13/20
 - 0s - loss: 0.0137 - acc: 0.9957 - val_loss: 0.2455 - val_acc: 0.9504
Epoch 14/20
 - 0s - loss: 0.0142 - acc: 0.9960 - val_loss: 0.2563 - val_acc: 0.9510
Epoch 15/20
 - 0s - loss: 0.0114 - acc: 0.9961 - val_loss: 0.2846 - val_acc: 0.9433
Epoch 16/20
 - 0s - loss: 0.0123 - acc: 0.9956 - val_loss: 0.2273 - val_acc: 0.9598
Epoch 17/20
 - 0s - loss: 0.0115 - acc: 0.9968 - val_loss: 0.2929 - val_acc: 0.9489
Epoch 18/20
 - 0s - loss: 0.0067 - acc: 0.9973 - val_loss: 0.2485 - val_acc: 0.9583
Epoch 19/20
 - 0s - loss: 0.0105 - acc: 0.9973 - val_loss: 0.2465 - val_acc: 0.9580
Epoch 20/20
 - 0s - loss: 0.0052 - acc: 0.9985 - val_loss: 0.2711 - val_acc: 0.9557
Test loss: 0.271057566990073
Test accuracy: 0.9557
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0332 - acc: 0.3547 - val_loss: 1.1440 - val_acc: 0.6284
Epoch 2/20
 - 1s - loss: 1.1487 - acc: 0.6257 - val_loss: 0.7090 - val_acc: 0.7716
Epoch 3/20
 - 1s - loss: 0.8677 - acc: 0.7080 - val_loss: 0.6341 - val_acc: 0.8042
Epoch 4/20
 - 1s - loss: 0.7377 - acc: 0.7617 - val_loss: 0.6949 - val_acc: 0.7576
Epoch 5/20
 - 1s - loss: 0.6765 - acc: 0.7749 - val_loss: 0.5513 - val_acc: 0.8109
Epoch 6/20
 - 1s - loss: 0.5960 - acc: 0.8053 - val_loss: 0.3778 - val_acc: 0.8819
Epoch 7/20
 - 1s - loss: 0.5610 - acc: 0.8189 - val_loss: 0.4217 - val_acc: 0.8575
Epoch 8/20
 - 1s - loss: 0.4981 - acc: 0.8425 - val_loss: 0.3678 - val_acc: 0.8845
Epoch 9/20
 - 1s - loss: 0.4688 - acc: 0.8465 - val_loss: 0.3984 - val_acc: 0.8734
Epoch 10/20
 - 1s - loss: 0.4498 - acc: 0.8587 - val_loss: 0.7148 - val_acc: 0.7967
Epoch 11/20
 - 1s - loss: 0.4012 - acc: 0.8717 - val_loss: 0.3871 - val_acc: 0.8670
Epoch 12/20
 - 1s - loss: 0.3806 - acc: 0.8811 - val_loss: 0.3146 - val_acc: 0.9036
Epoch 13/20
 - 1s - loss: 0.3716 - acc: 0.8804 - val_loss: 0.4764 - val_acc: 0.8558
Epoch 14/20
 - 1s - loss: 0.3388 - acc: 0.8952 - val_loss: 0.3960 - val_acc: 0.8730
Epoch 15/20
 - 1s - loss: 0.3270 - acc: 0.8943 - val_loss: 0.2755 - val_acc: 0.9151
Epoch 16/20
 - 1s - loss: 0.3262 - acc: 0.8959 - val_loss: 0.3408 - val_acc: 0.8881
Epoch 17/20
 - 1s - loss: 0.2931 - acc: 0.9083 - val_loss: 0.2720 - val_acc: 0.9182
Epoch 18/20
 - 1s - loss: 0.2731 - acc: 0.9155 - val_loss: 0.3123 - val_acc: 0.9004
Epoch 19/20
 - 1s - loss: 0.2781 - acc: 0.9116 - val_loss: 0.2635 - val_acc: 0.9156
Epoch 20/20
 - 1s - loss: 0.2812 - acc: 0.9079 - val_loss: 0.2097 - val_acc: 0.9357
Test loss: 0.21117265407443048
Test accuracy: 0.9354
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.8270 - acc: 0.7411 - val_loss: 0.3780 - val_acc: 0.8866
Epoch 2/20
 - 0s - loss: 0.3299 - acc: 0.8989 - val_loss: 0.3983 - val_acc: 0.8629
Epoch 3/20
 - 0s - loss: 0.2375 - acc: 0.9315 - val_loss: 0.4298 - val_acc: 0.8646
Epoch 4/20
 - 0s - loss: 0.1631 - acc: 0.9491 - val_loss: 0.2576 - val_acc: 0.9200
Epoch 5/20
 - 0s - loss: 0.1217 - acc: 0.9619 - val_loss: 0.2848 - val_acc: 0.9123
Epoch 6/20
 - 0s - loss: 0.0982 - acc: 0.9747 - val_loss: 0.2476 - val_acc: 0.9266
Epoch 7/20
 - 0s - loss: 0.0670 - acc: 0.9805 - val_loss: 0.3823 - val_acc: 0.8918
Epoch 8/20
 - 0s - loss: 0.0491 - acc: 0.9864 - val_loss: 0.2974 - val_acc: 0.9184
Epoch 9/20
 - 0s - loss: 0.0424 - acc: 0.9864 - val_loss: 0.2703 - val_acc: 0.9286
Epoch 10/20
 - 0s - loss: 0.0310 - acc: 0.9917 - val_loss: 0.2480 - val_acc: 0.9378
Epoch 11/20
 - 0s - loss: 0.0273 - acc: 0.9923 - val_loss: 0.2571 - val_acc: 0.9346
Epoch 12/20
 - 0s - loss: 0.0159 - acc: 0.9960 - val_loss: 0.3120 - val_acc: 0.9272
Epoch 13/20
 - 0s - loss: 0.0197 - acc: 0.9936 - val_loss: 0.2506 - val_acc: 0.9419
Epoch 14/20
 - 0s - loss: 0.0158 - acc: 0.9952 - val_loss: 0.2623 - val_acc: 0.9398
Epoch 15/20
 - 0s - loss: 0.0098 - acc: 0.9963 - val_loss: 0.2489 - val_acc: 0.9437
Epoch 16/20
 - 0s - loss: 0.0091 - acc: 0.9976 - val_loss: 0.2871 - val_acc: 0.9406
Epoch 17/20
 - 0s - loss: 0.0125 - acc: 0.9949 - val_loss: 0.2743 - val_acc: 0.9422
Epoch 18/20
 - 0s - loss: 0.0065 - acc: 0.9979 - val_loss: 0.2951 - val_acc: 0.9422
Epoch 19/20
 - 0s - loss: 0.0076 - acc: 0.9979 - val_loss: 0.2839 - val_acc: 0.9456
Epoch 20/20
 - 0s - loss: 0.0058 - acc: 0.9989 - val_loss: 0.3146 - val_acc: 0.9393
Test loss: 0.3146232620961873
Test accuracy: 0.9393
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6111 - acc: 0.2320 - val_loss: 1.7143 - val_acc: 0.5618
Epoch 2/20
 - 1s - loss: 1.6615 - acc: 0.4355 - val_loss: 1.1158 - val_acc: 0.6198
Epoch 3/20
 - 1s - loss: 1.2125 - acc: 0.5971 - val_loss: 1.2265 - val_acc: 0.5690
Epoch 4/20
 - 1s - loss: 1.0421 - acc: 0.6557 - val_loss: 0.8691 - val_acc: 0.6989
Epoch 5/20
 - 1s - loss: 0.9547 - acc: 0.6859 - val_loss: 2.3329 - val_acc: 0.4480
Epoch 6/20
 - 1s - loss: 0.8434 - acc: 0.7251 - val_loss: 0.7230 - val_acc: 0.7873
Epoch 7/20
 - 1s - loss: 0.7415 - acc: 0.7547 - val_loss: 0.9276 - val_acc: 0.6756
Epoch 8/20
 - 1s - loss: 0.7732 - acc: 0.7443 - val_loss: 0.7344 - val_acc: 0.7492
Epoch 9/20
 - 1s - loss: 0.6402 - acc: 0.7909 - val_loss: 0.7410 - val_acc: 0.7654
Epoch 10/20
 - 1s - loss: 0.6660 - acc: 0.7840 - val_loss: 0.6312 - val_acc: 0.7865
Epoch 11/20
 - 1s - loss: 0.5954 - acc: 0.8035 - val_loss: 1.0703 - val_acc: 0.6090
Epoch 12/20
 - 1s - loss: 0.5922 - acc: 0.8069 - val_loss: 0.4582 - val_acc: 0.8580
Epoch 13/20
 - 1s - loss: 0.5838 - acc: 0.8072 - val_loss: 0.4223 - val_acc: 0.8590
Epoch 14/20
 - 1s - loss: 0.4584 - acc: 0.8579 - val_loss: 0.9015 - val_acc: 0.6840
Epoch 15/20
 - 1s - loss: 0.5032 - acc: 0.8427 - val_loss: 0.9678 - val_acc: 0.6844
Epoch 16/20
 - 1s - loss: 0.4319 - acc: 0.8595 - val_loss: 0.7251 - val_acc: 0.7854
Epoch 17/20
 - 1s - loss: 0.4648 - acc: 0.8483 - val_loss: 0.5107 - val_acc: 0.8390
Epoch 18/20
 - 1s - loss: 0.4128 - acc: 0.8707 - val_loss: 0.5118 - val_acc: 0.8408
Epoch 19/20
 - 1s - loss: 0.4259 - acc: 0.8693 - val_loss: 0.7233 - val_acc: 0.7882
Epoch 20/20
 - 1s - loss: 0.4453 - acc: 0.8608 - val_loss: 0.3139 - val_acc: 0.9014
Test loss: 0.3140631684586406
Test accuracy: 0.9014
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1529 - acc: 0.6379 - val_loss: 0.5822 - val_acc: 0.8234
Epoch 2/20
 - 0s - loss: 0.4837 - acc: 0.8523 - val_loss: 0.5720 - val_acc: 0.8268
Epoch 3/20
 - 0s - loss: 0.3170 - acc: 0.9088 - val_loss: 0.3981 - val_acc: 0.8771
Epoch 4/20
 - 0s - loss: 0.2555 - acc: 0.9259 - val_loss: 0.4387 - val_acc: 0.8630
Epoch 5/20
 - 0s - loss: 0.1885 - acc: 0.9483 - val_loss: 0.3285 - val_acc: 0.9002
Epoch 6/20
 - 0s - loss: 0.1434 - acc: 0.9573 - val_loss: 0.3583 - val_acc: 0.8923
Epoch 7/20
 - 0s - loss: 0.1142 - acc: 0.9680 - val_loss: 0.4394 - val_acc: 0.8755
Epoch 8/20
 - 0s - loss: 0.0847 - acc: 0.9792 - val_loss: 0.2834 - val_acc: 0.9163
Epoch 9/20
 - 0s - loss: 0.0589 - acc: 0.9845 - val_loss: 0.2903 - val_acc: 0.9157
Epoch 10/20
 - 0s - loss: 0.0621 - acc: 0.9819 - val_loss: 0.6766 - val_acc: 0.8292
Epoch 11/20
 - 0s - loss: 0.0330 - acc: 0.9925 - val_loss: 0.2810 - val_acc: 0.9234
Epoch 12/20
 - 0s - loss: 0.0167 - acc: 0.9979 - val_loss: 0.3608 - val_acc: 0.9076
Epoch 13/20
 - 0s - loss: 0.0327 - acc: 0.9899 - val_loss: 0.3386 - val_acc: 0.9155
Epoch 14/20
 - 0s - loss: 0.0173 - acc: 0.9952 - val_loss: 0.3152 - val_acc: 0.9192
Epoch 15/20
 - 0s - loss: 0.0306 - acc: 0.9925 - val_loss: 0.3149 - val_acc: 0.9238
Epoch 16/20
 - 0s - loss: 0.0078 - acc: 0.9984 - val_loss: 0.3337 - val_acc: 0.9225
Epoch 17/20
 - 0s - loss: 0.0076 - acc: 0.9984 - val_loss: 1.2897 - val_acc: 0.7605
Epoch 18/20
 - 0s - loss: 0.0528 - acc: 0.9835 - val_loss: 0.3434 - val_acc: 0.9220
Epoch 19/20
 - 0s - loss: 0.0029 - acc: 1.0000 - val_loss: 0.3508 - val_acc: 0.9238
Epoch 20/20
 - 0s - loss: 0.0108 - acc: 0.9984 - val_loss: 0.4217 - val_acc: 0.9087
Test loss: 0.4217053096427815
Test accuracy: 0.9087
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2759 - acc: 0.1520 - val_loss: 1.9806 - val_acc: 0.3278
Epoch 2/20
 - 1s - loss: 1.9340 - acc: 0.3328 - val_loss: 1.5990 - val_acc: 0.5198
Epoch 3/20
 - 1s - loss: 1.7062 - acc: 0.4315 - val_loss: 1.8772 - val_acc: 0.3205
Epoch 4/20
 - 1s - loss: 1.4513 - acc: 0.5163 - val_loss: 1.3854 - val_acc: 0.5139
Epoch 5/20
 - 1s - loss: 1.2680 - acc: 0.5733 - val_loss: 1.0966 - val_acc: 0.6014
Epoch 6/20
 - 1s - loss: 1.1628 - acc: 0.6149 - val_loss: 1.2030 - val_acc: 0.5739
Epoch 7/20
 - 1s - loss: 1.0151 - acc: 0.6619 - val_loss: 0.7808 - val_acc: 0.7418
Epoch 8/20
 - 1s - loss: 0.9649 - acc: 0.6901 - val_loss: 1.1635 - val_acc: 0.6136
Epoch 9/20
 - 1s - loss: 0.8815 - acc: 0.7136 - val_loss: 0.7901 - val_acc: 0.7519
Epoch 10/20
 - 1s - loss: 0.8608 - acc: 0.7264 - val_loss: 0.6880 - val_acc: 0.7736
Epoch 11/20
 - 1s - loss: 0.8526 - acc: 0.7307 - val_loss: 0.7118 - val_acc: 0.7628
Epoch 12/20
 - 1s - loss: 0.7498 - acc: 0.7467 - val_loss: 0.6440 - val_acc: 0.7879
Epoch 13/20
 - 1s - loss: 0.8903 - acc: 0.7120 - val_loss: 0.6003 - val_acc: 0.8122
Epoch 14/20
 - 1s - loss: 0.6004 - acc: 0.8043 - val_loss: 0.5698 - val_acc: 0.8138
Epoch 15/20
 - 1s - loss: 0.6541 - acc: 0.7888 - val_loss: 1.0656 - val_acc: 0.7256
Epoch 16/20
 - 1s - loss: 0.7164 - acc: 0.7691 - val_loss: 0.7422 - val_acc: 0.7589
Epoch 17/20
 - 1s - loss: 0.6108 - acc: 0.7984 - val_loss: 0.5968 - val_acc: 0.8087
Epoch 18/20
 - 1s - loss: 0.6144 - acc: 0.7979 - val_loss: 0.5199 - val_acc: 0.8244
Epoch 19/20
 - 1s - loss: 0.5984 - acc: 0.8005 - val_loss: 0.9346 - val_acc: 0.7159
Epoch 20/20
 - 1s - loss: 0.5440 - acc: 0.8251 - val_loss: 0.5043 - val_acc: 0.8304
Test loss: 0.5045651490330696
Test accuracy: 0.829
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5065 - acc: 0.5400 - val_loss: 1.0782 - val_acc: 0.6453
Epoch 2/20
 - 0s - loss: 0.6362 - acc: 0.8111 - val_loss: 0.5214 - val_acc: 0.8461
Epoch 3/20
 - 0s - loss: 0.4064 - acc: 0.8805 - val_loss: 0.5169 - val_acc: 0.8336
Epoch 4/20
 - 0s - loss: 0.3563 - acc: 0.8911 - val_loss: 0.5183 - val_acc: 0.8388
Epoch 5/20
 - 0s - loss: 0.2303 - acc: 0.9381 - val_loss: 0.4054 - val_acc: 0.8713
Epoch 6/20
 - 0s - loss: 0.1511 - acc: 0.9648 - val_loss: 0.3956 - val_acc: 0.8788
Epoch 7/20
 - 0s - loss: 0.1560 - acc: 0.9573 - val_loss: 0.6683 - val_acc: 0.8120
Epoch 8/20
 - 0s - loss: 0.1387 - acc: 0.9616 - val_loss: 0.4043 - val_acc: 0.8747
Epoch 9/20
 - 0s - loss: 0.0783 - acc: 0.9776 - val_loss: 0.4656 - val_acc: 0.8569
Epoch 10/20
 - 0s - loss: 0.0838 - acc: 0.9797 - val_loss: 0.3709 - val_acc: 0.8950
Epoch 11/20
 - 0s - loss: 0.0429 - acc: 0.9936 - val_loss: 0.4588 - val_acc: 0.8730
Epoch 12/20
 - 0s - loss: 0.0489 - acc: 0.9915 - val_loss: 0.4004 - val_acc: 0.8886
Epoch 13/20
 - 0s - loss: 0.0203 - acc: 0.9979 - val_loss: 0.3973 - val_acc: 0.8913
Epoch 14/20
 - 0s - loss: 0.0152 - acc: 0.9989 - val_loss: 0.3990 - val_acc: 0.8958
Epoch 15/20
 - 0s - loss: 0.0120 - acc: 0.9989 - val_loss: 0.4173 - val_acc: 0.8904
Epoch 16/20
 - 0s - loss: 0.0481 - acc: 0.9861 - val_loss: 0.7002 - val_acc: 0.8359
Epoch 17/20
 - 0s - loss: 0.0214 - acc: 0.9936 - val_loss: 0.4101 - val_acc: 0.8968
Epoch 18/20
 - 0s - loss: 0.0043 - acc: 1.0000 - val_loss: 0.4693 - val_acc: 0.8863
Epoch 19/20
 - 0s - loss: 0.0044 - acc: 0.9989 - val_loss: 0.4226 - val_acc: 0.8983
Epoch 20/20
 - 0s - loss: 0.0083 - acc: 0.9989 - val_loss: 0.5371 - val_acc: 0.8814
Test loss: 0.5371174181456677
Test accuracy: 0.8814
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.8367 - acc: 0.1131 - val_loss: 2.2558 - val_acc: 0.1920
Epoch 2/20
 - 1s - loss: 2.2434 - acc: 0.1985 - val_loss: 2.0652 - val_acc: 0.1979
Epoch 3/20
 - 1s - loss: 1.9759 - acc: 0.3212 - val_loss: 1.9446 - val_acc: 0.3103
Epoch 4/20
 - 1s - loss: 1.8974 - acc: 0.3511 - val_loss: 1.9996 - val_acc: 0.2962
Epoch 5/20
 - 0s - loss: 1.6383 - acc: 0.4707 - val_loss: 2.1678 - val_acc: 0.3003
Epoch 6/20
 - 1s - loss: 1.5999 - acc: 0.5165 - val_loss: 1.2451 - val_acc: 0.5815
Epoch 7/20
 - 1s - loss: 1.4327 - acc: 0.5336 - val_loss: 2.2764 - val_acc: 0.2393
Epoch 8/20
 - 1s - loss: 1.5082 - acc: 0.5091 - val_loss: 1.4486 - val_acc: 0.4878
Epoch 9/20
 - 1s - loss: 1.2379 - acc: 0.5763 - val_loss: 1.6643 - val_acc: 0.4395
Epoch 10/20
 - 1s - loss: 1.2837 - acc: 0.5454 - val_loss: 1.2973 - val_acc: 0.5402
Epoch 11/20
 - 1s - loss: 1.0417 - acc: 0.6713 - val_loss: 1.2506 - val_acc: 0.5149
Epoch 12/20
 - 1s - loss: 1.1425 - acc: 0.6083 - val_loss: 1.2710 - val_acc: 0.5350
Epoch 13/20
 - 1s - loss: 0.9362 - acc: 0.7022 - val_loss: 1.1480 - val_acc: 0.6185
Epoch 14/20
 - 1s - loss: 0.9880 - acc: 0.6873 - val_loss: 0.8560 - val_acc: 0.7088
Epoch 15/20
 - 1s - loss: 0.9130 - acc: 0.6969 - val_loss: 0.7476 - val_acc: 0.7511
Epoch 16/20
 - 1s - loss: 0.9689 - acc: 0.6734 - val_loss: 1.0366 - val_acc: 0.6505
Epoch 17/20
 - 1s - loss: 0.8623 - acc: 0.7001 - val_loss: 1.0086 - val_acc: 0.6451
Epoch 18/20
 - 1s - loss: 0.8255 - acc: 0.7321 - val_loss: 0.7925 - val_acc: 0.7203
Epoch 19/20
 - 1s - loss: 0.7789 - acc: 0.7375 - val_loss: 1.0812 - val_acc: 0.6449
Epoch 20/20
 - 1s - loss: 0.7347 - acc: 0.7716 - val_loss: 0.5886 - val_acc: 0.8098
Test loss: 0.5894912110567093
Test accuracy: 0.8093
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.7762 - acc: 0.4017 - val_loss: 1.1248 - val_acc: 0.6541
Epoch 2/20
 - 0s - loss: 0.7698 - acc: 0.7842 - val_loss: 0.7800 - val_acc: 0.7458
Epoch 3/20
 - 0s - loss: 0.4206 - acc: 0.8718 - val_loss: 0.7129 - val_acc: 0.7693
Epoch 4/20
 - 0s - loss: 0.3460 - acc: 0.8996 - val_loss: 0.8550 - val_acc: 0.7077
Epoch 5/20
 - 0s - loss: 0.2429 - acc: 0.9380 - val_loss: 0.7852 - val_acc: 0.7401
Epoch 6/20
 - 0s - loss: 0.2418 - acc: 0.9380 - val_loss: 0.5654 - val_acc: 0.8216
Epoch 7/20
 - 0s - loss: 0.1170 - acc: 0.9786 - val_loss: 0.5345 - val_acc: 0.8306
Epoch 8/20
 - 0s - loss: 0.0998 - acc: 0.9850 - val_loss: 0.5781 - val_acc: 0.8316
Epoch 9/20
 - 0s - loss: 0.0601 - acc: 0.9915 - val_loss: 0.5202 - val_acc: 0.8441
Epoch 10/20
 - 0s - loss: 0.0408 - acc: 1.0000 - val_loss: 0.5328 - val_acc: 0.8390
Epoch 11/20
 - 0s - loss: 0.0447 - acc: 0.9979 - val_loss: 0.5016 - val_acc: 0.8531
Epoch 12/20
 - 0s - loss: 0.0325 - acc: 0.9957 - val_loss: 0.6036 - val_acc: 0.8343
Epoch 13/20
 - 0s - loss: 0.0467 - acc: 0.9915 - val_loss: 0.8696 - val_acc: 0.7953
Epoch 14/20
 - 0s - loss: 0.1173 - acc: 0.9487 - val_loss: 0.5637 - val_acc: 0.8442
Epoch 15/20
 - 0s - loss: 0.0204 - acc: 0.9979 - val_loss: 0.5448 - val_acc: 0.8525
Epoch 16/20
 - 0s - loss: 0.0108 - acc: 1.0000 - val_loss: 0.5544 - val_acc: 0.8534
Epoch 17/20
 - 0s - loss: 0.0101 - acc: 1.0000 - val_loss: 0.5762 - val_acc: 0.8515
Epoch 18/20
 - 0s - loss: 0.0080 - acc: 1.0000 - val_loss: 0.5681 - val_acc: 0.8532
Epoch 19/20
 - 0s - loss: 0.0071 - acc: 1.0000 - val_loss: 0.5683 - val_acc: 0.8547
Epoch 20/20
 - 0s - loss: 0.0047 - acc: 1.0000 - val_loss: 0.5755 - val_acc: 0.8534
Test loss: 0.5754928892232478
Test accuracy: 0.8534
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.8476 - acc: 0.1325 - val_loss: 2.7012 - val_acc: 0.1146
Epoch 2/20
 - 0s - loss: 2.4886 - acc: 0.1645 - val_loss: 2.1256 - val_acc: 0.2322
Epoch 3/20
 - 0s - loss: 2.0540 - acc: 0.2799 - val_loss: 2.2169 - val_acc: 0.1052
Epoch 4/20
 - 0s - loss: 2.1286 - acc: 0.2692 - val_loss: 1.8798 - val_acc: 0.3447
Epoch 5/20
 - 0s - loss: 2.1991 - acc: 0.2714 - val_loss: 1.9808 - val_acc: 0.3645
Epoch 6/20
 - 0s - loss: 1.7614 - acc: 0.4808 - val_loss: 2.0363 - val_acc: 0.2245
Epoch 7/20
 - 0s - loss: 2.0226 - acc: 0.2927 - val_loss: 1.8304 - val_acc: 0.5606
Epoch 8/20
 - 0s - loss: 1.6261 - acc: 0.4765 - val_loss: 1.4733 - val_acc: 0.5195
Epoch 9/20
 - 0s - loss: 1.4315 - acc: 0.5214 - val_loss: 2.2277 - val_acc: 0.2845
Epoch 10/20
 - 0s - loss: 1.7929 - acc: 0.4316 - val_loss: 1.3600 - val_acc: 0.5384
Epoch 11/20
 - 0s - loss: 1.4606 - acc: 0.5235 - val_loss: 1.5538 - val_acc: 0.5225
Epoch 12/20
 - 0s - loss: 1.4598 - acc: 0.5556 - val_loss: 1.4870 - val_acc: 0.4603
Epoch 13/20
 - 0s - loss: 1.3728 - acc: 0.5470 - val_loss: 1.1754 - val_acc: 0.6222
Epoch 14/20
 - 0s - loss: 1.1796 - acc: 0.6090 - val_loss: 1.6452 - val_acc: 0.4522
Epoch 15/20
 - 0s - loss: 1.2598 - acc: 0.5855 - val_loss: 1.2662 - val_acc: 0.5644
Epoch 16/20
 - 0s - loss: 1.1826 - acc: 0.5983 - val_loss: 1.2985 - val_acc: 0.5398
Epoch 17/20
 - 0s - loss: 1.2127 - acc: 0.5983 - val_loss: 1.1754 - val_acc: 0.6451
Epoch 18/20
 - 0s - loss: 1.0071 - acc: 0.6795 - val_loss: 1.6028 - val_acc: 0.5663
Epoch 19/20
 - 0s - loss: 0.9884 - acc: 0.7030 - val_loss: 1.0282 - val_acc: 0.6276
Epoch 20/20
 - 0s - loss: 1.0963 - acc: 0.6560 - val_loss: 0.9735 - val_acc: 0.6855
Test loss: 0.9731919971466064
Test accuracy: 0.6841
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1229 - acc: 0.2051 - val_loss: 1.8468 - val_acc: 0.4221
Epoch 2/20
 - 0s - loss: 1.3279 - acc: 0.6368 - val_loss: 1.2487 - val_acc: 0.6227
Epoch 3/20
 - 0s - loss: 0.8347 - acc: 0.7607 - val_loss: 1.1039 - val_acc: 0.6617
Epoch 4/20
 - 0s - loss: 0.5657 - acc: 0.8376 - val_loss: 0.8945 - val_acc: 0.7243
Epoch 5/20
 - 0s - loss: 0.3537 - acc: 0.9402 - val_loss: 0.8438 - val_acc: 0.7408
Epoch 6/20
 - 0s - loss: 0.2524 - acc: 0.9444 - val_loss: 0.7919 - val_acc: 0.7511
Epoch 7/20
 - 0s - loss: 0.1980 - acc: 0.9701 - val_loss: 0.7691 - val_acc: 0.7502
Epoch 8/20
 - 0s - loss: 0.1481 - acc: 0.9829 - val_loss: 0.7532 - val_acc: 0.7605
Epoch 9/20
 - 0s - loss: 0.1010 - acc: 0.9915 - val_loss: 0.7620 - val_acc: 0.7609
Epoch 10/20
 - 0s - loss: 0.1060 - acc: 0.9786 - val_loss: 0.8954 - val_acc: 0.7340
Epoch 11/20
 - 0s - loss: 0.0801 - acc: 1.0000 - val_loss: 0.8061 - val_acc: 0.7686
Epoch 12/20
 - 0s - loss: 0.0636 - acc: 0.9957 - val_loss: 0.7530 - val_acc: 0.7778
Epoch 13/20
 - 0s - loss: 0.0382 - acc: 1.0000 - val_loss: 0.7841 - val_acc: 0.7707
Epoch 14/20
 - 0s - loss: 0.0287 - acc: 1.0000 - val_loss: 0.7645 - val_acc: 0.7795
Epoch 15/20
 - 0s - loss: 0.0239 - acc: 1.0000 - val_loss: 0.7663 - val_acc: 0.7849
Epoch 16/20
 - 0s - loss: 0.0237 - acc: 1.0000 - val_loss: 0.8473 - val_acc: 0.7671
Epoch 17/20
 - 0s - loss: 0.0307 - acc: 0.9957 - val_loss: 0.7932 - val_acc: 0.7771
Epoch 18/20
 - 0s - loss: 0.0211 - acc: 1.0000 - val_loss: 0.8411 - val_acc: 0.7791
Epoch 19/20
 - 0s - loss: 0.0129 - acc: 1.0000 - val_loss: 0.8016 - val_acc: 0.7895
Epoch 20/20
 - 0s - loss: 0.0100 - acc: 1.0000 - val_loss: 0.7957 - val_acc: 0.7891
Test loss: 0.7956615072458982
Test accuracy: 0.7891
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.3633 - acc: 0.1111 - val_loss: 5.5057 - val_acc: 0.0982
Epoch 2/20
 - 0s - loss: 5.2605 - acc: 0.0812 - val_loss: 2.8031 - val_acc: 0.0980
Epoch 3/20
 - 0s - loss: 2.6555 - acc: 0.1538 - val_loss: 2.1670 - val_acc: 0.3444
Epoch 4/20
 - 0s - loss: 2.2114 - acc: 0.2009 - val_loss: 2.2506 - val_acc: 0.1778
Epoch 5/20
 - 0s - loss: 2.2758 - acc: 0.1923 - val_loss: 2.0757 - val_acc: 0.3178
Epoch 6/20
 - 0s - loss: 1.9964 - acc: 0.3291 - val_loss: 2.0846 - val_acc: 0.2047
Epoch 7/20
 - 0s - loss: 2.0947 - acc: 0.2479 - val_loss: 2.0972 - val_acc: 0.3166
Epoch 8/20
 - 0s - loss: 1.9862 - acc: 0.3162 - val_loss: 1.9078 - val_acc: 0.4463
Epoch 9/20
 - 0s - loss: 1.7906 - acc: 0.4274 - val_loss: 1.9089 - val_acc: 0.3840
Epoch 10/20
 - 0s - loss: 1.7518 - acc: 0.4274 - val_loss: 1.8531 - val_acc: 0.4684
Epoch 11/20
 - 0s - loss: 1.9622 - acc: 0.3932 - val_loss: 2.0902 - val_acc: 0.3713
Epoch 12/20
 - 0s - loss: 1.8139 - acc: 0.4487 - val_loss: 1.8765 - val_acc: 0.3108
Epoch 13/20
 - 0s - loss: 1.6469 - acc: 0.4487 - val_loss: 1.7569 - val_acc: 0.3849
Epoch 14/20
 - 0s - loss: 1.5637 - acc: 0.5000 - val_loss: 1.9781 - val_acc: 0.2744
Epoch 15/20
 - 0s - loss: 1.8192 - acc: 0.4316 - val_loss: 1.6739 - val_acc: 0.4513
Epoch 16/20
 - 0s - loss: 1.6071 - acc: 0.5043 - val_loss: 1.7949 - val_acc: 0.3871
Epoch 17/20
 - 0s - loss: 1.5552 - acc: 0.4573 - val_loss: 1.6954 - val_acc: 0.4037
Epoch 18/20
 - 0s - loss: 1.4936 - acc: 0.5427 - val_loss: 1.4700 - val_acc: 0.4884
Epoch 19/20
 - 0s - loss: 1.3038 - acc: 0.5855 - val_loss: 1.6583 - val_acc: 0.4353
Epoch 20/20
 - 0s - loss: 1.3852 - acc: 0.5385 - val_loss: 1.5121 - val_acc: 0.5177
Test loss: 1.5125956119537354
Test accuracy: 0.5152
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3178 - acc: 0.0513 - val_loss: 2.0152 - val_acc: 0.3822
Epoch 2/20
 - 0s - loss: 1.5462 - acc: 0.5556 - val_loss: 1.4528 - val_acc: 0.6033
Epoch 3/20
 - 0s - loss: 0.9535 - acc: 0.8718 - val_loss: 1.7056 - val_acc: 0.4560
Epoch 4/20
 - 0s - loss: 0.7847 - acc: 0.7436 - val_loss: 1.4579 - val_acc: 0.5337
Epoch 5/20
 - 0s - loss: 0.7626 - acc: 0.8291 - val_loss: 1.3028 - val_acc: 0.5653
Epoch 6/20
 - 0s - loss: 0.4608 - acc: 0.8718 - val_loss: 1.2114 - val_acc: 0.6086
Epoch 7/20
 - 0s - loss: 0.2685 - acc: 0.9573 - val_loss: 0.9922 - val_acc: 0.6795
Epoch 8/20
 - 0s - loss: 0.1775 - acc: 0.9829 - val_loss: 1.0576 - val_acc: 0.6555
Epoch 9/20
 - 0s - loss: 0.1377 - acc: 1.0000 - val_loss: 1.0317 - val_acc: 0.6847
Epoch 10/20
 - 0s - loss: 0.1190 - acc: 0.9915 - val_loss: 1.0415 - val_acc: 0.6594
Epoch 11/20
 - 0s - loss: 0.1001 - acc: 0.9829 - val_loss: 1.0320 - val_acc: 0.6868
Epoch 12/20
 - 0s - loss: 0.0797 - acc: 0.9915 - val_loss: 1.0177 - val_acc: 0.6827
Epoch 13/20
 - 0s - loss: 0.0628 - acc: 1.0000 - val_loss: 0.9880 - val_acc: 0.7109
Epoch 14/20
 - 0s - loss: 0.0497 - acc: 1.0000 - val_loss: 0.9984 - val_acc: 0.7008
Epoch 15/20
 - 0s - loss: 0.0345 - acc: 1.0000 - val_loss: 0.9876 - val_acc: 0.7080
Epoch 16/20
 - 0s - loss: 0.0305 - acc: 1.0000 - val_loss: 0.9921 - val_acc: 0.7097
Epoch 17/20
 - 0s - loss: 0.0292 - acc: 1.0000 - val_loss: 1.0016 - val_acc: 0.7117
Epoch 18/20
 - 0s - loss: 0.0239 - acc: 1.0000 - val_loss: 0.9849 - val_acc: 0.7156
Epoch 19/20
 - 0s - loss: 0.0201 - acc: 1.0000 - val_loss: 1.0181 - val_acc: 0.7141
Epoch 20/20
 - 0s - loss: 0.0164 - acc: 1.0000 - val_loss: 1.0253 - val_acc: 0.7142
Test loss: 1.0252787601470947
Test accuracy: 0.7142
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5987 - acc: 0.1026 - val_loss: 8.5788 - val_acc: 0.1367
Epoch 2/20
 - 0s - loss: 7.7327 - acc: 0.2137 - val_loss: 6.5605 - val_acc: 0.0958
Epoch 3/20
 - 0s - loss: 7.1864 - acc: 0.1197 - val_loss: 5.3048 - val_acc: 0.0982
Epoch 4/20
 - 0s - loss: 6.0020 - acc: 0.1453 - val_loss: 3.0005 - val_acc: 0.1132
Epoch 5/20
 - 0s - loss: 3.1813 - acc: 0.2137 - val_loss: 2.2448 - val_acc: 0.1299
Epoch 6/20
 - 0s - loss: 2.1838 - acc: 0.2650 - val_loss: 2.2507 - val_acc: 0.1983
Epoch 7/20
 - 0s - loss: 2.1198 - acc: 0.2393 - val_loss: 2.0907 - val_acc: 0.3254
Epoch 8/20
 - 0s - loss: 1.9915 - acc: 0.3590 - val_loss: 2.0837 - val_acc: 0.2709
Epoch 9/20
 - 0s - loss: 1.9245 - acc: 0.3761 - val_loss: 2.1682 - val_acc: 0.2053
Epoch 10/20
 - 0s - loss: 1.9347 - acc: 0.3333 - val_loss: 2.3224 - val_acc: 0.0982
Epoch 11/20
 - 0s - loss: 2.2025 - acc: 0.1795 - val_loss: 2.1891 - val_acc: 0.1818
Epoch 12/20
 - 0s - loss: 2.0138 - acc: 0.2991 - val_loss: 1.9961 - val_acc: 0.2851
Epoch 13/20
 - 0s - loss: 1.7675 - acc: 0.4188 - val_loss: 2.2261 - val_acc: 0.1675
Epoch 14/20
 - 0s - loss: 1.9484 - acc: 0.2735 - val_loss: 2.1222 - val_acc: 0.3796
Epoch 15/20
 - 0s - loss: 1.9850 - acc: 0.4701 - val_loss: 1.9368 - val_acc: 0.3482
Epoch 16/20
 - 0s - loss: 1.6454 - acc: 0.5043 - val_loss: 1.8824 - val_acc: 0.4405
Epoch 17/20
 - 0s - loss: 1.5866 - acc: 0.5897 - val_loss: 1.8402 - val_acc: 0.4209
Epoch 18/20
 - 0s - loss: 1.5556 - acc: 0.5556 - val_loss: 2.2490 - val_acc: 0.3513
Epoch 19/20
 - 0s - loss: 1.9036 - acc: 0.3675 - val_loss: 2.2184 - val_acc: 0.2381
Epoch 20/20
 - 0s - loss: 2.0372 - acc: 0.3162 - val_loss: 2.1307 - val_acc: 0.3472
Test loss: 2.1308975582122804
Test accuracy: 0.3465
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2435 - acc: 0.9241 - val_loss: 0.1106 - val_acc: 0.9661
Epoch 2/20
 - 3s - loss: 0.1025 - acc: 0.9693 - val_loss: 0.0748 - val_acc: 0.9766
Epoch 3/20
 - 3s - loss: 0.0755 - acc: 0.9774 - val_loss: 0.0792 - val_acc: 0.9759
Epoch 4/20
 - 3s - loss: 0.0619 - acc: 0.9812 - val_loss: 0.0884 - val_acc: 0.9771
Epoch 5/20
 - 3s - loss: 0.0487 - acc: 0.9849 - val_loss: 0.0808 - val_acc: 0.9786
Epoch 6/20
 - 3s - loss: 0.0458 - acc: 0.9864 - val_loss: 0.0690 - val_acc: 0.9816
Epoch 7/20
 - 2s - loss: 0.0400 - acc: 0.9885 - val_loss: 0.0889 - val_acc: 0.9800
Epoch 8/20
 - 3s - loss: 0.0360 - acc: 0.9894 - val_loss: 0.0876 - val_acc: 0.9804
Epoch 9/20
 - 3s - loss: 0.0340 - acc: 0.9902 - val_loss: 0.0877 - val_acc: 0.9825
Epoch 10/20
 - 3s - loss: 0.0305 - acc: 0.9914 - val_loss: 0.0866 - val_acc: 0.9819
Epoch 11/20
 - 3s - loss: 0.0275 - acc: 0.9921 - val_loss: 0.0848 - val_acc: 0.9829
Epoch 12/20
 - 3s - loss: 0.0264 - acc: 0.9927 - val_loss: 0.0928 - val_acc: 0.9824
Epoch 13/20
 - 3s - loss: 0.0243 - acc: 0.9932 - val_loss: 0.0949 - val_acc: 0.9833
Epoch 14/20
 - 3s - loss: 0.0236 - acc: 0.9938 - val_loss: 0.1046 - val_acc: 0.9831
Epoch 15/20
 - 3s - loss: 0.0225 - acc: 0.9942 - val_loss: 0.1105 - val_acc: 0.9816
Epoch 16/20
 - 3s - loss: 0.0217 - acc: 0.9943 - val_loss: 0.1020 - val_acc: 0.9840
Epoch 17/20
 - 3s - loss: 0.0258 - acc: 0.9936 - val_loss: 0.1100 - val_acc: 0.9830
Epoch 18/20
 - 3s - loss: 0.0198 - acc: 0.9950 - val_loss: 0.1102 - val_acc: 0.9834
Epoch 19/20
 - 3s - loss: 0.0193 - acc: 0.9946 - val_loss: 0.1101 - val_acc: 0.9828
Epoch 20/20
 - 3s - loss: 0.0197 - acc: 0.9952 - val_loss: 0.1165 - val_acc: 0.9839
Test loss: 0.1165118314834398
Test accuracy: 0.9839
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9389 - acc: 0.6972 - val_loss: 0.4122 - val_acc: 0.8675
Epoch 2/20
 - 5s - loss: 0.4285 - acc: 0.8635 - val_loss: 0.4967 - val_acc: 0.8411
Epoch 3/20
 - 5s - loss: 0.3200 - acc: 0.8978 - val_loss: 0.2241 - val_acc: 0.9276
Epoch 4/20
 - 5s - loss: 0.2671 - acc: 0.9157 - val_loss: 0.1794 - val_acc: 0.9445
Epoch 5/20
 - 5s - loss: 0.2342 - acc: 0.9272 - val_loss: 0.1839 - val_acc: 0.9410
Epoch 6/20
 - 5s - loss: 0.2158 - acc: 0.9349 - val_loss: 0.1481 - val_acc: 0.9556
Epoch 7/20
 - 5s - loss: 0.1999 - acc: 0.9392 - val_loss: 0.1310 - val_acc: 0.9609
Epoch 8/20
 - 5s - loss: 0.1931 - acc: 0.9409 - val_loss: 0.1254 - val_acc: 0.9608
Epoch 9/20
 - 5s - loss: 0.1846 - acc: 0.9449 - val_loss: 0.1469 - val_acc: 0.9541
Epoch 10/20
 - 5s - loss: 0.1786 - acc: 0.9465 - val_loss: 0.1576 - val_acc: 0.9488
Epoch 11/20
 - 5s - loss: 0.1712 - acc: 0.9486 - val_loss: 0.1091 - val_acc: 0.9680
Epoch 12/20
 - 5s - loss: 0.1727 - acc: 0.9483 - val_loss: 0.1196 - val_acc: 0.9642
Epoch 13/20
 - 5s - loss: 0.1691 - acc: 0.9507 - val_loss: 0.1023 - val_acc: 0.9709
Epoch 14/20
 - 5s - loss: 0.1710 - acc: 0.9510 - val_loss: 0.1013 - val_acc: 0.9721
Epoch 15/20
 - 5s - loss: 0.1633 - acc: 0.9526 - val_loss: 0.1642 - val_acc: 0.9547
Epoch 16/20
 - 5s - loss: 0.1662 - acc: 0.9523 - val_loss: 0.1418 - val_acc: 0.9597
Epoch 17/20
 - 5s - loss: 0.1687 - acc: 0.9530 - val_loss: 0.1134 - val_acc: 0.9676
Epoch 18/20
 - 5s - loss: 0.1664 - acc: 0.9532 - val_loss: 0.1063 - val_acc: 0.9708
Epoch 19/20
 - 5s - loss: 0.1677 - acc: 0.9532 - val_loss: 0.1117 - val_acc: 0.9660
Epoch 20/20
 - 5s - loss: 0.1655 - acc: 0.9535 - val_loss: 0.1015 - val_acc: 0.9712
Test loss: 0.1029804717022067
Test accuracy: 0.9719
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.3348 - acc: 0.8961 - val_loss: 0.1578 - val_acc: 0.9496
Epoch 2/20
 - 1s - loss: 0.1318 - acc: 0.9593 - val_loss: 0.1203 - val_acc: 0.9637
Epoch 3/20
 - 1s - loss: 0.0906 - acc: 0.9717 - val_loss: 0.1276 - val_acc: 0.9632
Epoch 4/20
 - 1s - loss: 0.0696 - acc: 0.9787 - val_loss: 0.0996 - val_acc: 0.9706
Epoch 5/20
 - 1s - loss: 0.0519 - acc: 0.9844 - val_loss: 0.1008 - val_acc: 0.9724
Epoch 6/20
 - 1s - loss: 0.0463 - acc: 0.9855 - val_loss: 0.0880 - val_acc: 0.9775
Epoch 7/20
 - 1s - loss: 0.0353 - acc: 0.9888 - val_loss: 0.1093 - val_acc: 0.9753
Epoch 8/20
 - 1s - loss: 0.0316 - acc: 0.9898 - val_loss: 0.0972 - val_acc: 0.9780
Epoch 9/20
 - 1s - loss: 0.0287 - acc: 0.9908 - val_loss: 0.0989 - val_acc: 0.9778
Epoch 10/20
 - 1s - loss: 0.0243 - acc: 0.9924 - val_loss: 0.1136 - val_acc: 0.9775
Epoch 11/20
 - 1s - loss: 0.0204 - acc: 0.9935 - val_loss: 0.1265 - val_acc: 0.9748
Epoch 12/20
 - 1s - loss: 0.0171 - acc: 0.9946 - val_loss: 0.1252 - val_acc: 0.9751
Epoch 13/20
 - 1s - loss: 0.0209 - acc: 0.9936 - val_loss: 0.1094 - val_acc: 0.9793
Epoch 14/20
 - 1s - loss: 0.0157 - acc: 0.9952 - val_loss: 0.1261 - val_acc: 0.9781
Epoch 15/20
 - 1s - loss: 0.0186 - acc: 0.9945 - val_loss: 0.1142 - val_acc: 0.9789
Epoch 16/20
 - 1s - loss: 0.0131 - acc: 0.9958 - val_loss: 0.1209 - val_acc: 0.9799
Epoch 17/20
 - 1s - loss: 0.0156 - acc: 0.9955 - val_loss: 0.1420 - val_acc: 0.9775
Epoch 18/20
 - 1s - loss: 0.0140 - acc: 0.9954 - val_loss: 0.1255 - val_acc: 0.9783
Epoch 19/20
 - 1s - loss: 0.0142 - acc: 0.9957 - val_loss: 0.1373 - val_acc: 0.9792
Epoch 20/20
 - 1s - loss: 0.0117 - acc: 0.9966 - val_loss: 0.1268 - val_acc: 0.9799
Test loss: 0.1267679320878055
Test accuracy: 0.9799
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2196 - acc: 0.6057 - val_loss: 1.2019 - val_acc: 0.5948
Epoch 2/20
 - 2s - loss: 0.6160 - acc: 0.7995 - val_loss: 0.5092 - val_acc: 0.8371
Epoch 3/20
 - 2s - loss: 0.4650 - acc: 0.8523 - val_loss: 0.3510 - val_acc: 0.8867
Epoch 4/20
 - 2s - loss: 0.3784 - acc: 0.8808 - val_loss: 0.2788 - val_acc: 0.9118
Epoch 5/20
 - 2s - loss: 0.3231 - acc: 0.8979 - val_loss: 0.2748 - val_acc: 0.9117
Epoch 6/20
 - 2s - loss: 0.2895 - acc: 0.9099 - val_loss: 0.4124 - val_acc: 0.8597
Epoch 7/20
 - 2s - loss: 0.2585 - acc: 0.9196 - val_loss: 0.4627 - val_acc: 0.8396
Epoch 8/20
 - 2s - loss: 0.2392 - acc: 0.9240 - val_loss: 0.3039 - val_acc: 0.8975
Epoch 9/20
 - 2s - loss: 0.2246 - acc: 0.9313 - val_loss: 0.4559 - val_acc: 0.8649
Epoch 10/20
 - 2s - loss: 0.2186 - acc: 0.9326 - val_loss: 0.2094 - val_acc: 0.9327
Epoch 11/20
 - 2s - loss: 0.1996 - acc: 0.9374 - val_loss: 0.2913 - val_acc: 0.9150
Epoch 12/20
 - 2s - loss: 0.1923 - acc: 0.9401 - val_loss: 0.2830 - val_acc: 0.9145
Epoch 13/20
 - 2s - loss: 0.1880 - acc: 0.9408 - val_loss: 0.1270 - val_acc: 0.9594
Epoch 14/20
 - 2s - loss: 0.1782 - acc: 0.9435 - val_loss: 0.1655 - val_acc: 0.9478
Epoch 15/20
 - 2s - loss: 0.1730 - acc: 0.9467 - val_loss: 0.1463 - val_acc: 0.9571
Epoch 16/20
 - 3s - loss: 0.1693 - acc: 0.9479 - val_loss: 0.1203 - val_acc: 0.9622
Epoch 17/20
 - 2s - loss: 0.1603 - acc: 0.9513 - val_loss: 0.1608 - val_acc: 0.9518
Epoch 18/20
 - 2s - loss: 0.1591 - acc: 0.9512 - val_loss: 0.1767 - val_acc: 0.9496
Epoch 19/20
 - 2s - loss: 0.1550 - acc: 0.9528 - val_loss: 0.1132 - val_acc: 0.9646
Epoch 20/20
 - 2s - loss: 0.1487 - acc: 0.9530 - val_loss: 0.1231 - val_acc: 0.9655
Test loss: 0.12449311376593541
Test accuracy: 0.9652
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4584 - acc: 0.8543 - val_loss: 0.2972 - val_acc: 0.9070
Epoch 2/20
 - 1s - loss: 0.1836 - acc: 0.9437 - val_loss: 0.3096 - val_acc: 0.9078
Epoch 3/20
 - 1s - loss: 0.1262 - acc: 0.9619 - val_loss: 0.2149 - val_acc: 0.9368
Epoch 4/20
 - 1s - loss: 0.0909 - acc: 0.9697 - val_loss: 0.1395 - val_acc: 0.9598
Epoch 5/20
 - 1s - loss: 0.0678 - acc: 0.9795 - val_loss: 0.1250 - val_acc: 0.9628
Epoch 6/20
 - 1s - loss: 0.0474 - acc: 0.9863 - val_loss: 0.1465 - val_acc: 0.9614
Epoch 7/20
 - 1s - loss: 0.0376 - acc: 0.9880 - val_loss: 0.1310 - val_acc: 0.9668
Epoch 8/20
 - 1s - loss: 0.0326 - acc: 0.9899 - val_loss: 0.1390 - val_acc: 0.9666
Epoch 9/20
 - 1s - loss: 0.0263 - acc: 0.9916 - val_loss: 0.1609 - val_acc: 0.9642
Epoch 10/20
 - 1s - loss: 0.0240 - acc: 0.9926 - val_loss: 0.1443 - val_acc: 0.9700
Epoch 11/20
 - 1s - loss: 0.0191 - acc: 0.9943 - val_loss: 0.1494 - val_acc: 0.9712
Epoch 12/20
 - 1s - loss: 0.0189 - acc: 0.9943 - val_loss: 0.1578 - val_acc: 0.9697
Epoch 13/20
 - 1s - loss: 0.0163 - acc: 0.9953 - val_loss: 0.1677 - val_acc: 0.9694
Epoch 14/20
 - 1s - loss: 0.0166 - acc: 0.9944 - val_loss: 0.1617 - val_acc: 0.9702
Epoch 15/20
 - 1s - loss: 0.0120 - acc: 0.9953 - val_loss: 0.1641 - val_acc: 0.9719
Epoch 16/20
 - 1s - loss: 0.0110 - acc: 0.9964 - val_loss: 0.1960 - val_acc: 0.9677
Epoch 17/20
 - 1s - loss: 0.0113 - acc: 0.9963 - val_loss: 0.1632 - val_acc: 0.9712
Epoch 18/20
 - 1s - loss: 0.0108 - acc: 0.9971 - val_loss: 0.2029 - val_acc: 0.9651
Epoch 19/20
 - 1s - loss: 0.0149 - acc: 0.9953 - val_loss: 0.1753 - val_acc: 0.9718
Epoch 20/20
 - 1s - loss: 0.0086 - acc: 0.9977 - val_loss: 0.1898 - val_acc: 0.9710
Test loss: 0.18982356682711396
Test accuracy: 0.971
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.5989 - acc: 0.4907 - val_loss: 1.0681 - val_acc: 0.6108
Epoch 2/20
 - 1s - loss: 0.8426 - acc: 0.7212 - val_loss: 1.7050 - val_acc: 0.4870
Epoch 3/20
 - 1s - loss: 0.6526 - acc: 0.7912 - val_loss: 0.8214 - val_acc: 0.7664
Epoch 4/20
 - 1s - loss: 0.5521 - acc: 0.8232 - val_loss: 1.0198 - val_acc: 0.6909
Epoch 5/20
 - 1s - loss: 0.4761 - acc: 0.8490 - val_loss: 1.3097 - val_acc: 0.6243
Epoch 6/20
 - 1s - loss: 0.4294 - acc: 0.8636 - val_loss: 0.4263 - val_acc: 0.8628
Epoch 7/20
 - 1s - loss: 0.3813 - acc: 0.8800 - val_loss: 0.3884 - val_acc: 0.8801
Epoch 8/20
 - 1s - loss: 0.3523 - acc: 0.8893 - val_loss: 1.1940 - val_acc: 0.6584
Epoch 9/20
 - 1s - loss: 0.3229 - acc: 0.8977 - val_loss: 0.2873 - val_acc: 0.9106
Epoch 10/20
 - 1s - loss: 0.2844 - acc: 0.9097 - val_loss: 0.3622 - val_acc: 0.8823
Epoch 11/20
 - 1s - loss: 0.2870 - acc: 0.9090 - val_loss: 0.4038 - val_acc: 0.8772
Epoch 12/20
 - 1s - loss: 0.2540 - acc: 0.9203 - val_loss: 0.2201 - val_acc: 0.9312
Epoch 13/20
 - 1s - loss: 0.2531 - acc: 0.9185 - val_loss: 0.2259 - val_acc: 0.9337
Epoch 14/20
 - 1s - loss: 0.2293 - acc: 0.9279 - val_loss: 0.2746 - val_acc: 0.9140
Epoch 15/20
 - 1s - loss: 0.2115 - acc: 0.9319 - val_loss: 0.3121 - val_acc: 0.9108
Epoch 16/20
 - 1s - loss: 0.2169 - acc: 0.9324 - val_loss: 0.1663 - val_acc: 0.9507
Epoch 17/20
 - 1s - loss: 0.2007 - acc: 0.9352 - val_loss: 0.3124 - val_acc: 0.8982
Epoch 18/20
 - 1s - loss: 0.1926 - acc: 0.9386 - val_loss: 0.1867 - val_acc: 0.9441
Epoch 19/20
 - 1s - loss: 0.1889 - acc: 0.9413 - val_loss: 0.1860 - val_acc: 0.9408
Epoch 20/20
 - 1s - loss: 0.1807 - acc: 0.9417 - val_loss: 0.7748 - val_acc: 0.7886
Test loss: 0.7742185335874557
Test accuracy: 0.7887
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6105 - acc: 0.8087 - val_loss: 0.2889 - val_acc: 0.9132
Epoch 2/20
 - 0s - loss: 0.2442 - acc: 0.9279 - val_loss: 0.2698 - val_acc: 0.9144
Epoch 3/20
 - 0s - loss: 0.1702 - acc: 0.9487 - val_loss: 0.2293 - val_acc: 0.9279
Epoch 4/20
 - 0s - loss: 0.1132 - acc: 0.9661 - val_loss: 0.2031 - val_acc: 0.9400
Epoch 5/20
 - 0s - loss: 0.0874 - acc: 0.9732 - val_loss: 0.1678 - val_acc: 0.9497
Epoch 6/20
 - 0s - loss: 0.0609 - acc: 0.9804 - val_loss: 0.2282 - val_acc: 0.9371
Epoch 7/20
 - 0s - loss: 0.0511 - acc: 0.9844 - val_loss: 0.1815 - val_acc: 0.9497
Epoch 8/20
 - 0s - loss: 0.0360 - acc: 0.9893 - val_loss: 0.1854 - val_acc: 0.9510
Epoch 9/20
 - 0s - loss: 0.0293 - acc: 0.9899 - val_loss: 0.2092 - val_acc: 0.9491
Epoch 10/20
 - 0s - loss: 0.0200 - acc: 0.9939 - val_loss: 0.2165 - val_acc: 0.9503
Epoch 11/20
 - 0s - loss: 0.0200 - acc: 0.9940 - val_loss: 0.2297 - val_acc: 0.9492
Epoch 12/20
 - 0s - loss: 0.0151 - acc: 0.9944 - val_loss: 0.2312 - val_acc: 0.9513
Epoch 13/20
 - 0s - loss: 0.0102 - acc: 0.9969 - val_loss: 0.2488 - val_acc: 0.9505
Epoch 14/20
 - 0s - loss: 0.0158 - acc: 0.9939 - val_loss: 0.2733 - val_acc: 0.9484
Epoch 15/20
 - 0s - loss: 0.0117 - acc: 0.9957 - val_loss: 0.2383 - val_acc: 0.9545
Epoch 16/20
 - 0s - loss: 0.0080 - acc: 0.9973 - val_loss: 0.2570 - val_acc: 0.9518
Epoch 17/20
 - 0s - loss: 0.0113 - acc: 0.9968 - val_loss: 0.2700 - val_acc: 0.9523
Epoch 18/20
 - 0s - loss: 0.0090 - acc: 0.9965 - val_loss: 0.2743 - val_acc: 0.9556
Epoch 19/20
 - 0s - loss: 0.0100 - acc: 0.9964 - val_loss: 0.2699 - val_acc: 0.9537
Epoch 20/20
 - 0s - loss: 0.0083 - acc: 0.9972 - val_loss: 0.2689 - val_acc: 0.9548
Test loss: 0.2688700656216571
Test accuracy: 0.9548
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.1740 - acc: 0.3437 - val_loss: 1.5914 - val_acc: 0.5218
Epoch 2/20
 - 1s - loss: 1.1197 - acc: 0.6336 - val_loss: 0.9751 - val_acc: 0.6594
Epoch 3/20
 - 1s - loss: 0.8737 - acc: 0.7152 - val_loss: 1.0251 - val_acc: 0.6498
Epoch 4/20
 - 1s - loss: 0.7296 - acc: 0.7659 - val_loss: 1.0568 - val_acc: 0.6336
Epoch 5/20
 - 1s - loss: 0.6613 - acc: 0.7848 - val_loss: 1.0341 - val_acc: 0.7016
Epoch 6/20
 - 1s - loss: 0.5984 - acc: 0.8047 - val_loss: 0.7062 - val_acc: 0.7533
Epoch 7/20
 - 1s - loss: 0.5401 - acc: 0.8251 - val_loss: 0.5704 - val_acc: 0.8179
Epoch 8/20
 - 1s - loss: 0.5132 - acc: 0.8387 - val_loss: 0.3432 - val_acc: 0.8893
Epoch 9/20
 - 1s - loss: 0.4628 - acc: 0.8523 - val_loss: 0.5512 - val_acc: 0.8161
Epoch 10/20
 - 1s - loss: 0.4194 - acc: 0.8625 - val_loss: 0.3562 - val_acc: 0.8866
Epoch 11/20
 - 1s - loss: 0.4127 - acc: 0.8680 - val_loss: 0.3246 - val_acc: 0.8952
Epoch 12/20
 - 1s - loss: 0.3806 - acc: 0.8781 - val_loss: 0.5662 - val_acc: 0.8213
Epoch 13/20
 - 1s - loss: 0.3609 - acc: 0.8847 - val_loss: 0.3249 - val_acc: 0.8939
Epoch 14/20
 - 1s - loss: 0.3393 - acc: 0.8933 - val_loss: 0.6833 - val_acc: 0.8092
Epoch 15/20
 - 1s - loss: 0.3476 - acc: 0.8899 - val_loss: 0.2658 - val_acc: 0.9149
Epoch 16/20
 - 1s - loss: 0.3062 - acc: 0.9015 - val_loss: 0.6182 - val_acc: 0.7724
Epoch 17/20
 - 1s - loss: 0.3105 - acc: 0.8997 - val_loss: 0.2371 - val_acc: 0.9274
Epoch 18/20
 - 1s - loss: 0.2850 - acc: 0.9101 - val_loss: 0.3550 - val_acc: 0.8828
Epoch 19/20
 - 1s - loss: 0.2749 - acc: 0.9113 - val_loss: 0.4131 - val_acc: 0.8629
Epoch 20/20
 - 1s - loss: 0.2689 - acc: 0.9139 - val_loss: 0.3849 - val_acc: 0.8802
Test loss: 0.3854675292730331
Test accuracy: 0.8809
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.7931 - acc: 0.7461 - val_loss: 0.3700 - val_acc: 0.8908
Epoch 2/20
 - 0s - loss: 0.3222 - acc: 0.9053 - val_loss: 0.3999 - val_acc: 0.8726
Epoch 3/20
 - 0s - loss: 0.2250 - acc: 0.9312 - val_loss: 0.2401 - val_acc: 0.9313
Epoch 4/20
 - 0s - loss: 0.1671 - acc: 0.9496 - val_loss: 0.5170 - val_acc: 0.8515
Epoch 5/20
 - 0s - loss: 0.1221 - acc: 0.9629 - val_loss: 0.2285 - val_acc: 0.9314
Epoch 6/20
 - 0s - loss: 0.0912 - acc: 0.9709 - val_loss: 0.2018 - val_acc: 0.9421
Epoch 7/20
 - 0s - loss: 0.0667 - acc: 0.9795 - val_loss: 0.2909 - val_acc: 0.9166
Epoch 8/20
 - 0s - loss: 0.0512 - acc: 0.9835 - val_loss: 0.3627 - val_acc: 0.9082
Epoch 9/20
 - 0s - loss: 0.0373 - acc: 0.9888 - val_loss: 0.2507 - val_acc: 0.9312
Epoch 10/20
 - 0s - loss: 0.0321 - acc: 0.9907 - val_loss: 0.2676 - val_acc: 0.9308
Epoch 11/20
 - 0s - loss: 0.0196 - acc: 0.9949 - val_loss: 0.2573 - val_acc: 0.9373
Epoch 12/20
 - 0s - loss: 0.0213 - acc: 0.9928 - val_loss: 0.2658 - val_acc: 0.9353
Epoch 13/20
 - 0s - loss: 0.0121 - acc: 0.9960 - val_loss: 0.2605 - val_acc: 0.9407
Epoch 14/20
 - 0s - loss: 0.0113 - acc: 0.9963 - val_loss: 0.2883 - val_acc: 0.9331
Epoch 15/20
 - 0s - loss: 0.0152 - acc: 0.9952 - val_loss: 0.2570 - val_acc: 0.9423
Epoch 16/20
 - 0s - loss: 0.0052 - acc: 0.9981 - val_loss: 0.3245 - val_acc: 0.9321
Epoch 17/20
 - 0s - loss: 0.0073 - acc: 0.9981 - val_loss: 0.2893 - val_acc: 0.9431
Epoch 18/20
 - 0s - loss: 0.0077 - acc: 0.9976 - val_loss: 0.3743 - val_acc: 0.9239
Epoch 19/20
 - 0s - loss: 0.0058 - acc: 0.9981 - val_loss: 0.2870 - val_acc: 0.9438
Epoch 20/20
 - 0s - loss: 0.0041 - acc: 0.9989 - val_loss: 0.3178 - val_acc: 0.9412
Test loss: 0.31779827759060425
Test accuracy: 0.9412
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.4770 - acc: 0.2549 - val_loss: 1.7276 - val_acc: 0.4113
Epoch 2/20
 - 1s - loss: 1.5428 - acc: 0.4787 - val_loss: 1.9275 - val_acc: 0.3098
Epoch 3/20
 - 1s - loss: 1.2215 - acc: 0.5904 - val_loss: 1.0606 - val_acc: 0.6708
Epoch 4/20
 - 1s - loss: 0.9855 - acc: 0.6747 - val_loss: 1.1742 - val_acc: 0.6239
Epoch 5/20
 - 1s - loss: 0.9285 - acc: 0.6944 - val_loss: 0.8170 - val_acc: 0.7240
Epoch 6/20
 - 1s - loss: 0.8231 - acc: 0.7288 - val_loss: 0.9402 - val_acc: 0.6906
Epoch 7/20
 - 1s - loss: 0.7615 - acc: 0.7541 - val_loss: 0.6827 - val_acc: 0.7840
Epoch 8/20
 - 1s - loss: 0.6844 - acc: 0.7763 - val_loss: 1.0583 - val_acc: 0.6479
Epoch 9/20
 - 1s - loss: 0.6643 - acc: 0.7861 - val_loss: 0.5869 - val_acc: 0.8112
Epoch 10/20
 - 1s - loss: 0.5988 - acc: 0.8083 - val_loss: 0.8417 - val_acc: 0.7311
Epoch 11/20
 - 1s - loss: 0.6186 - acc: 0.8037 - val_loss: 0.5401 - val_acc: 0.8163
Epoch 12/20
 - 1s - loss: 0.5662 - acc: 0.8136 - val_loss: 0.7681 - val_acc: 0.7414
Epoch 13/20
 - 1s - loss: 0.5316 - acc: 0.8347 - val_loss: 0.4514 - val_acc: 0.8489
Epoch 14/20
 - 1s - loss: 0.5202 - acc: 0.8296 - val_loss: 0.5679 - val_acc: 0.8077
Epoch 15/20
 - 1s - loss: 0.4623 - acc: 0.8467 - val_loss: 0.5829 - val_acc: 0.8155
Epoch 16/20
 - 1s - loss: 0.4740 - acc: 0.8467 - val_loss: 0.7888 - val_acc: 0.7319
Epoch 17/20
 - 1s - loss: 0.4263 - acc: 0.8717 - val_loss: 0.4388 - val_acc: 0.8531
Epoch 18/20
 - 1s - loss: 0.4399 - acc: 0.8608 - val_loss: 0.6463 - val_acc: 0.8030
Epoch 19/20
 - 1s - loss: 0.3847 - acc: 0.8800 - val_loss: 0.6093 - val_acc: 0.7922
Epoch 20/20
 - 1s - loss: 0.3819 - acc: 0.8763 - val_loss: 0.9406 - val_acc: 0.7643
Test loss: 0.9391528994083405
Test accuracy: 0.7639
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1141 - acc: 0.6443 - val_loss: 0.7732 - val_acc: 0.7441
Epoch 2/20
 - 0s - loss: 0.4860 - acc: 0.8592 - val_loss: 0.4417 - val_acc: 0.8620
Epoch 3/20
 - 0s - loss: 0.3041 - acc: 0.9179 - val_loss: 0.3522 - val_acc: 0.8920
Epoch 4/20
 - 0s - loss: 0.2515 - acc: 0.9264 - val_loss: 0.3515 - val_acc: 0.8957
Epoch 5/20
 - 0s - loss: 0.1662 - acc: 0.9536 - val_loss: 0.4515 - val_acc: 0.8598
Epoch 6/20
 - 0s - loss: 0.1275 - acc: 0.9653 - val_loss: 0.4187 - val_acc: 0.8712
Epoch 7/20
 - 0s - loss: 0.1007 - acc: 0.9739 - val_loss: 0.3161 - val_acc: 0.9084
Epoch 8/20
 - 0s - loss: 0.0997 - acc: 0.9707 - val_loss: 0.2686 - val_acc: 0.9192
Epoch 9/20
 - 0s - loss: 0.0466 - acc: 0.9888 - val_loss: 0.3284 - val_acc: 0.9043
Epoch 10/20
 - 0s - loss: 0.0539 - acc: 0.9845 - val_loss: 0.2892 - val_acc: 0.9210
Epoch 11/20
 - 0s - loss: 0.0530 - acc: 0.9840 - val_loss: 0.2906 - val_acc: 0.9210
Epoch 12/20
 - 0s - loss: 0.0138 - acc: 0.9989 - val_loss: 0.3093 - val_acc: 0.9188
Epoch 13/20
 - 0s - loss: 0.0223 - acc: 0.9952 - val_loss: 0.4800 - val_acc: 0.8880
Epoch 14/20
 - 0s - loss: 0.0261 - acc: 0.9925 - val_loss: 0.3211 - val_acc: 0.9213
Epoch 15/20
 - 0s - loss: 0.0254 - acc: 0.9925 - val_loss: 0.3122 - val_acc: 0.9247
Epoch 16/20
 - 0s - loss: 0.0093 - acc: 0.9984 - val_loss: 0.4132 - val_acc: 0.9080
Epoch 17/20
 - 0s - loss: 0.0074 - acc: 0.9979 - val_loss: 0.4146 - val_acc: 0.9075
Epoch 18/20
 - 0s - loss: 0.0095 - acc: 0.9968 - val_loss: 0.4598 - val_acc: 0.8966
Epoch 19/20
 - 0s - loss: 0.0087 - acc: 0.9968 - val_loss: 0.3678 - val_acc: 0.9183
Epoch 20/20
 - 0s - loss: 0.0031 - acc: 1.0000 - val_loss: 0.5006 - val_acc: 0.9014
Test loss: 0.5005954248590627
Test accuracy: 0.9014
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.3438 - acc: 0.1669 - val_loss: 2.1276 - val_acc: 0.2555
Epoch 2/20
 - 1s - loss: 1.9855 - acc: 0.3184 - val_loss: 1.7039 - val_acc: 0.3682
Epoch 3/20
 - 1s - loss: 1.7285 - acc: 0.4357 - val_loss: 1.9534 - val_acc: 0.3473
Epoch 4/20
 - 1s - loss: 1.4668 - acc: 0.5205 - val_loss: 1.3939 - val_acc: 0.5239
Epoch 5/20
 - 1s - loss: 1.2491 - acc: 0.5899 - val_loss: 1.0907 - val_acc: 0.6413
Epoch 6/20
 - 1s - loss: 1.1690 - acc: 0.6032 - val_loss: 0.9034 - val_acc: 0.7127
Epoch 7/20
 - 1s - loss: 1.1256 - acc: 0.6432 - val_loss: 1.2395 - val_acc: 0.5622
Epoch 8/20
 - 1s - loss: 0.9826 - acc: 0.6624 - val_loss: 0.8505 - val_acc: 0.7095
Epoch 9/20
 - 1s - loss: 0.9366 - acc: 0.6885 - val_loss: 1.0489 - val_acc: 0.6063
Epoch 10/20
 - 1s - loss: 0.9080 - acc: 0.6923 - val_loss: 0.9015 - val_acc: 0.7270
Epoch 11/20
 - 1s - loss: 0.7964 - acc: 0.7456 - val_loss: 1.3121 - val_acc: 0.5662
Epoch 12/20
 - 1s - loss: 0.8078 - acc: 0.7456 - val_loss: 0.9266 - val_acc: 0.7338
Epoch 13/20
 - 1s - loss: 0.7263 - acc: 0.7627 - val_loss: 1.2223 - val_acc: 0.5908
Epoch 14/20
 - 1s - loss: 0.7422 - acc: 0.7536 - val_loss: 1.0990 - val_acc: 0.6666
Epoch 15/20
 - 1s - loss: 0.6981 - acc: 0.7851 - val_loss: 0.9201 - val_acc: 0.6812
Epoch 16/20
 - 1s - loss: 0.7210 - acc: 0.7477 - val_loss: 0.6569 - val_acc: 0.7760
Epoch 17/20
 - 1s - loss: 0.6775 - acc: 0.7861 - val_loss: 0.8642 - val_acc: 0.7128
Epoch 18/20
 - 1s - loss: 0.5736 - acc: 0.8053 - val_loss: 0.8948 - val_acc: 0.7288
Epoch 19/20
 - 1s - loss: 0.6218 - acc: 0.8112 - val_loss: 0.5870 - val_acc: 0.8023
Epoch 20/20
 - 1s - loss: 0.5986 - acc: 0.8064 - val_loss: 0.4475 - val_acc: 0.8567
Test loss: 0.447240947663784
Test accuracy: 0.8574
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.4810 - acc: 0.5059 - val_loss: 0.9201 - val_acc: 0.7053
Epoch 2/20
 - 0s - loss: 0.6282 - acc: 0.8132 - val_loss: 0.7234 - val_acc: 0.7495
Epoch 3/20
 - 0s - loss: 0.4095 - acc: 0.8741 - val_loss: 0.7840 - val_acc: 0.7392
Epoch 4/20
 - 0s - loss: 0.3101 - acc: 0.9082 - val_loss: 0.4935 - val_acc: 0.8505
Epoch 5/20
 - 0s - loss: 0.2291 - acc: 0.9413 - val_loss: 0.6087 - val_acc: 0.8052
Epoch 6/20
 - 0s - loss: 0.2268 - acc: 0.9274 - val_loss: 0.4113 - val_acc: 0.8696
Epoch 7/20
 - 0s - loss: 0.1798 - acc: 0.9466 - val_loss: 0.4618 - val_acc: 0.8572
Epoch 8/20
 - 0s - loss: 0.1053 - acc: 0.9755 - val_loss: 0.3607 - val_acc: 0.8903
Epoch 9/20
 - 0s - loss: 0.1023 - acc: 0.9669 - val_loss: 0.4470 - val_acc: 0.8646
Epoch 10/20
 - 0s - loss: 0.0564 - acc: 0.9936 - val_loss: 0.3795 - val_acc: 0.8855
Epoch 11/20
 - 0s - loss: 0.0363 - acc: 0.9957 - val_loss: 0.5874 - val_acc: 0.8315
Epoch 12/20
 - 0s - loss: 0.0866 - acc: 0.9776 - val_loss: 0.4541 - val_acc: 0.8726
Epoch 13/20
 - 0s - loss: 0.0208 - acc: 0.9968 - val_loss: 0.5721 - val_acc: 0.8431
Epoch 14/20
 - 0s - loss: 0.0873 - acc: 0.9797 - val_loss: 0.4045 - val_acc: 0.8924
Epoch 15/20
 - 0s - loss: 0.0147 - acc: 0.9989 - val_loss: 0.3990 - val_acc: 0.8943
Epoch 16/20
 - 0s - loss: 0.0096 - acc: 0.9989 - val_loss: 0.4605 - val_acc: 0.8814
Epoch 17/20
 - 0s - loss: 0.0078 - acc: 1.0000 - val_loss: 0.4224 - val_acc: 0.8956
Epoch 18/20
 - 0s - loss: 0.0071 - acc: 0.9989 - val_loss: 0.6854 - val_acc: 0.8494
Epoch 19/20
 - 0s - loss: 0.0284 - acc: 0.9936 - val_loss: 0.4657 - val_acc: 0.8893
Epoch 20/20
 - 0s - loss: 0.0063 - acc: 1.0000 - val_loss: 0.4785 - val_acc: 0.8853
Test loss: 0.47846098974896595
Test accuracy: 0.8853
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.3126 - acc: 0.1387 - val_loss: 2.2518 - val_acc: 0.1434
Epoch 2/20
 - 1s - loss: 2.1960 - acc: 0.1996 - val_loss: 2.1122 - val_acc: 0.1824
Epoch 3/20
 - 1s - loss: 2.0854 - acc: 0.2615 - val_loss: 1.8354 - val_acc: 0.4032
Epoch 4/20
 - 1s - loss: 1.8748 - acc: 0.3223 - val_loss: 1.6913 - val_acc: 0.4765
Epoch 5/20
 - 1s - loss: 1.6185 - acc: 0.4931 - val_loss: 1.9799 - val_acc: 0.1818
Epoch 6/20
 - 1s - loss: 1.6488 - acc: 0.4493 - val_loss: 1.4011 - val_acc: 0.6246
Epoch 7/20
 - 1s - loss: 1.4329 - acc: 0.5208 - val_loss: 1.7335 - val_acc: 0.3035
Epoch 8/20
 - 1s - loss: 1.4030 - acc: 0.5293 - val_loss: 1.7381 - val_acc: 0.3875
Epoch 9/20
 - 1s - loss: 1.2372 - acc: 0.5848 - val_loss: 1.2484 - val_acc: 0.5762
Epoch 10/20
 - 1s - loss: 1.1786 - acc: 0.6201 - val_loss: 1.2217 - val_acc: 0.5443
Epoch 11/20
 - 1s - loss: 1.1173 - acc: 0.6265 - val_loss: 0.9272 - val_acc: 0.6747
Epoch 12/20
 - 1s - loss: 1.0547 - acc: 0.6788 - val_loss: 0.9641 - val_acc: 0.6463
Epoch 13/20
 - 0s - loss: 0.9646 - acc: 0.6777 - val_loss: 0.9699 - val_acc: 0.6650
Epoch 14/20
 - 1s - loss: 0.9353 - acc: 0.6894 - val_loss: 1.0415 - val_acc: 0.6349
Epoch 15/20
 - 1s - loss: 0.8996 - acc: 0.7150 - val_loss: 1.1453 - val_acc: 0.5748
Epoch 16/20
 - 1s - loss: 0.9578 - acc: 0.6820 - val_loss: 0.8856 - val_acc: 0.7159
Epoch 17/20
 - 1s - loss: 0.8208 - acc: 0.7161 - val_loss: 0.8460 - val_acc: 0.6961
Epoch 18/20
 - 1s - loss: 0.8131 - acc: 0.7417 - val_loss: 1.5793 - val_acc: 0.4586
Epoch 19/20
 - 1s - loss: 0.9079 - acc: 0.7033 - val_loss: 1.0079 - val_acc: 0.6741
Epoch 20/20
 - 1s - loss: 0.6904 - acc: 0.7951 - val_loss: 0.6513 - val_acc: 0.7885
Test loss: 0.6513482809543609
Test accuracy: 0.7871
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8036 - acc: 0.4274 - val_loss: 1.0772 - val_acc: 0.6736
Epoch 2/20
 - 0s - loss: 0.7507 - acc: 0.7927 - val_loss: 1.0543 - val_acc: 0.6481
Epoch 3/20
 - 0s - loss: 0.5268 - acc: 0.8269 - val_loss: 0.7073 - val_acc: 0.7626
Epoch 4/20
 - 0s - loss: 0.3352 - acc: 0.9145 - val_loss: 0.6205 - val_acc: 0.8045
Epoch 5/20
 - 0s - loss: 0.2399 - acc: 0.9316 - val_loss: 0.7927 - val_acc: 0.7340
Epoch 6/20
 - 0s - loss: 0.2554 - acc: 0.9252 - val_loss: 0.5549 - val_acc: 0.8166
Epoch 7/20
 - 0s - loss: 0.1919 - acc: 0.9380 - val_loss: 0.6723 - val_acc: 0.7730
Epoch 8/20
 - 0s - loss: 0.1091 - acc: 0.9786 - val_loss: 0.5475 - val_acc: 0.8346
Epoch 9/20
 - 0s - loss: 0.0678 - acc: 0.9936 - val_loss: 0.5639 - val_acc: 0.8289
Epoch 10/20
 - 0s - loss: 0.0644 - acc: 0.9893 - val_loss: 0.5523 - val_acc: 0.8347
Epoch 11/20
 - 0s - loss: 0.0402 - acc: 0.9936 - val_loss: 0.5631 - val_acc: 0.8345
Epoch 12/20
 - 0s - loss: 0.0289 - acc: 1.0000 - val_loss: 0.5521 - val_acc: 0.8466
Epoch 13/20
 - 0s - loss: 0.0290 - acc: 1.0000 - val_loss: 0.6466 - val_acc: 0.8180
Epoch 14/20
 - 0s - loss: 0.0316 - acc: 0.9957 - val_loss: 0.5884 - val_acc: 0.8434
Epoch 15/20
 - 0s - loss: 0.0197 - acc: 1.0000 - val_loss: 0.5726 - val_acc: 0.8474
Epoch 16/20
 - 0s - loss: 0.0131 - acc: 0.9979 - val_loss: 0.5530 - val_acc: 0.8491
Epoch 17/20
 - 0s - loss: 0.0231 - acc: 0.9957 - val_loss: 1.0778 - val_acc: 0.7276
Epoch 18/20
 - 0s - loss: 0.1946 - acc: 0.9423 - val_loss: 0.5553 - val_acc: 0.8476
Epoch 19/20
 - 0s - loss: 0.0093 - acc: 1.0000 - val_loss: 0.5794 - val_acc: 0.8468
Epoch 20/20
 - 0s - loss: 0.0052 - acc: 1.0000 - val_loss: 0.5632 - val_acc: 0.8539
Test loss: 0.5632210013225675
Test accuracy: 0.8539
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.9111 - acc: 0.1239 - val_loss: 3.4034 - val_acc: 0.1643
Epoch 2/20
 - 0s - loss: 2.6740 - acc: 0.1581 - val_loss: 2.2406 - val_acc: 0.1935
Epoch 3/20
 - 0s - loss: 2.1453 - acc: 0.2308 - val_loss: 2.1682 - val_acc: 0.1880
Epoch 4/20
 - 0s - loss: 2.1787 - acc: 0.2094 - val_loss: 2.0877 - val_acc: 0.2612
Epoch 5/20
 - 0s - loss: 1.9007 - acc: 0.3590 - val_loss: 2.1226 - val_acc: 0.2949
Epoch 6/20
 - 0s - loss: 1.7794 - acc: 0.4231 - val_loss: 1.9696 - val_acc: 0.2436
Epoch 7/20
 - 0s - loss: 1.8089 - acc: 0.3825 - val_loss: 1.6502 - val_acc: 0.5078
Epoch 8/20
 - 0s - loss: 1.5576 - acc: 0.4936 - val_loss: 1.9294 - val_acc: 0.3398
Epoch 9/20
 - 0s - loss: 1.7807 - acc: 0.4316 - val_loss: 1.7191 - val_acc: 0.4643
Epoch 10/20
 - 0s - loss: 1.6412 - acc: 0.4209 - val_loss: 1.4136 - val_acc: 0.5412
Epoch 11/20
 - 0s - loss: 1.3250 - acc: 0.5491 - val_loss: 1.3057 - val_acc: 0.5677
Epoch 12/20
 - 0s - loss: 1.2248 - acc: 0.6111 - val_loss: 1.7194 - val_acc: 0.4748
Epoch 13/20
 - 0s - loss: 1.3395 - acc: 0.5833 - val_loss: 1.3537 - val_acc: 0.5488
Epoch 14/20
 - 0s - loss: 1.2687 - acc: 0.6154 - val_loss: 1.2869 - val_acc: 0.5623
Epoch 15/20
 - 0s - loss: 1.0472 - acc: 0.6709 - val_loss: 1.1989 - val_acc: 0.6013
Epoch 16/20
 - 0s - loss: 1.1981 - acc: 0.6197 - val_loss: 1.2697 - val_acc: 0.5528
Epoch 17/20
 - 0s - loss: 1.0613 - acc: 0.6368 - val_loss: 1.0507 - val_acc: 0.6612
Epoch 18/20
 - 0s - loss: 0.8063 - acc: 0.7479 - val_loss: 0.9613 - val_acc: 0.6768
Epoch 19/20
 - 0s - loss: 0.8622 - acc: 0.7158 - val_loss: 1.7103 - val_acc: 0.4217
Epoch 20/20
 - 0s - loss: 1.3684 - acc: 0.5705 - val_loss: 1.0795 - val_acc: 0.6573
Test loss: 1.0790543077468873
Test accuracy: 0.6572
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1985 - acc: 0.2350 - val_loss: 1.6140 - val_acc: 0.4719
Epoch 2/20
 - 0s - loss: 1.2420 - acc: 0.6410 - val_loss: 1.4330 - val_acc: 0.5660
Epoch 3/20
 - 0s - loss: 0.7656 - acc: 0.8162 - val_loss: 1.1025 - val_acc: 0.6587
Epoch 4/20
 - 0s - loss: 0.5413 - acc: 0.8291 - val_loss: 1.1597 - val_acc: 0.6362
Epoch 5/20
 - 0s - loss: 0.5426 - acc: 0.8120 - val_loss: 0.8913 - val_acc: 0.7108
Epoch 6/20
 - 0s - loss: 0.3281 - acc: 0.9188 - val_loss: 0.8707 - val_acc: 0.7080
Epoch 7/20
 - 0s - loss: 0.2253 - acc: 0.9444 - val_loss: 0.7139 - val_acc: 0.7669
Epoch 8/20
 - 0s - loss: 0.1459 - acc: 0.9744 - val_loss: 0.7029 - val_acc: 0.7754
Epoch 9/20
 - 0s - loss: 0.1163 - acc: 0.9744 - val_loss: 0.7563 - val_acc: 0.7604
Epoch 10/20
 - 0s - loss: 0.0968 - acc: 0.9872 - val_loss: 0.7663 - val_acc: 0.7634
Epoch 11/20
 - 0s - loss: 0.0695 - acc: 0.9915 - val_loss: 0.6968 - val_acc: 0.7831
Epoch 12/20
 - 0s - loss: 0.0612 - acc: 1.0000 - val_loss: 0.7350 - val_acc: 0.7829
Epoch 13/20
 - 0s - loss: 0.0524 - acc: 0.9957 - val_loss: 0.7469 - val_acc: 0.7820
Epoch 14/20
 - 0s - loss: 0.0386 - acc: 1.0000 - val_loss: 0.7288 - val_acc: 0.7819
Epoch 15/20
 - 0s - loss: 0.0262 - acc: 1.0000 - val_loss: 0.7338 - val_acc: 0.7832
Epoch 16/20
 - 0s - loss: 0.0268 - acc: 1.0000 - val_loss: 0.7306 - val_acc: 0.7827
Epoch 17/20
 - 0s - loss: 0.0146 - acc: 1.0000 - val_loss: 0.7457 - val_acc: 0.7849
Epoch 18/20
 - 0s - loss: 0.0183 - acc: 1.0000 - val_loss: 0.7929 - val_acc: 0.7791
Epoch 19/20
 - 0s - loss: 0.0131 - acc: 1.0000 - val_loss: 0.7475 - val_acc: 0.7875
Epoch 20/20
 - 0s - loss: 0.0103 - acc: 1.0000 - val_loss: 0.8044 - val_acc: 0.7846
Test loss: 0.8044047864556313
Test accuracy: 0.7846
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.1176 - acc: 0.1197 - val_loss: 5.5144 - val_acc: 0.1034
Epoch 2/20
 - 0s - loss: 4.9907 - acc: 0.1453 - val_loss: 2.6532 - val_acc: 0.0919
Epoch 3/20
 - 0s - loss: 2.6833 - acc: 0.0983 - val_loss: 2.3663 - val_acc: 0.1389
Epoch 4/20
 - 0s - loss: 2.3055 - acc: 0.1838 - val_loss: 2.1548 - val_acc: 0.2483
Epoch 5/20
 - 0s - loss: 2.0633 - acc: 0.3248 - val_loss: 2.0730 - val_acc: 0.3924
Epoch 6/20
 - 0s - loss: 2.0281 - acc: 0.2821 - val_loss: 2.1707 - val_acc: 0.2452
Epoch 7/20
 - 0s - loss: 2.0932 - acc: 0.2821 - val_loss: 1.9725 - val_acc: 0.2859
Epoch 8/20
 - 0s - loss: 1.9244 - acc: 0.3205 - val_loss: 1.8735 - val_acc: 0.3838
Epoch 9/20
 - 0s - loss: 1.8318 - acc: 0.3846 - val_loss: 2.1878 - val_acc: 0.1683
Epoch 10/20
 - 0s - loss: 2.1284 - acc: 0.2436 - val_loss: 1.8152 - val_acc: 0.5238
Epoch 11/20
 - 0s - loss: 1.7806 - acc: 0.4359 - val_loss: 2.1426 - val_acc: 0.2789
Epoch 12/20
 - 0s - loss: 1.9996 - acc: 0.3675 - val_loss: 1.7148 - val_acc: 0.5141
Epoch 13/20
 - 0s - loss: 1.5272 - acc: 0.5855 - val_loss: 1.7711 - val_acc: 0.3493
Epoch 14/20
 - 0s - loss: 1.9692 - acc: 0.2991 - val_loss: 2.1134 - val_acc: 0.2314
Epoch 15/20
 - 0s - loss: 1.9458 - acc: 0.3718 - val_loss: 1.7210 - val_acc: 0.4504
Epoch 16/20
 - 0s - loss: 1.5455 - acc: 0.4744 - val_loss: 1.8502 - val_acc: 0.3066
Epoch 17/20
 - 0s - loss: 1.6858 - acc: 0.4145 - val_loss: 1.6763 - val_acc: 0.4609
Epoch 18/20
 - 0s - loss: 1.3849 - acc: 0.5812 - val_loss: 1.4203 - val_acc: 0.6137
Epoch 19/20
 - 0s - loss: 1.1646 - acc: 0.6667 - val_loss: 1.3721 - val_acc: 0.5785
Epoch 20/20
 - 0s - loss: 1.2774 - acc: 0.6154 - val_loss: 1.8448 - val_acc: 0.3641
Test loss: 1.8448046697616578
Test accuracy: 0.3628
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3797 - acc: 0.0940 - val_loss: 2.0417 - val_acc: 0.2802
Epoch 2/20
 - 0s - loss: 1.6089 - acc: 0.4957 - val_loss: 1.6860 - val_acc: 0.5173
Epoch 3/20
 - 0s - loss: 1.2996 - acc: 0.7521 - val_loss: 1.4430 - val_acc: 0.5529
Epoch 4/20
 - 0s - loss: 0.7785 - acc: 0.8547 - val_loss: 1.1630 - val_acc: 0.6241
Epoch 5/20
 - 0s - loss: 0.4927 - acc: 0.9658 - val_loss: 1.1411 - val_acc: 0.6559
Epoch 6/20
 - 0s - loss: 0.3274 - acc: 0.9402 - val_loss: 1.1619 - val_acc: 0.5971
Epoch 7/20
 - 0s - loss: 0.3130 - acc: 0.9231 - val_loss: 1.4000 - val_acc: 0.6292
Epoch 8/20
 - 0s - loss: 0.4451 - acc: 0.8718 - val_loss: 1.0139 - val_acc: 0.6726
Epoch 9/20
 - 0s - loss: 0.1942 - acc: 0.9316 - val_loss: 0.9420 - val_acc: 0.7220
Epoch 10/20
 - 0s - loss: 0.1042 - acc: 0.9915 - val_loss: 0.9570 - val_acc: 0.7063
Epoch 11/20
 - 0s - loss: 0.0792 - acc: 1.0000 - val_loss: 0.9543 - val_acc: 0.7161
Epoch 12/20
 - 0s - loss: 0.0633 - acc: 0.9915 - val_loss: 0.9583 - val_acc: 0.7098
Epoch 13/20
 - 0s - loss: 0.0448 - acc: 1.0000 - val_loss: 0.9391 - val_acc: 0.7209
Epoch 14/20
 - 0s - loss: 0.0398 - acc: 1.0000 - val_loss: 0.9604 - val_acc: 0.7157
Epoch 15/20
 - 0s - loss: 0.0340 - acc: 1.0000 - val_loss: 0.9630 - val_acc: 0.7187
Epoch 16/20
 - 0s - loss: 0.0260 - acc: 1.0000 - val_loss: 0.9622 - val_acc: 0.7224
Epoch 17/20
 - 0s - loss: 0.0239 - acc: 1.0000 - val_loss: 0.9676 - val_acc: 0.7233
Epoch 18/20
 - 0s - loss: 0.0188 - acc: 1.0000 - val_loss: 0.9824 - val_acc: 0.7229
Epoch 19/20
 - 0s - loss: 0.0200 - acc: 1.0000 - val_loss: 1.0079 - val_acc: 0.7178
Epoch 20/20
 - 0s - loss: 0.0188 - acc: 1.0000 - val_loss: 1.0157 - val_acc: 0.7146
Test loss: 1.0157048876762391
Test accuracy: 0.7146
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6700 - acc: 0.0684 - val_loss: 8.0957 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 7.0309 - acc: 0.1624 - val_loss: 5.6085 - val_acc: 0.1253
Epoch 3/20
 - 0s - loss: 6.0530 - acc: 0.1624 - val_loss: 3.2624 - val_acc: 0.1033
Epoch 4/20
 - 0s - loss: 3.4672 - acc: 0.1966 - val_loss: 2.7802 - val_acc: 0.1205
Epoch 5/20
 - 0s - loss: 2.8904 - acc: 0.1795 - val_loss: 2.2558 - val_acc: 0.1248
Epoch 6/20
 - 0s - loss: 2.2813 - acc: 0.1197 - val_loss: 2.2906 - val_acc: 0.1529
Epoch 7/20
 - 0s - loss: 2.1903 - acc: 0.2137 - val_loss: 2.2032 - val_acc: 0.3176
Epoch 8/20
 - 0s - loss: 2.0755 - acc: 0.2564 - val_loss: 2.1356 - val_acc: 0.2258
Epoch 9/20
 - 0s - loss: 1.9933 - acc: 0.2991 - val_loss: 2.0879 - val_acc: 0.3090
Epoch 10/20
 - 0s - loss: 2.0079 - acc: 0.2906 - val_loss: 2.1370 - val_acc: 0.1300
Epoch 11/20
 - 0s - loss: 1.9518 - acc: 0.2821 - val_loss: 2.2145 - val_acc: 0.2076
Epoch 12/20
 - 0s - loss: 2.0861 - acc: 0.2991 - val_loss: 2.0979 - val_acc: 0.2444
Epoch 13/20
 - 0s - loss: 1.9685 - acc: 0.3419 - val_loss: 2.0417 - val_acc: 0.3877
Epoch 14/20
 - 0s - loss: 1.7586 - acc: 0.4188 - val_loss: 1.8797 - val_acc: 0.4784
Epoch 15/20
 - 0s - loss: 1.6263 - acc: 0.5214 - val_loss: 1.8805 - val_acc: 0.3202
Epoch 16/20
 - 0s - loss: 1.5367 - acc: 0.4786 - val_loss: 2.0140 - val_acc: 0.3722
Epoch 17/20
 - 0s - loss: 1.7362 - acc: 0.4274 - val_loss: 2.1480 - val_acc: 0.2550
Epoch 18/20
 - 0s - loss: 1.7817 - acc: 0.3504 - val_loss: 1.9273 - val_acc: 0.2861
Epoch 19/20
 - 0s - loss: 1.6675 - acc: 0.4103 - val_loss: 2.2102 - val_acc: 0.2658
Epoch 20/20
 - 0s - loss: 1.8890 - acc: 0.2906 - val_loss: 2.4382 - val_acc: 0.2731
Test loss: 2.4379539993286135
Test accuracy: 0.2729
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2462 - acc: 0.9232 - val_loss: 0.1391 - val_acc: 0.9575
Epoch 2/20
 - 2s - loss: 0.1027 - acc: 0.9695 - val_loss: 0.0795 - val_acc: 0.9755
Epoch 3/20
 - 3s - loss: 0.0768 - acc: 0.9763 - val_loss: 0.0733 - val_acc: 0.9788
Epoch 4/20
 - 3s - loss: 0.0619 - acc: 0.9820 - val_loss: 0.0752 - val_acc: 0.9788
Epoch 5/20
 - 3s - loss: 0.0509 - acc: 0.9846 - val_loss: 0.0972 - val_acc: 0.9748
Epoch 6/20
 - 3s - loss: 0.0438 - acc: 0.9871 - val_loss: 0.0739 - val_acc: 0.9817
Epoch 7/20
 - 3s - loss: 0.0388 - acc: 0.9883 - val_loss: 0.0832 - val_acc: 0.9814
Epoch 8/20
 - 2s - loss: 0.0356 - acc: 0.9899 - val_loss: 0.0806 - val_acc: 0.9833
Epoch 9/20
 - 3s - loss: 0.0325 - acc: 0.9909 - val_loss: 0.0885 - val_acc: 0.9826
Epoch 10/20
 - 3s - loss: 0.0300 - acc: 0.9913 - val_loss: 0.0859 - val_acc: 0.9826
Epoch 11/20
 - 3s - loss: 0.0284 - acc: 0.9919 - val_loss: 0.0992 - val_acc: 0.9810
Epoch 12/20
 - 3s - loss: 0.0257 - acc: 0.9928 - val_loss: 0.0959 - val_acc: 0.9829
Epoch 13/20
 - 3s - loss: 0.0230 - acc: 0.9937 - val_loss: 0.1001 - val_acc: 0.9825
Epoch 14/20
 - 3s - loss: 0.0230 - acc: 0.9935 - val_loss: 0.0975 - val_acc: 0.9827
Epoch 15/20
 - 3s - loss: 0.0221 - acc: 0.9941 - val_loss: 0.1121 - val_acc: 0.9821
Epoch 16/20
 - 3s - loss: 0.0208 - acc: 0.9944 - val_loss: 0.1186 - val_acc: 0.9805
Epoch 17/20
 - 3s - loss: 0.0201 - acc: 0.9948 - val_loss: 0.1276 - val_acc: 0.9800
Epoch 18/20
 - 3s - loss: 0.0191 - acc: 0.9951 - val_loss: 0.1070 - val_acc: 0.9850
Epoch 19/20
 - 2s - loss: 0.0188 - acc: 0.9952 - val_loss: 0.1206 - val_acc: 0.9826
Epoch 20/20
 - 3s - loss: 0.0190 - acc: 0.9952 - val_loss: 0.1231 - val_acc: 0.9826
Test loss: 0.12309695973984783
Test accuracy: 0.9826
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9348 - acc: 0.6985 - val_loss: 0.8097 - val_acc: 0.7464
Epoch 2/20
 - 5s - loss: 0.4287 - acc: 0.8629 - val_loss: 0.3502 - val_acc: 0.8803
Epoch 3/20
 - 5s - loss: 0.3222 - acc: 0.8991 - val_loss: 0.2230 - val_acc: 0.9280
Epoch 4/20
 - 5s - loss: 0.2719 - acc: 0.9161 - val_loss: 0.1456 - val_acc: 0.9557
Epoch 5/20
 - 5s - loss: 0.2350 - acc: 0.9269 - val_loss: 0.1632 - val_acc: 0.9484
Epoch 6/20
 - 5s - loss: 0.2208 - acc: 0.9315 - val_loss: 0.1815 - val_acc: 0.9445
Epoch 7/20
 - 5s - loss: 0.2005 - acc: 0.9384 - val_loss: 0.1340 - val_acc: 0.9562
Epoch 8/20
 - 5s - loss: 0.1927 - acc: 0.9414 - val_loss: 0.1182 - val_acc: 0.9645
Epoch 9/20
 - 5s - loss: 0.1815 - acc: 0.9451 - val_loss: 0.1128 - val_acc: 0.9657
Epoch 10/20
 - 5s - loss: 0.1783 - acc: 0.9455 - val_loss: 0.1359 - val_acc: 0.9591
Epoch 11/20
 - 5s - loss: 0.1686 - acc: 0.9485 - val_loss: 0.1428 - val_acc: 0.9565
Epoch 12/20
 - 5s - loss: 0.1729 - acc: 0.9495 - val_loss: 0.1194 - val_acc: 0.9636
Epoch 13/20
 - 5s - loss: 0.1690 - acc: 0.9506 - val_loss: 0.2017 - val_acc: 0.9445
Epoch 14/20
 - 5s - loss: 0.1683 - acc: 0.9510 - val_loss: 0.0951 - val_acc: 0.9712
Epoch 15/20
 - 5s - loss: 0.1606 - acc: 0.9531 - val_loss: 0.0996 - val_acc: 0.9707
Epoch 16/20
 - 4s - loss: 0.1652 - acc: 0.9528 - val_loss: 0.1402 - val_acc: 0.9613
Epoch 17/20
 - 5s - loss: 0.1637 - acc: 0.9539 - val_loss: 0.0963 - val_acc: 0.9705
Epoch 18/20
 - 5s - loss: 0.1685 - acc: 0.9538 - val_loss: 0.1419 - val_acc: 0.9573
Epoch 19/20
 - 5s - loss: 0.1624 - acc: 0.9536 - val_loss: 0.0931 - val_acc: 0.9739
Epoch 20/20
 - 5s - loss: 0.1607 - acc: 0.9545 - val_loss: 0.1274 - val_acc: 0.9647
Test loss: 0.12768082250205917
Test accuracy: 0.9644
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.3324 - acc: 0.8987 - val_loss: 0.2315 - val_acc: 0.9263
Epoch 2/20
 - 1s - loss: 0.1330 - acc: 0.9586 - val_loss: 0.1330 - val_acc: 0.9596
Epoch 3/20
 - 1s - loss: 0.0887 - acc: 0.9733 - val_loss: 0.1285 - val_acc: 0.9632
Epoch 4/20
 - 1s - loss: 0.0659 - acc: 0.9789 - val_loss: 0.0873 - val_acc: 0.9742
Epoch 5/20
 - 1s - loss: 0.0507 - acc: 0.9842 - val_loss: 0.1124 - val_acc: 0.9684
Epoch 6/20
 - 1s - loss: 0.0432 - acc: 0.9861 - val_loss: 0.1029 - val_acc: 0.9731
Epoch 7/20
 - 1s - loss: 0.0340 - acc: 0.9894 - val_loss: 0.0969 - val_acc: 0.9775
Epoch 8/20
 - 1s - loss: 0.0284 - acc: 0.9905 - val_loss: 0.1123 - val_acc: 0.9754
Epoch 9/20
 - 1s - loss: 0.0277 - acc: 0.9913 - val_loss: 0.1143 - val_acc: 0.9752
Epoch 10/20
 - 1s - loss: 0.0246 - acc: 0.9921 - val_loss: 0.1120 - val_acc: 0.9768
Epoch 11/20
 - 1s - loss: 0.0228 - acc: 0.9926 - val_loss: 0.1086 - val_acc: 0.9776
Epoch 12/20
 - 1s - loss: 0.0192 - acc: 0.9937 - val_loss: 0.1208 - val_acc: 0.9771
Epoch 13/20
 - 1s - loss: 0.0186 - acc: 0.9939 - val_loss: 0.1265 - val_acc: 0.9775
Epoch 14/20
 - 1s - loss: 0.0180 - acc: 0.9945 - val_loss: 0.1143 - val_acc: 0.9773
Epoch 15/20
 - 1s - loss: 0.0148 - acc: 0.9955 - val_loss: 0.1326 - val_acc: 0.9771
Epoch 16/20
 - 1s - loss: 0.0127 - acc: 0.9959 - val_loss: 0.1267 - val_acc: 0.9777
Epoch 17/20
 - 1s - loss: 0.0138 - acc: 0.9955 - val_loss: 0.1288 - val_acc: 0.9768
Epoch 18/20
 - 1s - loss: 0.0128 - acc: 0.9966 - val_loss: 0.1374 - val_acc: 0.9766
Epoch 19/20
 - 1s - loss: 0.0137 - acc: 0.9959 - val_loss: 0.1440 - val_acc: 0.9766
Epoch 20/20
 - 1s - loss: 0.0135 - acc: 0.9963 - val_loss: 0.1573 - val_acc: 0.9770
Test loss: 0.15730522744949904
Test accuracy: 0.977
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2496 - acc: 0.5997 - val_loss: 0.5144 - val_acc: 0.8355
Epoch 2/20
 - 2s - loss: 0.6197 - acc: 0.8014 - val_loss: 0.5160 - val_acc: 0.8276
Epoch 3/20
 - 2s - loss: 0.4729 - acc: 0.8506 - val_loss: 0.2896 - val_acc: 0.9099
Epoch 4/20
 - 2s - loss: 0.3888 - acc: 0.8779 - val_loss: 0.2700 - val_acc: 0.9153
Epoch 5/20
 - 2s - loss: 0.3344 - acc: 0.8957 - val_loss: 0.3654 - val_acc: 0.8836
Epoch 6/20
 - 2s - loss: 0.2971 - acc: 0.9077 - val_loss: 0.2738 - val_acc: 0.9119
Epoch 7/20
 - 2s - loss: 0.2720 - acc: 0.9141 - val_loss: 0.1721 - val_acc: 0.9463
Epoch 8/20
 - 2s - loss: 0.2467 - acc: 0.9239 - val_loss: 0.2969 - val_acc: 0.9102
Epoch 9/20
 - 2s - loss: 0.2346 - acc: 0.9267 - val_loss: 0.2242 - val_acc: 0.9282
Epoch 10/20
 - 2s - loss: 0.2143 - acc: 0.9332 - val_loss: 0.3467 - val_acc: 0.8898
Epoch 11/20
 - 2s - loss: 0.2001 - acc: 0.9382 - val_loss: 0.6321 - val_acc: 0.8230
Epoch 12/20
 - 2s - loss: 0.1988 - acc: 0.9396 - val_loss: 0.1654 - val_acc: 0.9477
Epoch 13/20
 - 2s - loss: 0.1857 - acc: 0.9423 - val_loss: 0.2326 - val_acc: 0.9239
Epoch 14/20
 - 2s - loss: 0.1832 - acc: 0.9441 - val_loss: 0.1602 - val_acc: 0.9548
Epoch 15/20
 - 2s - loss: 0.1781 - acc: 0.9464 - val_loss: 0.1923 - val_acc: 0.9401
Epoch 16/20
 - 3s - loss: 0.1678 - acc: 0.9482 - val_loss: 0.1993 - val_acc: 0.9445
Epoch 17/20
 - 2s - loss: 0.1676 - acc: 0.9483 - val_loss: 0.1743 - val_acc: 0.9427
Epoch 18/20
 - 2s - loss: 0.1613 - acc: 0.9508 - val_loss: 0.1492 - val_acc: 0.9548
Epoch 19/20
 - 2s - loss: 0.1614 - acc: 0.9512 - val_loss: 0.1296 - val_acc: 0.9606
Epoch 20/20
 - 2s - loss: 0.1516 - acc: 0.9535 - val_loss: 0.1894 - val_acc: 0.9392
Test loss: 0.189440809587948
Test accuracy: 0.9394
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4606 - acc: 0.8556 - val_loss: 0.2515 - val_acc: 0.9195
Epoch 2/20
 - 1s - loss: 0.1852 - acc: 0.9449 - val_loss: 0.1604 - val_acc: 0.9517
Epoch 3/20
 - 1s - loss: 0.1201 - acc: 0.9613 - val_loss: 0.1795 - val_acc: 0.9445
Epoch 4/20
 - 1s - loss: 0.0821 - acc: 0.9731 - val_loss: 0.1473 - val_acc: 0.9570
Epoch 5/20
 - 1s - loss: 0.0686 - acc: 0.9777 - val_loss: 0.1113 - val_acc: 0.9687
Epoch 6/20
 - 1s - loss: 0.0485 - acc: 0.9840 - val_loss: 0.1448 - val_acc: 0.9613
Epoch 7/20
 - 1s - loss: 0.0406 - acc: 0.9861 - val_loss: 0.1525 - val_acc: 0.9645
Epoch 8/20
 - 1s - loss: 0.0276 - acc: 0.9911 - val_loss: 0.1668 - val_acc: 0.9634
Epoch 9/20
 - 1s - loss: 0.0277 - acc: 0.9909 - val_loss: 0.1517 - val_acc: 0.9648
Epoch 10/20
 - 1s - loss: 0.0222 - acc: 0.9921 - val_loss: 0.1436 - val_acc: 0.9696
Epoch 11/20
 - 1s - loss: 0.0189 - acc: 0.9940 - val_loss: 0.1520 - val_acc: 0.9664
Epoch 12/20
 - 1s - loss: 0.0177 - acc: 0.9943 - val_loss: 0.1596 - val_acc: 0.9693
Epoch 13/20
 - 1s - loss: 0.0163 - acc: 0.9948 - val_loss: 0.1480 - val_acc: 0.9697
Epoch 14/20
 - 1s - loss: 0.0111 - acc: 0.9959 - val_loss: 0.1762 - val_acc: 0.9691
Epoch 15/20
 - 1s - loss: 0.0123 - acc: 0.9962 - val_loss: 0.1715 - val_acc: 0.9691
Epoch 16/20
 - 1s - loss: 0.0122 - acc: 0.9957 - val_loss: 0.1693 - val_acc: 0.9709
Epoch 17/20
 - 1s - loss: 0.0102 - acc: 0.9960 - val_loss: 0.1852 - val_acc: 0.9700
Epoch 18/20
 - 1s - loss: 0.0097 - acc: 0.9969 - val_loss: 0.2063 - val_acc: 0.9670
Epoch 19/20
 - 1s - loss: 0.0100 - acc: 0.9965 - val_loss: 0.1926 - val_acc: 0.9714
Epoch 20/20
 - 1s - loss: 0.0097 - acc: 0.9965 - val_loss: 0.1692 - val_acc: 0.9735
Test loss: 0.1692491950280933
Test accuracy: 0.9735
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6610 - acc: 0.4779 - val_loss: 1.7114 - val_acc: 0.3973
Epoch 2/20
 - 1s - loss: 0.8524 - acc: 0.7207 - val_loss: 0.7060 - val_acc: 0.7534
Epoch 3/20
 - 1s - loss: 0.6618 - acc: 0.7854 - val_loss: 0.5303 - val_acc: 0.8217
Epoch 4/20
 - 1s - loss: 0.5541 - acc: 0.8238 - val_loss: 0.5861 - val_acc: 0.8156
Epoch 5/20
 - 1s - loss: 0.4794 - acc: 0.8477 - val_loss: 0.6451 - val_acc: 0.7876
Epoch 6/20
 - 1s - loss: 0.4310 - acc: 0.8636 - val_loss: 0.5091 - val_acc: 0.8286
Epoch 7/20
 - 1s - loss: 0.3811 - acc: 0.8785 - val_loss: 0.3831 - val_acc: 0.8783
Epoch 8/20
 - 1s - loss: 0.3375 - acc: 0.8949 - val_loss: 0.5389 - val_acc: 0.8221
Epoch 9/20
 - 1s - loss: 0.3174 - acc: 0.8967 - val_loss: 0.7501 - val_acc: 0.7575
Epoch 10/20
 - 1s - loss: 0.2892 - acc: 0.9067 - val_loss: 0.2524 - val_acc: 0.9202
Epoch 11/20
 - 1s - loss: 0.2793 - acc: 0.9109 - val_loss: 0.2579 - val_acc: 0.9143
Epoch 12/20
 - 1s - loss: 0.2656 - acc: 0.9177 - val_loss: 0.3889 - val_acc: 0.8712
Epoch 13/20
 - 1s - loss: 0.2488 - acc: 0.9223 - val_loss: 0.2628 - val_acc: 0.9220
Epoch 14/20
 - 1s - loss: 0.2436 - acc: 0.9233 - val_loss: 0.2204 - val_acc: 0.9336
Epoch 15/20
 - 1s - loss: 0.2261 - acc: 0.9288 - val_loss: 0.3074 - val_acc: 0.9036
Epoch 16/20
 - 1s - loss: 0.2256 - acc: 0.9293 - val_loss: 0.1771 - val_acc: 0.9455
Epoch 17/20
 - 1s - loss: 0.2073 - acc: 0.9351 - val_loss: 0.1650 - val_acc: 0.9502
Epoch 18/20
 - 1s - loss: 0.2093 - acc: 0.9349 - val_loss: 0.2921 - val_acc: 0.9055
Epoch 19/20
 - 1s - loss: 0.1883 - acc: 0.9417 - val_loss: 0.3845 - val_acc: 0.8791
Epoch 20/20
 - 1s - loss: 0.1863 - acc: 0.9418 - val_loss: 0.1985 - val_acc: 0.9412
Test loss: 0.1979730359067209
Test accuracy: 0.9419
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6002 - acc: 0.8092 - val_loss: 0.3710 - val_acc: 0.8839
Epoch 2/20
 - 0s - loss: 0.2442 - acc: 0.9261 - val_loss: 0.3093 - val_acc: 0.9071
Epoch 3/20
 - 0s - loss: 0.1669 - acc: 0.9489 - val_loss: 0.2378 - val_acc: 0.9266
Epoch 4/20
 - 0s - loss: 0.1150 - acc: 0.9645 - val_loss: 0.3187 - val_acc: 0.8994
Epoch 5/20
 - 0s - loss: 0.0891 - acc: 0.9705 - val_loss: 0.1627 - val_acc: 0.9504
Epoch 6/20
 - 0s - loss: 0.0622 - acc: 0.9776 - val_loss: 0.1942 - val_acc: 0.9472
Epoch 7/20
 - 0s - loss: 0.0432 - acc: 0.9867 - val_loss: 0.2116 - val_acc: 0.9445
Epoch 8/20
 - 0s - loss: 0.0414 - acc: 0.9875 - val_loss: 0.1755 - val_acc: 0.9543
Epoch 9/20
 - 0s - loss: 0.0257 - acc: 0.9919 - val_loss: 0.2148 - val_acc: 0.9474
Epoch 10/20
 - 0s - loss: 0.0256 - acc: 0.9916 - val_loss: 0.2153 - val_acc: 0.9493
Epoch 11/20
 - 0s - loss: 0.0206 - acc: 0.9937 - val_loss: 0.2269 - val_acc: 0.9506
Epoch 12/20
 - 0s - loss: 0.0169 - acc: 0.9943 - val_loss: 0.2098 - val_acc: 0.9551
Epoch 13/20
 - 0s - loss: 0.0132 - acc: 0.9953 - val_loss: 0.2500 - val_acc: 0.9500
Epoch 14/20
 - 0s - loss: 0.0102 - acc: 0.9965 - val_loss: 0.2388 - val_acc: 0.9547
Epoch 15/20
 - 0s - loss: 0.0104 - acc: 0.9968 - val_loss: 0.2597 - val_acc: 0.9517
Epoch 16/20
 - 0s - loss: 0.0073 - acc: 0.9972 - val_loss: 0.2518 - val_acc: 0.9543
Epoch 17/20
 - 0s - loss: 0.0085 - acc: 0.9965 - val_loss: 0.2600 - val_acc: 0.9555
Epoch 18/20
 - 0s - loss: 0.0090 - acc: 0.9972 - val_loss: 0.2811 - val_acc: 0.9500
Epoch 19/20
 - 0s - loss: 0.0056 - acc: 0.9983 - val_loss: 0.2560 - val_acc: 0.9565
Epoch 20/20
 - 0s - loss: 0.0107 - acc: 0.9964 - val_loss: 0.2508 - val_acc: 0.9582
Test loss: 0.25080296038805255
Test accuracy: 0.9582
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0850 - acc: 0.3652 - val_loss: 1.1198 - val_acc: 0.6268
Epoch 2/20
 - 1s - loss: 1.1118 - acc: 0.6349 - val_loss: 1.0186 - val_acc: 0.6155
Epoch 3/20
 - 1s - loss: 0.8717 - acc: 0.7145 - val_loss: 0.7470 - val_acc: 0.7354
Epoch 4/20
 - 1s - loss: 0.7480 - acc: 0.7607 - val_loss: 0.7968 - val_acc: 0.7356
Epoch 5/20
 - 1s - loss: 0.6462 - acc: 0.7877 - val_loss: 0.8640 - val_acc: 0.7313
Epoch 6/20
 - 1s - loss: 0.5886 - acc: 0.8084 - val_loss: 0.4999 - val_acc: 0.8346
Epoch 7/20
 - 1s - loss: 0.5373 - acc: 0.8285 - val_loss: 0.5926 - val_acc: 0.8070
Epoch 8/20
 - 1s - loss: 0.4962 - acc: 0.8408 - val_loss: 0.3178 - val_acc: 0.9034
Epoch 9/20
 - 1s - loss: 0.4642 - acc: 0.8475 - val_loss: 0.4570 - val_acc: 0.8565
Epoch 10/20
 - 1s - loss: 0.4173 - acc: 0.8672 - val_loss: 0.3784 - val_acc: 0.8729
Epoch 11/20
 - 1s - loss: 0.4221 - acc: 0.8647 - val_loss: 0.2849 - val_acc: 0.9122
Epoch 12/20
 - 1s - loss: 0.3751 - acc: 0.8776 - val_loss: 0.6189 - val_acc: 0.8023
Epoch 13/20
 - 1s - loss: 0.3403 - acc: 0.8920 - val_loss: 0.3852 - val_acc: 0.8723
Epoch 14/20
 - 1s - loss: 0.3480 - acc: 0.8876 - val_loss: 0.3958 - val_acc: 0.8742
Epoch 15/20
 - 1s - loss: 0.3244 - acc: 0.8969 - val_loss: 0.3387 - val_acc: 0.8937
Epoch 16/20
 - 1s - loss: 0.2986 - acc: 0.9035 - val_loss: 0.4469 - val_acc: 0.8540
Epoch 17/20
 - 1s - loss: 0.3072 - acc: 0.9005 - val_loss: 0.2510 - val_acc: 0.9211
Epoch 18/20
 - 1s - loss: 0.2783 - acc: 0.9100 - val_loss: 0.6689 - val_acc: 0.8028
Epoch 19/20
 - 1s - loss: 0.2788 - acc: 0.9144 - val_loss: 0.2854 - val_acc: 0.9061
Epoch 20/20
 - 1s - loss: 0.2628 - acc: 0.9184 - val_loss: 0.3434 - val_acc: 0.8992
Test loss: 0.3436667451247573
Test accuracy: 0.8997
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.7893 - acc: 0.7520 - val_loss: 0.4263 - val_acc: 0.8668
Epoch 2/20
 - 0s - loss: 0.3353 - acc: 0.8973 - val_loss: 0.2940 - val_acc: 0.9149
Epoch 3/20
 - 0s - loss: 0.2256 - acc: 0.9336 - val_loss: 0.4151 - val_acc: 0.8646
Epoch 4/20
 - 0s - loss: 0.1704 - acc: 0.9469 - val_loss: 0.2604 - val_acc: 0.9187
Epoch 5/20
 - 0s - loss: 0.1195 - acc: 0.9640 - val_loss: 0.5317 - val_acc: 0.8416
Epoch 6/20
 - 0s - loss: 0.1007 - acc: 0.9693 - val_loss: 0.2371 - val_acc: 0.9257
Epoch 7/20
 - 0s - loss: 0.0693 - acc: 0.9763 - val_loss: 0.2317 - val_acc: 0.9312
Epoch 8/20
 - 0s - loss: 0.0502 - acc: 0.9864 - val_loss: 0.2195 - val_acc: 0.9392
Epoch 9/20
 - 0s - loss: 0.0414 - acc: 0.9880 - val_loss: 0.3496 - val_acc: 0.9079
Epoch 10/20
 - 0s - loss: 0.0256 - acc: 0.9931 - val_loss: 0.2542 - val_acc: 0.9376
Epoch 11/20
 - 0s - loss: 0.0264 - acc: 0.9920 - val_loss: 0.2410 - val_acc: 0.9390
Epoch 12/20
 - 0s - loss: 0.0163 - acc: 0.9949 - val_loss: 0.3569 - val_acc: 0.9146
Epoch 13/20
 - 0s - loss: 0.0221 - acc: 0.9931 - val_loss: 0.2487 - val_acc: 0.9437
Epoch 14/20
 - 0s - loss: 0.0173 - acc: 0.9941 - val_loss: 0.3463 - val_acc: 0.9253
Epoch 15/20
 - 0s - loss: 0.0134 - acc: 0.9947 - val_loss: 0.2512 - val_acc: 0.9446
Epoch 16/20
 - 0s - loss: 0.0097 - acc: 0.9979 - val_loss: 0.2813 - val_acc: 0.9444
Epoch 17/20
 - 0s - loss: 0.0081 - acc: 0.9973 - val_loss: 0.2624 - val_acc: 0.9455
Epoch 18/20
 - 0s - loss: 0.0057 - acc: 0.9981 - val_loss: 0.3465 - val_acc: 0.9341
Epoch 19/20
 - 0s - loss: 0.0072 - acc: 0.9981 - val_loss: 0.3464 - val_acc: 0.9360
Epoch 20/20
 - 0s - loss: 0.0087 - acc: 0.9968 - val_loss: 0.3339 - val_acc: 0.9344
Test loss: 0.33385302028098085
Test accuracy: 0.9344
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.3593 - acc: 0.2683 - val_loss: 1.9512 - val_acc: 0.3610
Epoch 2/20
 - 1s - loss: 1.5865 - acc: 0.4747 - val_loss: 2.6059 - val_acc: 0.2765
Epoch 3/20
 - 1s - loss: 1.2313 - acc: 0.6128 - val_loss: 1.0238 - val_acc: 0.6446
Epoch 4/20
 - 1s - loss: 1.0174 - acc: 0.6664 - val_loss: 0.9118 - val_acc: 0.6493
Epoch 5/20
 - 1s - loss: 0.9270 - acc: 0.6872 - val_loss: 0.7977 - val_acc: 0.7183
Epoch 6/20
 - 1s - loss: 0.7847 - acc: 0.7357 - val_loss: 0.9035 - val_acc: 0.6741
Epoch 7/20
 - 1s - loss: 0.7488 - acc: 0.7611 - val_loss: 2.7532 - val_acc: 0.3384
Epoch 8/20
 - 1s - loss: 0.7427 - acc: 0.7741 - val_loss: 0.7930 - val_acc: 0.7279
Epoch 9/20
 - 1s - loss: 0.6462 - acc: 0.7853 - val_loss: 1.0108 - val_acc: 0.6990
Epoch 10/20
 - 1s - loss: 0.6384 - acc: 0.7944 - val_loss: 0.9343 - val_acc: 0.7084
Epoch 11/20
 - 1s - loss: 0.6105 - acc: 0.7989 - val_loss: 0.7474 - val_acc: 0.7347
Epoch 12/20
 - 1s - loss: 0.5276 - acc: 0.8269 - val_loss: 0.5637 - val_acc: 0.8084
Epoch 13/20
 - 1s - loss: 0.5316 - acc: 0.8224 - val_loss: 1.0656 - val_acc: 0.6475
Epoch 14/20
 - 1s - loss: 0.5247 - acc: 0.8299 - val_loss: 1.1856 - val_acc: 0.6754
Epoch 15/20
 - 1s - loss: 0.4867 - acc: 0.8477 - val_loss: 0.3866 - val_acc: 0.8785
Epoch 16/20
 - 1s - loss: 0.4731 - acc: 0.8488 - val_loss: 1.1090 - val_acc: 0.6899
Epoch 17/20
 - 1s - loss: 0.4444 - acc: 0.8611 - val_loss: 0.4164 - val_acc: 0.8643
Epoch 18/20
 - 1s - loss: 0.3954 - acc: 0.8693 - val_loss: 0.4792 - val_acc: 0.8462
Epoch 19/20
 - 1s - loss: 0.4575 - acc: 0.8547 - val_loss: 0.4412 - val_acc: 0.8578
Epoch 20/20
 - 1s - loss: 0.4107 - acc: 0.8653 - val_loss: 0.4953 - val_acc: 0.8468
Test loss: 0.4946298543810844
Test accuracy: 0.8469
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1293 - acc: 0.6475 - val_loss: 0.6003 - val_acc: 0.7975
Epoch 2/20
 - 0s - loss: 0.4308 - acc: 0.8709 - val_loss: 0.4055 - val_acc: 0.8773
Epoch 3/20
 - 0s - loss: 0.3242 - acc: 0.9061 - val_loss: 0.3570 - val_acc: 0.8894
Epoch 4/20
 - 0s - loss: 0.2637 - acc: 0.9179 - val_loss: 0.3897 - val_acc: 0.8803
Epoch 5/20
 - 0s - loss: 0.1806 - acc: 0.9456 - val_loss: 0.3513 - val_acc: 0.8938
Epoch 6/20
 - 0s - loss: 0.1556 - acc: 0.9552 - val_loss: 0.3194 - val_acc: 0.9037
Epoch 7/20
 - 0s - loss: 0.1257 - acc: 0.9600 - val_loss: 0.4309 - val_acc: 0.8693
Epoch 8/20
 - 0s - loss: 0.0856 - acc: 0.9744 - val_loss: 0.3883 - val_acc: 0.8835
Epoch 9/20
 - 0s - loss: 0.0580 - acc: 0.9856 - val_loss: 0.3309 - val_acc: 0.9091
Epoch 10/20
 - 0s - loss: 0.0611 - acc: 0.9851 - val_loss: 0.2942 - val_acc: 0.9172
Epoch 11/20
 - 0s - loss: 0.0396 - acc: 0.9904 - val_loss: 0.4499 - val_acc: 0.8735
Epoch 12/20
 - 0s - loss: 0.0384 - acc: 0.9877 - val_loss: 0.3941 - val_acc: 0.8999
Epoch 13/20
 - 0s - loss: 0.0158 - acc: 0.9973 - val_loss: 0.4042 - val_acc: 0.9002
Epoch 14/20
 - 0s - loss: 0.0254 - acc: 0.9941 - val_loss: 0.3058 - val_acc: 0.9226
Epoch 15/20
 - 0s - loss: 0.0098 - acc: 0.9979 - val_loss: 0.3396 - val_acc: 0.9184
Epoch 16/20
 - 0s - loss: 0.0100 - acc: 0.9984 - val_loss: 0.3810 - val_acc: 0.9116
Epoch 17/20
 - 0s - loss: 0.0387 - acc: 0.9904 - val_loss: 0.4865 - val_acc: 0.8968
Epoch 18/20
 - 0s - loss: 0.0073 - acc: 0.9995 - val_loss: 0.3146 - val_acc: 0.9245
Epoch 19/20
 - 0s - loss: 0.0023 - acc: 1.0000 - val_loss: 0.3365 - val_acc: 0.9260
Epoch 20/20
 - 0s - loss: 0.0276 - acc: 0.9915 - val_loss: 0.3271 - val_acc: 0.9249
Test loss: 0.3270678310186835
Test accuracy: 0.9249
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.9064 - acc: 0.1707 - val_loss: 2.1715 - val_acc: 0.2209
Epoch 2/20
 - 1s - loss: 1.9643 - acc: 0.3445 - val_loss: 2.2269 - val_acc: 0.3007
Epoch 3/20
 - 1s - loss: 1.7190 - acc: 0.4117 - val_loss: 1.2584 - val_acc: 0.6226
Epoch 4/20
 - 1s - loss: 1.5211 - acc: 0.4827 - val_loss: 1.6137 - val_acc: 0.4692
Epoch 5/20
 - 1s - loss: 1.2754 - acc: 0.5803 - val_loss: 1.0540 - val_acc: 0.6342
Epoch 6/20
 - 1s - loss: 1.1011 - acc: 0.6416 - val_loss: 1.0265 - val_acc: 0.6606
Epoch 7/20
 - 1s - loss: 1.0170 - acc: 0.6480 - val_loss: 0.8817 - val_acc: 0.6842
Epoch 8/20
 - 1s - loss: 1.0584 - acc: 0.6549 - val_loss: 1.0136 - val_acc: 0.6625
Epoch 9/20
 - 1s - loss: 0.9389 - acc: 0.6779 - val_loss: 1.1129 - val_acc: 0.6445
Epoch 10/20
 - 1s - loss: 0.8404 - acc: 0.7184 - val_loss: 0.7093 - val_acc: 0.7726
Epoch 11/20
 - 1s - loss: 0.8378 - acc: 0.7216 - val_loss: 1.1632 - val_acc: 0.5984
Epoch 12/20
 - 1s - loss: 0.7774 - acc: 0.7456 - val_loss: 0.7375 - val_acc: 0.7356
Epoch 13/20
 - 1s - loss: 0.7336 - acc: 0.7637 - val_loss: 0.7036 - val_acc: 0.7689
Epoch 14/20
 - 1s - loss: 0.7259 - acc: 0.7648 - val_loss: 0.6216 - val_acc: 0.7888
Epoch 15/20
 - 1s - loss: 0.7273 - acc: 0.7659 - val_loss: 0.6791 - val_acc: 0.7792
Epoch 16/20
 - 1s - loss: 0.6740 - acc: 0.7840 - val_loss: 0.7744 - val_acc: 0.7437
Epoch 17/20
 - 1s - loss: 0.5799 - acc: 0.8155 - val_loss: 0.8683 - val_acc: 0.7002
Epoch 18/20
 - 1s - loss: 0.6922 - acc: 0.7600 - val_loss: 0.6434 - val_acc: 0.7841
Epoch 19/20
 - 1s - loss: 0.5863 - acc: 0.8155 - val_loss: 0.6826 - val_acc: 0.7802
Epoch 20/20
 - 1s - loss: 0.6112 - acc: 0.7973 - val_loss: 0.4536 - val_acc: 0.8570
Test loss: 0.4526566290855408
Test accuracy: 0.8557
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5689 - acc: 0.4845 - val_loss: 0.8383 - val_acc: 0.7560
Epoch 2/20
 - 0s - loss: 0.6099 - acc: 0.8207 - val_loss: 0.7520 - val_acc: 0.7581
Epoch 3/20
 - 0s - loss: 0.4343 - acc: 0.8762 - val_loss: 0.4969 - val_acc: 0.8415
Epoch 4/20
 - 0s - loss: 0.2917 - acc: 0.9178 - val_loss: 0.5038 - val_acc: 0.8459
Epoch 5/20
 - 0s - loss: 0.2631 - acc: 0.9317 - val_loss: 0.4352 - val_acc: 0.8565
Epoch 6/20
 - 0s - loss: 0.1857 - acc: 0.9424 - val_loss: 0.4915 - val_acc: 0.8433
Epoch 7/20
 - 0s - loss: 0.1396 - acc: 0.9605 - val_loss: 0.4371 - val_acc: 0.8615
Epoch 8/20
 - 0s - loss: 0.1326 - acc: 0.9605 - val_loss: 0.9122 - val_acc: 0.7637
Epoch 9/20
 - 0s - loss: 0.1449 - acc: 0.9541 - val_loss: 0.4185 - val_acc: 0.8762
Epoch 10/20
 - 0s - loss: 0.0523 - acc: 0.9915 - val_loss: 0.3830 - val_acc: 0.8870
Epoch 11/20
 - 0s - loss: 0.0408 - acc: 0.9947 - val_loss: 0.4490 - val_acc: 0.8748
Epoch 12/20
 - 0s - loss: 0.0254 - acc: 0.9989 - val_loss: 0.4741 - val_acc: 0.8773
Epoch 13/20
 - 0s - loss: 0.0457 - acc: 0.9893 - val_loss: 0.4440 - val_acc: 0.8847
Epoch 14/20
 - 0s - loss: 0.0182 - acc: 0.9979 - val_loss: 0.4743 - val_acc: 0.8779
Epoch 15/20
 - 0s - loss: 0.0822 - acc: 0.9733 - val_loss: 0.4100 - val_acc: 0.8887
Epoch 16/20
 - 0s - loss: 0.0135 - acc: 0.9989 - val_loss: 0.3809 - val_acc: 0.8995
Epoch 17/20
 - 0s - loss: 0.0077 - acc: 0.9989 - val_loss: 0.5065 - val_acc: 0.8683
Epoch 18/20
 - 0s - loss: 0.0073 - acc: 1.0000 - val_loss: 0.4164 - val_acc: 0.8974
Epoch 19/20
 - 0s - loss: 0.0045 - acc: 1.0000 - val_loss: 0.4525 - val_acc: 0.8903
Epoch 20/20
 - 0s - loss: 0.0317 - acc: 0.9915 - val_loss: 1.0702 - val_acc: 0.7970
Test loss: 1.0701960042655467
Test accuracy: 0.797
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.4182 - acc: 0.1334 - val_loss: 2.1932 - val_acc: 0.1699
Epoch 2/20
 - 0s - loss: 2.1744 - acc: 0.2188 - val_loss: 2.0306 - val_acc: 0.2448
Epoch 3/20
 - 0s - loss: 1.9654 - acc: 0.3116 - val_loss: 2.0275 - val_acc: 0.3120
Epoch 4/20
 - 0s - loss: 1.8091 - acc: 0.4023 - val_loss: 1.7620 - val_acc: 0.4288
Epoch 5/20
 - 0s - loss: 1.7121 - acc: 0.4226 - val_loss: 1.8559 - val_acc: 0.3532
Epoch 6/20
 - 0s - loss: 1.5514 - acc: 0.4557 - val_loss: 1.9187 - val_acc: 0.3821
Epoch 7/20
 - 0s - loss: 1.4294 - acc: 0.5304 - val_loss: 1.5051 - val_acc: 0.4545
Epoch 8/20
 - 0s - loss: 1.4231 - acc: 0.5069 - val_loss: 1.2309 - val_acc: 0.6059
Epoch 9/20
 - 0s - loss: 1.3271 - acc: 0.5496 - val_loss: 1.2045 - val_acc: 0.5808
Epoch 10/20
 - 0s - loss: 1.1048 - acc: 0.6467 - val_loss: 1.0155 - val_acc: 0.6184
Epoch 11/20
 - 0s - loss: 1.1700 - acc: 0.6190 - val_loss: 1.0272 - val_acc: 0.6397
Epoch 12/20
 - 0s - loss: 1.0115 - acc: 0.6628 - val_loss: 1.5413 - val_acc: 0.5080
Epoch 13/20
 - 0s - loss: 1.0023 - acc: 0.6841 - val_loss: 1.1649 - val_acc: 0.6247
Epoch 14/20
 - 0s - loss: 0.8286 - acc: 0.7343 - val_loss: 1.1377 - val_acc: 0.6164
Epoch 15/20
 - 0s - loss: 1.0119 - acc: 0.6499 - val_loss: 0.8927 - val_acc: 0.7188
Epoch 16/20
 - 0s - loss: 0.9025 - acc: 0.7054 - val_loss: 0.8370 - val_acc: 0.7064
Epoch 17/20
 - 0s - loss: 0.8638 - acc: 0.7161 - val_loss: 1.1640 - val_acc: 0.6037
Epoch 18/20
 - 0s - loss: 0.8147 - acc: 0.7407 - val_loss: 1.2441 - val_acc: 0.6202
Epoch 19/20
 - 0s - loss: 1.0158 - acc: 0.6862 - val_loss: 0.8465 - val_acc: 0.6952
Epoch 20/20
 - 0s - loss: 0.7065 - acc: 0.7631 - val_loss: 0.8331 - val_acc: 0.7393
Test loss: 0.8330447965145111
Test accuracy: 0.7388
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8807 - acc: 0.3803 - val_loss: 1.2630 - val_acc: 0.6264
Epoch 2/20
 - 0s - loss: 0.7927 - acc: 0.7927 - val_loss: 0.9674 - val_acc: 0.6874
Epoch 3/20
 - 0s - loss: 0.5178 - acc: 0.8504 - val_loss: 0.8660 - val_acc: 0.7226
Epoch 4/20
 - 0s - loss: 0.3741 - acc: 0.8782 - val_loss: 0.7467 - val_acc: 0.7636
Epoch 5/20
 - 0s - loss: 0.3475 - acc: 0.8910 - val_loss: 0.5561 - val_acc: 0.8197
Epoch 6/20
 - 0s - loss: 0.2044 - acc: 0.9466 - val_loss: 0.5724 - val_acc: 0.8109
Epoch 7/20
 - 0s - loss: 0.1383 - acc: 0.9722 - val_loss: 0.6069 - val_acc: 0.8078
Epoch 8/20
 - 0s - loss: 0.1074 - acc: 0.9701 - val_loss: 0.6734 - val_acc: 0.7960
Epoch 9/20
 - 0s - loss: 0.1144 - acc: 0.9701 - val_loss: 0.5782 - val_acc: 0.8200
Epoch 10/20
 - 0s - loss: 0.0640 - acc: 0.9957 - val_loss: 0.5534 - val_acc: 0.8386
Epoch 11/20
 - 0s - loss: 0.0455 - acc: 0.9957 - val_loss: 0.5345 - val_acc: 0.8444
Epoch 12/20
 - 0s - loss: 0.0306 - acc: 0.9979 - val_loss: 0.5618 - val_acc: 0.8369
Epoch 13/20
 - 0s - loss: 0.0244 - acc: 1.0000 - val_loss: 0.5666 - val_acc: 0.8378
Epoch 14/20
 - 0s - loss: 0.0834 - acc: 0.9829 - val_loss: 1.0123 - val_acc: 0.7494
Epoch 15/20
 - 0s - loss: 0.0480 - acc: 0.9850 - val_loss: 0.5610 - val_acc: 0.8474
Epoch 16/20
 - 0s - loss: 0.0127 - acc: 1.0000 - val_loss: 0.5925 - val_acc: 0.8426
Epoch 17/20
 - 0s - loss: 0.0115 - acc: 1.0000 - val_loss: 0.5755 - val_acc: 0.8464
Epoch 18/20
 - 0s - loss: 0.0076 - acc: 1.0000 - val_loss: 0.5866 - val_acc: 0.8452
Epoch 19/20
 - 0s - loss: 0.0060 - acc: 1.0000 - val_loss: 0.6577 - val_acc: 0.8329
Epoch 20/20
 - 0s - loss: 0.0076 - acc: 1.0000 - val_loss: 0.5945 - val_acc: 0.8512
Test loss: 0.5944521731257438
Test accuracy: 0.8512
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.8171 - acc: 0.0919 - val_loss: 3.8101 - val_acc: 0.1032
Epoch 2/20
 - 0s - loss: 2.8970 - acc: 0.1752 - val_loss: 2.1154 - val_acc: 0.2873
Epoch 3/20
 - 0s - loss: 2.1006 - acc: 0.2650 - val_loss: 2.0932 - val_acc: 0.2818
Epoch 4/20
 - 0s - loss: 1.9477 - acc: 0.3355 - val_loss: 1.8787 - val_acc: 0.3377
Epoch 5/20
 - 0s - loss: 1.9747 - acc: 0.2970 - val_loss: 2.0492 - val_acc: 0.2606
Epoch 6/20
 - 0s - loss: 1.8099 - acc: 0.3889 - val_loss: 1.8960 - val_acc: 0.3449
Epoch 7/20
 - 0s - loss: 1.6136 - acc: 0.4850 - val_loss: 1.9833 - val_acc: 0.2561
Epoch 8/20
 - 0s - loss: 1.7918 - acc: 0.3953 - val_loss: 1.4695 - val_acc: 0.5952
Epoch 9/20
 - 0s - loss: 1.5866 - acc: 0.4957 - val_loss: 1.5668 - val_acc: 0.4977
Epoch 10/20
 - 0s - loss: 1.5064 - acc: 0.4979 - val_loss: 1.7816 - val_acc: 0.4526
Epoch 11/20
 - 0s - loss: 1.3534 - acc: 0.5791 - val_loss: 1.2467 - val_acc: 0.5760
Epoch 12/20
 - 0s - loss: 1.4814 - acc: 0.5064 - val_loss: 1.5533 - val_acc: 0.4775
Epoch 13/20
 - 0s - loss: 1.1418 - acc: 0.6325 - val_loss: 1.0712 - val_acc: 0.6751
Epoch 14/20
 - 0s - loss: 0.9706 - acc: 0.7030 - val_loss: 1.7570 - val_acc: 0.5384
Epoch 15/20
 - 0s - loss: 1.1665 - acc: 0.6560 - val_loss: 1.4426 - val_acc: 0.4838
Epoch 16/20
 - 0s - loss: 1.3064 - acc: 0.5513 - val_loss: 1.3913 - val_acc: 0.5262
Epoch 17/20
 - 0s - loss: 1.2982 - acc: 0.5705 - val_loss: 1.3608 - val_acc: 0.6088
Epoch 18/20
 - 0s - loss: 0.9807 - acc: 0.7009 - val_loss: 1.2152 - val_acc: 0.5778
Epoch 19/20
 - 0s - loss: 1.0516 - acc: 0.6538 - val_loss: 1.0363 - val_acc: 0.6544
Epoch 20/20
 - 0s - loss: 0.8928 - acc: 0.7244 - val_loss: 1.0718 - val_acc: 0.6720
Test loss: 1.070753112220764
Test accuracy: 0.6724
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0764 - acc: 0.2436 - val_loss: 1.7861 - val_acc: 0.4380
Epoch 2/20
 - 0s - loss: 1.3731 - acc: 0.5684 - val_loss: 1.2897 - val_acc: 0.5632
Epoch 3/20
 - 0s - loss: 0.8392 - acc: 0.7479 - val_loss: 0.9928 - val_acc: 0.7082
Epoch 4/20
 - 0s - loss: 0.5014 - acc: 0.8846 - val_loss: 0.9743 - val_acc: 0.6888
Epoch 5/20
 - 0s - loss: 0.4357 - acc: 0.8718 - val_loss: 0.8680 - val_acc: 0.7116
Epoch 6/20
 - 0s - loss: 0.2890 - acc: 0.9274 - val_loss: 0.8111 - val_acc: 0.7483
Epoch 7/20
 - 0s - loss: 0.2320 - acc: 0.9530 - val_loss: 0.7654 - val_acc: 0.7648
Epoch 8/20
 - 0s - loss: 0.1473 - acc: 0.9915 - val_loss: 0.8065 - val_acc: 0.7415
Epoch 9/20
 - 0s - loss: 0.1260 - acc: 0.9829 - val_loss: 0.8350 - val_acc: 0.7549
Epoch 10/20
 - 0s - loss: 0.1095 - acc: 0.9786 - val_loss: 0.7254 - val_acc: 0.7708
Epoch 11/20
 - 0s - loss: 0.0644 - acc: 0.9957 - val_loss: 0.7825 - val_acc: 0.7709
Epoch 12/20
 - 0s - loss: 0.0576 - acc: 1.0000 - val_loss: 0.7400 - val_acc: 0.7797
Epoch 13/20
 - 0s - loss: 0.0610 - acc: 0.9915 - val_loss: 0.8211 - val_acc: 0.7620
Epoch 14/20
 - 0s - loss: 0.0559 - acc: 0.9957 - val_loss: 0.7873 - val_acc: 0.7731
Epoch 15/20
 - 0s - loss: 0.0300 - acc: 1.0000 - val_loss: 0.7706 - val_acc: 0.7787
Epoch 16/20
 - 0s - loss: 0.0290 - acc: 0.9957 - val_loss: 0.8285 - val_acc: 0.7708
Epoch 17/20
 - 0s - loss: 0.0249 - acc: 1.0000 - val_loss: 0.8133 - val_acc: 0.7738
Epoch 18/20
 - 0s - loss: 0.0152 - acc: 1.0000 - val_loss: 0.8263 - val_acc: 0.7751
Epoch 19/20
 - 0s - loss: 0.0144 - acc: 1.0000 - val_loss: 0.8007 - val_acc: 0.7860
Epoch 20/20
 - 0s - loss: 0.0101 - acc: 1.0000 - val_loss: 0.8317 - val_acc: 0.7804
Test loss: 0.8316583556622267
Test accuracy: 0.7804
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.0798 - acc: 0.1068 - val_loss: 5.8280 - val_acc: 0.1028
Epoch 2/20
 - 0s - loss: 6.0388 - acc: 0.1325 - val_loss: 4.0572 - val_acc: 0.1486
Epoch 3/20
 - 0s - loss: 3.5204 - acc: 0.1068 - val_loss: 2.2476 - val_acc: 0.2676
Epoch 4/20
 - 0s - loss: 2.2201 - acc: 0.2179 - val_loss: 2.1313 - val_acc: 0.2356
Epoch 5/20
 - 0s - loss: 2.1055 - acc: 0.2564 - val_loss: 2.2726 - val_acc: 0.2369
Epoch 6/20
 - 0s - loss: 2.0833 - acc: 0.3162 - val_loss: 2.0106 - val_acc: 0.2761
Epoch 7/20
 - 0s - loss: 2.1568 - acc: 0.2436 - val_loss: 2.1938 - val_acc: 0.2510
Epoch 8/20
 - 0s - loss: 1.9580 - acc: 0.3291 - val_loss: 1.8408 - val_acc: 0.4164
Epoch 9/20
 - 0s - loss: 1.8192 - acc: 0.4188 - val_loss: 2.0827 - val_acc: 0.2801
Epoch 10/20
 - 0s - loss: 1.9052 - acc: 0.3675 - val_loss: 1.8659 - val_acc: 0.4054
Epoch 11/20
 - 0s - loss: 1.8164 - acc: 0.3889 - val_loss: 2.0210 - val_acc: 0.3250
Epoch 12/20
 - 0s - loss: 1.7889 - acc: 0.3846 - val_loss: 2.0160 - val_acc: 0.3471
Epoch 13/20
 - 0s - loss: 1.7814 - acc: 0.3846 - val_loss: 1.9274 - val_acc: 0.4001
Epoch 14/20
 - 0s - loss: 1.7126 - acc: 0.4060 - val_loss: 1.7992 - val_acc: 0.3987
Epoch 15/20
 - 0s - loss: 1.8521 - acc: 0.4017 - val_loss: 2.0924 - val_acc: 0.2384
Epoch 16/20
 - 0s - loss: 1.8088 - acc: 0.3632 - val_loss: 1.6291 - val_acc: 0.5325
Epoch 17/20
 - 0s - loss: 1.4474 - acc: 0.5641 - val_loss: 1.6149 - val_acc: 0.5276
Epoch 18/20
 - 0s - loss: 1.5127 - acc: 0.5171 - val_loss: 1.9980 - val_acc: 0.3037
Epoch 19/20
 - 0s - loss: 1.5458 - acc: 0.5000 - val_loss: 1.5764 - val_acc: 0.4872
Epoch 20/20
 - 0s - loss: 1.4487 - acc: 0.5427 - val_loss: 1.8680 - val_acc: 0.4669
Test loss: 1.8682137664794922
Test accuracy: 0.4656
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3574 - acc: 0.1453 - val_loss: 2.1268 - val_acc: 0.2999
Epoch 2/20
 - 0s - loss: 1.6010 - acc: 0.4957 - val_loss: 1.7424 - val_acc: 0.4560
Epoch 3/20
 - 0s - loss: 1.2798 - acc: 0.7521 - val_loss: 1.5018 - val_acc: 0.4861
Epoch 4/20
 - 0s - loss: 0.7881 - acc: 0.8120 - val_loss: 1.2638 - val_acc: 0.5681
Epoch 5/20
 - 0s - loss: 0.5338 - acc: 0.9402 - val_loss: 1.3005 - val_acc: 0.5833
Epoch 6/20
 - 0s - loss: 0.4349 - acc: 0.8803 - val_loss: 1.2866 - val_acc: 0.5483
Epoch 7/20
 - 0s - loss: 0.3865 - acc: 0.8803 - val_loss: 1.1829 - val_acc: 0.6415
Epoch 8/20
 - 0s - loss: 0.2881 - acc: 0.9145 - val_loss: 1.0384 - val_acc: 0.6589
Epoch 9/20
 - 0s - loss: 0.1583 - acc: 0.9915 - val_loss: 0.9783 - val_acc: 0.7048
Epoch 10/20
 - 0s - loss: 0.0980 - acc: 0.9915 - val_loss: 0.9932 - val_acc: 0.6983
Epoch 11/20
 - 0s - loss: 0.0734 - acc: 1.0000 - val_loss: 0.9796 - val_acc: 0.7083
Epoch 12/20
 - 0s - loss: 0.0642 - acc: 1.0000 - val_loss: 1.0061 - val_acc: 0.7034
Epoch 13/20
 - 0s - loss: 0.0560 - acc: 1.0000 - val_loss: 0.9969 - val_acc: 0.7072
Epoch 14/20
 - 0s - loss: 0.0462 - acc: 1.0000 - val_loss: 0.9885 - val_acc: 0.7107
Epoch 15/20
 - 0s - loss: 0.0336 - acc: 1.0000 - val_loss: 0.9755 - val_acc: 0.7170
Epoch 16/20
 - 0s - loss: 0.0312 - acc: 1.0000 - val_loss: 0.9948 - val_acc: 0.7212
Epoch 17/20
 - 0s - loss: 0.0250 - acc: 1.0000 - val_loss: 1.0154 - val_acc: 0.7160
Epoch 18/20
 - 0s - loss: 0.0225 - acc: 1.0000 - val_loss: 0.9980 - val_acc: 0.7221
Epoch 19/20
 - 0s - loss: 0.0171 - acc: 1.0000 - val_loss: 1.0083 - val_acc: 0.7186
Epoch 20/20
 - 0s - loss: 0.0172 - acc: 1.0000 - val_loss: 1.0341 - val_acc: 0.7176
Test loss: 1.0341202619552612
Test accuracy: 0.7176
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7290 - acc: 0.0684 - val_loss: 6.8736 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 6.2459 - acc: 0.1624 - val_loss: 6.3690 - val_acc: 0.1604
Epoch 3/20
 - 0s - loss: 6.3079 - acc: 0.1026 - val_loss: 5.9861 - val_acc: 0.0982
Epoch 4/20
 - 0s - loss: 6.2572 - acc: 0.1111 - val_loss: 3.5224 - val_acc: 0.1010
Epoch 5/20
 - 0s - loss: 3.4929 - acc: 0.1538 - val_loss: 2.5578 - val_acc: 0.1192
Epoch 6/20
 - 0s - loss: 2.5079 - acc: 0.1538 - val_loss: 2.1940 - val_acc: 0.1796
Epoch 7/20
 - 0s - loss: 2.1948 - acc: 0.2051 - val_loss: 2.2423 - val_acc: 0.1287
Epoch 8/20
 - 0s - loss: 2.0502 - acc: 0.2564 - val_loss: 2.1628 - val_acc: 0.1562
Epoch 9/20
 - 0s - loss: 2.0691 - acc: 0.2735 - val_loss: 2.2224 - val_acc: 0.1175
Epoch 10/20
 - 0s - loss: 2.0327 - acc: 0.2393 - val_loss: 2.1070 - val_acc: 0.1861
Epoch 11/20
 - 0s - loss: 1.9942 - acc: 0.2821 - val_loss: 2.2113 - val_acc: 0.1667
Epoch 12/20
 - 0s - loss: 1.9858 - acc: 0.2821 - val_loss: 2.0496 - val_acc: 0.2935
Epoch 13/20
 - 0s - loss: 1.9025 - acc: 0.3675 - val_loss: 1.9747 - val_acc: 0.2911
Epoch 14/20
 - 0s - loss: 1.7464 - acc: 0.4103 - val_loss: 1.9062 - val_acc: 0.4456
Epoch 15/20
 - 0s - loss: 1.6301 - acc: 0.6068 - val_loss: 1.8659 - val_acc: 0.3500
Epoch 16/20
 - 0s - loss: 1.6337 - acc: 0.4872 - val_loss: 1.9153 - val_acc: 0.3851
Epoch 17/20
 - 0s - loss: 1.5901 - acc: 0.5214 - val_loss: 2.0669 - val_acc: 0.2710
Epoch 18/20
 - 0s - loss: 1.8405 - acc: 0.3590 - val_loss: 2.4604 - val_acc: 0.1952
Epoch 19/20
 - 0s - loss: 2.0749 - acc: 0.2821 - val_loss: 2.3697 - val_acc: 0.2919
Epoch 20/20
 - 0s - loss: 2.2556 - acc: 0.3504 - val_loss: 2.0167 - val_acc: 0.2265
Test loss: 2.01677036113739
Test accuracy: 0.2263
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2448 - acc: 0.9247 - val_loss: 0.1120 - val_acc: 0.9645
Epoch 2/20
 - 2s - loss: 0.1028 - acc: 0.9683 - val_loss: 0.0911 - val_acc: 0.9740
Epoch 3/20
 - 2s - loss: 0.0752 - acc: 0.9775 - val_loss: 0.0715 - val_acc: 0.9788
Epoch 4/20
 - 2s - loss: 0.0596 - acc: 0.9820 - val_loss: 0.0776 - val_acc: 0.9805
Epoch 5/20
 - 2s - loss: 0.0515 - acc: 0.9847 - val_loss: 0.0924 - val_acc: 0.9770
Epoch 6/20
 - 2s - loss: 0.0439 - acc: 0.9866 - val_loss: 0.0745 - val_acc: 0.9811
Epoch 7/20
 - 2s - loss: 0.0400 - acc: 0.9881 - val_loss: 0.0743 - val_acc: 0.9834
Epoch 8/20
 - 2s - loss: 0.0354 - acc: 0.9892 - val_loss: 0.0832 - val_acc: 0.9814
Epoch 9/20
 - 2s - loss: 0.0308 - acc: 0.9910 - val_loss: 0.0835 - val_acc: 0.9827
Epoch 10/20
 - 2s - loss: 0.0317 - acc: 0.9916 - val_loss: 0.0853 - val_acc: 0.9815
Epoch 11/20
 - 2s - loss: 0.0262 - acc: 0.9922 - val_loss: 0.0901 - val_acc: 0.9829
Epoch 12/20
 - 2s - loss: 0.0262 - acc: 0.9929 - val_loss: 0.0777 - val_acc: 0.9838
Epoch 13/20
 - 2s - loss: 0.0239 - acc: 0.9931 - val_loss: 0.0928 - val_acc: 0.9828
Epoch 14/20
 - 2s - loss: 0.0238 - acc: 0.9935 - val_loss: 0.1076 - val_acc: 0.9820
Epoch 15/20
 - 2s - loss: 0.0232 - acc: 0.9940 - val_loss: 0.1125 - val_acc: 0.9813
Epoch 16/20
 - 2s - loss: 0.0218 - acc: 0.9942 - val_loss: 0.0962 - val_acc: 0.9838
Epoch 17/20
 - 2s - loss: 0.0208 - acc: 0.9944 - val_loss: 0.1043 - val_acc: 0.9831
Epoch 18/20
 - 2s - loss: 0.0181 - acc: 0.9952 - val_loss: 0.1133 - val_acc: 0.9810
Epoch 19/20
 - 2s - loss: 0.0190 - acc: 0.9950 - val_loss: 0.1045 - val_acc: 0.9835
Epoch 20/20
 - 2s - loss: 0.0179 - acc: 0.9951 - val_loss: 0.1030 - val_acc: 0.9831
Test loss: 0.10304964034144669
Test accuracy: 0.9831
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9382 - acc: 0.6989 - val_loss: 0.4163 - val_acc: 0.8686
Epoch 2/20
 - 4s - loss: 0.4299 - acc: 0.8638 - val_loss: 0.3489 - val_acc: 0.8823
Epoch 3/20
 - 4s - loss: 0.3149 - acc: 0.9006 - val_loss: 0.2022 - val_acc: 0.9348
Epoch 4/20
 - 4s - loss: 0.2637 - acc: 0.9185 - val_loss: 0.2466 - val_acc: 0.9161
Epoch 5/20
 - 4s - loss: 0.2357 - acc: 0.9269 - val_loss: 0.2333 - val_acc: 0.9221
Epoch 6/20
 - 4s - loss: 0.2166 - acc: 0.9325 - val_loss: 0.3496 - val_acc: 0.8893
Epoch 7/20
 - 4s - loss: 0.2001 - acc: 0.9395 - val_loss: 0.1981 - val_acc: 0.9362
Epoch 8/20
 - 4s - loss: 0.1907 - acc: 0.9416 - val_loss: 0.1467 - val_acc: 0.9549
Epoch 9/20
 - 4s - loss: 0.1827 - acc: 0.9463 - val_loss: 0.1417 - val_acc: 0.9530
Epoch 10/20
 - 4s - loss: 0.1754 - acc: 0.9467 - val_loss: 0.1245 - val_acc: 0.9637
Epoch 11/20
 - 4s - loss: 0.1735 - acc: 0.9478 - val_loss: 0.1080 - val_acc: 0.9666
Epoch 12/20
 - 4s - loss: 0.1710 - acc: 0.9511 - val_loss: 0.0965 - val_acc: 0.9692
Epoch 13/20
 - 4s - loss: 0.1670 - acc: 0.9518 - val_loss: 0.1600 - val_acc: 0.9519
Epoch 14/20
 - 4s - loss: 0.1680 - acc: 0.9518 - val_loss: 0.1875 - val_acc: 0.9485
Epoch 15/20
 - 4s - loss: 0.1625 - acc: 0.9530 - val_loss: 0.1332 - val_acc: 0.9663
Epoch 16/20
 - 4s - loss: 0.1678 - acc: 0.9528 - val_loss: 0.1214 - val_acc: 0.9667
Epoch 17/20
 - 4s - loss: 0.1630 - acc: 0.9529 - val_loss: 0.1274 - val_acc: 0.9628
Epoch 18/20
 - 4s - loss: 0.1624 - acc: 0.9547 - val_loss: 0.1313 - val_acc: 0.9646
Epoch 19/20
 - 4s - loss: 0.1634 - acc: 0.9531 - val_loss: 0.1271 - val_acc: 0.9671
Epoch 20/20
 - 4s - loss: 0.1652 - acc: 0.9545 - val_loss: 0.2281 - val_acc: 0.9367
Test loss: 0.2271260639661923
Test accuracy: 0.9353
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3409 - acc: 0.8944 - val_loss: 0.1468 - val_acc: 0.9538
Epoch 2/20
 - 1s - loss: 0.1329 - acc: 0.9598 - val_loss: 0.1322 - val_acc: 0.9594
Epoch 3/20
 - 1s - loss: 0.0888 - acc: 0.9722 - val_loss: 0.1062 - val_acc: 0.9666
Epoch 4/20
 - 1s - loss: 0.0679 - acc: 0.9778 - val_loss: 0.0975 - val_acc: 0.9726
Epoch 5/20
 - 1s - loss: 0.0519 - acc: 0.9838 - val_loss: 0.0878 - val_acc: 0.9761
Epoch 6/20
 - 1s - loss: 0.0438 - acc: 0.9860 - val_loss: 0.1115 - val_acc: 0.9724
Epoch 7/20
 - 1s - loss: 0.0372 - acc: 0.9886 - val_loss: 0.1040 - val_acc: 0.9750
Epoch 8/20
 - 1s - loss: 0.0318 - acc: 0.9903 - val_loss: 0.1057 - val_acc: 0.9759
Epoch 9/20
 - 1s - loss: 0.0289 - acc: 0.9917 - val_loss: 0.1074 - val_acc: 0.9751
Epoch 10/20
 - 1s - loss: 0.0247 - acc: 0.9920 - val_loss: 0.1324 - val_acc: 0.9710
Epoch 11/20
 - 1s - loss: 0.0204 - acc: 0.9933 - val_loss: 0.1090 - val_acc: 0.9783
Epoch 12/20
 - 1s - loss: 0.0204 - acc: 0.9940 - val_loss: 0.1145 - val_acc: 0.9775
Epoch 13/20
 - 1s - loss: 0.0179 - acc: 0.9939 - val_loss: 0.1393 - val_acc: 0.9747
Epoch 14/20
 - 1s - loss: 0.0153 - acc: 0.9953 - val_loss: 0.1227 - val_acc: 0.9795
Epoch 15/20
 - 1s - loss: 0.0165 - acc: 0.9953 - val_loss: 0.1347 - val_acc: 0.9767
Epoch 16/20
 - 1s - loss: 0.0144 - acc: 0.9954 - val_loss: 0.1373 - val_acc: 0.9787
Epoch 17/20
 - 1s - loss: 0.0145 - acc: 0.9958 - val_loss: 0.1458 - val_acc: 0.9782
Epoch 18/20
 - 1s - loss: 0.0180 - acc: 0.9952 - val_loss: 0.1188 - val_acc: 0.9808
Epoch 19/20
 - 1s - loss: 0.0134 - acc: 0.9962 - val_loss: 0.1285 - val_acc: 0.9797
Epoch 20/20
 - 1s - loss: 0.0119 - acc: 0.9964 - val_loss: 0.1465 - val_acc: 0.9771
Test loss: 0.14649633206886928
Test accuracy: 0.9771
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2355 - acc: 0.5996 - val_loss: 0.6616 - val_acc: 0.7487
Epoch 2/20
 - 2s - loss: 0.6112 - acc: 0.8023 - val_loss: 0.5170 - val_acc: 0.8281
Epoch 3/20
 - 2s - loss: 0.4602 - acc: 0.8555 - val_loss: 0.2753 - val_acc: 0.9100
Epoch 4/20
 - 2s - loss: 0.3741 - acc: 0.8820 - val_loss: 0.3961 - val_acc: 0.8718
Epoch 5/20
 - 2s - loss: 0.3314 - acc: 0.8965 - val_loss: 0.9007 - val_acc: 0.7314
Epoch 6/20
 - 2s - loss: 0.2939 - acc: 0.9071 - val_loss: 0.4945 - val_acc: 0.8407
Epoch 7/20
 - 2s - loss: 0.2610 - acc: 0.9186 - val_loss: 0.2296 - val_acc: 0.9273
Epoch 8/20
 - 2s - loss: 0.2477 - acc: 0.9228 - val_loss: 0.2829 - val_acc: 0.8971
Epoch 9/20
 - 2s - loss: 0.2240 - acc: 0.9296 - val_loss: 0.1807 - val_acc: 0.9422
Epoch 10/20
 - 2s - loss: 0.2142 - acc: 0.9320 - val_loss: 0.1682 - val_acc: 0.9471
Epoch 11/20
 - 2s - loss: 0.2013 - acc: 0.9365 - val_loss: 0.1283 - val_acc: 0.9602
Epoch 12/20
 - 2s - loss: 0.1937 - acc: 0.9415 - val_loss: 0.1691 - val_acc: 0.9475
Epoch 13/20
 - 2s - loss: 0.1889 - acc: 0.9408 - val_loss: 0.3061 - val_acc: 0.8909
Epoch 14/20
 - 2s - loss: 0.1765 - acc: 0.9438 - val_loss: 0.1889 - val_acc: 0.9403
Epoch 15/20
 - 2s - loss: 0.1727 - acc: 0.9461 - val_loss: 0.1664 - val_acc: 0.9495
Epoch 16/20
 - 2s - loss: 0.1664 - acc: 0.9472 - val_loss: 0.1532 - val_acc: 0.9528
Epoch 17/20
 - 2s - loss: 0.1642 - acc: 0.9479 - val_loss: 0.1289 - val_acc: 0.9622
Epoch 18/20
 - 2s - loss: 0.1595 - acc: 0.9504 - val_loss: 0.1433 - val_acc: 0.9564
Epoch 19/20
 - 2s - loss: 0.1615 - acc: 0.9505 - val_loss: 0.1635 - val_acc: 0.9528
Epoch 20/20
 - 2s - loss: 0.1551 - acc: 0.9535 - val_loss: 0.3084 - val_acc: 0.9139
Test loss: 0.3095227759575471
Test accuracy: 0.9111
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4631 - acc: 0.8553 - val_loss: 0.2561 - val_acc: 0.9186
Epoch 2/20
 - 1s - loss: 0.1857 - acc: 0.9432 - val_loss: 0.1962 - val_acc: 0.9385
Epoch 3/20
 - 1s - loss: 0.1239 - acc: 0.9605 - val_loss: 0.1630 - val_acc: 0.9492
Epoch 4/20
 - 1s - loss: 0.0844 - acc: 0.9734 - val_loss: 0.1227 - val_acc: 0.9636
Epoch 5/20
 - 1s - loss: 0.0610 - acc: 0.9799 - val_loss: 0.1329 - val_acc: 0.9619
Epoch 6/20
 - 1s - loss: 0.0490 - acc: 0.9826 - val_loss: 0.1346 - val_acc: 0.9637
Epoch 7/20
 - 1s - loss: 0.0389 - acc: 0.9865 - val_loss: 0.1194 - val_acc: 0.9710
Epoch 8/20
 - 1s - loss: 0.0307 - acc: 0.9895 - val_loss: 0.1591 - val_acc: 0.9608
Epoch 9/20
 - 1s - loss: 0.0246 - acc: 0.9909 - val_loss: 0.1565 - val_acc: 0.9648
Epoch 10/20
 - 1s - loss: 0.0219 - acc: 0.9927 - val_loss: 0.1422 - val_acc: 0.9695
Epoch 11/20
 - 1s - loss: 0.0208 - acc: 0.9932 - val_loss: 0.1480 - val_acc: 0.9709
Epoch 12/20
 - 1s - loss: 0.0183 - acc: 0.9941 - val_loss: 0.1705 - val_acc: 0.9670
Epoch 13/20
 - 1s - loss: 0.0151 - acc: 0.9949 - val_loss: 0.1630 - val_acc: 0.9668
Epoch 14/20
 - 1s - loss: 0.0121 - acc: 0.9958 - val_loss: 0.1675 - val_acc: 0.9679
Epoch 15/20
 - 1s - loss: 0.0137 - acc: 0.9955 - val_loss: 0.1853 - val_acc: 0.9668
Epoch 16/20
 - 1s - loss: 0.0136 - acc: 0.9951 - val_loss: 0.1882 - val_acc: 0.9697
Epoch 17/20
 - 1s - loss: 0.0096 - acc: 0.9969 - val_loss: 0.1702 - val_acc: 0.9725
Epoch 18/20
 - 1s - loss: 0.0138 - acc: 0.9953 - val_loss: 0.1722 - val_acc: 0.9712
Epoch 19/20
 - 1s - loss: 0.0096 - acc: 0.9966 - val_loss: 0.2014 - val_acc: 0.9676
Epoch 20/20
 - 1s - loss: 0.0101 - acc: 0.9972 - val_loss: 0.1754 - val_acc: 0.9717
Test loss: 0.17540135078127847
Test accuracy: 0.9717
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6351 - acc: 0.4770 - val_loss: 1.4088 - val_acc: 0.5582
Epoch 2/20
 - 1s - loss: 0.8437 - acc: 0.7254 - val_loss: 0.7134 - val_acc: 0.7359
Epoch 3/20
 - 1s - loss: 0.6562 - acc: 0.7868 - val_loss: 0.8831 - val_acc: 0.7239
Epoch 4/20
 - 1s - loss: 0.5530 - acc: 0.8208 - val_loss: 0.5696 - val_acc: 0.8137
Epoch 5/20
 - 1s - loss: 0.4787 - acc: 0.8457 - val_loss: 0.6284 - val_acc: 0.7978
Epoch 6/20
 - 1s - loss: 0.4315 - acc: 0.8683 - val_loss: 0.5366 - val_acc: 0.8233
Epoch 7/20
 - 1s - loss: 0.3891 - acc: 0.8752 - val_loss: 0.3637 - val_acc: 0.8863
Epoch 8/20
 - 1s - loss: 0.3612 - acc: 0.8846 - val_loss: 0.7748 - val_acc: 0.7696
Epoch 9/20
 - 1s - loss: 0.3266 - acc: 0.8956 - val_loss: 0.7119 - val_acc: 0.8100
Epoch 10/20
 - 1s - loss: 0.3108 - acc: 0.9013 - val_loss: 0.3877 - val_acc: 0.8783
Epoch 11/20
 - 1s - loss: 0.2895 - acc: 0.9062 - val_loss: 0.2050 - val_acc: 0.9356
Epoch 12/20
 - 1s - loss: 0.2713 - acc: 0.9135 - val_loss: 0.5994 - val_acc: 0.8194
Epoch 13/20
 - 1s - loss: 0.2582 - acc: 0.9183 - val_loss: 0.2230 - val_acc: 0.9287
Epoch 14/20
 - 1s - loss: 0.2333 - acc: 0.9266 - val_loss: 0.3837 - val_acc: 0.8712
Epoch 15/20
 - 1s - loss: 0.2352 - acc: 0.9262 - val_loss: 0.2270 - val_acc: 0.9262
Epoch 16/20
 - 1s - loss: 0.2228 - acc: 0.9273 - val_loss: 0.1833 - val_acc: 0.9441
Epoch 17/20
 - 1s - loss: 0.2135 - acc: 0.9315 - val_loss: 0.3435 - val_acc: 0.9033
Epoch 18/20
 - 1s - loss: 0.2078 - acc: 0.9354 - val_loss: 0.2732 - val_acc: 0.9174
Epoch 19/20
 - 1s - loss: 0.1916 - acc: 0.9377 - val_loss: 0.1882 - val_acc: 0.9411
Epoch 20/20
 - 1s - loss: 0.1918 - acc: 0.9383 - val_loss: 0.1866 - val_acc: 0.9471
Test loss: 0.1876542228359729
Test accuracy: 0.9479
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.5986 - acc: 0.8148 - val_loss: 0.4067 - val_acc: 0.8747
Epoch 2/20
 - 0s - loss: 0.2489 - acc: 0.9235 - val_loss: 0.2742 - val_acc: 0.9107
Epoch 3/20
 - 0s - loss: 0.1644 - acc: 0.9495 - val_loss: 0.2031 - val_acc: 0.9375
Epoch 4/20
 - 0s - loss: 0.1186 - acc: 0.9637 - val_loss: 0.1774 - val_acc: 0.9457
Epoch 5/20
 - 0s - loss: 0.0854 - acc: 0.9737 - val_loss: 0.1701 - val_acc: 0.9496
Epoch 6/20
 - 0s - loss: 0.0585 - acc: 0.9820 - val_loss: 0.1815 - val_acc: 0.9494
Epoch 7/20
 - 0s - loss: 0.0459 - acc: 0.9863 - val_loss: 0.1842 - val_acc: 0.9524
Epoch 8/20
 - 0s - loss: 0.0316 - acc: 0.9904 - val_loss: 0.1870 - val_acc: 0.9547
Epoch 9/20
 - 0s - loss: 0.0253 - acc: 0.9911 - val_loss: 0.1999 - val_acc: 0.9507
Epoch 10/20
 - 0s - loss: 0.0238 - acc: 0.9929 - val_loss: 0.2315 - val_acc: 0.9474
Epoch 11/20
 - 0s - loss: 0.0204 - acc: 0.9936 - val_loss: 0.1983 - val_acc: 0.9547
Epoch 12/20
 - 0s - loss: 0.0210 - acc: 0.9939 - val_loss: 0.2068 - val_acc: 0.9553
Epoch 13/20
 - 0s - loss: 0.0139 - acc: 0.9952 - val_loss: 0.2066 - val_acc: 0.9551
Epoch 14/20
 - 0s - loss: 0.0090 - acc: 0.9971 - val_loss: 0.2140 - val_acc: 0.9585
Epoch 15/20
 - 0s - loss: 0.0105 - acc: 0.9957 - val_loss: 0.2521 - val_acc: 0.9530
Epoch 16/20
 - 0s - loss: 0.0085 - acc: 0.9977 - val_loss: 0.2542 - val_acc: 0.9518
Epoch 17/20
 - 0s - loss: 0.0067 - acc: 0.9976 - val_loss: 0.2333 - val_acc: 0.9588
Epoch 18/20
 - 0s - loss: 0.0079 - acc: 0.9972 - val_loss: 0.2430 - val_acc: 0.9582
Epoch 19/20
 - 0s - loss: 0.0051 - acc: 0.9987 - val_loss: 0.2596 - val_acc: 0.9558
Epoch 20/20
 - 0s - loss: 0.0073 - acc: 0.9977 - val_loss: 0.2710 - val_acc: 0.9568
Test loss: 0.27100537057549406
Test accuracy: 0.9568
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.2938 - acc: 0.3496 - val_loss: 1.5765 - val_acc: 0.4569
Epoch 2/20
 - 1s - loss: 1.1385 - acc: 0.6163 - val_loss: 0.9234 - val_acc: 0.6796
Epoch 3/20
 - 1s - loss: 0.8854 - acc: 0.7088 - val_loss: 0.6618 - val_acc: 0.8036
Epoch 4/20
 - 1s - loss: 0.7252 - acc: 0.7615 - val_loss: 0.6036 - val_acc: 0.8088
Epoch 5/20
 - 1s - loss: 0.6536 - acc: 0.7933 - val_loss: 0.9655 - val_acc: 0.7196
Epoch 6/20
 - 1s - loss: 0.5968 - acc: 0.8101 - val_loss: 0.4532 - val_acc: 0.8484
Epoch 7/20
 - 1s - loss: 0.5310 - acc: 0.8300 - val_loss: 0.7834 - val_acc: 0.7321
Epoch 8/20
 - 1s - loss: 0.5024 - acc: 0.8415 - val_loss: 0.4051 - val_acc: 0.8623
Epoch 9/20
 - 1s - loss: 0.4673 - acc: 0.8457 - val_loss: 0.3162 - val_acc: 0.8984
Epoch 10/20
 - 1s - loss: 0.4164 - acc: 0.8675 - val_loss: 0.5408 - val_acc: 0.8396
Epoch 11/20
 - 1s - loss: 0.3957 - acc: 0.8755 - val_loss: 0.5078 - val_acc: 0.8337
Epoch 12/20
 - 1s - loss: 0.3870 - acc: 0.8768 - val_loss: 0.3469 - val_acc: 0.8887
Epoch 13/20
 - 1s - loss: 0.3739 - acc: 0.8757 - val_loss: 0.3398 - val_acc: 0.8947
Epoch 14/20
 - 1s - loss: 0.3394 - acc: 0.8917 - val_loss: 0.3459 - val_acc: 0.8947
Epoch 15/20
 - 1s - loss: 0.3114 - acc: 0.9019 - val_loss: 0.4413 - val_acc: 0.8594
Epoch 16/20
 - 1s - loss: 0.3218 - acc: 0.8985 - val_loss: 0.2463 - val_acc: 0.9235
Epoch 17/20
 - 1s - loss: 0.2967 - acc: 0.9055 - val_loss: 0.3589 - val_acc: 0.8892
Epoch 18/20
 - 1s - loss: 0.2803 - acc: 0.9083 - val_loss: 0.3907 - val_acc: 0.8727
Epoch 19/20
 - 1s - loss: 0.3185 - acc: 0.9028 - val_loss: 0.3466 - val_acc: 0.8918
Epoch 20/20
 - 1s - loss: 0.2413 - acc: 0.9251 - val_loss: 0.3284 - val_acc: 0.8909
Test loss: 0.32912706934213637
Test accuracy: 0.8906
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8183 - acc: 0.7448 - val_loss: 0.5119 - val_acc: 0.8281
Epoch 2/20
 - 0s - loss: 0.3243 - acc: 0.9011 - val_loss: 0.4496 - val_acc: 0.8602
Epoch 3/20
 - 0s - loss: 0.2444 - acc: 0.9248 - val_loss: 0.3609 - val_acc: 0.8857
Epoch 4/20
 - 0s - loss: 0.1557 - acc: 0.9547 - val_loss: 0.3159 - val_acc: 0.9036
Epoch 5/20
 - 0s - loss: 0.1264 - acc: 0.9589 - val_loss: 0.2342 - val_acc: 0.9291
Epoch 6/20
 - 0s - loss: 0.0879 - acc: 0.9736 - val_loss: 0.2809 - val_acc: 0.9200
Epoch 7/20
 - 0s - loss: 0.0743 - acc: 0.9755 - val_loss: 0.3571 - val_acc: 0.8963
Epoch 8/20
 - 0s - loss: 0.0557 - acc: 0.9829 - val_loss: 0.2313 - val_acc: 0.9340
Epoch 9/20
 - 0s - loss: 0.0351 - acc: 0.9909 - val_loss: 0.2679 - val_acc: 0.9311
Epoch 10/20
 - 0s - loss: 0.0334 - acc: 0.9888 - val_loss: 0.2442 - val_acc: 0.9383
Epoch 11/20
 - 0s - loss: 0.0201 - acc: 0.9939 - val_loss: 0.2415 - val_acc: 0.9410
Epoch 12/20
 - 0s - loss: 0.0240 - acc: 0.9928 - val_loss: 0.2999 - val_acc: 0.9320
Epoch 13/20
 - 0s - loss: 0.0103 - acc: 0.9984 - val_loss: 0.2756 - val_acc: 0.9375
Epoch 14/20
 - 0s - loss: 0.0154 - acc: 0.9955 - val_loss: 0.3015 - val_acc: 0.9358
Epoch 15/20
 - 0s - loss: 0.0101 - acc: 0.9976 - val_loss: 0.3302 - val_acc: 0.9306
Epoch 16/20
 - 0s - loss: 0.0131 - acc: 0.9963 - val_loss: 0.2996 - val_acc: 0.9355
Epoch 17/20
 - 0s - loss: 0.0059 - acc: 0.9981 - val_loss: 0.2675 - val_acc: 0.9453
Epoch 18/20
 - 0s - loss: 0.0103 - acc: 0.9979 - val_loss: 0.2791 - val_acc: 0.9444
Epoch 19/20
 - 0s - loss: 0.0057 - acc: 0.9981 - val_loss: 0.3132 - val_acc: 0.9371
Epoch 20/20
 - 0s - loss: 0.0078 - acc: 0.9973 - val_loss: 0.3014 - val_acc: 0.9425
Test loss: 0.30140355014349407
Test accuracy: 0.9425
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.3087 - acc: 0.2656 - val_loss: 1.5950 - val_acc: 0.5160
Epoch 2/20
 - 1s - loss: 1.5371 - acc: 0.4947 - val_loss: 1.3491 - val_acc: 0.5417
Epoch 3/20
 - 1s - loss: 1.2058 - acc: 0.6120 - val_loss: 0.8827 - val_acc: 0.6945
Epoch 4/20
 - 1s - loss: 1.0338 - acc: 0.6547 - val_loss: 1.8616 - val_acc: 0.3448
Epoch 5/20
 - 1s - loss: 0.9122 - acc: 0.7088 - val_loss: 1.0610 - val_acc: 0.6286
Epoch 6/20
 - 1s - loss: 0.8007 - acc: 0.7355 - val_loss: 0.6668 - val_acc: 0.7801
Epoch 7/20
 - 1s - loss: 0.7491 - acc: 0.7563 - val_loss: 0.6506 - val_acc: 0.7828
Epoch 8/20
 - 1s - loss: 0.7164 - acc: 0.7701 - val_loss: 0.8187 - val_acc: 0.7292
Epoch 9/20
 - 1s - loss: 0.6499 - acc: 0.7859 - val_loss: 0.6675 - val_acc: 0.7672
Epoch 10/20
 - 1s - loss: 0.6220 - acc: 0.7965 - val_loss: 0.5830 - val_acc: 0.7917
Epoch 11/20
 - 1s - loss: 0.6075 - acc: 0.7968 - val_loss: 0.5342 - val_acc: 0.8236
Epoch 12/20
 - 1s - loss: 0.5340 - acc: 0.8304 - val_loss: 0.6069 - val_acc: 0.8074
Epoch 13/20
 - 1s - loss: 0.5354 - acc: 0.8291 - val_loss: 0.8123 - val_acc: 0.7302
Epoch 14/20
 - 1s - loss: 0.5203 - acc: 0.8325 - val_loss: 0.6626 - val_acc: 0.7701
Epoch 15/20
 - 1s - loss: 0.5224 - acc: 0.8283 - val_loss: 0.6174 - val_acc: 0.7999
Epoch 16/20
 - 1s - loss: 0.4618 - acc: 0.8533 - val_loss: 0.4653 - val_acc: 0.8471
Epoch 17/20
 - 1s - loss: 0.4292 - acc: 0.8581 - val_loss: 0.4852 - val_acc: 0.8427
Epoch 18/20
 - 1s - loss: 0.4093 - acc: 0.8699 - val_loss: 0.4859 - val_acc: 0.8346
Epoch 19/20
 - 1s - loss: 0.4664 - acc: 0.8555 - val_loss: 0.7357 - val_acc: 0.7767
Epoch 20/20
 - 1s - loss: 0.4126 - acc: 0.8653 - val_loss: 0.6576 - val_acc: 0.7883
Test loss: 0.6574956585049629
Test accuracy: 0.787
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1322 - acc: 0.6416 - val_loss: 0.6738 - val_acc: 0.7835
Epoch 2/20
 - 0s - loss: 0.4734 - acc: 0.8555 - val_loss: 0.4140 - val_acc: 0.8770
Epoch 3/20
 - 0s - loss: 0.3244 - acc: 0.9008 - val_loss: 0.3532 - val_acc: 0.8935
Epoch 4/20
 - 0s - loss: 0.2479 - acc: 0.9259 - val_loss: 0.3718 - val_acc: 0.8863
Epoch 5/20
 - 0s - loss: 0.1732 - acc: 0.9467 - val_loss: 0.3301 - val_acc: 0.9055
Epoch 6/20
 - 0s - loss: 0.1494 - acc: 0.9563 - val_loss: 0.3356 - val_acc: 0.9040
Epoch 7/20
 - 0s - loss: 0.0966 - acc: 0.9739 - val_loss: 0.3932 - val_acc: 0.8903
Epoch 8/20
 - 0s - loss: 0.0858 - acc: 0.9744 - val_loss: 0.2971 - val_acc: 0.9121
Epoch 9/20
 - 0s - loss: 0.0682 - acc: 0.9781 - val_loss: 0.6194 - val_acc: 0.8321
Epoch 10/20
 - 0s - loss: 0.0565 - acc: 0.9835 - val_loss: 0.3622 - val_acc: 0.8956
Epoch 11/20
 - 0s - loss: 0.0293 - acc: 0.9947 - val_loss: 0.2877 - val_acc: 0.9211
Epoch 12/20
 - 0s - loss: 0.0631 - acc: 0.9797 - val_loss: 0.3276 - val_acc: 0.9100
Epoch 13/20
 - 0s - loss: 0.0170 - acc: 0.9973 - val_loss: 0.3385 - val_acc: 0.9154
Epoch 14/20
 - 0s - loss: 0.0061 - acc: 1.0000 - val_loss: 0.3255 - val_acc: 0.9196
Epoch 15/20
 - 0s - loss: 0.0100 - acc: 0.9973 - val_loss: 0.4089 - val_acc: 0.9044
Epoch 16/20
 - 0s - loss: 0.0136 - acc: 0.9968 - val_loss: 0.3896 - val_acc: 0.9132
Epoch 17/20
 - 0s - loss: 0.0096 - acc: 0.9984 - val_loss: 0.4572 - val_acc: 0.9020
Epoch 18/20
 - 0s - loss: 0.0258 - acc: 0.9904 - val_loss: 0.3560 - val_acc: 0.9204
Epoch 19/20
 - 0s - loss: 0.0031 - acc: 0.9995 - val_loss: 0.3697 - val_acc: 0.9171
Epoch 20/20
 - 0s - loss: 0.0387 - acc: 0.9872 - val_loss: 0.3701 - val_acc: 0.9202
Test loss: 0.3700845605126815
Test accuracy: 0.9202
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.0065 - acc: 0.2021 - val_loss: 2.0607 - val_acc: 0.1629
Epoch 2/20
 - 1s - loss: 1.9712 - acc: 0.3093 - val_loss: 1.8452 - val_acc: 0.4340
Epoch 3/20
 - 1s - loss: 1.7739 - acc: 0.4075 - val_loss: 1.3226 - val_acc: 0.5982
Epoch 4/20
 - 1s - loss: 1.4272 - acc: 0.5339 - val_loss: 1.2341 - val_acc: 0.6626
Epoch 5/20
 - 1s - loss: 1.2514 - acc: 0.5931 - val_loss: 1.6397 - val_acc: 0.4299
Epoch 6/20
 - 1s - loss: 1.1213 - acc: 0.6267 - val_loss: 1.5351 - val_acc: 0.4477
Epoch 7/20
 - 1s - loss: 1.0241 - acc: 0.6629 - val_loss: 0.8714 - val_acc: 0.6941
Epoch 8/20
 - 1s - loss: 1.0001 - acc: 0.6555 - val_loss: 1.0155 - val_acc: 0.6446
Epoch 9/20
 - 1s - loss: 0.9385 - acc: 0.6960 - val_loss: 1.0148 - val_acc: 0.6544
Epoch 10/20
 - 1s - loss: 0.8471 - acc: 0.7131 - val_loss: 0.8064 - val_acc: 0.7237
Epoch 11/20
 - 1s - loss: 0.9449 - acc: 0.6944 - val_loss: 0.6637 - val_acc: 0.7733
Epoch 12/20
 - 1s - loss: 0.7795 - acc: 0.7355 - val_loss: 1.2514 - val_acc: 0.6130
Epoch 13/20
 - 1s - loss: 0.7751 - acc: 0.7509 - val_loss: 0.6577 - val_acc: 0.7914
Epoch 14/20
 - 1s - loss: 0.6588 - acc: 0.7936 - val_loss: 0.7685 - val_acc: 0.7493
Epoch 15/20
 - 1s - loss: 0.7348 - acc: 0.7728 - val_loss: 0.5887 - val_acc: 0.8158
Epoch 16/20
 - 1s - loss: 0.7159 - acc: 0.7755 - val_loss: 0.9707 - val_acc: 0.6904
Epoch 17/20
 - 1s - loss: 0.6663 - acc: 0.7696 - val_loss: 0.4675 - val_acc: 0.8601
Epoch 18/20
 - 1s - loss: 0.6147 - acc: 0.8048 - val_loss: 0.7796 - val_acc: 0.7624
Epoch 19/20
 - 1s - loss: 0.6747 - acc: 0.7893 - val_loss: 0.5716 - val_acc: 0.8153
Epoch 20/20
 - 1s - loss: 0.6240 - acc: 0.7968 - val_loss: 0.9039 - val_acc: 0.7103
Test loss: 0.9040174829483032
Test accuracy: 0.7092
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5544 - acc: 0.4867 - val_loss: 0.8973 - val_acc: 0.7087
Epoch 2/20
 - 0s - loss: 0.5891 - acc: 0.8303 - val_loss: 0.6698 - val_acc: 0.7821
Epoch 3/20
 - 0s - loss: 0.4175 - acc: 0.8698 - val_loss: 0.6884 - val_acc: 0.7769
Epoch 4/20
 - 0s - loss: 0.3264 - acc: 0.8986 - val_loss: 0.4097 - val_acc: 0.8766
Epoch 5/20
 - 0s - loss: 0.2239 - acc: 0.9338 - val_loss: 0.5569 - val_acc: 0.8237
Epoch 6/20
 - 0s - loss: 0.2138 - acc: 0.9349 - val_loss: 0.3718 - val_acc: 0.8883
Epoch 7/20
 - 0s - loss: 0.1083 - acc: 0.9797 - val_loss: 0.4809 - val_acc: 0.8558
Epoch 8/20
 - 0s - loss: 0.1447 - acc: 0.9541 - val_loss: 0.4069 - val_acc: 0.8754
Epoch 9/20
 - 0s - loss: 0.0818 - acc: 0.9787 - val_loss: 0.4198 - val_acc: 0.8768
Epoch 10/20
 - 0s - loss: 0.0549 - acc: 0.9861 - val_loss: 0.4433 - val_acc: 0.8767
Epoch 11/20
 - 0s - loss: 0.0430 - acc: 0.9904 - val_loss: 0.4279 - val_acc: 0.8831
Epoch 12/20
 - 0s - loss: 0.1157 - acc: 0.9755 - val_loss: 0.4088 - val_acc: 0.8825
Epoch 13/20
 - 0s - loss: 0.0238 - acc: 0.9979 - val_loss: 0.4211 - val_acc: 0.8829
Epoch 14/20
 - 0s - loss: 0.0207 - acc: 0.9979 - val_loss: 0.4461 - val_acc: 0.8841
Epoch 15/20
 - 0s - loss: 0.0119 - acc: 0.9989 - val_loss: 0.4177 - val_acc: 0.8930
Epoch 16/20
 - 0s - loss: 0.0078 - acc: 1.0000 - val_loss: 0.5120 - val_acc: 0.8784
Epoch 17/20
 - 0s - loss: 0.0221 - acc: 0.9925 - val_loss: 0.6761 - val_acc: 0.8473
Epoch 18/20
 - 0s - loss: 0.0254 - acc: 0.9947 - val_loss: 0.4382 - val_acc: 0.8910
Epoch 19/20
 - 0s - loss: 0.0041 - acc: 1.0000 - val_loss: 0.4481 - val_acc: 0.8962
Epoch 20/20
 - 0s - loss: 0.0023 - acc: 1.0000 - val_loss: 0.4447 - val_acc: 0.8985
Test loss: 0.4446917234510649
Test accuracy: 0.8985
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.4676 - acc: 0.1227 - val_loss: 2.2738 - val_acc: 0.2059
Epoch 2/20
 - 1s - loss: 2.1588 - acc: 0.2231 - val_loss: 2.0280 - val_acc: 0.2052
Epoch 3/20
 - 1s - loss: 2.0583 - acc: 0.2476 - val_loss: 1.8723 - val_acc: 0.3115
Epoch 4/20
 - 1s - loss: 1.8815 - acc: 0.3575 - val_loss: 2.1180 - val_acc: 0.2194
Epoch 5/20
 - 1s - loss: 1.7376 - acc: 0.4098 - val_loss: 1.8114 - val_acc: 0.4212
Epoch 6/20
 - 1s - loss: 1.5416 - acc: 0.5059 - val_loss: 1.5388 - val_acc: 0.4170
Epoch 7/20
 - 1s - loss: 1.4449 - acc: 0.5176 - val_loss: 1.6280 - val_acc: 0.5258
Epoch 8/20
 - 1s - loss: 1.4031 - acc: 0.5261 - val_loss: 1.2322 - val_acc: 0.5613
Epoch 9/20
 - 1s - loss: 1.2625 - acc: 0.5912 - val_loss: 1.3465 - val_acc: 0.5342
Epoch 10/20
 - 1s - loss: 1.1737 - acc: 0.6211 - val_loss: 1.2305 - val_acc: 0.5709
Epoch 11/20
 - 1s - loss: 1.1212 - acc: 0.6350 - val_loss: 1.5920 - val_acc: 0.4804
Epoch 12/20
 - 1s - loss: 1.0626 - acc: 0.6766 - val_loss: 1.0996 - val_acc: 0.6259
Epoch 13/20
 - 0s - loss: 0.9599 - acc: 0.6841 - val_loss: 1.3494 - val_acc: 0.5346
Epoch 14/20
 - 1s - loss: 0.9389 - acc: 0.6713 - val_loss: 0.7971 - val_acc: 0.7565
Epoch 15/20
 - 1s - loss: 0.8671 - acc: 0.7097 - val_loss: 0.9943 - val_acc: 0.6408
Epoch 16/20
 - 1s - loss: 0.8441 - acc: 0.7279 - val_loss: 1.0254 - val_acc: 0.6259
Epoch 17/20
 - 1s - loss: 0.9123 - acc: 0.7108 - val_loss: 1.4636 - val_acc: 0.4973
Epoch 18/20
 - 1s - loss: 0.8651 - acc: 0.7215 - val_loss: 1.1259 - val_acc: 0.6548
Epoch 19/20
 - 1s - loss: 0.8321 - acc: 0.7311 - val_loss: 0.7370 - val_acc: 0.7644
Epoch 20/20
 - 1s - loss: 0.8742 - acc: 0.7108 - val_loss: 0.9842 - val_acc: 0.6665
Test loss: 0.9849589274406433
Test accuracy: 0.6649
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.7272 - acc: 0.4252 - val_loss: 1.4257 - val_acc: 0.5244
Epoch 2/20
 - 0s - loss: 0.8692 - acc: 0.7500 - val_loss: 0.8745 - val_acc: 0.7265
Epoch 3/20
 - 0s - loss: 0.4470 - acc: 0.8889 - val_loss: 0.7357 - val_acc: 0.7594
Epoch 4/20
 - 0s - loss: 0.3738 - acc: 0.8889 - val_loss: 0.7534 - val_acc: 0.7354
Epoch 5/20
 - 0s - loss: 0.2371 - acc: 0.9338 - val_loss: 0.7144 - val_acc: 0.7684
Epoch 6/20
 - 0s - loss: 0.2232 - acc: 0.9359 - val_loss: 0.5729 - val_acc: 0.8309
Epoch 7/20
 - 0s - loss: 0.1243 - acc: 0.9850 - val_loss: 0.5008 - val_acc: 0.8434
Epoch 8/20
 - 0s - loss: 0.1022 - acc: 0.9829 - val_loss: 0.5342 - val_acc: 0.8412
Epoch 9/20
 - 0s - loss: 0.1073 - acc: 0.9765 - val_loss: 0.6916 - val_acc: 0.7965
Epoch 10/20
 - 0s - loss: 0.0701 - acc: 0.9936 - val_loss: 0.5877 - val_acc: 0.8283
Epoch 11/20
 - 0s - loss: 0.0425 - acc: 0.9957 - val_loss: 0.5176 - val_acc: 0.8477
Epoch 12/20
 - 0s - loss: 0.0296 - acc: 1.0000 - val_loss: 0.5967 - val_acc: 0.8316
Epoch 13/20
 - 0s - loss: 0.0291 - acc: 0.9979 - val_loss: 0.5340 - val_acc: 0.8473
Epoch 14/20
 - 0s - loss: 0.0210 - acc: 0.9979 - val_loss: 0.6172 - val_acc: 0.8322
Epoch 15/20
 - 0s - loss: 0.0216 - acc: 0.9936 - val_loss: 0.5579 - val_acc: 0.8461
Epoch 16/20
 - 0s - loss: 0.0146 - acc: 1.0000 - val_loss: 0.5711 - val_acc: 0.8508
Epoch 17/20
 - 0s - loss: 0.0067 - acc: 1.0000 - val_loss: 0.5417 - val_acc: 0.8539
Epoch 18/20
 - 0s - loss: 0.0077 - acc: 1.0000 - val_loss: 0.5468 - val_acc: 0.8564
Epoch 19/20
 - 0s - loss: 0.0083 - acc: 1.0000 - val_loss: 0.6013 - val_acc: 0.8465
Epoch 20/20
 - 0s - loss: 0.2155 - acc: 0.9530 - val_loss: 0.6219 - val_acc: 0.8458
Test loss: 0.6218966776937246
Test accuracy: 0.8458
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.4063 - acc: 0.1218 - val_loss: 3.1584 - val_acc: 0.1815
Epoch 2/20
 - 0s - loss: 2.6101 - acc: 0.1667 - val_loss: 2.3320 - val_acc: 0.1558
Epoch 3/20
 - 0s - loss: 2.2004 - acc: 0.2030 - val_loss: 2.0435 - val_acc: 0.2664
Epoch 4/20
 - 0s - loss: 1.9372 - acc: 0.3205 - val_loss: 1.9108 - val_acc: 0.4070
Epoch 5/20
 - 0s - loss: 1.9522 - acc: 0.3397 - val_loss: 2.0943 - val_acc: 0.3304
Epoch 6/20
 - 0s - loss: 1.8657 - acc: 0.3504 - val_loss: 1.8404 - val_acc: 0.3583
Epoch 7/20
 - 0s - loss: 1.6127 - acc: 0.4808 - val_loss: 1.6915 - val_acc: 0.3271
Epoch 8/20
 - 0s - loss: 1.5877 - acc: 0.4209 - val_loss: 1.6347 - val_acc: 0.4250
Epoch 9/20
 - 0s - loss: 1.6401 - acc: 0.4231 - val_loss: 1.9678 - val_acc: 0.4265
Epoch 10/20
 - 0s - loss: 1.5539 - acc: 0.5150 - val_loss: 1.3682 - val_acc: 0.5593
Epoch 11/20
 - 0s - loss: 1.3757 - acc: 0.5769 - val_loss: 1.7355 - val_acc: 0.4502
Epoch 12/20
 - 0s - loss: 1.2444 - acc: 0.6389 - val_loss: 1.5934 - val_acc: 0.4783
Epoch 13/20
 - 0s - loss: 1.5774 - acc: 0.4786 - val_loss: 1.2314 - val_acc: 0.5997
Epoch 14/20
 - 0s - loss: 1.1251 - acc: 0.6603 - val_loss: 1.4140 - val_acc: 0.4648
Epoch 15/20
 - 0s - loss: 1.2069 - acc: 0.5769 - val_loss: 1.1292 - val_acc: 0.6125
Epoch 16/20
 - 0s - loss: 0.9287 - acc: 0.7073 - val_loss: 1.3276 - val_acc: 0.5491
Epoch 17/20
 - 0s - loss: 1.1421 - acc: 0.6325 - val_loss: 1.3186 - val_acc: 0.5497
Epoch 18/20
 - 0s - loss: 1.1351 - acc: 0.6090 - val_loss: 1.0286 - val_acc: 0.6736
Epoch 19/20
 - 0s - loss: 0.8242 - acc: 0.7628 - val_loss: 1.0676 - val_acc: 0.6440
Epoch 20/20
 - 0s - loss: 0.8992 - acc: 0.7051 - val_loss: 1.2730 - val_acc: 0.5483
Test loss: 1.2726385811805725
Test accuracy: 0.5511
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0949 - acc: 0.2222 - val_loss: 1.7359 - val_acc: 0.4329
Epoch 2/20
 - 0s - loss: 1.2907 - acc: 0.5983 - val_loss: 1.4563 - val_acc: 0.5407
Epoch 3/20
 - 0s - loss: 0.9169 - acc: 0.7265 - val_loss: 1.1169 - val_acc: 0.6449
Epoch 4/20
 - 0s - loss: 0.5677 - acc: 0.8547 - val_loss: 1.0032 - val_acc: 0.6509
Epoch 5/20
 - 0s - loss: 0.4511 - acc: 0.8761 - val_loss: 0.8143 - val_acc: 0.7462
Epoch 6/20
 - 0s - loss: 0.2577 - acc: 0.9615 - val_loss: 0.8298 - val_acc: 0.7402
Epoch 7/20
 - 0s - loss: 0.2008 - acc: 0.9573 - val_loss: 0.7915 - val_acc: 0.7553
Epoch 8/20
 - 0s - loss: 0.1701 - acc: 0.9615 - val_loss: 0.8489 - val_acc: 0.7472
Epoch 9/20
 - 0s - loss: 0.1991 - acc: 0.9530 - val_loss: 0.9321 - val_acc: 0.7321
Epoch 10/20
 - 0s - loss: 0.1486 - acc: 0.9615 - val_loss: 0.7366 - val_acc: 0.7752
Epoch 11/20
 - 0s - loss: 0.0686 - acc: 0.9957 - val_loss: 0.7309 - val_acc: 0.7843
Epoch 12/20
 - 0s - loss: 0.0595 - acc: 1.0000 - val_loss: 0.7577 - val_acc: 0.7774
Epoch 13/20
 - 0s - loss: 0.0413 - acc: 1.0000 - val_loss: 0.7564 - val_acc: 0.7840
Epoch 14/20
 - 0s - loss: 0.0340 - acc: 0.9957 - val_loss: 0.7509 - val_acc: 0.7849
Epoch 15/20
 - 0s - loss: 0.0298 - acc: 1.0000 - val_loss: 0.7666 - val_acc: 0.7827
Epoch 16/20
 - 0s - loss: 0.0368 - acc: 0.9957 - val_loss: 0.9425 - val_acc: 0.7550
Epoch 17/20
 - 0s - loss: 0.0604 - acc: 0.9829 - val_loss: 1.0779 - val_acc: 0.7367
Epoch 18/20
 - 0s - loss: 0.0344 - acc: 1.0000 - val_loss: 0.7860 - val_acc: 0.7854
Epoch 19/20
 - 0s - loss: 0.0128 - acc: 1.0000 - val_loss: 0.7898 - val_acc: 0.7871
Epoch 20/20
 - 0s - loss: 0.0137 - acc: 1.0000 - val_loss: 0.7906 - val_acc: 0.7890
Test loss: 0.7905897148072719
Test accuracy: 0.789
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 6.0303 - acc: 0.0769 - val_loss: 4.7528 - val_acc: 0.1010
Epoch 2/20
 - 0s - loss: 4.7212 - acc: 0.0812 - val_loss: 2.5299 - val_acc: 0.1123
Epoch 3/20
 - 0s - loss: 2.4854 - acc: 0.1538 - val_loss: 2.2262 - val_acc: 0.1198
Epoch 4/20
 - 0s - loss: 2.2806 - acc: 0.1667 - val_loss: 2.3301 - val_acc: 0.2078
Epoch 5/20
 - 0s - loss: 2.1997 - acc: 0.2179 - val_loss: 2.0963 - val_acc: 0.3061
Epoch 6/20
 - 0s - loss: 1.9851 - acc: 0.3803 - val_loss: 1.9410 - val_acc: 0.3704
Epoch 7/20
 - 0s - loss: 1.9683 - acc: 0.3675 - val_loss: 2.2540 - val_acc: 0.2102
Epoch 8/20
 - 0s - loss: 2.2578 - acc: 0.2051 - val_loss: 2.0060 - val_acc: 0.3817
Epoch 9/20
 - 0s - loss: 1.8940 - acc: 0.3504 - val_loss: 2.1458 - val_acc: 0.2201
Epoch 10/20
 - 0s - loss: 2.0118 - acc: 0.2778 - val_loss: 1.9952 - val_acc: 0.4993
Epoch 11/20
 - 0s - loss: 1.8351 - acc: 0.3932 - val_loss: 1.9132 - val_acc: 0.3428
Epoch 12/20
 - 0s - loss: 1.7794 - acc: 0.3974 - val_loss: 1.8055 - val_acc: 0.4656
Epoch 13/20
 - 0s - loss: 1.6019 - acc: 0.4829 - val_loss: 1.7529 - val_acc: 0.4007
Epoch 14/20
 - 0s - loss: 1.5416 - acc: 0.5128 - val_loss: 1.6782 - val_acc: 0.4227
Epoch 15/20
 - 0s - loss: 1.4386 - acc: 0.5556 - val_loss: 2.6668 - val_acc: 0.1271
Epoch 16/20
 - 0s - loss: 2.4179 - acc: 0.2436 - val_loss: 1.7869 - val_acc: 0.4495
Epoch 17/20
 - 0s - loss: 1.5043 - acc: 0.5299 - val_loss: 1.6334 - val_acc: 0.4129
Epoch 18/20
 - 0s - loss: 1.4606 - acc: 0.5000 - val_loss: 1.8501 - val_acc: 0.4505
Epoch 19/20
 - 0s - loss: 1.4770 - acc: 0.5171 - val_loss: 1.5454 - val_acc: 0.4677
Epoch 20/20
 - 0s - loss: 1.3323 - acc: 0.5598 - val_loss: 1.7514 - val_acc: 0.3831
Test loss: 1.7513685829162597
Test accuracy: 0.3837
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3089 - acc: 0.0855 - val_loss: 2.0334 - val_acc: 0.3216
Epoch 2/20
 - 0s - loss: 1.5606 - acc: 0.4786 - val_loss: 1.7034 - val_acc: 0.4393
Epoch 3/20
 - 0s - loss: 1.2556 - acc: 0.6923 - val_loss: 1.4858 - val_acc: 0.4870
Epoch 4/20
 - 0s - loss: 0.7756 - acc: 0.8120 - val_loss: 1.3136 - val_acc: 0.5584
Epoch 5/20
 - 0s - loss: 0.5739 - acc: 0.8718 - val_loss: 1.1889 - val_acc: 0.6318
Epoch 6/20
 - 0s - loss: 0.4297 - acc: 0.9231 - val_loss: 1.1476 - val_acc: 0.6288
Epoch 7/20
 - 0s - loss: 0.2705 - acc: 0.9573 - val_loss: 0.9842 - val_acc: 0.6872
Epoch 8/20
 - 0s - loss: 0.2164 - acc: 0.9744 - val_loss: 1.1552 - val_acc: 0.6117
Epoch 9/20
 - 0s - loss: 0.1835 - acc: 0.9573 - val_loss: 1.1601 - val_acc: 0.6651
Epoch 10/20
 - 0s - loss: 0.2633 - acc: 0.9060 - val_loss: 1.1013 - val_acc: 0.6327
Epoch 11/20
 - 0s - loss: 0.1285 - acc: 0.9829 - val_loss: 0.9536 - val_acc: 0.7075
Epoch 12/20
 - 0s - loss: 0.0935 - acc: 1.0000 - val_loss: 0.9311 - val_acc: 0.7159
Epoch 13/20
 - 0s - loss: 0.0524 - acc: 1.0000 - val_loss: 0.9355 - val_acc: 0.7210
Epoch 14/20
 - 0s - loss: 0.0482 - acc: 1.0000 - val_loss: 0.9374 - val_acc: 0.7164
Epoch 15/20
 - 0s - loss: 0.0352 - acc: 1.0000 - val_loss: 0.9438 - val_acc: 0.7237
Epoch 16/20
 - 0s - loss: 0.0310 - acc: 1.0000 - val_loss: 0.9288 - val_acc: 0.7280
Epoch 17/20
 - 0s - loss: 0.0269 - acc: 1.0000 - val_loss: 0.9563 - val_acc: 0.7240
Epoch 18/20
 - 0s - loss: 0.0237 - acc: 1.0000 - val_loss: 0.9369 - val_acc: 0.7276
Epoch 19/20
 - 0s - loss: 0.0193 - acc: 1.0000 - val_loss: 0.9610 - val_acc: 0.7282
Epoch 20/20
 - 0s - loss: 0.0190 - acc: 1.0000 - val_loss: 0.9689 - val_acc: 0.7278
Test loss: 0.9688826013326645
Test accuracy: 0.7278
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6172 - acc: 0.1197 - val_loss: 8.7432 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 7.8681 - acc: 0.1624 - val_loss: 6.6429 - val_acc: 0.0980
Epoch 3/20
 - 0s - loss: 7.0177 - acc: 0.1282 - val_loss: 5.1823 - val_acc: 0.1009
Epoch 4/20
 - 0s - loss: 5.9234 - acc: 0.1453 - val_loss: 3.1861 - val_acc: 0.1333
Epoch 5/20
 - 0s - loss: 3.6101 - acc: 0.1282 - val_loss: 2.2019 - val_acc: 0.2601
Epoch 6/20
 - 0s - loss: 2.2189 - acc: 0.1624 - val_loss: 2.1130 - val_acc: 0.2869
Epoch 7/20
 - 0s - loss: 1.9976 - acc: 0.3419 - val_loss: 2.0681 - val_acc: 0.3280
Epoch 8/20
 - 0s - loss: 1.9389 - acc: 0.2991 - val_loss: 2.0372 - val_acc: 0.3578
Epoch 9/20
 - 0s - loss: 1.8918 - acc: 0.3846 - val_loss: 2.0241 - val_acc: 0.3117
Epoch 10/20
 - 0s - loss: 1.9226 - acc: 0.3333 - val_loss: 2.1990 - val_acc: 0.2164
Epoch 11/20
 - 0s - loss: 2.0561 - acc: 0.2308 - val_loss: 2.2051 - val_acc: 0.2960
Epoch 12/20
 - 0s - loss: 2.0163 - acc: 0.3504 - val_loss: 2.0416 - val_acc: 0.2133
Epoch 13/20
 - 0s - loss: 1.9047 - acc: 0.3162 - val_loss: 2.2907 - val_acc: 0.1856
Epoch 14/20
 - 0s - loss: 1.9696 - acc: 0.2906 - val_loss: 2.0828 - val_acc: 0.2497
Epoch 15/20
 - 0s - loss: 1.9379 - acc: 0.2906 - val_loss: 2.0893 - val_acc: 0.2440
Epoch 16/20
 - 0s - loss: 1.8564 - acc: 0.3419 - val_loss: 1.8711 - val_acc: 0.3969
Epoch 17/20
 - 0s - loss: 1.6055 - acc: 0.4786 - val_loss: 1.9841 - val_acc: 0.2828
Epoch 18/20
 - 0s - loss: 1.6629 - acc: 0.4701 - val_loss: 2.0326 - val_acc: 0.2782
Epoch 19/20
 - 0s - loss: 1.7447 - acc: 0.4017 - val_loss: 1.9222 - val_acc: 0.3402
Epoch 20/20
 - 0s - loss: 1.6387 - acc: 0.4444 - val_loss: 1.7587 - val_acc: 0.4784
Test loss: 1.7589808053970337
Test accuracy: 0.4782
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2442 - acc: 0.9237 - val_loss: 0.1093 - val_acc: 0.9654
Epoch 2/20
 - 2s - loss: 0.1023 - acc: 0.9687 - val_loss: 0.0804 - val_acc: 0.9752
Epoch 3/20
 - 2s - loss: 0.0740 - acc: 0.9776 - val_loss: 0.0768 - val_acc: 0.9776
Epoch 4/20
 - 2s - loss: 0.0600 - acc: 0.9818 - val_loss: 0.0742 - val_acc: 0.9797
Epoch 5/20
 - 2s - loss: 0.0517 - acc: 0.9844 - val_loss: 0.0705 - val_acc: 0.9811
Epoch 6/20
 - 2s - loss: 0.0427 - acc: 0.9871 - val_loss: 0.0793 - val_acc: 0.9800
Epoch 7/20
 - 2s - loss: 0.0391 - acc: 0.9886 - val_loss: 0.0890 - val_acc: 0.9805
Epoch 8/20
 - 2s - loss: 0.0353 - acc: 0.9899 - val_loss: 0.0814 - val_acc: 0.9837
Epoch 9/20
 - 2s - loss: 0.0309 - acc: 0.9909 - val_loss: 0.1282 - val_acc: 0.9747
Epoch 10/20
 - 2s - loss: 0.0314 - acc: 0.9913 - val_loss: 0.0872 - val_acc: 0.9833
Epoch 11/20
 - 2s - loss: 0.0283 - acc: 0.9917 - val_loss: 0.0888 - val_acc: 0.9814
Epoch 12/20
 - 2s - loss: 0.0239 - acc: 0.9930 - val_loss: 0.0943 - val_acc: 0.9837
Epoch 13/20
 - 2s - loss: 0.0232 - acc: 0.9933 - val_loss: 0.1005 - val_acc: 0.9825
Epoch 14/20
 - 2s - loss: 0.0231 - acc: 0.9935 - val_loss: 0.1033 - val_acc: 0.9830
Epoch 15/20
 - 2s - loss: 0.0209 - acc: 0.9941 - val_loss: 0.1082 - val_acc: 0.9836
Epoch 16/20
 - 2s - loss: 0.0208 - acc: 0.9947 - val_loss: 0.1106 - val_acc: 0.9822
Epoch 17/20
 - 2s - loss: 0.0198 - acc: 0.9947 - val_loss: 0.1048 - val_acc: 0.9844
Epoch 18/20
 - 2s - loss: 0.0198 - acc: 0.9950 - val_loss: 0.1117 - val_acc: 0.9828
Epoch 19/20
 - 2s - loss: 0.0188 - acc: 0.9954 - val_loss: 0.1114 - val_acc: 0.9841
Epoch 20/20
 - 2s - loss: 0.0162 - acc: 0.9957 - val_loss: 0.1193 - val_acc: 0.9833
Test loss: 0.11926749864772648
Test accuracy: 0.9833
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9384 - acc: 0.7007 - val_loss: 0.3995 - val_acc: 0.8724
Epoch 2/20
 - 4s - loss: 0.4312 - acc: 0.8626 - val_loss: 0.3527 - val_acc: 0.8845
Epoch 3/20
 - 4s - loss: 0.3201 - acc: 0.8990 - val_loss: 0.2082 - val_acc: 0.9364
Epoch 4/20
 - 4s - loss: 0.2632 - acc: 0.9186 - val_loss: 0.2215 - val_acc: 0.9290
Epoch 5/20
 - 4s - loss: 0.2356 - acc: 0.9267 - val_loss: 0.1376 - val_acc: 0.9564
Epoch 6/20
 - 4s - loss: 0.2165 - acc: 0.9336 - val_loss: 0.1668 - val_acc: 0.9485
Epoch 7/20
 - 4s - loss: 0.2027 - acc: 0.9380 - val_loss: 0.1337 - val_acc: 0.9597
Epoch 8/20
 - 4s - loss: 0.1911 - acc: 0.9420 - val_loss: 0.1291 - val_acc: 0.9608
Epoch 9/20
 - 4s - loss: 0.1819 - acc: 0.9446 - val_loss: 0.1221 - val_acc: 0.9618
Epoch 10/20
 - 4s - loss: 0.1797 - acc: 0.9463 - val_loss: 0.1338 - val_acc: 0.9596
Epoch 11/20
 - 4s - loss: 0.1773 - acc: 0.9478 - val_loss: 0.1289 - val_acc: 0.9600
Epoch 12/20
 - 4s - loss: 0.1732 - acc: 0.9477 - val_loss: 0.1478 - val_acc: 0.9572
Epoch 13/20
 - 4s - loss: 0.1697 - acc: 0.9504 - val_loss: 0.1130 - val_acc: 0.9648
Epoch 14/20
 - 4s - loss: 0.1734 - acc: 0.9496 - val_loss: 0.1294 - val_acc: 0.9624
Epoch 15/20
 - 4s - loss: 0.1661 - acc: 0.9519 - val_loss: 0.1764 - val_acc: 0.9447
Epoch 16/20
 - 4s - loss: 0.1614 - acc: 0.9532 - val_loss: 0.1336 - val_acc: 0.9616
Epoch 17/20
 - 4s - loss: 0.1646 - acc: 0.9525 - val_loss: 0.1097 - val_acc: 0.9679
Epoch 18/20
 - 4s - loss: 0.1651 - acc: 0.9537 - val_loss: 0.1209 - val_acc: 0.9647
Epoch 19/20
 - 4s - loss: 0.1653 - acc: 0.9532 - val_loss: 0.1346 - val_acc: 0.9633
Epoch 20/20
 - 4s - loss: 0.1599 - acc: 0.9546 - val_loss: 0.1016 - val_acc: 0.9697
Test loss: 0.10192194623998366
Test accuracy: 0.9699
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3406 - acc: 0.8943 - val_loss: 0.1584 - val_acc: 0.9500
Epoch 2/20
 - 1s - loss: 0.1337 - acc: 0.9599 - val_loss: 0.1122 - val_acc: 0.9647
Epoch 3/20
 - 1s - loss: 0.0912 - acc: 0.9719 - val_loss: 0.1120 - val_acc: 0.9658
Epoch 4/20
 - 1s - loss: 0.0677 - acc: 0.9789 - val_loss: 0.0923 - val_acc: 0.9740
Epoch 5/20
 - 1s - loss: 0.0510 - acc: 0.9840 - val_loss: 0.0933 - val_acc: 0.9754
Epoch 6/20
 - 1s - loss: 0.0437 - acc: 0.9863 - val_loss: 0.0978 - val_acc: 0.9775
Epoch 7/20
 - 1s - loss: 0.0355 - acc: 0.9886 - val_loss: 0.1069 - val_acc: 0.9754
Epoch 8/20
 - 1s - loss: 0.0295 - acc: 0.9902 - val_loss: 0.1081 - val_acc: 0.9744
Epoch 9/20
 - 1s - loss: 0.0288 - acc: 0.9911 - val_loss: 0.1064 - val_acc: 0.9760
Epoch 10/20
 - 1s - loss: 0.0266 - acc: 0.9920 - val_loss: 0.1076 - val_acc: 0.9774
Epoch 11/20
 - 1s - loss: 0.0212 - acc: 0.9926 - val_loss: 0.1016 - val_acc: 0.9807
Epoch 12/20
 - 1s - loss: 0.0187 - acc: 0.9937 - val_loss: 0.1161 - val_acc: 0.9782
Epoch 13/20
 - 1s - loss: 0.0172 - acc: 0.9945 - val_loss: 0.1250 - val_acc: 0.9787
Epoch 14/20
 - 1s - loss: 0.0180 - acc: 0.9948 - val_loss: 0.1678 - val_acc: 0.9718
Epoch 15/20
 - 1s - loss: 0.0168 - acc: 0.9944 - val_loss: 0.1384 - val_acc: 0.9769
Epoch 16/20
 - 1s - loss: 0.0148 - acc: 0.9957 - val_loss: 0.1468 - val_acc: 0.9762
Epoch 17/20
 - 1s - loss: 0.0146 - acc: 0.9956 - val_loss: 0.1210 - val_acc: 0.9795
Epoch 18/20
 - 1s - loss: 0.0110 - acc: 0.9964 - val_loss: 0.1322 - val_acc: 0.9799
Epoch 19/20
 - 1s - loss: 0.0104 - acc: 0.9966 - val_loss: 0.1368 - val_acc: 0.9780
Epoch 20/20
 - 1s - loss: 0.0128 - acc: 0.9963 - val_loss: 0.1294 - val_acc: 0.9795
Test loss: 0.12940008859871122
Test accuracy: 0.9795
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2763 - acc: 0.5987 - val_loss: 0.7163 - val_acc: 0.7669
Epoch 2/20
 - 2s - loss: 0.6142 - acc: 0.7997 - val_loss: 0.7280 - val_acc: 0.7868
Epoch 3/20
 - 2s - loss: 0.4661 - acc: 0.8505 - val_loss: 0.8411 - val_acc: 0.7509
Epoch 4/20
 - 2s - loss: 0.3760 - acc: 0.8807 - val_loss: 0.2896 - val_acc: 0.9096
Epoch 5/20
 - 2s - loss: 0.3252 - acc: 0.8962 - val_loss: 0.2430 - val_acc: 0.9222
Epoch 6/20
 - 2s - loss: 0.2854 - acc: 0.9098 - val_loss: 0.3240 - val_acc: 0.8958
Epoch 7/20
 - 2s - loss: 0.2619 - acc: 0.9179 - val_loss: 0.1710 - val_acc: 0.9451
Epoch 8/20
 - 2s - loss: 0.2403 - acc: 0.9261 - val_loss: 0.1751 - val_acc: 0.9446
Epoch 9/20
 - 2s - loss: 0.2282 - acc: 0.9289 - val_loss: 0.1955 - val_acc: 0.9387
Epoch 10/20
 - 2s - loss: 0.2131 - acc: 0.9335 - val_loss: 0.1973 - val_acc: 0.9428
Epoch 11/20
 - 2s - loss: 0.2002 - acc: 0.9368 - val_loss: 0.2160 - val_acc: 0.9276
Epoch 12/20
 - 2s - loss: 0.1944 - acc: 0.9398 - val_loss: 0.3263 - val_acc: 0.8956
Epoch 13/20
 - 2s - loss: 0.1857 - acc: 0.9431 - val_loss: 0.2360 - val_acc: 0.9352
Epoch 14/20
 - 2s - loss: 0.1796 - acc: 0.9439 - val_loss: 0.1861 - val_acc: 0.9451
Epoch 15/20
 - 2s - loss: 0.1748 - acc: 0.9452 - val_loss: 0.1524 - val_acc: 0.9529
Epoch 16/20
 - 2s - loss: 0.1688 - acc: 0.9493 - val_loss: 0.1765 - val_acc: 0.9434
Epoch 17/20
 - 2s - loss: 0.1668 - acc: 0.9495 - val_loss: 0.1123 - val_acc: 0.9654
Epoch 18/20
 - 2s - loss: 0.1642 - acc: 0.9499 - val_loss: 0.2994 - val_acc: 0.9026
Epoch 19/20
 - 2s - loss: 0.1558 - acc: 0.9532 - val_loss: 0.1498 - val_acc: 0.9570
Epoch 20/20
 - 2s - loss: 0.1524 - acc: 0.9538 - val_loss: 0.2022 - val_acc: 0.9468
Test loss: 0.20127607665512479
Test accuracy: 0.9472
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4629 - acc: 0.8587 - val_loss: 0.3295 - val_acc: 0.8988
Epoch 2/20
 - 1s - loss: 0.1813 - acc: 0.9441 - val_loss: 0.1541 - val_acc: 0.9516
Epoch 3/20
 - 1s - loss: 0.1188 - acc: 0.9627 - val_loss: 0.1317 - val_acc: 0.9598
Epoch 4/20
 - 1s - loss: 0.0824 - acc: 0.9736 - val_loss: 0.1436 - val_acc: 0.9586
Epoch 5/20
 - 1s - loss: 0.0596 - acc: 0.9804 - val_loss: 0.1308 - val_acc: 0.9615
Epoch 6/20
 - 1s - loss: 0.0519 - acc: 0.9843 - val_loss: 0.1240 - val_acc: 0.9696
Epoch 7/20
 - 1s - loss: 0.0383 - acc: 0.9877 - val_loss: 0.1426 - val_acc: 0.9660
Epoch 8/20
 - 1s - loss: 0.0326 - acc: 0.9893 - val_loss: 0.1413 - val_acc: 0.9679
Epoch 9/20
 - 1s - loss: 0.0270 - acc: 0.9912 - val_loss: 0.1295 - val_acc: 0.9691
Epoch 10/20
 - 1s - loss: 0.0215 - acc: 0.9930 - val_loss: 0.1527 - val_acc: 0.9692
Epoch 11/20
 - 1s - loss: 0.0187 - acc: 0.9934 - val_loss: 0.1598 - val_acc: 0.9673
Epoch 12/20
 - 1s - loss: 0.0193 - acc: 0.9942 - val_loss: 0.1575 - val_acc: 0.9684
Epoch 13/20
 - 1s - loss: 0.0142 - acc: 0.9955 - val_loss: 0.1622 - val_acc: 0.9681
Epoch 14/20
 - 1s - loss: 0.0140 - acc: 0.9951 - val_loss: 0.1693 - val_acc: 0.9700
Epoch 15/20
 - 1s - loss: 0.0146 - acc: 0.9953 - val_loss: 0.1828 - val_acc: 0.9682
Epoch 16/20
 - 1s - loss: 0.0123 - acc: 0.9963 - val_loss: 0.1915 - val_acc: 0.9686
Epoch 17/20
 - 1s - loss: 0.0102 - acc: 0.9970 - val_loss: 0.1761 - val_acc: 0.9713
Epoch 18/20
 - 1s - loss: 0.0114 - acc: 0.9967 - val_loss: 0.1770 - val_acc: 0.9725
Epoch 19/20
 - 1s - loss: 0.0087 - acc: 0.9970 - val_loss: 0.1986 - val_acc: 0.9699
Epoch 20/20
 - 1s - loss: 0.0121 - acc: 0.9964 - val_loss: 0.1886 - val_acc: 0.9695
Test loss: 0.18861600080563556
Test accuracy: 0.9695
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6413 - acc: 0.4828 - val_loss: 1.2197 - val_acc: 0.5630
Epoch 2/20
 - 1s - loss: 0.8500 - acc: 0.7166 - val_loss: 0.8361 - val_acc: 0.7321
Epoch 3/20
 - 1s - loss: 0.6634 - acc: 0.7841 - val_loss: 0.5339 - val_acc: 0.8230
Epoch 4/20
 - 1s - loss: 0.5540 - acc: 0.8187 - val_loss: 0.3975 - val_acc: 0.8665
Epoch 5/20
 - 1s - loss: 0.4869 - acc: 0.8445 - val_loss: 0.4499 - val_acc: 0.8534
Epoch 6/20
 - 1s - loss: 0.4322 - acc: 0.8609 - val_loss: 0.4624 - val_acc: 0.8440
Epoch 7/20
 - 1s - loss: 0.3858 - acc: 0.8757 - val_loss: 0.3934 - val_acc: 0.8673
Epoch 8/20
 - 1s - loss: 0.3531 - acc: 0.8856 - val_loss: 0.8187 - val_acc: 0.7223
Epoch 9/20
 - 1s - loss: 0.3312 - acc: 0.8949 - val_loss: 0.1906 - val_acc: 0.9426
Epoch 10/20
 - 1s - loss: 0.3098 - acc: 0.9055 - val_loss: 0.2649 - val_acc: 0.9135
Epoch 11/20
 - 1s - loss: 0.2734 - acc: 0.9155 - val_loss: 0.2718 - val_acc: 0.9164
Epoch 12/20
 - 1s - loss: 0.2628 - acc: 0.9163 - val_loss: 0.2465 - val_acc: 0.9252
Epoch 13/20
 - 1s - loss: 0.2541 - acc: 0.9199 - val_loss: 0.5700 - val_acc: 0.8099
Epoch 14/20
 - 1s - loss: 0.2514 - acc: 0.9205 - val_loss: 0.3624 - val_acc: 0.8810
Epoch 15/20
 - 1s - loss: 0.2402 - acc: 0.9249 - val_loss: 0.3267 - val_acc: 0.9047
Epoch 16/20
 - 1s - loss: 0.2234 - acc: 0.9311 - val_loss: 0.2615 - val_acc: 0.9178
Epoch 17/20
 - 1s - loss: 0.2217 - acc: 0.9298 - val_loss: 0.2203 - val_acc: 0.9333
Epoch 18/20
 - 1s - loss: 0.1978 - acc: 0.9367 - val_loss: 0.2479 - val_acc: 0.9276
Epoch 19/20
 - 1s - loss: 0.1923 - acc: 0.9403 - val_loss: 0.5552 - val_acc: 0.8306
Epoch 20/20
 - 1s - loss: 0.1906 - acc: 0.9401 - val_loss: 0.6189 - val_acc: 0.8182
Test loss: 0.619083422267437
Test accuracy: 0.8177
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.5979 - acc: 0.8153 - val_loss: 0.3368 - val_acc: 0.9000
Epoch 2/20
 - 0s - loss: 0.2496 - acc: 0.9245 - val_loss: 0.2436 - val_acc: 0.9258
Epoch 3/20
 - 0s - loss: 0.1619 - acc: 0.9501 - val_loss: 0.2274 - val_acc: 0.9284
Epoch 4/20
 - 0s - loss: 0.1156 - acc: 0.9637 - val_loss: 0.1883 - val_acc: 0.9426
Epoch 5/20
 - 0s - loss: 0.0863 - acc: 0.9725 - val_loss: 0.2435 - val_acc: 0.9250
Epoch 6/20
 - 0s - loss: 0.0639 - acc: 0.9785 - val_loss: 0.1919 - val_acc: 0.9477
Epoch 7/20
 - 0s - loss: 0.0433 - acc: 0.9876 - val_loss: 0.1767 - val_acc: 0.9528
Epoch 8/20
 - 0s - loss: 0.0418 - acc: 0.9872 - val_loss: 0.1764 - val_acc: 0.9535
Epoch 9/20
 - 0s - loss: 0.0282 - acc: 0.9911 - val_loss: 0.1853 - val_acc: 0.9531
Epoch 10/20
 - 0s - loss: 0.0209 - acc: 0.9933 - val_loss: 0.2287 - val_acc: 0.9462
Epoch 11/20
 - 0s - loss: 0.0189 - acc: 0.9945 - val_loss: 0.2098 - val_acc: 0.9566
Epoch 12/20
 - 0s - loss: 0.0165 - acc: 0.9939 - val_loss: 0.2278 - val_acc: 0.9505
Epoch 13/20
 - 0s - loss: 0.0111 - acc: 0.9965 - val_loss: 0.2241 - val_acc: 0.9560
Epoch 14/20
 - 0s - loss: 0.0088 - acc: 0.9976 - val_loss: 0.2560 - val_acc: 0.9518
Epoch 15/20
 - 0s - loss: 0.0111 - acc: 0.9967 - val_loss: 0.2572 - val_acc: 0.9529
Epoch 16/20
 - 0s - loss: 0.0070 - acc: 0.9981 - val_loss: 0.2668 - val_acc: 0.9497
Epoch 17/20
 - 0s - loss: 0.0093 - acc: 0.9959 - val_loss: 0.2457 - val_acc: 0.9559
Epoch 18/20
 - 0s - loss: 0.0067 - acc: 0.9976 - val_loss: 0.2429 - val_acc: 0.9556
Epoch 19/20
 - 0s - loss: 0.0104 - acc: 0.9967 - val_loss: 0.2387 - val_acc: 0.9586
Epoch 20/20
 - 0s - loss: 0.0048 - acc: 0.9980 - val_loss: 0.2779 - val_acc: 0.9526
Test loss: 0.27787906719556915
Test accuracy: 0.9526
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.1481 - acc: 0.3635 - val_loss: 1.3875 - val_acc: 0.5097
Epoch 2/20
 - 1s - loss: 1.1493 - acc: 0.6176 - val_loss: 1.5479 - val_acc: 0.4656
Epoch 3/20
 - 1s - loss: 0.8736 - acc: 0.7111 - val_loss: 0.8125 - val_acc: 0.7427
Epoch 4/20
 - 1s - loss: 0.7467 - acc: 0.7516 - val_loss: 0.7160 - val_acc: 0.7440
Epoch 5/20
 - 1s - loss: 0.6385 - acc: 0.7960 - val_loss: 0.6476 - val_acc: 0.7997
Epoch 6/20
 - 1s - loss: 0.5818 - acc: 0.8132 - val_loss: 0.5382 - val_acc: 0.8159
Epoch 7/20
 - 1s - loss: 0.5416 - acc: 0.8265 - val_loss: 0.4606 - val_acc: 0.8530
Epoch 8/20
 - 1s - loss: 0.4951 - acc: 0.8437 - val_loss: 0.6707 - val_acc: 0.7836
Epoch 9/20
 - 1s - loss: 0.4578 - acc: 0.8533 - val_loss: 0.5223 - val_acc: 0.8434
Epoch 10/20
 - 1s - loss: 0.4369 - acc: 0.8611 - val_loss: 0.2927 - val_acc: 0.9081
Epoch 11/20
 - 1s - loss: 0.4167 - acc: 0.8737 - val_loss: 0.4735 - val_acc: 0.8379
Epoch 12/20
 - 1s - loss: 0.3752 - acc: 0.8771 - val_loss: 0.7348 - val_acc: 0.7840
Epoch 13/20
 - 1s - loss: 0.3691 - acc: 0.8811 - val_loss: 0.3676 - val_acc: 0.8814
Epoch 14/20
 - 1s - loss: 0.3702 - acc: 0.8844 - val_loss: 0.3569 - val_acc: 0.8878
Epoch 15/20
 - 1s - loss: 0.3042 - acc: 0.9009 - val_loss: 0.7060 - val_acc: 0.7774
Epoch 16/20
 - 1s - loss: 0.3200 - acc: 0.9008 - val_loss: 0.3847 - val_acc: 0.8763
Epoch 17/20
 - 1s - loss: 0.3128 - acc: 0.9063 - val_loss: 0.2644 - val_acc: 0.9205
Epoch 18/20
 - 1s - loss: 0.2759 - acc: 0.9092 - val_loss: 0.2618 - val_acc: 0.9187
Epoch 19/20
 - 1s - loss: 0.2600 - acc: 0.9192 - val_loss: 0.3061 - val_acc: 0.9069
Epoch 20/20
 - 1s - loss: 0.2641 - acc: 0.9184 - val_loss: 0.3942 - val_acc: 0.8767
Test loss: 0.3943476030874997
Test accuracy: 0.8761
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8311 - acc: 0.7357 - val_loss: 0.6596 - val_acc: 0.7772
Epoch 2/20
 - 0s - loss: 0.3476 - acc: 0.8917 - val_loss: 0.3469 - val_acc: 0.8931
Epoch 3/20
 - 0s - loss: 0.2171 - acc: 0.9379 - val_loss: 0.2824 - val_acc: 0.9113
Epoch 4/20
 - 0s - loss: 0.1756 - acc: 0.9467 - val_loss: 0.3131 - val_acc: 0.9016
Epoch 5/20
 - 0s - loss: 0.1238 - acc: 0.9608 - val_loss: 0.2235 - val_acc: 0.9327
Epoch 6/20
 - 0s - loss: 0.0931 - acc: 0.9685 - val_loss: 0.3134 - val_acc: 0.9098
Epoch 7/20
 - 0s - loss: 0.0672 - acc: 0.9779 - val_loss: 0.2359 - val_acc: 0.9318
Epoch 8/20
 - 0s - loss: 0.0547 - acc: 0.9811 - val_loss: 0.2605 - val_acc: 0.9279
Epoch 9/20
 - 0s - loss: 0.0451 - acc: 0.9845 - val_loss: 0.2344 - val_acc: 0.9378
Epoch 10/20
 - 0s - loss: 0.0246 - acc: 0.9928 - val_loss: 0.2968 - val_acc: 0.9224
Epoch 11/20
 - 0s - loss: 0.0305 - acc: 0.9904 - val_loss: 0.2703 - val_acc: 0.9322
Epoch 12/20
 - 0s - loss: 0.0173 - acc: 0.9949 - val_loss: 0.3318 - val_acc: 0.9232
Epoch 13/20
 - 0s - loss: 0.0147 - acc: 0.9952 - val_loss: 0.2522 - val_acc: 0.9423
Epoch 14/20
 - 0s - loss: 0.0105 - acc: 0.9971 - val_loss: 0.3200 - val_acc: 0.9327
Epoch 15/20
 - 0s - loss: 0.0125 - acc: 0.9955 - val_loss: 0.2736 - val_acc: 0.9400
Epoch 16/20
 - 0s - loss: 0.0115 - acc: 0.9963 - val_loss: 0.2871 - val_acc: 0.9402
Epoch 17/20
 - 0s - loss: 0.0078 - acc: 0.9979 - val_loss: 0.2758 - val_acc: 0.9421
Epoch 18/20
 - 0s - loss: 0.0062 - acc: 0.9992 - val_loss: 0.2972 - val_acc: 0.9414
Epoch 19/20
 - 0s - loss: 0.0067 - acc: 0.9973 - val_loss: 0.3556 - val_acc: 0.9344
Epoch 20/20
 - 0s - loss: 0.0048 - acc: 0.9989 - val_loss: 0.2971 - val_acc: 0.9467
Test loss: 0.29705396808307016
Test accuracy: 0.9467
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5916 - acc: 0.2429 - val_loss: 1.7259 - val_acc: 0.4551
Epoch 2/20
 - 1s - loss: 1.6213 - acc: 0.4376 - val_loss: 1.6453 - val_acc: 0.4971
Epoch 3/20
 - 1s - loss: 1.2399 - acc: 0.5912 - val_loss: 1.2640 - val_acc: 0.5662
Epoch 4/20
 - 1s - loss: 1.0543 - acc: 0.6509 - val_loss: 0.9912 - val_acc: 0.6543
Epoch 5/20
 - 1s - loss: 0.8687 - acc: 0.7128 - val_loss: 0.9874 - val_acc: 0.6266
Epoch 6/20
 - 1s - loss: 0.7993 - acc: 0.7293 - val_loss: 1.0162 - val_acc: 0.6445
Epoch 7/20
 - 1s - loss: 0.7403 - acc: 0.7517 - val_loss: 0.9206 - val_acc: 0.7244
Epoch 8/20
 - 1s - loss: 0.7519 - acc: 0.7627 - val_loss: 0.7694 - val_acc: 0.7439
Epoch 9/20
 - 1s - loss: 0.6647 - acc: 0.7816 - val_loss: 1.2666 - val_acc: 0.6303
Epoch 10/20
 - 1s - loss: 0.6513 - acc: 0.7869 - val_loss: 0.9233 - val_acc: 0.7086
Epoch 11/20
 - 1s - loss: 0.5957 - acc: 0.8123 - val_loss: 0.5957 - val_acc: 0.8070
Epoch 12/20
 - 1s - loss: 0.5896 - acc: 0.8048 - val_loss: 0.8956 - val_acc: 0.7214
Epoch 13/20
 - 1s - loss: 0.5350 - acc: 0.8235 - val_loss: 0.6081 - val_acc: 0.8016
Epoch 14/20
 - 1s - loss: 0.5300 - acc: 0.8381 - val_loss: 0.7234 - val_acc: 0.7541
Epoch 15/20
 - 1s - loss: 0.5056 - acc: 0.8405 - val_loss: 0.5573 - val_acc: 0.8169
Epoch 16/20
 - 1s - loss: 0.4466 - acc: 0.8547 - val_loss: 0.5218 - val_acc: 0.8249
Epoch 17/20
 - 1s - loss: 0.5002 - acc: 0.8392 - val_loss: 0.8966 - val_acc: 0.7371
Epoch 18/20
 - 1s - loss: 0.4299 - acc: 0.8621 - val_loss: 0.4383 - val_acc: 0.8564
Epoch 19/20
 - 1s - loss: 0.4381 - acc: 0.8621 - val_loss: 0.3511 - val_acc: 0.8874
Epoch 20/20
 - 1s - loss: 0.3906 - acc: 0.8712 - val_loss: 0.5952 - val_acc: 0.8165
Test loss: 0.5953086506068707
Test accuracy: 0.8179
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1752 - acc: 0.6331 - val_loss: 0.5358 - val_acc: 0.8343
Epoch 2/20
 - 0s - loss: 0.4484 - acc: 0.8645 - val_loss: 0.3865 - val_acc: 0.8847
Epoch 3/20
 - 0s - loss: 0.3157 - acc: 0.9088 - val_loss: 0.4198 - val_acc: 0.8737
Epoch 4/20
 - 0s - loss: 0.2558 - acc: 0.9275 - val_loss: 0.3244 - val_acc: 0.8999
Epoch 5/20
 - 0s - loss: 0.1683 - acc: 0.9515 - val_loss: 0.4520 - val_acc: 0.8568
Epoch 6/20
 - 0s - loss: 0.1470 - acc: 0.9557 - val_loss: 0.2890 - val_acc: 0.9137
Epoch 7/20
 - 0s - loss: 0.1003 - acc: 0.9728 - val_loss: 0.4050 - val_acc: 0.8863
Epoch 8/20
 - 0s - loss: 0.0850 - acc: 0.9739 - val_loss: 0.2925 - val_acc: 0.9164
Epoch 9/20
 - 0s - loss: 0.0750 - acc: 0.9781 - val_loss: 0.3257 - val_acc: 0.9050
Epoch 10/20
 - 0s - loss: 0.0412 - acc: 0.9915 - val_loss: 0.3119 - val_acc: 0.9126
Epoch 11/20
 - 0s - loss: 0.0355 - acc: 0.9893 - val_loss: 0.4738 - val_acc: 0.8771
Epoch 12/20
 - 0s - loss: 0.0291 - acc: 0.9931 - val_loss: 0.3147 - val_acc: 0.9186
Epoch 13/20
 - 0s - loss: 0.0229 - acc: 0.9957 - val_loss: 0.3152 - val_acc: 0.9191
Epoch 14/20
 - 0s - loss: 0.0215 - acc: 0.9920 - val_loss: 0.3042 - val_acc: 0.9230
Epoch 15/20
 - 0s - loss: 0.0175 - acc: 0.9968 - val_loss: 0.3583 - val_acc: 0.9159
Epoch 16/20
 - 0s - loss: 0.0090 - acc: 0.9979 - val_loss: 0.8839 - val_acc: 0.8280
Epoch 17/20
 - 0s - loss: 0.0412 - acc: 0.9893 - val_loss: 0.3207 - val_acc: 0.9252
Epoch 18/20
 - 0s - loss: 0.0028 - acc: 1.0000 - val_loss: 0.3499 - val_acc: 0.9236
Epoch 19/20
 - 0s - loss: 0.0028 - acc: 1.0000 - val_loss: 0.3655 - val_acc: 0.9209
Epoch 20/20
 - 0s - loss: 0.0286 - acc: 0.9904 - val_loss: 0.3818 - val_acc: 0.9205
Test loss: 0.3818088595906447
Test accuracy: 0.9205
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.0320 - acc: 0.1728 - val_loss: 2.1529 - val_acc: 0.3171
Epoch 2/20
 - 1s - loss: 1.9109 - acc: 0.3323 - val_loss: 1.7531 - val_acc: 0.4272
Epoch 3/20
 - 1s - loss: 1.7109 - acc: 0.4315 - val_loss: 1.3898 - val_acc: 0.6241
Epoch 4/20
 - 1s - loss: 1.3640 - acc: 0.5541 - val_loss: 2.0355 - val_acc: 0.4101
Epoch 5/20
 - 1s - loss: 1.2736 - acc: 0.5701 - val_loss: 1.1908 - val_acc: 0.5882
Epoch 6/20
 - 1s - loss: 1.1705 - acc: 0.6048 - val_loss: 1.4296 - val_acc: 0.6051
Epoch 7/20
 - 1s - loss: 1.0944 - acc: 0.6427 - val_loss: 0.9108 - val_acc: 0.6885
Epoch 8/20
 - 1s - loss: 0.9090 - acc: 0.7051 - val_loss: 0.8343 - val_acc: 0.7267
Epoch 9/20
 - 1s - loss: 0.9002 - acc: 0.7040 - val_loss: 0.5892 - val_acc: 0.8054
Epoch 10/20
 - 1s - loss: 0.8302 - acc: 0.7205 - val_loss: 1.0426 - val_acc: 0.6838
Epoch 11/20
 - 1s - loss: 0.8365 - acc: 0.7323 - val_loss: 0.7774 - val_acc: 0.7454
Epoch 12/20
 - 1s - loss: 0.7015 - acc: 0.7680 - val_loss: 1.1927 - val_acc: 0.6283
Epoch 13/20
 - 1s - loss: 0.8135 - acc: 0.7429 - val_loss: 0.7748 - val_acc: 0.7211
Epoch 14/20
 - 1s - loss: 0.7498 - acc: 0.7509 - val_loss: 0.5718 - val_acc: 0.8135
Epoch 15/20
 - 1s - loss: 0.7034 - acc: 0.7771 - val_loss: 0.7997 - val_acc: 0.7339
Epoch 16/20
 - 1s - loss: 0.6496 - acc: 0.8027 - val_loss: 1.0899 - val_acc: 0.6848
Epoch 17/20
 - 1s - loss: 0.6334 - acc: 0.7952 - val_loss: 0.4943 - val_acc: 0.8433
Epoch 18/20
 - 1s - loss: 0.6157 - acc: 0.8032 - val_loss: 0.6576 - val_acc: 0.7919
Epoch 19/20
 - 1s - loss: 0.6851 - acc: 0.7653 - val_loss: 0.6160 - val_acc: 0.7915
Epoch 20/20
 - 1s - loss: 0.4750 - acc: 0.8432 - val_loss: 0.9932 - val_acc: 0.6522
Test loss: 0.9933215201377869
Test accuracy: 0.6525
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5420 - acc: 0.5197 - val_loss: 0.8624 - val_acc: 0.7247
Epoch 2/20
 - 0s - loss: 0.6657 - acc: 0.8036 - val_loss: 0.6739 - val_acc: 0.7796
Epoch 3/20
 - 0s - loss: 0.4365 - acc: 0.8783 - val_loss: 0.7229 - val_acc: 0.7489
Epoch 4/20
 - 0s - loss: 0.3361 - acc: 0.9007 - val_loss: 0.4191 - val_acc: 0.8699
Epoch 5/20
 - 0s - loss: 0.2281 - acc: 0.9424 - val_loss: 0.4048 - val_acc: 0.8737
Epoch 6/20
 - 0s - loss: 0.1916 - acc: 0.9498 - val_loss: 0.5169 - val_acc: 0.8351
Epoch 7/20
 - 0s - loss: 0.1449 - acc: 0.9530 - val_loss: 0.3688 - val_acc: 0.8888
Epoch 8/20
 - 0s - loss: 0.0932 - acc: 0.9787 - val_loss: 0.4103 - val_acc: 0.8719
Epoch 9/20
 - 0s - loss: 0.0886 - acc: 0.9776 - val_loss: 0.4456 - val_acc: 0.8700
Epoch 10/20
 - 0s - loss: 0.0618 - acc: 0.9840 - val_loss: 0.4522 - val_acc: 0.8715
Epoch 11/20
 - 0s - loss: 0.0350 - acc: 0.9957 - val_loss: 0.3981 - val_acc: 0.8881
Epoch 12/20
 - 0s - loss: 0.0664 - acc: 0.9872 - val_loss: 0.5112 - val_acc: 0.8697
Epoch 13/20
 - 0s - loss: 0.0292 - acc: 0.9936 - val_loss: 0.3845 - val_acc: 0.8901
Epoch 14/20
 - 0s - loss: 0.0267 - acc: 0.9957 - val_loss: 0.3771 - val_acc: 0.8986
Epoch 15/20
 - 0s - loss: 0.0091 - acc: 1.0000 - val_loss: 0.3880 - val_acc: 0.8971
Epoch 16/20
 - 0s - loss: 0.0250 - acc: 0.9925 - val_loss: 0.4281 - val_acc: 0.8906
Epoch 17/20
 - 0s - loss: 0.0087 - acc: 0.9989 - val_loss: 0.5741 - val_acc: 0.8612
Epoch 18/20
 - 0s - loss: 0.0650 - acc: 0.9819 - val_loss: 0.4394 - val_acc: 0.8944
Epoch 19/20
 - 0s - loss: 0.0102 - acc: 0.9989 - val_loss: 0.3979 - val_acc: 0.9013
Epoch 20/20
 - 0s - loss: 0.0037 - acc: 1.0000 - val_loss: 0.4219 - val_acc: 0.8982
Test loss: 0.42185018638186156
Test accuracy: 0.8982
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.6696 - acc: 0.1217 - val_loss: 2.3070 - val_acc: 0.2834
Epoch 2/20
 - 1s - loss: 2.1498 - acc: 0.2423 - val_loss: 2.3112 - val_acc: 0.2555
Epoch 3/20
 - 0s - loss: 1.9331 - acc: 0.3351 - val_loss: 1.9618 - val_acc: 0.3218
Epoch 4/20
 - 1s - loss: 1.8860 - acc: 0.3682 - val_loss: 2.1941 - val_acc: 0.2406
Epoch 5/20
 - 0s - loss: 1.7703 - acc: 0.4365 - val_loss: 2.0250 - val_acc: 0.4012
Epoch 6/20
 - 0s - loss: 1.5184 - acc: 0.4931 - val_loss: 1.9654 - val_acc: 0.3546
Epoch 7/20
 - 0s - loss: 1.5703 - acc: 0.5315 - val_loss: 1.6876 - val_acc: 0.3204
Epoch 8/20
 - 0s - loss: 1.2865 - acc: 0.5838 - val_loss: 1.2546 - val_acc: 0.5796
Epoch 9/20
 - 0s - loss: 1.2656 - acc: 0.6297 - val_loss: 1.0911 - val_acc: 0.6201
Epoch 10/20
 - 0s - loss: 1.1919 - acc: 0.6105 - val_loss: 1.0486 - val_acc: 0.6335
Epoch 11/20
 - 0s - loss: 1.0103 - acc: 0.6638 - val_loss: 1.0783 - val_acc: 0.6098
Epoch 12/20
 - 0s - loss: 1.0717 - acc: 0.6446 - val_loss: 1.2783 - val_acc: 0.6173
Epoch 13/20
 - 0s - loss: 1.0135 - acc: 0.6798 - val_loss: 1.0137 - val_acc: 0.6636
Epoch 14/20
 - 0s - loss: 0.9570 - acc: 0.6809 - val_loss: 1.0769 - val_acc: 0.6402
Epoch 15/20
 - 0s - loss: 0.9276 - acc: 0.6948 - val_loss: 1.2490 - val_acc: 0.5515
Epoch 16/20
 - 0s - loss: 0.9340 - acc: 0.6745 - val_loss: 0.7742 - val_acc: 0.7549
Epoch 17/20
 - 0s - loss: 0.9114 - acc: 0.7247 - val_loss: 1.0369 - val_acc: 0.6265
Epoch 18/20
 - 0s - loss: 0.7051 - acc: 0.7705 - val_loss: 1.2236 - val_acc: 0.5880
Epoch 19/20
 - 0s - loss: 0.9851 - acc: 0.6894 - val_loss: 0.9674 - val_acc: 0.6681
Epoch 20/20
 - 0s - loss: 0.7176 - acc: 0.7567 - val_loss: 0.9849 - val_acc: 0.6721
Test loss: 0.9839505820274353
Test accuracy: 0.673
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.9069 - acc: 0.3098 - val_loss: 1.2459 - val_acc: 0.6512
Epoch 2/20
 - 0s - loss: 0.7741 - acc: 0.8013 - val_loss: 1.0068 - val_acc: 0.6574
Epoch 3/20
 - 0s - loss: 0.5694 - acc: 0.8333 - val_loss: 0.6797 - val_acc: 0.7723
Epoch 4/20
 - 0s - loss: 0.3361 - acc: 0.9060 - val_loss: 0.6481 - val_acc: 0.7847
Epoch 5/20
 - 0s - loss: 0.2467 - acc: 0.9359 - val_loss: 0.6773 - val_acc: 0.7977
Epoch 6/20
 - 0s - loss: 0.1920 - acc: 0.9509 - val_loss: 0.6664 - val_acc: 0.7827
Epoch 7/20
 - 0s - loss: 0.1734 - acc: 0.9487 - val_loss: 0.7231 - val_acc: 0.7674
Epoch 8/20
 - 0s - loss: 0.1776 - acc: 0.9530 - val_loss: 0.5091 - val_acc: 0.8427
Epoch 9/20
 - 0s - loss: 0.0712 - acc: 0.9936 - val_loss: 0.5254 - val_acc: 0.8435
Epoch 10/20
 - 0s - loss: 0.0528 - acc: 0.9915 - val_loss: 0.5545 - val_acc: 0.8357
Epoch 11/20
 - 0s - loss: 0.0830 - acc: 0.9765 - val_loss: 0.5572 - val_acc: 0.8356
Epoch 12/20
 - 0s - loss: 0.0334 - acc: 0.9979 - val_loss: 0.5300 - val_acc: 0.8428
Epoch 13/20
 - 0s - loss: 0.0253 - acc: 0.9979 - val_loss: 0.6457 - val_acc: 0.8242
Epoch 14/20
 - 0s - loss: 0.0217 - acc: 1.0000 - val_loss: 0.5971 - val_acc: 0.8392
Epoch 15/20
 - 0s - loss: 0.0138 - acc: 1.0000 - val_loss: 0.6250 - val_acc: 0.8247
Epoch 16/20
 - 0s - loss: 0.0095 - acc: 1.0000 - val_loss: 0.5709 - val_acc: 0.8516
Epoch 17/20
 - 0s - loss: 0.0079 - acc: 1.0000 - val_loss: 0.5636 - val_acc: 0.8542
Epoch 18/20
 - 0s - loss: 0.0064 - acc: 1.0000 - val_loss: 0.5769 - val_acc: 0.8431
Epoch 19/20
 - 0s - loss: 0.0985 - acc: 0.9701 - val_loss: 1.0126 - val_acc: 0.7563
Epoch 20/20
 - 0s - loss: 0.1683 - acc: 0.9423 - val_loss: 0.5654 - val_acc: 0.8542
Test loss: 0.5653954795777798
Test accuracy: 0.8542
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.8067 - acc: 0.0833 - val_loss: 3.5835 - val_acc: 0.1538
Epoch 2/20
 - 0s - loss: 2.6633 - acc: 0.1923 - val_loss: 2.1330 - val_acc: 0.2509
Epoch 3/20
 - 0s - loss: 2.0935 - acc: 0.2821 - val_loss: 2.0575 - val_acc: 0.2351
Epoch 4/20
 - 0s - loss: 1.9329 - acc: 0.3697 - val_loss: 2.1923 - val_acc: 0.2289
Epoch 5/20
 - 0s - loss: 1.9472 - acc: 0.3248 - val_loss: 1.9500 - val_acc: 0.3065
Epoch 6/20
 - 0s - loss: 1.6370 - acc: 0.4701 - val_loss: 2.1367 - val_acc: 0.3346
Epoch 7/20
 - 0s - loss: 1.8750 - acc: 0.4316 - val_loss: 1.8008 - val_acc: 0.4217
Epoch 8/20
 - 0s - loss: 1.8316 - acc: 0.3889 - val_loss: 1.6633 - val_acc: 0.4309
Epoch 9/20
 - 0s - loss: 1.4147 - acc: 0.5598 - val_loss: 1.3930 - val_acc: 0.5755
Epoch 10/20
 - 0s - loss: 1.6323 - acc: 0.4765 - val_loss: 1.7464 - val_acc: 0.3197
Epoch 11/20
 - 0s - loss: 1.5414 - acc: 0.4658 - val_loss: 1.4176 - val_acc: 0.5463
Epoch 12/20
 - 0s - loss: 1.1296 - acc: 0.6581 - val_loss: 1.4624 - val_acc: 0.5083
Epoch 13/20
 - 0s - loss: 1.2310 - acc: 0.5940 - val_loss: 1.5330 - val_acc: 0.4911
Epoch 14/20
 - 0s - loss: 1.1532 - acc: 0.6346 - val_loss: 1.2492 - val_acc: 0.5881
Epoch 15/20
 - 0s - loss: 1.0489 - acc: 0.6774 - val_loss: 1.0537 - val_acc: 0.6715
Epoch 16/20
 - 0s - loss: 1.0210 - acc: 0.6774 - val_loss: 1.0397 - val_acc: 0.6706
Epoch 17/20
 - 0s - loss: 1.2465 - acc: 0.6004 - val_loss: 1.2911 - val_acc: 0.5451
Epoch 18/20
 - 0s - loss: 1.1661 - acc: 0.5962 - val_loss: 1.4682 - val_acc: 0.4991
Epoch 19/20
 - 0s - loss: 1.0234 - acc: 0.6795 - val_loss: 0.8327 - val_acc: 0.7350
Epoch 20/20
 - 0s - loss: 0.7194 - acc: 0.7863 - val_loss: 1.0201 - val_acc: 0.6171
Test loss: 1.020755204963684
Test accuracy: 0.6166
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1545 - acc: 0.1795 - val_loss: 1.7746 - val_acc: 0.4126
Epoch 2/20
 - 0s - loss: 1.3213 - acc: 0.6496 - val_loss: 1.2392 - val_acc: 0.6022
Epoch 3/20
 - 0s - loss: 0.7756 - acc: 0.8248 - val_loss: 1.2590 - val_acc: 0.6109
Epoch 4/20
 - 0s - loss: 0.6502 - acc: 0.7949 - val_loss: 1.0137 - val_acc: 0.6412
Epoch 5/20
 - 0s - loss: 0.4058 - acc: 0.9017 - val_loss: 0.8645 - val_acc: 0.7232
Epoch 6/20
 - 0s - loss: 0.2488 - acc: 0.9444 - val_loss: 0.8186 - val_acc: 0.7338
Epoch 7/20
 - 0s - loss: 0.1884 - acc: 0.9701 - val_loss: 0.7513 - val_acc: 0.7655
Epoch 8/20
 - 0s - loss: 0.1566 - acc: 0.9615 - val_loss: 0.8703 - val_acc: 0.7340
Epoch 9/20
 - 0s - loss: 0.2408 - acc: 0.9359 - val_loss: 0.9573 - val_acc: 0.7249
Epoch 10/20
 - 0s - loss: 0.1457 - acc: 0.9744 - val_loss: 0.7421 - val_acc: 0.7693
Epoch 11/20
 - 0s - loss: 0.0868 - acc: 0.9872 - val_loss: 0.7064 - val_acc: 0.7807
Epoch 12/20
 - 0s - loss: 0.0508 - acc: 1.0000 - val_loss: 0.7272 - val_acc: 0.7824
Epoch 13/20
 - 0s - loss: 0.0463 - acc: 1.0000 - val_loss: 0.7432 - val_acc: 0.7830
Epoch 14/20
 - 0s - loss: 0.0504 - acc: 0.9915 - val_loss: 0.7664 - val_acc: 0.7658
Epoch 15/20
 - 0s - loss: 0.0430 - acc: 0.9957 - val_loss: 0.7548 - val_acc: 0.7815
Epoch 16/20
 - 0s - loss: 0.0269 - acc: 1.0000 - val_loss: 0.8023 - val_acc: 0.7764
Epoch 17/20
 - 0s - loss: 0.0215 - acc: 0.9957 - val_loss: 0.7285 - val_acc: 0.7922
Epoch 18/20
 - 0s - loss: 0.0234 - acc: 1.0000 - val_loss: 0.7759 - val_acc: 0.7839
Epoch 19/20
 - 0s - loss: 0.0152 - acc: 1.0000 - val_loss: 0.7693 - val_acc: 0.7926
Epoch 20/20
 - 0s - loss: 0.0124 - acc: 1.0000 - val_loss: 0.7773 - val_acc: 0.7918
Test loss: 0.777260458624363
Test accuracy: 0.7918
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.7662 - acc: 0.1154 - val_loss: 5.1845 - val_acc: 0.1010
Epoch 2/20
 - 0s - loss: 4.8768 - acc: 0.1410 - val_loss: 3.1162 - val_acc: 0.1800
Epoch 3/20
 - 0s - loss: 2.8990 - acc: 0.2009 - val_loss: 2.2553 - val_acc: 0.1153
Epoch 4/20
 - 0s - loss: 2.2236 - acc: 0.1923 - val_loss: 2.1877 - val_acc: 0.2733
Epoch 5/20
 - 0s - loss: 2.1321 - acc: 0.2564 - val_loss: 1.9951 - val_acc: 0.3350
Epoch 6/20
 - 0s - loss: 1.8565 - acc: 0.4359 - val_loss: 1.9571 - val_acc: 0.3610
Epoch 7/20
 - 0s - loss: 1.8874 - acc: 0.3333 - val_loss: 2.0319 - val_acc: 0.3728
Epoch 8/20
 - 0s - loss: 1.9637 - acc: 0.4017 - val_loss: 1.8210 - val_acc: 0.4465
Epoch 9/20
 - 0s - loss: 1.7573 - acc: 0.4487 - val_loss: 2.0394 - val_acc: 0.2760
Epoch 10/20
 - 0s - loss: 1.8458 - acc: 0.3333 - val_loss: 2.2194 - val_acc: 0.2274
Epoch 11/20
 - 0s - loss: 2.0259 - acc: 0.2778 - val_loss: 1.9016 - val_acc: 0.3170
Epoch 12/20
 - 0s - loss: 1.7276 - acc: 0.4487 - val_loss: 1.5893 - val_acc: 0.5477
Epoch 13/20
 - 0s - loss: 1.4744 - acc: 0.5855 - val_loss: 1.8236 - val_acc: 0.4084
Epoch 14/20
 - 0s - loss: 1.6876 - acc: 0.4615 - val_loss: 1.9500 - val_acc: 0.3058
Epoch 15/20
 - 0s - loss: 1.6254 - acc: 0.4872 - val_loss: 1.4897 - val_acc: 0.5476
Epoch 16/20
 - 0s - loss: 1.2339 - acc: 0.6667 - val_loss: 2.2036 - val_acc: 0.2931
Epoch 17/20
 - 0s - loss: 2.0096 - acc: 0.3846 - val_loss: 1.5734 - val_acc: 0.4992
Epoch 18/20
 - 0s - loss: 1.3564 - acc: 0.5470 - val_loss: 1.4695 - val_acc: 0.5468
Epoch 19/20
 - 0s - loss: 1.2452 - acc: 0.5940 - val_loss: 1.5936 - val_acc: 0.5784
Epoch 20/20
 - 0s - loss: 1.3705 - acc: 0.5470 - val_loss: 1.8425 - val_acc: 0.3374
Test loss: 1.8424327125549316
Test accuracy: 0.3365
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3501 - acc: 0.0427 - val_loss: 2.0435 - val_acc: 0.3978
Epoch 2/20
 - 0s - loss: 1.5676 - acc: 0.5897 - val_loss: 1.6394 - val_acc: 0.4922
Epoch 3/20
 - 0s - loss: 1.1483 - acc: 0.7692 - val_loss: 1.8648 - val_acc: 0.3533
Epoch 4/20
 - 0s - loss: 0.9966 - acc: 0.6667 - val_loss: 1.5241 - val_acc: 0.5307
Epoch 5/20
 - 0s - loss: 0.8371 - acc: 0.7692 - val_loss: 1.1077 - val_acc: 0.6646
Epoch 6/20
 - 0s - loss: 0.4060 - acc: 0.9829 - val_loss: 1.0964 - val_acc: 0.6706
Epoch 7/20
 - 0s - loss: 0.3043 - acc: 0.9316 - val_loss: 1.0639 - val_acc: 0.6579
Epoch 8/20
 - 0s - loss: 0.2076 - acc: 0.9915 - val_loss: 1.0952 - val_acc: 0.6509
Epoch 9/20
 - 0s - loss: 0.1668 - acc: 0.9744 - val_loss: 1.0788 - val_acc: 0.6661
Epoch 10/20
 - 0s - loss: 0.2097 - acc: 0.9487 - val_loss: 1.2865 - val_acc: 0.5778
Epoch 11/20
 - 0s - loss: 0.2098 - acc: 0.9316 - val_loss: 1.1639 - val_acc: 0.6631
Epoch 12/20
 - 0s - loss: 0.2023 - acc: 0.9316 - val_loss: 0.9624 - val_acc: 0.6874
Epoch 13/20
 - 0s - loss: 0.0731 - acc: 1.0000 - val_loss: 0.9565 - val_acc: 0.7094
Epoch 14/20
 - 0s - loss: 0.0440 - acc: 1.0000 - val_loss: 0.9580 - val_acc: 0.7118
Epoch 15/20
 - 0s - loss: 0.0480 - acc: 1.0000 - val_loss: 0.9595 - val_acc: 0.7149
Epoch 16/20
 - 0s - loss: 0.0396 - acc: 1.0000 - val_loss: 0.9648 - val_acc: 0.7130
Epoch 17/20
 - 0s - loss: 0.0336 - acc: 1.0000 - val_loss: 0.9701 - val_acc: 0.7105
Epoch 18/20
 - 0s - loss: 0.0282 - acc: 1.0000 - val_loss: 0.9611 - val_acc: 0.7163
Epoch 19/20
 - 0s - loss: 0.0259 - acc: 1.0000 - val_loss: 0.9874 - val_acc: 0.7146
Epoch 20/20
 - 0s - loss: 0.0192 - acc: 1.0000 - val_loss: 0.9845 - val_acc: 0.7153
Test loss: 0.984498837184906
Test accuracy: 0.7153
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5287 - acc: 0.1368 - val_loss: 8.6852 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 7.8446 - acc: 0.1282 - val_loss: 7.5998 - val_acc: 0.1135
Epoch 3/20
 - 0s - loss: 7.2227 - acc: 0.1538 - val_loss: 5.6061 - val_acc: 0.1019
Epoch 4/20
 - 0s - loss: 6.1713 - acc: 0.1111 - val_loss: 3.0969 - val_acc: 0.0958
Epoch 5/20
 - 0s - loss: 3.2285 - acc: 0.1709 - val_loss: 2.3788 - val_acc: 0.1019
Epoch 6/20
 - 0s - loss: 2.4479 - acc: 0.1709 - val_loss: 2.2705 - val_acc: 0.1135
Epoch 7/20
 - 0s - loss: 2.1203 - acc: 0.2308 - val_loss: 2.1384 - val_acc: 0.2377
Epoch 8/20
 - 0s - loss: 2.0963 - acc: 0.2479 - val_loss: 2.2075 - val_acc: 0.1278
Epoch 9/20
 - 0s - loss: 2.0537 - acc: 0.2308 - val_loss: 2.1063 - val_acc: 0.3623
Epoch 10/20
 - 0s - loss: 2.0375 - acc: 0.2564 - val_loss: 2.1325 - val_acc: 0.1840
Epoch 11/20
 - 0s - loss: 1.9670 - acc: 0.2906 - val_loss: 2.0450 - val_acc: 0.2915
Epoch 12/20
 - 0s - loss: 1.9016 - acc: 0.3504 - val_loss: 2.1878 - val_acc: 0.2051
Epoch 13/20
 - 0s - loss: 2.0001 - acc: 0.2906 - val_loss: 2.0688 - val_acc: 0.3362
Epoch 14/20
 - 0s - loss: 1.9057 - acc: 0.3675 - val_loss: 1.9428 - val_acc: 0.3155
Epoch 15/20
 - 0s - loss: 1.7377 - acc: 0.4359 - val_loss: 1.8995 - val_acc: 0.3674
Epoch 16/20
 - 0s - loss: 1.7107 - acc: 0.4957 - val_loss: 1.8969 - val_acc: 0.3345
Epoch 17/20
 - 0s - loss: 1.6439 - acc: 0.4786 - val_loss: 1.9698 - val_acc: 0.2948
Epoch 18/20
 - 0s - loss: 1.7386 - acc: 0.3248 - val_loss: 1.9034 - val_acc: 0.2930
Epoch 19/20
 - 0s - loss: 1.6084 - acc: 0.4615 - val_loss: 1.8843 - val_acc: 0.4117
Epoch 20/20
 - 0s - loss: 1.5387 - acc: 0.5214 - val_loss: 1.8761 - val_acc: 0.2888
Test loss: 1.876188911819458
Test accuracy: 0.2878
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2468 - acc: 0.9247 - val_loss: 0.0988 - val_acc: 0.9683
Epoch 2/20
 - 2s - loss: 0.1016 - acc: 0.9694 - val_loss: 0.0905 - val_acc: 0.9735
Epoch 3/20
 - 2s - loss: 0.0739 - acc: 0.9774 - val_loss: 0.0942 - val_acc: 0.9722
Epoch 4/20
 - 2s - loss: 0.0598 - acc: 0.9816 - val_loss: 0.0729 - val_acc: 0.9800
Epoch 5/20
 - 2s - loss: 0.0507 - acc: 0.9845 - val_loss: 0.0657 - val_acc: 0.9832
Epoch 6/20
 - 2s - loss: 0.0438 - acc: 0.9872 - val_loss: 0.0709 - val_acc: 0.9823
Epoch 7/20
 - 2s - loss: 0.0393 - acc: 0.9885 - val_loss: 0.0802 - val_acc: 0.9798
Epoch 8/20
 - 2s - loss: 0.0342 - acc: 0.9899 - val_loss: 0.0861 - val_acc: 0.9811
Epoch 9/20
 - 2s - loss: 0.0306 - acc: 0.9912 - val_loss: 0.0821 - val_acc: 0.9831
Epoch 10/20
 - 2s - loss: 0.0282 - acc: 0.9914 - val_loss: 0.0904 - val_acc: 0.9818
Epoch 11/20
 - 2s - loss: 0.0283 - acc: 0.9922 - val_loss: 0.0886 - val_acc: 0.9841
Epoch 12/20
 - 2s - loss: 0.0245 - acc: 0.9933 - val_loss: 0.0905 - val_acc: 0.9831
Epoch 13/20
 - 2s - loss: 0.0241 - acc: 0.9936 - val_loss: 0.0920 - val_acc: 0.9827
Epoch 14/20
 - 2s - loss: 0.0227 - acc: 0.9936 - val_loss: 0.0995 - val_acc: 0.9836
Epoch 15/20
 - 2s - loss: 0.0232 - acc: 0.9935 - val_loss: 0.0995 - val_acc: 0.9841
Epoch 16/20
 - 2s - loss: 0.0206 - acc: 0.9944 - val_loss: 0.1008 - val_acc: 0.9846
Epoch 17/20
 - 2s - loss: 0.0186 - acc: 0.9947 - val_loss: 0.1096 - val_acc: 0.9826
Epoch 18/20
 - 2s - loss: 0.0187 - acc: 0.9954 - val_loss: 0.1029 - val_acc: 0.9839
Epoch 19/20
 - 2s - loss: 0.0184 - acc: 0.9951 - val_loss: 0.1153 - val_acc: 0.9836
Epoch 20/20
 - 2s - loss: 0.0175 - acc: 0.9953 - val_loss: 0.1086 - val_acc: 0.9836
Test loss: 0.1085663279925959
Test accuracy: 0.9836
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9356 - acc: 0.6991 - val_loss: 0.5080 - val_acc: 0.8373
Epoch 2/20
 - 4s - loss: 0.4339 - acc: 0.8604 - val_loss: 0.2099 - val_acc: 0.9368
Epoch 3/20
 - 4s - loss: 0.3249 - acc: 0.8971 - val_loss: 0.2948 - val_acc: 0.9030
Epoch 4/20
 - 4s - loss: 0.2703 - acc: 0.9163 - val_loss: 0.2192 - val_acc: 0.9325
Epoch 5/20
 - 4s - loss: 0.2346 - acc: 0.9269 - val_loss: 0.1371 - val_acc: 0.9561
Epoch 6/20
 - 4s - loss: 0.2149 - acc: 0.9334 - val_loss: 0.1540 - val_acc: 0.9499
Epoch 7/20
 - 4s - loss: 0.2020 - acc: 0.9384 - val_loss: 0.1438 - val_acc: 0.9541
Epoch 8/20
 - 4s - loss: 0.1926 - acc: 0.9414 - val_loss: 0.1356 - val_acc: 0.9596
Epoch 9/20
 - 4s - loss: 0.1864 - acc: 0.9444 - val_loss: 0.2486 - val_acc: 0.9222
Epoch 10/20
 - 4s - loss: 0.1742 - acc: 0.9472 - val_loss: 0.1847 - val_acc: 0.9454
Epoch 11/20
 - 4s - loss: 0.1755 - acc: 0.9468 - val_loss: 0.1204 - val_acc: 0.9638
Epoch 12/20
 - 4s - loss: 0.1707 - acc: 0.9488 - val_loss: 0.1404 - val_acc: 0.9586
Epoch 13/20
 - 4s - loss: 0.1670 - acc: 0.9502 - val_loss: 0.1451 - val_acc: 0.9564
Epoch 14/20
 - 4s - loss: 0.1676 - acc: 0.9514 - val_loss: 0.1333 - val_acc: 0.9619
Epoch 15/20
 - 4s - loss: 0.1678 - acc: 0.9515 - val_loss: 0.1082 - val_acc: 0.9666
Epoch 16/20
 - 4s - loss: 0.1651 - acc: 0.9535 - val_loss: 0.1122 - val_acc: 0.9671
Epoch 17/20
 - 4s - loss: 0.1652 - acc: 0.9532 - val_loss: 0.1258 - val_acc: 0.9626
Epoch 18/20
 - 4s - loss: 0.1674 - acc: 0.9522 - val_loss: 0.1313 - val_acc: 0.9624
Epoch 19/20
 - 4s - loss: 0.1624 - acc: 0.9537 - val_loss: 0.1238 - val_acc: 0.9663
Epoch 20/20
 - 4s - loss: 0.1615 - acc: 0.9542 - val_loss: 0.1821 - val_acc: 0.9530
Test loss: 0.18231662020294898
Test accuracy: 0.9527
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3349 - acc: 0.8945 - val_loss: 0.1761 - val_acc: 0.9440
Epoch 2/20
 - 1s - loss: 0.1349 - acc: 0.9575 - val_loss: 0.1233 - val_acc: 0.9605
Epoch 3/20
 - 1s - loss: 0.0887 - acc: 0.9715 - val_loss: 0.1071 - val_acc: 0.9683
Epoch 4/20
 - 1s - loss: 0.0667 - acc: 0.9792 - val_loss: 0.1033 - val_acc: 0.9709
Epoch 5/20
 - 1s - loss: 0.0538 - acc: 0.9840 - val_loss: 0.0934 - val_acc: 0.9745
Epoch 6/20
 - 1s - loss: 0.0443 - acc: 0.9858 - val_loss: 0.0965 - val_acc: 0.9754
Epoch 7/20
 - 1s - loss: 0.0346 - acc: 0.9893 - val_loss: 0.0965 - val_acc: 0.9752
Epoch 8/20
 - 1s - loss: 0.0318 - acc: 0.9899 - val_loss: 0.1053 - val_acc: 0.9761
Epoch 9/20
 - 1s - loss: 0.0287 - acc: 0.9910 - val_loss: 0.1170 - val_acc: 0.9736
Epoch 10/20
 - 1s - loss: 0.0228 - acc: 0.9927 - val_loss: 0.1432 - val_acc: 0.9732
Epoch 11/20
 - 1s - loss: 0.0226 - acc: 0.9926 - val_loss: 0.1130 - val_acc: 0.9787
Epoch 12/20
 - 1s - loss: 0.0192 - acc: 0.9942 - val_loss: 0.1104 - val_acc: 0.9795
Epoch 13/20
 - 1s - loss: 0.0177 - acc: 0.9942 - val_loss: 0.1301 - val_acc: 0.9782
Epoch 14/20
 - 1s - loss: 0.0168 - acc: 0.9948 - val_loss: 0.1219 - val_acc: 0.9779
Epoch 15/20
 - 1s - loss: 0.0192 - acc: 0.9943 - val_loss: 0.1263 - val_acc: 0.9773
Epoch 16/20
 - 1s - loss: 0.0166 - acc: 0.9954 - val_loss: 0.1368 - val_acc: 0.9774
Epoch 17/20
 - 1s - loss: 0.0148 - acc: 0.9954 - val_loss: 0.1363 - val_acc: 0.9776
Epoch 18/20
 - 1s - loss: 0.0135 - acc: 0.9959 - val_loss: 0.1254 - val_acc: 0.9800
Epoch 19/20
 - 1s - loss: 0.0119 - acc: 0.9964 - val_loss: 0.1459 - val_acc: 0.9779
Epoch 20/20
 - 1s - loss: 0.0141 - acc: 0.9964 - val_loss: 0.1481 - val_acc: 0.9779
Test loss: 0.14812662880694497
Test accuracy: 0.9779
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2711 - acc: 0.5939 - val_loss: 0.7273 - val_acc: 0.7454
Epoch 2/20
 - 2s - loss: 0.6314 - acc: 0.7950 - val_loss: 1.1278 - val_acc: 0.6754
Epoch 3/20
 - 2s - loss: 0.4762 - acc: 0.8481 - val_loss: 0.2902 - val_acc: 0.9098
Epoch 4/20
 - 2s - loss: 0.3935 - acc: 0.8769 - val_loss: 0.3788 - val_acc: 0.8812
Epoch 5/20
 - 2s - loss: 0.3337 - acc: 0.8951 - val_loss: 0.3042 - val_acc: 0.9067
Epoch 6/20
 - 2s - loss: 0.2957 - acc: 0.9061 - val_loss: 0.3347 - val_acc: 0.8845
Epoch 7/20
 - 2s - loss: 0.2701 - acc: 0.9153 - val_loss: 0.2328 - val_acc: 0.9266
Epoch 8/20
 - 2s - loss: 0.2437 - acc: 0.9213 - val_loss: 0.2248 - val_acc: 0.9305
Epoch 9/20
 - 2s - loss: 0.2331 - acc: 0.9285 - val_loss: 0.1892 - val_acc: 0.9366
Epoch 10/20
 - 2s - loss: 0.2136 - acc: 0.9339 - val_loss: 0.1802 - val_acc: 0.9454
Epoch 11/20
 - 2s - loss: 0.2009 - acc: 0.9373 - val_loss: 0.2295 - val_acc: 0.9298
Epoch 12/20
 - 2s - loss: 0.1888 - acc: 0.9395 - val_loss: 0.1651 - val_acc: 0.9507
Epoch 13/20
 - 2s - loss: 0.1857 - acc: 0.9421 - val_loss: 0.2479 - val_acc: 0.9240
Epoch 14/20
 - 2s - loss: 0.1801 - acc: 0.9433 - val_loss: 0.2016 - val_acc: 0.9418
Epoch 15/20
 - 2s - loss: 0.1726 - acc: 0.9483 - val_loss: 0.1289 - val_acc: 0.9603
Epoch 16/20
 - 2s - loss: 0.1651 - acc: 0.9477 - val_loss: 0.2072 - val_acc: 0.9395
Epoch 17/20
 - 2s - loss: 0.1626 - acc: 0.9498 - val_loss: 0.2581 - val_acc: 0.9289
Epoch 18/20
 - 2s - loss: 0.1618 - acc: 0.9498 - val_loss: 0.1693 - val_acc: 0.9459
Epoch 19/20
 - 2s - loss: 0.1550 - acc: 0.9518 - val_loss: 0.1968 - val_acc: 0.9435
Epoch 20/20
 - 2s - loss: 0.1478 - acc: 0.9542 - val_loss: 0.1343 - val_acc: 0.9620
Test loss: 0.13402881953595205
Test accuracy: 0.9615
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4489 - acc: 0.8595 - val_loss: 0.2016 - val_acc: 0.9386
Epoch 2/20
 - 1s - loss: 0.1874 - acc: 0.9422 - val_loss: 0.1562 - val_acc: 0.9522
Epoch 3/20
 - 1s - loss: 0.1184 - acc: 0.9634 - val_loss: 0.1320 - val_acc: 0.9608
Epoch 4/20
 - 1s - loss: 0.0853 - acc: 0.9728 - val_loss: 0.1376 - val_acc: 0.9586
Epoch 5/20
 - 1s - loss: 0.0625 - acc: 0.9801 - val_loss: 0.1347 - val_acc: 0.9625
Epoch 6/20
 - 1s - loss: 0.0477 - acc: 0.9843 - val_loss: 0.1370 - val_acc: 0.9660
Epoch 7/20
 - 1s - loss: 0.0378 - acc: 0.9875 - val_loss: 0.1493 - val_acc: 0.9636
Epoch 8/20
 - 1s - loss: 0.0296 - acc: 0.9901 - val_loss: 0.1411 - val_acc: 0.9681
Epoch 9/20
 - 1s - loss: 0.0255 - acc: 0.9913 - val_loss: 0.1333 - val_acc: 0.9702
Epoch 10/20
 - 1s - loss: 0.0221 - acc: 0.9923 - val_loss: 0.1907 - val_acc: 0.9577
Epoch 11/20
 - 1s - loss: 0.0198 - acc: 0.9931 - val_loss: 0.1374 - val_acc: 0.9704
Epoch 12/20
 - 1s - loss: 0.0173 - acc: 0.9945 - val_loss: 0.2124 - val_acc: 0.9599
Epoch 13/20
 - 1s - loss: 0.0171 - acc: 0.9946 - val_loss: 0.1714 - val_acc: 0.9670
Epoch 14/20
 - 1s - loss: 0.0142 - acc: 0.9953 - val_loss: 0.1542 - val_acc: 0.9709
Epoch 15/20
 - 1s - loss: 0.0109 - acc: 0.9964 - val_loss: 0.1764 - val_acc: 0.9690
Epoch 16/20
 - 1s - loss: 0.0164 - acc: 0.9947 - val_loss: 0.1775 - val_acc: 0.9702
Epoch 17/20
 - 1s - loss: 0.0107 - acc: 0.9965 - val_loss: 0.1970 - val_acc: 0.9660
Epoch 18/20
 - 1s - loss: 0.0133 - acc: 0.9957 - val_loss: 0.1800 - val_acc: 0.9708
Epoch 19/20
 - 1s - loss: 0.0108 - acc: 0.9971 - val_loss: 0.1752 - val_acc: 0.9710
Epoch 20/20
 - 1s - loss: 0.0092 - acc: 0.9971 - val_loss: 0.1907 - val_acc: 0.9701
Test loss: 0.1906842655396868
Test accuracy: 0.9701
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6547 - acc: 0.4785 - val_loss: 1.2680 - val_acc: 0.5852
Epoch 2/20
 - 1s - loss: 0.8395 - acc: 0.7215 - val_loss: 0.9571 - val_acc: 0.7110
Epoch 3/20
 - 1s - loss: 0.6587 - acc: 0.7883 - val_loss: 0.4529 - val_acc: 0.8445
Epoch 4/20
 - 1s - loss: 0.5411 - acc: 0.8246 - val_loss: 1.3181 - val_acc: 0.6224
Epoch 5/20
 - 1s - loss: 0.4815 - acc: 0.8481 - val_loss: 0.5679 - val_acc: 0.8104
Epoch 6/20
 - 1s - loss: 0.4265 - acc: 0.8660 - val_loss: 0.3245 - val_acc: 0.9087
Epoch 7/20
 - 1s - loss: 0.3811 - acc: 0.8777 - val_loss: 0.3047 - val_acc: 0.9038
Epoch 8/20
 - 1s - loss: 0.3340 - acc: 0.8962 - val_loss: 0.4779 - val_acc: 0.8488
Epoch 9/20
 - 1s - loss: 0.3281 - acc: 0.8952 - val_loss: 0.3856 - val_acc: 0.8683
Epoch 10/20
 - 1s - loss: 0.3036 - acc: 0.9056 - val_loss: 0.2968 - val_acc: 0.9104
Epoch 11/20
 - 1s - loss: 0.2828 - acc: 0.9129 - val_loss: 0.1894 - val_acc: 0.9422
Epoch 12/20
 - 1s - loss: 0.2604 - acc: 0.9175 - val_loss: 0.1944 - val_acc: 0.9382
Epoch 13/20
 - 1s - loss: 0.2475 - acc: 0.9224 - val_loss: 0.2931 - val_acc: 0.9093
Epoch 14/20
 - 1s - loss: 0.2308 - acc: 0.9280 - val_loss: 0.3954 - val_acc: 0.8786
Epoch 15/20
 - 1s - loss: 0.2148 - acc: 0.9323 - val_loss: 0.2121 - val_acc: 0.9363
Epoch 16/20
 - 1s - loss: 0.2155 - acc: 0.9303 - val_loss: 0.4928 - val_acc: 0.8580
Epoch 17/20
 - 1s - loss: 0.2148 - acc: 0.9329 - val_loss: 0.3042 - val_acc: 0.9118
Epoch 18/20
 - 1s - loss: 0.1902 - acc: 0.9422 - val_loss: 0.2588 - val_acc: 0.9240
Epoch 19/20
 - 1s - loss: 0.1890 - acc: 0.9397 - val_loss: 0.3451 - val_acc: 0.8971
Epoch 20/20
 - 1s - loss: 0.1811 - acc: 0.9407 - val_loss: 0.3439 - val_acc: 0.8923
Test loss: 0.3446132090136409
Test accuracy: 0.8929
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6019 - acc: 0.8120 - val_loss: 0.3535 - val_acc: 0.8941
Epoch 2/20
 - 0s - loss: 0.2469 - acc: 0.9256 - val_loss: 0.2318 - val_acc: 0.9284
Epoch 3/20
 - 0s - loss: 0.1615 - acc: 0.9501 - val_loss: 0.1882 - val_acc: 0.9405
Epoch 4/20
 - 0s - loss: 0.1108 - acc: 0.9655 - val_loss: 0.1857 - val_acc: 0.9457
Epoch 5/20
 - 0s - loss: 0.0879 - acc: 0.9747 - val_loss: 0.1823 - val_acc: 0.9468
Epoch 6/20
 - 0s - loss: 0.0582 - acc: 0.9823 - val_loss: 0.1983 - val_acc: 0.9471
Epoch 7/20
 - 0s - loss: 0.0495 - acc: 0.9825 - val_loss: 0.1873 - val_acc: 0.9502
Epoch 8/20
 - 0s - loss: 0.0399 - acc: 0.9873 - val_loss: 0.2202 - val_acc: 0.9393
Epoch 9/20
 - 0s - loss: 0.0268 - acc: 0.9916 - val_loss: 0.2074 - val_acc: 0.9492
Epoch 10/20
 - 0s - loss: 0.0192 - acc: 0.9947 - val_loss: 0.1956 - val_acc: 0.9546
Epoch 11/20
 - 0s - loss: 0.0154 - acc: 0.9944 - val_loss: 0.2193 - val_acc: 0.9518
Epoch 12/20
 - 0s - loss: 0.0160 - acc: 0.9953 - val_loss: 0.2202 - val_acc: 0.9544
Epoch 13/20
 - 0s - loss: 0.0101 - acc: 0.9967 - val_loss: 0.2398 - val_acc: 0.9504
Epoch 14/20
 - 0s - loss: 0.0120 - acc: 0.9964 - val_loss: 0.2335 - val_acc: 0.9548
Epoch 15/20
 - 0s - loss: 0.0089 - acc: 0.9959 - val_loss: 0.2398 - val_acc: 0.9541
Epoch 16/20
 - 0s - loss: 0.0098 - acc: 0.9968 - val_loss: 0.2330 - val_acc: 0.9546
Epoch 17/20
 - 0s - loss: 0.0095 - acc: 0.9968 - val_loss: 0.2390 - val_acc: 0.9583
Epoch 18/20
 - 0s - loss: 0.0068 - acc: 0.9980 - val_loss: 0.2549 - val_acc: 0.9554
Epoch 19/20
 - 0s - loss: 0.0070 - acc: 0.9975 - val_loss: 0.3442 - val_acc: 0.9439
Epoch 20/20
 - 0s - loss: 0.0101 - acc: 0.9975 - val_loss: 0.2743 - val_acc: 0.9544
Test loss: 0.274270956930132
Test accuracy: 0.9544
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0471 - acc: 0.3716 - val_loss: 1.4047 - val_acc: 0.5197
Epoch 2/20
 - 1s - loss: 1.1204 - acc: 0.6241 - val_loss: 0.9108 - val_acc: 0.7230
Epoch 3/20
 - 1s - loss: 0.8908 - acc: 0.7069 - val_loss: 1.2145 - val_acc: 0.6041
Epoch 4/20
 - 1s - loss: 0.7274 - acc: 0.7644 - val_loss: 0.6040 - val_acc: 0.8059
Epoch 5/20
 - 1s - loss: 0.6658 - acc: 0.7777 - val_loss: 0.5175 - val_acc: 0.8212
Epoch 6/20
 - 1s - loss: 0.5920 - acc: 0.8063 - val_loss: 0.4251 - val_acc: 0.8700
Epoch 7/20
 - 1s - loss: 0.5280 - acc: 0.8327 - val_loss: 0.5532 - val_acc: 0.8193
Epoch 8/20
 - 1s - loss: 0.5018 - acc: 0.8363 - val_loss: 0.3974 - val_acc: 0.8712
Epoch 9/20
 - 1s - loss: 0.4603 - acc: 0.8515 - val_loss: 0.3864 - val_acc: 0.8735
Epoch 10/20
 - 1s - loss: 0.4144 - acc: 0.8641 - val_loss: 0.3879 - val_acc: 0.8734
Epoch 11/20
 - 1s - loss: 0.4159 - acc: 0.8715 - val_loss: 0.5157 - val_acc: 0.8364
Epoch 12/20
 - 1s - loss: 0.3852 - acc: 0.8772 - val_loss: 0.3141 - val_acc: 0.8954
Epoch 13/20
 - 1s - loss: 0.3482 - acc: 0.8877 - val_loss: 0.4606 - val_acc: 0.8572
Epoch 14/20
 - 1s - loss: 0.3512 - acc: 0.8891 - val_loss: 0.2726 - val_acc: 0.9087
Epoch 15/20
 - 1s - loss: 0.3198 - acc: 0.8963 - val_loss: 0.4010 - val_acc: 0.8810
Epoch 16/20
 - 1s - loss: 0.2937 - acc: 0.9073 - val_loss: 0.3882 - val_acc: 0.8804
Epoch 17/20
 - 1s - loss: 0.2888 - acc: 0.9105 - val_loss: 0.5375 - val_acc: 0.8397
Epoch 18/20
 - 1s - loss: 0.2920 - acc: 0.9080 - val_loss: 0.2918 - val_acc: 0.9050
Epoch 19/20
 - 1s - loss: 0.2646 - acc: 0.9155 - val_loss: 0.2945 - val_acc: 0.9105
Epoch 20/20
 - 1s - loss: 0.2458 - acc: 0.9208 - val_loss: 0.2572 - val_acc: 0.9198
Test loss: 0.25688753905296324
Test accuracy: 0.9203
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.8311 - acc: 0.7344 - val_loss: 0.4391 - val_acc: 0.8626
Epoch 2/20
 - 0s - loss: 0.3333 - acc: 0.8981 - val_loss: 0.3977 - val_acc: 0.8738
Epoch 3/20
 - 0s - loss: 0.2277 - acc: 0.9307 - val_loss: 0.2553 - val_acc: 0.9212
Epoch 4/20
 - 0s - loss: 0.1591 - acc: 0.9552 - val_loss: 0.2937 - val_acc: 0.9089
Epoch 5/20
 - 0s - loss: 0.1203 - acc: 0.9677 - val_loss: 0.3092 - val_acc: 0.9014
Epoch 6/20
 - 0s - loss: 0.0826 - acc: 0.9731 - val_loss: 0.2599 - val_acc: 0.9239
Epoch 7/20
 - 0s - loss: 0.0734 - acc: 0.9768 - val_loss: 0.2194 - val_acc: 0.9337
Epoch 8/20
 - 0s - loss: 0.0504 - acc: 0.9843 - val_loss: 0.2304 - val_acc: 0.9352
Epoch 9/20
 - 0s - loss: 0.0404 - acc: 0.9883 - val_loss: 0.2624 - val_acc: 0.9282
Epoch 10/20
 - 0s - loss: 0.0298 - acc: 0.9907 - val_loss: 0.2664 - val_acc: 0.9290
Epoch 11/20
 - 0s - loss: 0.0235 - acc: 0.9925 - val_loss: 0.2202 - val_acc: 0.9443
Epoch 12/20
 - 0s - loss: 0.0204 - acc: 0.9939 - val_loss: 0.2514 - val_acc: 0.9387
Epoch 13/20
 - 0s - loss: 0.0139 - acc: 0.9952 - val_loss: 0.2950 - val_acc: 0.9314
Epoch 14/20
 - 0s - loss: 0.0188 - acc: 0.9936 - val_loss: 0.2972 - val_acc: 0.9323
Epoch 15/20
 - 0s - loss: 0.0069 - acc: 0.9987 - val_loss: 0.3005 - val_acc: 0.9351
Epoch 16/20
 - 0s - loss: 0.0156 - acc: 0.9955 - val_loss: 0.2884 - val_acc: 0.9366
Epoch 17/20
 - 0s - loss: 0.0102 - acc: 0.9973 - val_loss: 0.2980 - val_acc: 0.9377
Epoch 18/20
 - 0s - loss: 0.0093 - acc: 0.9963 - val_loss: 0.3204 - val_acc: 0.9374
Epoch 19/20
 - 0s - loss: 0.0051 - acc: 0.9981 - val_loss: 0.4599 - val_acc: 0.9152
Epoch 20/20
 - 0s - loss: 0.0055 - acc: 0.9981 - val_loss: 0.2989 - val_acc: 0.9430
Test loss: 0.2989137623365583
Test accuracy: 0.943
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5701 - acc: 0.2571 - val_loss: 1.8884 - val_acc: 0.4626
Epoch 2/20
 - 1s - loss: 1.6400 - acc: 0.4555 - val_loss: 1.0410 - val_acc: 0.6837
Epoch 3/20
 - 1s - loss: 1.2212 - acc: 0.6005 - val_loss: 1.4078 - val_acc: 0.5449
Epoch 4/20
 - 1s - loss: 1.0320 - acc: 0.6539 - val_loss: 1.3665 - val_acc: 0.5518
Epoch 5/20
 - 1s - loss: 0.9540 - acc: 0.6805 - val_loss: 0.9044 - val_acc: 0.6835
Epoch 6/20
 - 1s - loss: 0.8630 - acc: 0.7112 - val_loss: 0.8731 - val_acc: 0.6857
Epoch 7/20
 - 1s - loss: 0.7522 - acc: 0.7477 - val_loss: 0.5819 - val_acc: 0.7978
Epoch 8/20
 - 1s - loss: 0.7444 - acc: 0.7557 - val_loss: 0.9014 - val_acc: 0.7174
Epoch 9/20
 - 1s - loss: 0.6677 - acc: 0.7787 - val_loss: 1.0092 - val_acc: 0.6798
Epoch 10/20
 - 1s - loss: 0.6683 - acc: 0.7827 - val_loss: 0.5220 - val_acc: 0.8199
Epoch 11/20
 - 1s - loss: 0.6207 - acc: 0.7933 - val_loss: 0.5206 - val_acc: 0.8340
Epoch 12/20
 - 1s - loss: 0.5879 - acc: 0.8104 - val_loss: 0.5252 - val_acc: 0.8265
Epoch 13/20
 - 1s - loss: 0.5114 - acc: 0.8376 - val_loss: 0.7313 - val_acc: 0.7726
Epoch 14/20
 - 1s - loss: 0.5056 - acc: 0.8400 - val_loss: 0.8072 - val_acc: 0.7484
Epoch 15/20
 - 1s - loss: 0.5120 - acc: 0.8357 - val_loss: 0.4909 - val_acc: 0.8469
Epoch 16/20
 - 1s - loss: 0.4828 - acc: 0.8427 - val_loss: 0.6000 - val_acc: 0.8042
Epoch 17/20
 - 1s - loss: 0.4375 - acc: 0.8541 - val_loss: 0.4038 - val_acc: 0.8641
Epoch 18/20
 - 1s - loss: 0.4283 - acc: 0.8640 - val_loss: 1.2646 - val_acc: 0.5946
Epoch 19/20
 - 1s - loss: 0.4484 - acc: 0.8531 - val_loss: 0.7573 - val_acc: 0.7697
Epoch 20/20
 - 1s - loss: 0.4056 - acc: 0.8717 - val_loss: 0.4168 - val_acc: 0.8633
Test loss: 0.4174587535917759
Test accuracy: 0.8608
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1541 - acc: 0.6224 - val_loss: 0.5541 - val_acc: 0.8324
Epoch 2/20
 - 0s - loss: 0.4388 - acc: 0.8677 - val_loss: 0.4128 - val_acc: 0.8772
Epoch 3/20
 - 0s - loss: 0.3249 - acc: 0.9051 - val_loss: 0.3714 - val_acc: 0.8850
Epoch 4/20
 - 0s - loss: 0.2471 - acc: 0.9307 - val_loss: 0.4740 - val_acc: 0.8488
Epoch 5/20
 - 0s - loss: 0.1814 - acc: 0.9472 - val_loss: 0.3051 - val_acc: 0.9070
Epoch 6/20
 - 0s - loss: 0.1384 - acc: 0.9637 - val_loss: 0.3092 - val_acc: 0.9071
Epoch 7/20
 - 0s - loss: 0.1120 - acc: 0.9669 - val_loss: 0.2876 - val_acc: 0.9131
Epoch 8/20
 - 0s - loss: 0.0835 - acc: 0.9776 - val_loss: 0.3848 - val_acc: 0.8882
Epoch 9/20
 - 0s - loss: 0.0753 - acc: 0.9771 - val_loss: 0.2984 - val_acc: 0.9150
Epoch 10/20
 - 0s - loss: 0.0427 - acc: 0.9920 - val_loss: 0.2899 - val_acc: 0.9204
Epoch 11/20
 - 0s - loss: 0.0244 - acc: 0.9963 - val_loss: 0.3312 - val_acc: 0.9093
Epoch 12/20
 - 0s - loss: 0.0607 - acc: 0.9835 - val_loss: 0.2966 - val_acc: 0.9200
Epoch 13/20
 - 0s - loss: 0.0114 - acc: 0.9995 - val_loss: 0.3069 - val_acc: 0.9247
Epoch 14/20
 - 0s - loss: 0.0436 - acc: 0.9872 - val_loss: 0.3093 - val_acc: 0.9206
Epoch 15/20
 - 0s - loss: 0.0084 - acc: 0.9989 - val_loss: 0.3036 - val_acc: 0.9257
Epoch 16/20
 - 0s - loss: 0.0102 - acc: 0.9984 - val_loss: 0.5098 - val_acc: 0.8793
Epoch 17/20
 - 0s - loss: 0.0447 - acc: 0.9888 - val_loss: 0.3528 - val_acc: 0.9182
Epoch 18/20
 - 0s - loss: 0.0043 - acc: 1.0000 - val_loss: 0.3418 - val_acc: 0.9224
Epoch 19/20
 - 0s - loss: 0.0020 - acc: 1.0000 - val_loss: 0.3541 - val_acc: 0.9231
Epoch 20/20
 - 0s - loss: 0.0146 - acc: 0.9957 - val_loss: 0.3901 - val_acc: 0.9191
Test loss: 0.3901103273138171
Test accuracy: 0.9191
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2875 - acc: 0.2005 - val_loss: 1.9627 - val_acc: 0.2477
Epoch 2/20
 - 1s - loss: 1.9687 - acc: 0.3045 - val_loss: 1.7745 - val_acc: 0.5004
Epoch 3/20
 - 1s - loss: 1.6938 - acc: 0.4389 - val_loss: 1.5609 - val_acc: 0.4705
Epoch 4/20
 - 1s - loss: 1.5256 - acc: 0.5317 - val_loss: 1.3768 - val_acc: 0.4825
Epoch 5/20
 - 1s - loss: 1.2908 - acc: 0.5840 - val_loss: 1.5950 - val_acc: 0.3779
Epoch 6/20
 - 1s - loss: 1.1315 - acc: 0.6427 - val_loss: 0.9654 - val_acc: 0.6547
Epoch 7/20
 - 1s - loss: 1.0840 - acc: 0.6389 - val_loss: 1.1066 - val_acc: 0.6138
Epoch 8/20
 - 1s - loss: 0.9917 - acc: 0.6885 - val_loss: 1.3230 - val_acc: 0.5791
Epoch 9/20
 - 1s - loss: 0.8985 - acc: 0.6949 - val_loss: 1.0248 - val_acc: 0.6456
Epoch 10/20
 - 1s - loss: 0.8277 - acc: 0.7291 - val_loss: 0.6399 - val_acc: 0.7895
Epoch 11/20
 - 1s - loss: 0.8316 - acc: 0.7157 - val_loss: 1.4148 - val_acc: 0.5813
Epoch 12/20
 - 1s - loss: 0.7551 - acc: 0.7557 - val_loss: 0.8383 - val_acc: 0.7328
Epoch 13/20
 - 1s - loss: 0.7644 - acc: 0.7499 - val_loss: 1.1932 - val_acc: 0.6013
Epoch 14/20
 - 1s - loss: 0.7492 - acc: 0.7483 - val_loss: 0.8342 - val_acc: 0.7302
Epoch 15/20
 - 1s - loss: 0.6984 - acc: 0.7803 - val_loss: 0.5811 - val_acc: 0.7903
Epoch 16/20
 - 1s - loss: 0.6928 - acc: 0.7669 - val_loss: 0.7695 - val_acc: 0.7232
Epoch 17/20
 - 1s - loss: 0.6749 - acc: 0.7813 - val_loss: 0.5497 - val_acc: 0.8123
Epoch 18/20
 - 1s - loss: 0.6364 - acc: 0.7867 - val_loss: 0.8066 - val_acc: 0.7470
Epoch 19/20
 - 1s - loss: 0.6374 - acc: 0.7931 - val_loss: 1.0422 - val_acc: 0.6481
Epoch 20/20
 - 1s - loss: 0.5251 - acc: 0.8309 - val_loss: 0.5732 - val_acc: 0.8115
Test loss: 0.5721600293517113
Test accuracy: 0.8124
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.4828 - acc: 0.5304 - val_loss: 0.8014 - val_acc: 0.7720
Epoch 2/20
 - 0s - loss: 0.6422 - acc: 0.8207 - val_loss: 0.7442 - val_acc: 0.7752
Epoch 3/20
 - 0s - loss: 0.4743 - acc: 0.8517 - val_loss: 0.5649 - val_acc: 0.8121
Epoch 4/20
 - 0s - loss: 0.3076 - acc: 0.9189 - val_loss: 0.5977 - val_acc: 0.8203
Epoch 5/20
 - 0s - loss: 0.2519 - acc: 0.9296 - val_loss: 0.4933 - val_acc: 0.8461
Epoch 6/20
 - 0s - loss: 0.1815 - acc: 0.9562 - val_loss: 0.4928 - val_acc: 0.8475
Epoch 7/20
 - 0s - loss: 0.1632 - acc: 0.9584 - val_loss: 0.4019 - val_acc: 0.8681
Epoch 8/20
 - 0s - loss: 0.1100 - acc: 0.9691 - val_loss: 0.4551 - val_acc: 0.8549
Epoch 9/20
 - 0s - loss: 0.0772 - acc: 0.9819 - val_loss: 0.3803 - val_acc: 0.8852
Epoch 10/20
 - 0s - loss: 0.0617 - acc: 0.9883 - val_loss: 0.7090 - val_acc: 0.8163
Epoch 11/20
 - 0s - loss: 0.1382 - acc: 0.9626 - val_loss: 0.4022 - val_acc: 0.8850
Epoch 12/20
 - 0s - loss: 0.0272 - acc: 0.9947 - val_loss: 0.3682 - val_acc: 0.8950
Epoch 13/20
 - 0s - loss: 0.0243 - acc: 0.9989 - val_loss: 0.4110 - val_acc: 0.8902
Epoch 14/20
 - 0s - loss: 0.0165 - acc: 0.9989 - val_loss: 0.4081 - val_acc: 0.8928
Epoch 15/20
 - 0s - loss: 0.0126 - acc: 1.0000 - val_loss: 0.4100 - val_acc: 0.8937
Epoch 16/20
 - 0s - loss: 0.0386 - acc: 0.9883 - val_loss: 0.4168 - val_acc: 0.8910
Epoch 17/20
 - 0s - loss: 0.0183 - acc: 0.9957 - val_loss: 0.4083 - val_acc: 0.8931
Epoch 18/20
 - 0s - loss: 0.0079 - acc: 1.0000 - val_loss: 0.4123 - val_acc: 0.8955
Epoch 19/20
 - 0s - loss: 0.0040 - acc: 1.0000 - val_loss: 0.4116 - val_acc: 0.9005
Epoch 20/20
 - 0s - loss: 0.0047 - acc: 0.9989 - val_loss: 0.9230 - val_acc: 0.8301
Test loss: 0.9229691767394542
Test accuracy: 0.8301
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.2804 - acc: 0.1313 - val_loss: 2.2108 - val_acc: 0.1443
Epoch 2/20
 - 1s - loss: 2.1605 - acc: 0.2241 - val_loss: 2.0838 - val_acc: 0.2738
Epoch 3/20
 - 1s - loss: 2.0212 - acc: 0.3052 - val_loss: 2.2791 - val_acc: 0.1639
Epoch 4/20
 - 1s - loss: 1.8569 - acc: 0.3746 - val_loss: 2.1117 - val_acc: 0.3750
Epoch 5/20
 - 0s - loss: 1.7514 - acc: 0.4248 - val_loss: 1.9104 - val_acc: 0.2404
Epoch 6/20
 - 1s - loss: 1.7169 - acc: 0.4013 - val_loss: 1.3272 - val_acc: 0.6241
Epoch 7/20
 - 0s - loss: 1.4439 - acc: 0.5240 - val_loss: 1.2955 - val_acc: 0.5428
Epoch 8/20
 - 0s - loss: 1.3756 - acc: 0.5475 - val_loss: 1.2312 - val_acc: 0.5882
Epoch 9/20
 - 1s - loss: 1.2398 - acc: 0.5902 - val_loss: 1.1475 - val_acc: 0.6100
Epoch 10/20
 - 1s - loss: 1.1536 - acc: 0.6425 - val_loss: 1.2489 - val_acc: 0.5346
Epoch 11/20
 - 1s - loss: 1.2014 - acc: 0.6137 - val_loss: 1.3501 - val_acc: 0.5563
Epoch 12/20
 - 1s - loss: 1.0428 - acc: 0.6734 - val_loss: 1.1082 - val_acc: 0.6106
Epoch 13/20
 - 0s - loss: 1.0383 - acc: 0.6596 - val_loss: 0.9628 - val_acc: 0.6753
Epoch 14/20
 - 1s - loss: 0.9772 - acc: 0.6830 - val_loss: 1.3299 - val_acc: 0.5924
Epoch 15/20
 - 0s - loss: 1.0125 - acc: 0.6969 - val_loss: 0.8070 - val_acc: 0.7402
Epoch 16/20
 - 0s - loss: 1.0193 - acc: 0.6596 - val_loss: 0.9243 - val_acc: 0.6958
Epoch 17/20
 - 1s - loss: 0.7023 - acc: 0.7727 - val_loss: 1.7303 - val_acc: 0.5053
Epoch 18/20
 - 1s - loss: 1.0261 - acc: 0.6980 - val_loss: 0.9481 - val_acc: 0.6771
Epoch 19/20
 - 0s - loss: 0.6714 - acc: 0.7876 - val_loss: 0.8407 - val_acc: 0.7258
Epoch 20/20
 - 0s - loss: 1.0910 - acc: 0.6350 - val_loss: 0.8586 - val_acc: 0.6968
Test loss: 0.8581319022655487
Test accuracy: 0.6998
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.7696 - acc: 0.4808 - val_loss: 1.3799 - val_acc: 0.5376
Epoch 2/20
 - 0s - loss: 0.8123 - acc: 0.7778 - val_loss: 0.9364 - val_acc: 0.6657
Epoch 3/20
 - 0s - loss: 0.5438 - acc: 0.8291 - val_loss: 0.7899 - val_acc: 0.7571
Epoch 4/20
 - 0s - loss: 0.3471 - acc: 0.9017 - val_loss: 0.6783 - val_acc: 0.7810
Epoch 5/20
 - 0s - loss: 0.2363 - acc: 0.9466 - val_loss: 0.6793 - val_acc: 0.7750
Epoch 6/20
 - 0s - loss: 0.2014 - acc: 0.9444 - val_loss: 0.5628 - val_acc: 0.8262
Epoch 7/20
 - 0s - loss: 0.1227 - acc: 0.9808 - val_loss: 0.6168 - val_acc: 0.8080
Epoch 8/20
 - 0s - loss: 0.1144 - acc: 0.9786 - val_loss: 0.5965 - val_acc: 0.8146
Epoch 9/20
 - 0s - loss: 0.1231 - acc: 0.9765 - val_loss: 0.5638 - val_acc: 0.8332
Epoch 10/20
 - 0s - loss: 0.0641 - acc: 0.9936 - val_loss: 0.5484 - val_acc: 0.8370
Epoch 11/20
 - 0s - loss: 0.0375 - acc: 1.0000 - val_loss: 0.5605 - val_acc: 0.8318
Epoch 12/20
 - 0s - loss: 0.0493 - acc: 0.9915 - val_loss: 1.2501 - val_acc: 0.7044
Epoch 13/20
 - 0s - loss: 0.1746 - acc: 0.9530 - val_loss: 0.5084 - val_acc: 0.8524
Epoch 14/20
 - 0s - loss: 0.0178 - acc: 1.0000 - val_loss: 0.5262 - val_acc: 0.8480
Epoch 15/20
 - 0s - loss: 0.0137 - acc: 1.0000 - val_loss: 0.5395 - val_acc: 0.8462
Epoch 16/20
 - 0s - loss: 0.0171 - acc: 0.9979 - val_loss: 0.6673 - val_acc: 0.8252
Epoch 17/20
 - 0s - loss: 0.0423 - acc: 0.9872 - val_loss: 0.6718 - val_acc: 0.8334
Epoch 18/20
 - 0s - loss: 0.0137 - acc: 0.9979 - val_loss: 0.5650 - val_acc: 0.8469
Epoch 19/20
 - 0s - loss: 0.0072 - acc: 1.0000 - val_loss: 0.5640 - val_acc: 0.8507
Epoch 20/20
 - 0s - loss: 0.0041 - acc: 1.0000 - val_loss: 0.5747 - val_acc: 0.8478
Test loss: 0.5747390717722476
Test accuracy: 0.8478
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.1891 - acc: 0.1090 - val_loss: 3.2330 - val_acc: 0.1136
Epoch 2/20
 - 0s - loss: 2.6788 - acc: 0.1368 - val_loss: 2.1611 - val_acc: 0.2029
Epoch 3/20
 - 0s - loss: 2.0532 - acc: 0.2778 - val_loss: 1.9486 - val_acc: 0.3366
Epoch 4/20
 - 0s - loss: 1.9958 - acc: 0.3291 - val_loss: 1.9439 - val_acc: 0.2974
Epoch 5/20
 - 0s - loss: 1.8785 - acc: 0.3355 - val_loss: 2.1010 - val_acc: 0.2386
Epoch 6/20
 - 0s - loss: 1.8519 - acc: 0.4295 - val_loss: 2.4648 - val_acc: 0.2274
Epoch 7/20
 - 0s - loss: 1.9498 - acc: 0.3483 - val_loss: 1.9071 - val_acc: 0.3748
Epoch 8/20
 - 0s - loss: 1.6361 - acc: 0.5043 - val_loss: 2.0858 - val_acc: 0.2932
Epoch 9/20
 - 0s - loss: 1.8853 - acc: 0.3889 - val_loss: 1.4202 - val_acc: 0.5669
Epoch 10/20
 - 0s - loss: 1.2293 - acc: 0.6303 - val_loss: 2.3281 - val_acc: 0.2463
Epoch 11/20
 - 0s - loss: 1.9005 - acc: 0.3697 - val_loss: 1.3740 - val_acc: 0.5868
Epoch 12/20
 - 0s - loss: 1.1902 - acc: 0.6218 - val_loss: 2.0313 - val_acc: 0.3448
Epoch 13/20
 - 0s - loss: 1.5749 - acc: 0.4722 - val_loss: 1.2695 - val_acc: 0.5878
Epoch 14/20
 - 0s - loss: 1.0690 - acc: 0.6560 - val_loss: 1.4396 - val_acc: 0.5252
Epoch 15/20
 - 0s - loss: 1.2645 - acc: 0.5385 - val_loss: 1.3379 - val_acc: 0.5328
Epoch 16/20
 - 0s - loss: 1.2497 - acc: 0.5791 - val_loss: 1.1474 - val_acc: 0.6113
Epoch 17/20
 - 0s - loss: 0.9388 - acc: 0.6709 - val_loss: 1.4084 - val_acc: 0.4488
Epoch 18/20
 - 0s - loss: 1.1626 - acc: 0.5897 - val_loss: 1.0885 - val_acc: 0.6553
Epoch 19/20
 - 0s - loss: 1.0580 - acc: 0.6453 - val_loss: 1.6079 - val_acc: 0.4869
Epoch 20/20
 - 0s - loss: 1.2498 - acc: 0.5577 - val_loss: 0.9429 - val_acc: 0.6849
Test loss: 0.9426953461647034
Test accuracy: 0.6847
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1374 - acc: 0.2436 - val_loss: 1.7149 - val_acc: 0.4841
Epoch 2/20
 - 0s - loss: 1.3033 - acc: 0.6709 - val_loss: 1.2306 - val_acc: 0.6141
Epoch 3/20
 - 0s - loss: 0.7694 - acc: 0.8077 - val_loss: 1.4148 - val_acc: 0.5760
Epoch 4/20
 - 0s - loss: 0.6264 - acc: 0.8248 - val_loss: 0.8873 - val_acc: 0.7265
Epoch 5/20
 - 0s - loss: 0.3696 - acc: 0.9274 - val_loss: 0.8565 - val_acc: 0.7302
Epoch 6/20
 - 0s - loss: 0.2904 - acc: 0.9359 - val_loss: 0.8926 - val_acc: 0.7258
Epoch 7/20
 - 0s - loss: 0.2808 - acc: 0.8932 - val_loss: 0.9015 - val_acc: 0.7328
Epoch 8/20
 - 0s - loss: 0.1899 - acc: 0.9744 - val_loss: 0.7315 - val_acc: 0.7683
Epoch 9/20
 - 0s - loss: 0.1222 - acc: 0.9915 - val_loss: 0.7488 - val_acc: 0.7701
Epoch 10/20
 - 0s - loss: 0.0850 - acc: 0.9915 - val_loss: 0.7294 - val_acc: 0.7734
Epoch 11/20
 - 0s - loss: 0.0648 - acc: 0.9915 - val_loss: 0.7701 - val_acc: 0.7637
Epoch 12/20
 - 0s - loss: 0.0829 - acc: 0.9786 - val_loss: 0.8932 - val_acc: 0.7472
Epoch 13/20
 - 0s - loss: 0.1077 - acc: 0.9658 - val_loss: 1.2494 - val_acc: 0.7115
Epoch 14/20
 - 0s - loss: 0.1526 - acc: 0.9658 - val_loss: 0.7015 - val_acc: 0.7870
Epoch 15/20
 - 0s - loss: 0.0337 - acc: 1.0000 - val_loss: 0.7473 - val_acc: 0.7877
Epoch 16/20
 - 0s - loss: 0.0267 - acc: 1.0000 - val_loss: 0.7291 - val_acc: 0.7901
Epoch 17/20
 - 0s - loss: 0.0203 - acc: 1.0000 - val_loss: 0.7526 - val_acc: 0.7866
Epoch 18/20
 - 0s - loss: 0.0158 - acc: 1.0000 - val_loss: 0.7523 - val_acc: 0.7890
Epoch 19/20
 - 0s - loss: 0.0126 - acc: 1.0000 - val_loss: 0.7606 - val_acc: 0.7912
Epoch 20/20
 - 0s - loss: 0.0127 - acc: 1.0000 - val_loss: 0.7626 - val_acc: 0.7914
Test loss: 0.762557955545187
Test accuracy: 0.7914
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.2652 - acc: 0.1154 - val_loss: 6.4947 - val_acc: 0.0958
Epoch 2/20
 - 0s - loss: 5.6937 - acc: 0.1026 - val_loss: 3.3020 - val_acc: 0.1878
Epoch 3/20
 - 0s - loss: 2.9729 - acc: 0.1453 - val_loss: 2.2685 - val_acc: 0.2100
Epoch 4/20
 - 0s - loss: 2.2126 - acc: 0.2564 - val_loss: 2.1402 - val_acc: 0.1439
Epoch 5/20
 - 0s - loss: 2.1789 - acc: 0.2479 - val_loss: 2.3279 - val_acc: 0.1135
Epoch 6/20
 - 0s - loss: 2.2539 - acc: 0.1709 - val_loss: 2.0725 - val_acc: 0.3104
Epoch 7/20
 - 0s - loss: 1.9494 - acc: 0.3162 - val_loss: 2.0437 - val_acc: 0.3396
Epoch 8/20
 - 0s - loss: 1.9550 - acc: 0.3632 - val_loss: 1.8790 - val_acc: 0.4315
Epoch 9/20
 - 0s - loss: 1.8086 - acc: 0.4060 - val_loss: 1.9937 - val_acc: 0.3402
Epoch 10/20
 - 0s - loss: 1.9733 - acc: 0.3547 - val_loss: 1.9193 - val_acc: 0.2821
Epoch 11/20
 - 0s - loss: 1.8082 - acc: 0.3590 - val_loss: 2.2463 - val_acc: 0.2414
Epoch 12/20
 - 0s - loss: 2.0057 - acc: 0.3419 - val_loss: 2.0970 - val_acc: 0.1869
Epoch 13/20
 - 0s - loss: 1.9290 - acc: 0.3333 - val_loss: 1.7884 - val_acc: 0.4426
Epoch 14/20
 - 0s - loss: 1.6419 - acc: 0.4744 - val_loss: 1.7424 - val_acc: 0.5056
Epoch 15/20
 - 0s - loss: 1.6190 - acc: 0.4744 - val_loss: 1.9986 - val_acc: 0.3188
Epoch 16/20
 - 0s - loss: 1.7262 - acc: 0.4145 - val_loss: 1.7382 - val_acc: 0.5279
Epoch 17/20
 - 0s - loss: 1.5276 - acc: 0.5000 - val_loss: 1.8094 - val_acc: 0.3349
Epoch 18/20
 - 0s - loss: 1.6044 - acc: 0.4316 - val_loss: 1.5721 - val_acc: 0.4291
Epoch 19/20
 - 0s - loss: 1.4203 - acc: 0.5000 - val_loss: 1.9727 - val_acc: 0.3047
Epoch 20/20
 - 0s - loss: 1.6010 - acc: 0.4530 - val_loss: 1.4855 - val_acc: 0.5568
Test loss: 1.4860137783050538
Test accuracy: 0.5569
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3736 - acc: 0.1111 - val_loss: 2.0388 - val_acc: 0.3566
Epoch 2/20
 - 0s - loss: 1.5974 - acc: 0.5470 - val_loss: 1.7076 - val_acc: 0.4135
Epoch 3/20
 - 0s - loss: 1.2256 - acc: 0.6410 - val_loss: 1.4637 - val_acc: 0.5175
Epoch 4/20
 - 0s - loss: 0.8225 - acc: 0.8291 - val_loss: 1.3195 - val_acc: 0.5679
Epoch 5/20
 - 0s - loss: 0.6220 - acc: 0.8462 - val_loss: 1.2680 - val_acc: 0.5568
Epoch 6/20
 - 0s - loss: 0.4516 - acc: 0.9060 - val_loss: 1.2554 - val_acc: 0.6172
Epoch 7/20
 - 0s - loss: 0.3476 - acc: 0.9231 - val_loss: 1.0750 - val_acc: 0.6307
Epoch 8/20
 - 0s - loss: 0.2337 - acc: 0.9573 - val_loss: 1.0402 - val_acc: 0.6845
Epoch 9/20
 - 0s - loss: 0.1983 - acc: 0.9573 - val_loss: 1.2044 - val_acc: 0.6077
Epoch 10/20
 - 0s - loss: 0.1705 - acc: 0.9573 - val_loss: 1.0199 - val_acc: 0.6811
Epoch 11/20
 - 0s - loss: 0.1985 - acc: 0.9573 - val_loss: 1.1819 - val_acc: 0.6348
Epoch 12/20
 - 0s - loss: 0.1382 - acc: 0.9829 - val_loss: 0.9138 - val_acc: 0.7198
Epoch 13/20
 - 0s - loss: 0.0881 - acc: 0.9915 - val_loss: 0.9405 - val_acc: 0.7106
Epoch 14/20
 - 0s - loss: 0.0494 - acc: 1.0000 - val_loss: 0.9279 - val_acc: 0.7203
Epoch 15/20
 - 0s - loss: 0.0368 - acc: 1.0000 - val_loss: 0.9442 - val_acc: 0.7170
Epoch 16/20
 - 0s - loss: 0.0327 - acc: 1.0000 - val_loss: 0.9637 - val_acc: 0.7164
Epoch 17/20
 - 0s - loss: 0.0260 - acc: 1.0000 - val_loss: 0.9773 - val_acc: 0.7173
Epoch 18/20
 - 0s - loss: 0.0235 - acc: 1.0000 - val_loss: 0.9635 - val_acc: 0.7228
Epoch 19/20
 - 0s - loss: 0.0255 - acc: 1.0000 - val_loss: 0.9648 - val_acc: 0.7246
Epoch 20/20
 - 0s - loss: 0.0208 - acc: 1.0000 - val_loss: 0.9861 - val_acc: 0.7198
Test loss: 0.9860656037092209
Test accuracy: 0.7198
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.9359 - acc: 0.0855 - val_loss: 8.0101 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 7.3804 - acc: 0.1624 - val_loss: 6.1627 - val_acc: 0.0980
Epoch 3/20
 - 0s - loss: 5.9718 - acc: 0.1368 - val_loss: 5.6678 - val_acc: 0.1010
Epoch 4/20
 - 0s - loss: 6.0464 - acc: 0.1197 - val_loss: 3.4390 - val_acc: 0.1021
Epoch 5/20
 - 0s - loss: 3.9104 - acc: 0.1111 - val_loss: 2.3373 - val_acc: 0.1068
Epoch 6/20
 - 0s - loss: 2.4226 - acc: 0.0855 - val_loss: 2.2054 - val_acc: 0.1817
Epoch 7/20
 - 0s - loss: 2.2071 - acc: 0.1795 - val_loss: 2.1772 - val_acc: 0.2147
Epoch 8/20
 - 0s - loss: 2.0778 - acc: 0.2821 - val_loss: 2.1437 - val_acc: 0.2008
Epoch 9/20
 - 0s - loss: 2.0203 - acc: 0.2906 - val_loss: 2.0998 - val_acc: 0.4713
Epoch 10/20
 - 0s - loss: 2.0513 - acc: 0.2821 - val_loss: 2.1929 - val_acc: 0.1932
Epoch 11/20
 - 0s - loss: 2.0227 - acc: 0.3077 - val_loss: 2.0976 - val_acc: 0.3192
Epoch 12/20
 - 0s - loss: 2.0247 - acc: 0.3248 - val_loss: 2.1449 - val_acc: 0.1902
Epoch 13/20
 - 0s - loss: 1.9758 - acc: 0.2906 - val_loss: 2.0335 - val_acc: 0.3109
Epoch 14/20
 - 0s - loss: 1.9016 - acc: 0.3675 - val_loss: 2.0102 - val_acc: 0.2750
Epoch 15/20
 - 0s - loss: 1.8021 - acc: 0.4103 - val_loss: 1.9404 - val_acc: 0.3440
Epoch 16/20
 - 0s - loss: 1.7451 - acc: 0.4103 - val_loss: 2.0408 - val_acc: 0.2575
Epoch 17/20
 - 0s - loss: 1.7914 - acc: 0.3162 - val_loss: 2.0407 - val_acc: 0.1547
Epoch 18/20
 - 0s - loss: 1.7970 - acc: 0.2906 - val_loss: 2.2289 - val_acc: 0.2547
Epoch 19/20
 - 0s - loss: 1.9695 - acc: 0.3590 - val_loss: 2.0870 - val_acc: 0.2490
Epoch 20/20
 - 0s - loss: 1.8189 - acc: 0.3846 - val_loss: 2.1015 - val_acc: 0.3059
Test loss: 2.1015550575256348
Test accuracy: 0.3074
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2456 - acc: 0.9253 - val_loss: 0.1108 - val_acc: 0.9641
Epoch 2/20
 - 2s - loss: 0.1032 - acc: 0.9687 - val_loss: 0.0877 - val_acc: 0.9732
Epoch 3/20
 - 2s - loss: 0.0758 - acc: 0.9768 - val_loss: 0.0798 - val_acc: 0.9774
Epoch 4/20
 - 3s - loss: 0.0603 - acc: 0.9821 - val_loss: 0.0836 - val_acc: 0.9766
Epoch 5/20
 - 3s - loss: 0.0509 - acc: 0.9847 - val_loss: 0.0656 - val_acc: 0.9826
Epoch 6/20
 - 3s - loss: 0.0438 - acc: 0.9866 - val_loss: 0.0685 - val_acc: 0.9826
Epoch 7/20
 - 2s - loss: 0.0379 - acc: 0.9887 - val_loss: 0.0731 - val_acc: 0.9834
Epoch 8/20
 - 2s - loss: 0.0355 - acc: 0.9894 - val_loss: 0.0808 - val_acc: 0.9807
Epoch 9/20
 - 2s - loss: 0.0304 - acc: 0.9911 - val_loss: 0.0822 - val_acc: 0.9833
Epoch 10/20
 - 2s - loss: 0.0302 - acc: 0.9913 - val_loss: 0.1018 - val_acc: 0.9790
Epoch 11/20
 - 2s - loss: 0.0268 - acc: 0.9927 - val_loss: 0.1001 - val_acc: 0.9813
Epoch 12/20
 - 2s - loss: 0.0255 - acc: 0.9927 - val_loss: 0.1017 - val_acc: 0.9820
Epoch 13/20
 - 2s - loss: 0.0248 - acc: 0.9931 - val_loss: 0.0922 - val_acc: 0.9846
Epoch 14/20
 - 2s - loss: 0.0230 - acc: 0.9935 - val_loss: 0.0966 - val_acc: 0.9836
Epoch 15/20
 - 2s - loss: 0.0212 - acc: 0.9941 - val_loss: 0.0884 - val_acc: 0.9839
Epoch 16/20
 - 2s - loss: 0.0202 - acc: 0.9944 - val_loss: 0.1051 - val_acc: 0.9831
Epoch 17/20
 - 2s - loss: 0.0179 - acc: 0.9949 - val_loss: 0.0963 - val_acc: 0.9848
Epoch 18/20
 - 2s - loss: 0.0182 - acc: 0.9952 - val_loss: 0.1062 - val_acc: 0.9831
Epoch 19/20
 - 2s - loss: 0.0186 - acc: 0.9954 - val_loss: 0.1170 - val_acc: 0.9828
Epoch 20/20
 - 2s - loss: 0.0190 - acc: 0.9953 - val_loss: 0.1088 - val_acc: 0.9843
Test loss: 0.10881533303042568
Test accuracy: 0.9843
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9457 - acc: 0.6962 - val_loss: 0.5212 - val_acc: 0.8308
Epoch 2/20
 - 4s - loss: 0.4292 - acc: 0.8638 - val_loss: 0.2331 - val_acc: 0.9268
Epoch 3/20
 - 4s - loss: 0.3197 - acc: 0.8994 - val_loss: 0.2095 - val_acc: 0.9363
Epoch 4/20
 - 4s - loss: 0.2683 - acc: 0.9165 - val_loss: 0.2552 - val_acc: 0.9209
Epoch 5/20
 - 4s - loss: 0.2360 - acc: 0.9245 - val_loss: 0.1906 - val_acc: 0.9398
Epoch 6/20
 - 4s - loss: 0.2166 - acc: 0.9324 - val_loss: 0.1381 - val_acc: 0.9555
Epoch 7/20
 - 4s - loss: 0.2041 - acc: 0.9377 - val_loss: 0.1637 - val_acc: 0.9468
Epoch 8/20
 - 4s - loss: 0.1906 - acc: 0.9424 - val_loss: 0.1679 - val_acc: 0.9486
Epoch 9/20
 - 4s - loss: 0.1831 - acc: 0.9457 - val_loss: 0.1358 - val_acc: 0.9572
Epoch 10/20
 - 4s - loss: 0.1742 - acc: 0.9470 - val_loss: 0.1499 - val_acc: 0.9532
Epoch 11/20
 - 4s - loss: 0.1763 - acc: 0.9480 - val_loss: 0.1206 - val_acc: 0.9653
Epoch 12/20
 - 4s - loss: 0.1705 - acc: 0.9495 - val_loss: 0.1072 - val_acc: 0.9687
Epoch 13/20
 - 4s - loss: 0.1661 - acc: 0.9510 - val_loss: 0.1568 - val_acc: 0.9523
Epoch 14/20
 - 4s - loss: 0.1664 - acc: 0.9512 - val_loss: 0.1358 - val_acc: 0.9661
Epoch 15/20
 - 4s - loss: 0.1652 - acc: 0.9522 - val_loss: 0.1194 - val_acc: 0.9679
Epoch 16/20
 - 4s - loss: 0.1665 - acc: 0.9517 - val_loss: 0.1400 - val_acc: 0.9609
Epoch 17/20
 - 4s - loss: 0.1656 - acc: 0.9529 - val_loss: 0.1254 - val_acc: 0.9653
Epoch 18/20
 - 4s - loss: 0.1643 - acc: 0.9536 - val_loss: 0.1306 - val_acc: 0.9644
Epoch 19/20
 - 4s - loss: 0.1608 - acc: 0.9543 - val_loss: 0.1187 - val_acc: 0.9649
Epoch 20/20
 - 4s - loss: 0.1696 - acc: 0.9539 - val_loss: 0.1016 - val_acc: 0.9690
Test loss: 0.10247082484510028
Test accuracy: 0.9692
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3370 - acc: 0.8952 - val_loss: 0.1958 - val_acc: 0.9369
Epoch 2/20
 - 1s - loss: 0.1326 - acc: 0.9589 - val_loss: 0.1243 - val_acc: 0.9621
Epoch 3/20
 - 1s - loss: 0.0904 - acc: 0.9731 - val_loss: 0.1064 - val_acc: 0.9692
Epoch 4/20
 - 1s - loss: 0.0676 - acc: 0.9787 - val_loss: 0.0971 - val_acc: 0.9726
Epoch 5/20
 - 1s - loss: 0.0534 - acc: 0.9831 - val_loss: 0.1036 - val_acc: 0.9724
Epoch 6/20
 - 1s - loss: 0.0432 - acc: 0.9871 - val_loss: 0.1002 - val_acc: 0.9743
Epoch 7/20
 - 1s - loss: 0.0373 - acc: 0.9885 - val_loss: 0.1081 - val_acc: 0.9743
Epoch 8/20
 - 1s - loss: 0.0319 - acc: 0.9895 - val_loss: 0.1053 - val_acc: 0.9759
Epoch 9/20
 - 1s - loss: 0.0285 - acc: 0.9916 - val_loss: 0.1014 - val_acc: 0.9769
Epoch 10/20
 - 1s - loss: 0.0241 - acc: 0.9927 - val_loss: 0.1249 - val_acc: 0.9737
Epoch 11/20
 - 1s - loss: 0.0241 - acc: 0.9927 - val_loss: 0.1036 - val_acc: 0.9795
Epoch 12/20
 - 1s - loss: 0.0186 - acc: 0.9944 - val_loss: 0.1320 - val_acc: 0.9761
Epoch 13/20
 - 1s - loss: 0.0175 - acc: 0.9945 - val_loss: 0.1225 - val_acc: 0.9779
Epoch 14/20
 - 1s - loss: 0.0178 - acc: 0.9947 - val_loss: 0.1412 - val_acc: 0.9763
Epoch 15/20
 - 1s - loss: 0.0154 - acc: 0.9957 - val_loss: 0.1294 - val_acc: 0.9785
Epoch 16/20
 - 1s - loss: 0.0169 - acc: 0.9950 - val_loss: 0.1427 - val_acc: 0.9762
Epoch 17/20
 - 1s - loss: 0.0133 - acc: 0.9956 - val_loss: 0.1410 - val_acc: 0.9758
Epoch 18/20
 - 1s - loss: 0.0125 - acc: 0.9958 - val_loss: 0.1317 - val_acc: 0.9794
Epoch 19/20
 - 1s - loss: 0.0147 - acc: 0.9960 - val_loss: 0.1351 - val_acc: 0.9789
Epoch 20/20
 - 1s - loss: 0.0110 - acc: 0.9963 - val_loss: 0.1590 - val_acc: 0.9769
Test loss: 0.1589817111708403
Test accuracy: 0.9769
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2570 - acc: 0.5912 - val_loss: 0.9043 - val_acc: 0.7220
Epoch 2/20
 - 2s - loss: 0.6089 - acc: 0.8045 - val_loss: 0.5671 - val_acc: 0.8059
Epoch 3/20
 - 2s - loss: 0.4689 - acc: 0.8483 - val_loss: 0.3574 - val_acc: 0.8730
Epoch 4/20
 - 2s - loss: 0.3833 - acc: 0.8782 - val_loss: 0.2683 - val_acc: 0.9100
Epoch 5/20
 - 2s - loss: 0.3310 - acc: 0.8956 - val_loss: 0.3382 - val_acc: 0.8877
Epoch 6/20
 - 2s - loss: 0.2954 - acc: 0.9084 - val_loss: 0.3224 - val_acc: 0.8919
Epoch 7/20
 - 2s - loss: 0.2668 - acc: 0.9157 - val_loss: 0.1871 - val_acc: 0.9411
Epoch 8/20
 - 2s - loss: 0.2479 - acc: 0.9220 - val_loss: 0.2058 - val_acc: 0.9346
Epoch 9/20
 - 2s - loss: 0.2268 - acc: 0.9303 - val_loss: 0.1862 - val_acc: 0.9396
Epoch 10/20
 - 2s - loss: 0.2152 - acc: 0.9311 - val_loss: 0.1609 - val_acc: 0.9499
Epoch 11/20
 - 2s - loss: 0.2035 - acc: 0.9362 - val_loss: 0.2017 - val_acc: 0.9387
Epoch 12/20
 - 2s - loss: 0.1972 - acc: 0.9382 - val_loss: 0.2032 - val_acc: 0.9387
Epoch 13/20
 - 2s - loss: 0.1844 - acc: 0.9422 - val_loss: 0.2531 - val_acc: 0.9225
Epoch 14/20
 - 2s - loss: 0.1834 - acc: 0.9446 - val_loss: 0.1533 - val_acc: 0.9519
Epoch 15/20
 - 2s - loss: 0.1794 - acc: 0.9450 - val_loss: 0.2308 - val_acc: 0.9261
Epoch 16/20
 - 2s - loss: 0.1681 - acc: 0.9474 - val_loss: 0.2426 - val_acc: 0.9277
Epoch 17/20
 - 2s - loss: 0.1645 - acc: 0.9491 - val_loss: 0.1685 - val_acc: 0.9471
Epoch 18/20
 - 2s - loss: 0.1661 - acc: 0.9490 - val_loss: 0.1860 - val_acc: 0.9386
Epoch 19/20
 - 2s - loss: 0.1559 - acc: 0.9526 - val_loss: 0.1340 - val_acc: 0.9593
Epoch 20/20
 - 2s - loss: 0.1502 - acc: 0.9531 - val_loss: 0.1342 - val_acc: 0.9565
Test loss: 0.13453465093462727
Test accuracy: 0.9564
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4748 - acc: 0.8547 - val_loss: 0.3559 - val_acc: 0.8859
Epoch 2/20
 - 1s - loss: 0.1894 - acc: 0.9431 - val_loss: 0.1424 - val_acc: 0.9542
Epoch 3/20
 - 1s - loss: 0.1242 - acc: 0.9617 - val_loss: 0.1645 - val_acc: 0.9480
Epoch 4/20
 - 1s - loss: 0.0876 - acc: 0.9705 - val_loss: 0.1142 - val_acc: 0.9671
Epoch 5/20
 - 1s - loss: 0.0640 - acc: 0.9793 - val_loss: 0.1334 - val_acc: 0.9621
Epoch 6/20
 - 1s - loss: 0.0505 - acc: 0.9828 - val_loss: 0.1461 - val_acc: 0.9646
Epoch 7/20
 - 1s - loss: 0.0382 - acc: 0.9875 - val_loss: 0.1297 - val_acc: 0.9668
Epoch 8/20
 - 1s - loss: 0.0316 - acc: 0.9895 - val_loss: 0.1398 - val_acc: 0.9650
Epoch 9/20
 - 1s - loss: 0.0255 - acc: 0.9915 - val_loss: 0.1369 - val_acc: 0.9695
Epoch 10/20
 - 1s - loss: 0.0236 - acc: 0.9919 - val_loss: 0.1589 - val_acc: 0.9664
Epoch 11/20
 - 1s - loss: 0.0179 - acc: 0.9941 - val_loss: 0.1513 - val_acc: 0.9696
Epoch 12/20
 - 1s - loss: 0.0187 - acc: 0.9941 - val_loss: 0.1512 - val_acc: 0.9701
Epoch 13/20
 - 1s - loss: 0.0167 - acc: 0.9947 - val_loss: 0.1536 - val_acc: 0.9704
Epoch 14/20
 - 1s - loss: 0.0134 - acc: 0.9952 - val_loss: 0.1780 - val_acc: 0.9669
Epoch 15/20
 - 1s - loss: 0.0117 - acc: 0.9962 - val_loss: 0.2039 - val_acc: 0.9639
Epoch 16/20
 - 1s - loss: 0.0144 - acc: 0.9950 - val_loss: 0.1635 - val_acc: 0.9705
Epoch 17/20
 - 1s - loss: 0.0103 - acc: 0.9964 - val_loss: 0.1919 - val_acc: 0.9700
Epoch 18/20
 - 1s - loss: 0.0097 - acc: 0.9967 - val_loss: 0.1810 - val_acc: 0.9706
Epoch 19/20
 - 1s - loss: 0.0148 - acc: 0.9961 - val_loss: 0.1822 - val_acc: 0.9694
Epoch 20/20
 - 1s - loss: 0.0095 - acc: 0.9970 - val_loss: 0.1872 - val_acc: 0.9713
Test loss: 0.18720550018173646
Test accuracy: 0.9713
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6309 - acc: 0.4879 - val_loss: 1.1412 - val_acc: 0.6763
Epoch 2/20
 - 1s - loss: 0.8587 - acc: 0.7263 - val_loss: 0.5714 - val_acc: 0.8075
Epoch 3/20
 - 1s - loss: 0.6541 - acc: 0.7875 - val_loss: 0.5515 - val_acc: 0.8176
Epoch 4/20
 - 1s - loss: 0.5559 - acc: 0.8241 - val_loss: 0.5573 - val_acc: 0.8236
Epoch 5/20
 - 1s - loss: 0.4869 - acc: 0.8409 - val_loss: 0.6028 - val_acc: 0.8227
Epoch 6/20
 - 1s - loss: 0.4322 - acc: 0.8637 - val_loss: 0.4027 - val_acc: 0.8663
Epoch 7/20
 - 1s - loss: 0.3872 - acc: 0.8739 - val_loss: 0.8473 - val_acc: 0.7592
Epoch 8/20
 - 1s - loss: 0.3542 - acc: 0.8883 - val_loss: 0.3487 - val_acc: 0.8817
Epoch 9/20
 - 1s - loss: 0.3238 - acc: 0.8952 - val_loss: 0.4394 - val_acc: 0.8621
Epoch 10/20
 - 1s - loss: 0.3036 - acc: 0.9043 - val_loss: 0.3691 - val_acc: 0.8802
Epoch 11/20
 - 1s - loss: 0.2816 - acc: 0.9113 - val_loss: 0.3695 - val_acc: 0.8886
Epoch 12/20
 - 1s - loss: 0.2685 - acc: 0.9151 - val_loss: 0.7322 - val_acc: 0.7779
Epoch 13/20
 - 1s - loss: 0.2548 - acc: 0.9208 - val_loss: 0.5273 - val_acc: 0.8375
Epoch 14/20
 - 1s - loss: 0.2472 - acc: 0.9222 - val_loss: 0.2947 - val_acc: 0.8980
Epoch 15/20
 - 1s - loss: 0.2277 - acc: 0.9284 - val_loss: 0.4357 - val_acc: 0.8268
Epoch 16/20
 - 1s - loss: 0.2098 - acc: 0.9339 - val_loss: 0.3128 - val_acc: 0.9074
Epoch 17/20
 - 1s - loss: 0.2071 - acc: 0.9354 - val_loss: 0.3263 - val_acc: 0.8945
Epoch 18/20
 - 1s - loss: 0.2033 - acc: 0.9365 - val_loss: 0.1614 - val_acc: 0.9520
Epoch 19/20
 - 1s - loss: 0.1971 - acc: 0.9405 - val_loss: 0.2521 - val_acc: 0.9319
Epoch 20/20
 - 1s - loss: 0.1851 - acc: 0.9410 - val_loss: 0.2153 - val_acc: 0.9315
Test loss: 0.21462287924438714
Test accuracy: 0.9324
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6006 - acc: 0.8128 - val_loss: 0.3396 - val_acc: 0.8927
Epoch 2/20
 - 0s - loss: 0.2444 - acc: 0.9275 - val_loss: 0.2399 - val_acc: 0.9265
Epoch 3/20
 - 0s - loss: 0.1572 - acc: 0.9524 - val_loss: 0.2064 - val_acc: 0.9388
Epoch 4/20
 - 0s - loss: 0.1104 - acc: 0.9677 - val_loss: 0.1948 - val_acc: 0.9423
Epoch 5/20
 - 0s - loss: 0.0834 - acc: 0.9739 - val_loss: 0.2097 - val_acc: 0.9392
Epoch 6/20
 - 0s - loss: 0.0657 - acc: 0.9795 - val_loss: 0.1660 - val_acc: 0.9509
Epoch 7/20
 - 0s - loss: 0.0429 - acc: 0.9869 - val_loss: 0.2096 - val_acc: 0.9464
Epoch 8/20
 - 0s - loss: 0.0391 - acc: 0.9875 - val_loss: 0.1887 - val_acc: 0.9502
Epoch 9/20
 - 0s - loss: 0.0260 - acc: 0.9905 - val_loss: 0.2615 - val_acc: 0.9399
Epoch 10/20
 - 0s - loss: 0.0183 - acc: 0.9939 - val_loss: 0.2512 - val_acc: 0.9428
Epoch 11/20
 - 0s - loss: 0.0197 - acc: 0.9939 - val_loss: 0.2017 - val_acc: 0.9584
Epoch 12/20
 - 0s - loss: 0.0153 - acc: 0.9941 - val_loss: 0.1904 - val_acc: 0.9577
Epoch 13/20
 - 0s - loss: 0.0138 - acc: 0.9956 - val_loss: 0.2835 - val_acc: 0.9425
Epoch 14/20
 - 0s - loss: 0.0104 - acc: 0.9967 - val_loss: 0.2237 - val_acc: 0.9563
Epoch 15/20
 - 0s - loss: 0.0095 - acc: 0.9973 - val_loss: 0.3055 - val_acc: 0.9428
Epoch 16/20
 - 0s - loss: 0.0116 - acc: 0.9967 - val_loss: 0.2362 - val_acc: 0.9548
Epoch 17/20
 - 0s - loss: 0.0048 - acc: 0.9989 - val_loss: 0.2270 - val_acc: 0.9594
Epoch 18/20
 - 0s - loss: 0.0121 - acc: 0.9961 - val_loss: 0.2445 - val_acc: 0.9560
Epoch 19/20
 - 0s - loss: 0.0074 - acc: 0.9980 - val_loss: 0.2461 - val_acc: 0.9578
Epoch 20/20
 - 0s - loss: 0.0075 - acc: 0.9977 - val_loss: 0.2627 - val_acc: 0.9574
Test loss: 0.2627390296905504
Test accuracy: 0.9574
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0974 - acc: 0.3577 - val_loss: 1.5028 - val_acc: 0.4544
Epoch 2/20
 - 1s - loss: 1.1669 - acc: 0.6164 - val_loss: 0.7656 - val_acc: 0.7488
Epoch 3/20
 - 1s - loss: 0.8673 - acc: 0.7161 - val_loss: 0.8120 - val_acc: 0.7248
Epoch 4/20
 - 1s - loss: 0.7478 - acc: 0.7524 - val_loss: 0.5470 - val_acc: 0.8214
Epoch 5/20
 - 1s - loss: 0.6754 - acc: 0.7843 - val_loss: 0.5828 - val_acc: 0.7944
Epoch 6/20
 - 1s - loss: 0.5717 - acc: 0.8088 - val_loss: 0.7789 - val_acc: 0.7184
Epoch 7/20
 - 1s - loss: 0.5382 - acc: 0.8331 - val_loss: 0.5637 - val_acc: 0.8161
Epoch 8/20
 - 1s - loss: 0.4898 - acc: 0.8437 - val_loss: 0.5162 - val_acc: 0.8411
Epoch 9/20
 - 1s - loss: 0.4685 - acc: 0.8501 - val_loss: 0.6962 - val_acc: 0.7679
Epoch 10/20
 - 1s - loss: 0.4233 - acc: 0.8683 - val_loss: 0.4136 - val_acc: 0.8781
Epoch 11/20
 - 1s - loss: 0.4103 - acc: 0.8740 - val_loss: 0.3007 - val_acc: 0.9055
Epoch 12/20
 - 1s - loss: 0.3769 - acc: 0.8817 - val_loss: 0.3957 - val_acc: 0.8683
Epoch 13/20
 - 1s - loss: 0.3727 - acc: 0.8777 - val_loss: 0.2961 - val_acc: 0.9114
Epoch 14/20
 - 1s - loss: 0.3402 - acc: 0.8913 - val_loss: 0.3266 - val_acc: 0.8946
Epoch 15/20
 - 1s - loss: 0.3313 - acc: 0.8932 - val_loss: 0.3749 - val_acc: 0.8736
Epoch 16/20
 - 1s - loss: 0.3123 - acc: 0.8980 - val_loss: 0.6809 - val_acc: 0.7850
Epoch 17/20
 - 1s - loss: 0.2956 - acc: 0.9053 - val_loss: 0.3901 - val_acc: 0.8785
Epoch 18/20
 - 1s - loss: 0.2757 - acc: 0.9121 - val_loss: 0.3500 - val_acc: 0.8941
Epoch 19/20
 - 1s - loss: 0.2773 - acc: 0.9107 - val_loss: 0.2973 - val_acc: 0.9013
Epoch 20/20
 - 1s - loss: 0.2636 - acc: 0.9176 - val_loss: 0.2463 - val_acc: 0.9244
Test loss: 0.245296326601319
Test accuracy: 0.9247
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8131 - acc: 0.7384 - val_loss: 0.3944 - val_acc: 0.8868
Epoch 2/20
 - 0s - loss: 0.3302 - acc: 0.8997 - val_loss: 0.4775 - val_acc: 0.8536
Epoch 3/20
 - 0s - loss: 0.2371 - acc: 0.9280 - val_loss: 0.3060 - val_acc: 0.9058
Epoch 4/20
 - 0s - loss: 0.1595 - acc: 0.9547 - val_loss: 0.3662 - val_acc: 0.8826
Epoch 5/20
 - 0s - loss: 0.1254 - acc: 0.9613 - val_loss: 0.2770 - val_acc: 0.9126
Epoch 6/20
 - 0s - loss: 0.0872 - acc: 0.9715 - val_loss: 0.2136 - val_acc: 0.9361
Epoch 7/20
 - 0s - loss: 0.0716 - acc: 0.9781 - val_loss: 0.2243 - val_acc: 0.9341
Epoch 8/20
 - 0s - loss: 0.0366 - acc: 0.9907 - val_loss: 0.2430 - val_acc: 0.9368
Epoch 9/20
 - 0s - loss: 0.0415 - acc: 0.9893 - val_loss: 0.2927 - val_acc: 0.9256
Epoch 10/20
 - 0s - loss: 0.0335 - acc: 0.9909 - val_loss: 0.2364 - val_acc: 0.9410
Epoch 11/20
 - 0s - loss: 0.0251 - acc: 0.9928 - val_loss: 0.2426 - val_acc: 0.9406
Epoch 12/20
 - 0s - loss: 0.0208 - acc: 0.9939 - val_loss: 0.2913 - val_acc: 0.9308
Epoch 13/20
 - 0s - loss: 0.0114 - acc: 0.9973 - val_loss: 0.2752 - val_acc: 0.9365
Epoch 14/20
 - 0s - loss: 0.0100 - acc: 0.9968 - val_loss: 0.3094 - val_acc: 0.9359
Epoch 15/20
 - 0s - loss: 0.0127 - acc: 0.9968 - val_loss: 0.2776 - val_acc: 0.9441
Epoch 16/20
 - 0s - loss: 0.0172 - acc: 0.9947 - val_loss: 0.2735 - val_acc: 0.9420
Epoch 17/20
 - 0s - loss: 0.0222 - acc: 0.9955 - val_loss: 0.2666 - val_acc: 0.9451
Epoch 18/20
 - 0s - loss: 0.0031 - acc: 0.9992 - val_loss: 0.3238 - val_acc: 0.9360
Epoch 19/20
 - 0s - loss: 0.0094 - acc: 0.9984 - val_loss: 0.2745 - val_acc: 0.9454
Epoch 20/20
 - 0s - loss: 0.0037 - acc: 0.9989 - val_loss: 0.2862 - val_acc: 0.9459
Test loss: 0.28622171348141967
Test accuracy: 0.9459
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7335 - acc: 0.2269 - val_loss: 1.7707 - val_acc: 0.3398
Epoch 2/20
 - 1s - loss: 1.5686 - acc: 0.4795 - val_loss: 1.9114 - val_acc: 0.3069
Epoch 3/20
 - 1s - loss: 1.2628 - acc: 0.5829 - val_loss: 1.0757 - val_acc: 0.6324
Epoch 4/20
 - 1s - loss: 0.9826 - acc: 0.6749 - val_loss: 2.0223 - val_acc: 0.3967
Epoch 5/20
 - 1s - loss: 0.9515 - acc: 0.6947 - val_loss: 0.8235 - val_acc: 0.7345
Epoch 6/20
 - 1s - loss: 0.8251 - acc: 0.7400 - val_loss: 1.0605 - val_acc: 0.6255
Epoch 7/20
 - 1s - loss: 0.7401 - acc: 0.7544 - val_loss: 1.3601 - val_acc: 0.5913
Epoch 8/20
 - 1s - loss: 0.7127 - acc: 0.7733 - val_loss: 0.6776 - val_acc: 0.7601
Epoch 9/20
 - 1s - loss: 0.6556 - acc: 0.7941 - val_loss: 0.9093 - val_acc: 0.6741
Epoch 10/20
 - 1s - loss: 0.6272 - acc: 0.8016 - val_loss: 0.8235 - val_acc: 0.7377
Epoch 11/20
 - 1s - loss: 0.5719 - acc: 0.8211 - val_loss: 0.7934 - val_acc: 0.7386
Epoch 12/20
 - 1s - loss: 0.5627 - acc: 0.8187 - val_loss: 0.7970 - val_acc: 0.7553
Epoch 13/20
 - 1s - loss: 0.5571 - acc: 0.8253 - val_loss: 0.3920 - val_acc: 0.8760
Epoch 14/20
 - 1s - loss: 0.5117 - acc: 0.8373 - val_loss: 0.5201 - val_acc: 0.8347
Epoch 15/20
 - 1s - loss: 0.5012 - acc: 0.8389 - val_loss: 0.6073 - val_acc: 0.7880
Epoch 16/20
 - 1s - loss: 0.4340 - acc: 0.8531 - val_loss: 0.6074 - val_acc: 0.8054
Epoch 17/20
 - 1s - loss: 0.4353 - acc: 0.8568 - val_loss: 0.7268 - val_acc: 0.7563
Epoch 18/20
 - 1s - loss: 0.4689 - acc: 0.8475 - val_loss: 0.5617 - val_acc: 0.8123
Epoch 19/20
 - 1s - loss: 0.4165 - acc: 0.8683 - val_loss: 0.5900 - val_acc: 0.8050
Epoch 20/20
 - 1s - loss: 0.4168 - acc: 0.8715 - val_loss: 0.4888 - val_acc: 0.8511
Test loss: 0.4895316271543503
Test accuracy: 0.8501
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1450 - acc: 0.6251 - val_loss: 0.5900 - val_acc: 0.8102
Epoch 2/20
 - 0s - loss: 0.4725 - acc: 0.8603 - val_loss: 0.4030 - val_acc: 0.8798
Epoch 3/20
 - 0s - loss: 0.3536 - acc: 0.8933 - val_loss: 0.3543 - val_acc: 0.8948
Epoch 4/20
 - 0s - loss: 0.2315 - acc: 0.9307 - val_loss: 0.3902 - val_acc: 0.8796
Epoch 5/20
 - 0s - loss: 0.1896 - acc: 0.9397 - val_loss: 0.3582 - val_acc: 0.8928
Epoch 6/20
 - 0s - loss: 0.1375 - acc: 0.9621 - val_loss: 0.3543 - val_acc: 0.8954
Epoch 7/20
 - 0s - loss: 0.0977 - acc: 0.9723 - val_loss: 0.4073 - val_acc: 0.8791
Epoch 8/20
 - 0s - loss: 0.0883 - acc: 0.9744 - val_loss: 0.5087 - val_acc: 0.8622
Epoch 9/20
 - 0s - loss: 0.0704 - acc: 0.9803 - val_loss: 0.2944 - val_acc: 0.9188
Epoch 10/20
 - 0s - loss: 0.0347 - acc: 0.9920 - val_loss: 0.3835 - val_acc: 0.9003
Epoch 11/20
 - 0s - loss: 0.0361 - acc: 0.9888 - val_loss: 0.2783 - val_acc: 0.9231
Epoch 12/20
 - 0s - loss: 0.0226 - acc: 0.9957 - val_loss: 0.3007 - val_acc: 0.9214
Epoch 13/20
 - 0s - loss: 0.0443 - acc: 0.9872 - val_loss: 0.2944 - val_acc: 0.9254
Epoch 14/20
 - 0s - loss: 0.0116 - acc: 0.9979 - val_loss: 0.2927 - val_acc: 0.9279
Epoch 15/20
 - 0s - loss: 0.0303 - acc: 0.9904 - val_loss: 0.3166 - val_acc: 0.9245
Epoch 16/20
 - 0s - loss: 0.0057 - acc: 0.9989 - val_loss: 0.3003 - val_acc: 0.9298
Epoch 17/20
 - 0s - loss: 0.0022 - acc: 1.0000 - val_loss: 0.3309 - val_acc: 0.9264
Epoch 18/20
 - 0s - loss: 0.0272 - acc: 0.9936 - val_loss: 0.3425 - val_acc: 0.9246
Epoch 19/20
 - 0s - loss: 0.0127 - acc: 0.9957 - val_loss: 0.3547 - val_acc: 0.9234
Epoch 20/20
 - 0s - loss: 0.0052 - acc: 0.9995 - val_loss: 0.3551 - val_acc: 0.9225
Test loss: 0.35507311081149384
Test accuracy: 0.9225
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.2691 - acc: 0.1664 - val_loss: 1.9638 - val_acc: 0.4809
Epoch 2/20
 - 1s - loss: 2.0066 - acc: 0.3269 - val_loss: 1.8473 - val_acc: 0.2556
Epoch 3/20
 - 1s - loss: 1.7783 - acc: 0.4213 - val_loss: 1.6849 - val_acc: 0.4504
Epoch 4/20
 - 1s - loss: 1.4686 - acc: 0.5147 - val_loss: 1.2709 - val_acc: 0.5603
Epoch 5/20
 - 1s - loss: 1.2793 - acc: 0.5925 - val_loss: 0.9001 - val_acc: 0.6980
Epoch 6/20
 - 1s - loss: 1.0536 - acc: 0.6523 - val_loss: 1.2412 - val_acc: 0.6291
Epoch 7/20
 - 1s - loss: 1.1951 - acc: 0.6075 - val_loss: 0.7465 - val_acc: 0.7717
Epoch 8/20
 - 1s - loss: 0.9462 - acc: 0.6805 - val_loss: 1.1030 - val_acc: 0.6241
Epoch 9/20
 - 1s - loss: 0.8826 - acc: 0.7109 - val_loss: 1.1286 - val_acc: 0.6104
Epoch 10/20
 - 1s - loss: 0.9377 - acc: 0.6944 - val_loss: 0.6826 - val_acc: 0.7722
Epoch 11/20
 - 1s - loss: 0.8040 - acc: 0.7568 - val_loss: 1.0805 - val_acc: 0.6536
Epoch 12/20
 - 1s - loss: 0.7921 - acc: 0.7403 - val_loss: 0.7329 - val_acc: 0.7472
Epoch 13/20
 - 1s - loss: 0.7648 - acc: 0.7584 - val_loss: 0.6431 - val_acc: 0.7895
Epoch 14/20
 - 1s - loss: 0.6734 - acc: 0.7872 - val_loss: 0.7036 - val_acc: 0.7569
Epoch 15/20
 - 1s - loss: 0.7062 - acc: 0.7723 - val_loss: 0.8539 - val_acc: 0.7171
Epoch 16/20
 - 1s - loss: 0.6898 - acc: 0.7803 - val_loss: 0.8597 - val_acc: 0.7372
Epoch 17/20
 - 1s - loss: 0.6278 - acc: 0.7909 - val_loss: 0.5314 - val_acc: 0.8195
Epoch 18/20
 - 1s - loss: 0.6218 - acc: 0.7957 - val_loss: 0.7016 - val_acc: 0.7686
Epoch 19/20
 - 1s - loss: 0.5713 - acc: 0.8149 - val_loss: 1.0570 - val_acc: 0.6451
Epoch 20/20
 - 1s - loss: 0.6522 - acc: 0.7899 - val_loss: 0.5843 - val_acc: 0.8023
Test loss: 0.5834552520275116
Test accuracy: 0.8035
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5651 - acc: 0.4973 - val_loss: 0.9392 - val_acc: 0.7061
Epoch 2/20
 - 0s - loss: 0.6262 - acc: 0.8218 - val_loss: 0.6184 - val_acc: 0.8012
Epoch 3/20
 - 0s - loss: 0.4196 - acc: 0.8751 - val_loss: 0.6760 - val_acc: 0.7692
Epoch 4/20
 - 0s - loss: 0.3470 - acc: 0.8858 - val_loss: 0.4859 - val_acc: 0.8465
Epoch 5/20
 - 0s - loss: 0.2425 - acc: 0.9456 - val_loss: 0.9381 - val_acc: 0.7117
Epoch 6/20
 - 0s - loss: 0.2397 - acc: 0.9285 - val_loss: 0.4399 - val_acc: 0.8679
Epoch 7/20
 - 0s - loss: 0.1365 - acc: 0.9616 - val_loss: 0.4923 - val_acc: 0.8494
Epoch 8/20
 - 0s - loss: 0.1773 - acc: 0.9488 - val_loss: 0.3881 - val_acc: 0.8793
Epoch 9/20
 - 0s - loss: 0.0708 - acc: 0.9893 - val_loss: 0.4607 - val_acc: 0.8622
Epoch 10/20
 - 0s - loss: 0.0687 - acc: 0.9851 - val_loss: 0.4445 - val_acc: 0.8685
Epoch 11/20
 - 0s - loss: 0.0527 - acc: 0.9915 - val_loss: 0.4070 - val_acc: 0.8807
Epoch 12/20
 - 0s - loss: 0.0323 - acc: 0.9925 - val_loss: 0.4643 - val_acc: 0.8713
Epoch 13/20
 - 0s - loss: 0.0272 - acc: 0.9968 - val_loss: 0.4179 - val_acc: 0.8817
Epoch 14/20
 - 0s - loss: 0.0361 - acc: 0.9936 - val_loss: 0.4179 - val_acc: 0.8885
Epoch 15/20
 - 0s - loss: 0.0115 - acc: 1.0000 - val_loss: 0.5415 - val_acc: 0.8639
Epoch 16/20
 - 0s - loss: 0.1406 - acc: 0.9605 - val_loss: 0.4833 - val_acc: 0.8742
Epoch 17/20
 - 0s - loss: 0.0098 - acc: 1.0000 - val_loss: 0.3854 - val_acc: 0.8969
Epoch 18/20
 - 0s - loss: 0.0062 - acc: 1.0000 - val_loss: 0.4133 - val_acc: 0.8909
Epoch 19/20
 - 0s - loss: 0.0053 - acc: 1.0000 - val_loss: 0.4866 - val_acc: 0.8865
Epoch 20/20
 - 0s - loss: 0.0785 - acc: 0.9744 - val_loss: 0.4303 - val_acc: 0.8973
Test loss: 0.4302879879336804
Test accuracy: 0.8973
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.0802 - acc: 0.1291 - val_loss: 2.1544 - val_acc: 0.2210
Epoch 2/20
 - 1s - loss: 2.1639 - acc: 0.2327 - val_loss: 2.1196 - val_acc: 0.1676
Epoch 3/20
 - 1s - loss: 2.0400 - acc: 0.3031 - val_loss: 1.8606 - val_acc: 0.2690
Epoch 4/20
 - 1s - loss: 1.8766 - acc: 0.3469 - val_loss: 1.8447 - val_acc: 0.3793
Epoch 5/20
 - 1s - loss: 1.7078 - acc: 0.4472 - val_loss: 1.5439 - val_acc: 0.4680
Epoch 6/20
 - 1s - loss: 1.5505 - acc: 0.4707 - val_loss: 1.5561 - val_acc: 0.4448
Epoch 7/20
 - 1s - loss: 1.5134 - acc: 0.4909 - val_loss: 1.1885 - val_acc: 0.5805
Epoch 8/20
 - 0s - loss: 1.3876 - acc: 0.5336 - val_loss: 1.0978 - val_acc: 0.6589
Epoch 9/20
 - 1s - loss: 1.1893 - acc: 0.6147 - val_loss: 1.2387 - val_acc: 0.6555
Epoch 10/20
 - 1s - loss: 1.0757 - acc: 0.6681 - val_loss: 1.3822 - val_acc: 0.5333
Epoch 11/20
 - 0s - loss: 1.0616 - acc: 0.6478 - val_loss: 0.9881 - val_acc: 0.6784
Epoch 12/20
 - 1s - loss: 1.0796 - acc: 0.6670 - val_loss: 0.8350 - val_acc: 0.7202
Epoch 13/20
 - 1s - loss: 0.8193 - acc: 0.7279 - val_loss: 1.9556 - val_acc: 0.3956
Epoch 14/20
 - 1s - loss: 1.0686 - acc: 0.6457 - val_loss: 1.1203 - val_acc: 0.6308
Epoch 15/20
 - 1s - loss: 0.8995 - acc: 0.7289 - val_loss: 0.9446 - val_acc: 0.6903
Epoch 16/20
 - 0s - loss: 0.9052 - acc: 0.6980 - val_loss: 1.3042 - val_acc: 0.5550
Epoch 17/20
 - 0s - loss: 0.9722 - acc: 0.6841 - val_loss: 1.0063 - val_acc: 0.6420
Epoch 18/20
 - 1s - loss: 0.7169 - acc: 0.7663 - val_loss: 1.1451 - val_acc: 0.6079
Epoch 19/20
 - 1s - loss: 0.8456 - acc: 0.7193 - val_loss: 0.8300 - val_acc: 0.7251
Epoch 20/20
 - 0s - loss: 0.6980 - acc: 0.7673 - val_loss: 1.4681 - val_acc: 0.4923
Test loss: 1.4693364204406738
Test accuracy: 0.4923
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.9324 - acc: 0.3846 - val_loss: 1.3870 - val_acc: 0.5331
Epoch 2/20
 - 0s - loss: 0.7876 - acc: 0.7927 - val_loss: 1.0000 - val_acc: 0.6935
Epoch 3/20
 - 0s - loss: 0.4930 - acc: 0.8590 - val_loss: 0.6838 - val_acc: 0.7857
Epoch 4/20
 - 0s - loss: 0.3853 - acc: 0.8761 - val_loss: 0.6409 - val_acc: 0.7807
Epoch 5/20
 - 0s - loss: 0.2462 - acc: 0.9295 - val_loss: 0.7074 - val_acc: 0.7617
Epoch 6/20
 - 0s - loss: 0.2075 - acc: 0.9551 - val_loss: 0.6114 - val_acc: 0.8065
Epoch 7/20
 - 0s - loss: 0.1721 - acc: 0.9487 - val_loss: 0.6151 - val_acc: 0.8084
Epoch 8/20
 - 0s - loss: 0.1092 - acc: 0.9765 - val_loss: 0.5174 - val_acc: 0.8406
Epoch 9/20
 - 0s - loss: 0.0822 - acc: 0.9893 - val_loss: 0.6619 - val_acc: 0.8089
Epoch 10/20
 - 0s - loss: 0.0725 - acc: 0.9872 - val_loss: 0.5868 - val_acc: 0.8306
Epoch 11/20
 - 0s - loss: 0.0464 - acc: 0.9979 - val_loss: 0.5420 - val_acc: 0.8429
Epoch 12/20
 - 0s - loss: 0.0335 - acc: 0.9979 - val_loss: 0.6588 - val_acc: 0.8180
Epoch 13/20
 - 0s - loss: 0.1473 - acc: 0.9551 - val_loss: 0.6099 - val_acc: 0.8261
Epoch 14/20
 - 0s - loss: 0.0259 - acc: 0.9979 - val_loss: 0.5339 - val_acc: 0.8463
Epoch 15/20
 - 0s - loss: 0.0157 - acc: 1.0000 - val_loss: 0.5359 - val_acc: 0.8494
Epoch 16/20
 - 0s - loss: 0.0141 - acc: 1.0000 - val_loss: 0.6513 - val_acc: 0.8366
Epoch 17/20
 - 0s - loss: 0.0322 - acc: 0.9915 - val_loss: 0.5560 - val_acc: 0.8527
Epoch 18/20
 - 0s - loss: 0.0087 - acc: 1.0000 - val_loss: 0.5668 - val_acc: 0.8509
Epoch 19/20
 - 0s - loss: 0.0068 - acc: 1.0000 - val_loss: 0.5697 - val_acc: 0.8506
Epoch 20/20
 - 0s - loss: 0.0041 - acc: 1.0000 - val_loss: 0.6184 - val_acc: 0.8528
Test loss: 0.6184485977709293
Test accuracy: 0.8528
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.8364 - acc: 0.1282 - val_loss: 2.9325 - val_acc: 0.0959
Epoch 2/20
 - 0s - loss: 2.6692 - acc: 0.1560 - val_loss: 2.2001 - val_acc: 0.2982
Epoch 3/20
 - 0s - loss: 2.1082 - acc: 0.2714 - val_loss: 2.1546 - val_acc: 0.2060
Epoch 4/20
 - 0s - loss: 2.0259 - acc: 0.2692 - val_loss: 2.1355 - val_acc: 0.3061
Epoch 5/20
 - 0s - loss: 1.9712 - acc: 0.3269 - val_loss: 1.9866 - val_acc: 0.2027
Epoch 6/20
 - 0s - loss: 1.8423 - acc: 0.3697 - val_loss: 1.7848 - val_acc: 0.3318
Epoch 7/20
 - 0s - loss: 1.9165 - acc: 0.3184 - val_loss: 1.9697 - val_acc: 0.4247
Epoch 8/20
 - 0s - loss: 1.6192 - acc: 0.5214 - val_loss: 1.7764 - val_acc: 0.3299
Epoch 9/20
 - 0s - loss: 1.5419 - acc: 0.4551 - val_loss: 1.7027 - val_acc: 0.4629
Epoch 10/20
 - 0s - loss: 1.5438 - acc: 0.4786 - val_loss: 1.9587 - val_acc: 0.2398
Epoch 11/20
 - 0s - loss: 1.4072 - acc: 0.5641 - val_loss: 1.5022 - val_acc: 0.5183
Epoch 12/20
 - 0s - loss: 1.5663 - acc: 0.4872 - val_loss: 1.3410 - val_acc: 0.6152
Epoch 13/20
 - 0s - loss: 1.2414 - acc: 0.6154 - val_loss: 1.3213 - val_acc: 0.5155
Epoch 14/20
 - 0s - loss: 1.1679 - acc: 0.6218 - val_loss: 1.1847 - val_acc: 0.6208
Epoch 15/20
 - 0s - loss: 1.1913 - acc: 0.6197 - val_loss: 1.4198 - val_acc: 0.5230
Epoch 16/20
 - 0s - loss: 0.9811 - acc: 0.7094 - val_loss: 0.9955 - val_acc: 0.6913
Epoch 17/20
 - 0s - loss: 1.0223 - acc: 0.6667 - val_loss: 1.2698 - val_acc: 0.5263
Epoch 18/20
 - 0s - loss: 1.1373 - acc: 0.6090 - val_loss: 1.4859 - val_acc: 0.4906
Epoch 19/20
 - 0s - loss: 1.0729 - acc: 0.6645 - val_loss: 0.9900 - val_acc: 0.6570
Epoch 20/20
 - 0s - loss: 0.7692 - acc: 0.7500 - val_loss: 1.3145 - val_acc: 0.5173
Test loss: 1.3145928154945374
Test accuracy: 0.5169
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1903 - acc: 0.2094 - val_loss: 1.7226 - val_acc: 0.5831
Epoch 2/20
 - 0s - loss: 1.3029 - acc: 0.7009 - val_loss: 1.5028 - val_acc: 0.5049
Epoch 3/20
 - 0s - loss: 1.0146 - acc: 0.6752 - val_loss: 1.2769 - val_acc: 0.6109
Epoch 4/20
 - 0s - loss: 0.5667 - acc: 0.8761 - val_loss: 0.9006 - val_acc: 0.7233
Epoch 5/20
 - 0s - loss: 0.3838 - acc: 0.8932 - val_loss: 0.9017 - val_acc: 0.7159
Epoch 6/20
 - 0s - loss: 0.3770 - acc: 0.8846 - val_loss: 0.9596 - val_acc: 0.7072
Epoch 7/20
 - 0s - loss: 0.2455 - acc: 0.9316 - val_loss: 0.7672 - val_acc: 0.7584
Epoch 8/20
 - 0s - loss: 0.1620 - acc: 0.9701 - val_loss: 0.7370 - val_acc: 0.7678
Epoch 9/20
 - 0s - loss: 0.1088 - acc: 0.9915 - val_loss: 0.7742 - val_acc: 0.7645
Epoch 10/20
 - 0s - loss: 0.0939 - acc: 0.9915 - val_loss: 0.7637 - val_acc: 0.7741
Epoch 11/20
 - 0s - loss: 0.0679 - acc: 0.9915 - val_loss: 0.7444 - val_acc: 0.7674
Epoch 12/20
 - 0s - loss: 0.0751 - acc: 0.9872 - val_loss: 0.7194 - val_acc: 0.7798
Epoch 13/20
 - 0s - loss: 0.0430 - acc: 1.0000 - val_loss: 0.7558 - val_acc: 0.7773
Epoch 14/20
 - 0s - loss: 0.0364 - acc: 1.0000 - val_loss: 0.7399 - val_acc: 0.7797
Epoch 15/20
 - 0s - loss: 0.0302 - acc: 1.0000 - val_loss: 0.7986 - val_acc: 0.7764
Epoch 16/20
 - 0s - loss: 0.0246 - acc: 1.0000 - val_loss: 0.7785 - val_acc: 0.7816
Epoch 17/20
 - 0s - loss: 0.0184 - acc: 1.0000 - val_loss: 0.7584 - val_acc: 0.7842
Epoch 18/20
 - 0s - loss: 0.0158 - acc: 1.0000 - val_loss: 0.7809 - val_acc: 0.7844
Epoch 19/20
 - 0s - loss: 0.0128 - acc: 1.0000 - val_loss: 0.7831 - val_acc: 0.7840
Epoch 20/20
 - 0s - loss: 0.0120 - acc: 1.0000 - val_loss: 0.8258 - val_acc: 0.7794
Test loss: 0.8257711037874221
Test accuracy: 0.7794
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.0634 - acc: 0.0940 - val_loss: 8.0871 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 6.5661 - acc: 0.1368 - val_loss: 4.5054 - val_acc: 0.1012
Epoch 3/20
 - 0s - loss: 4.1883 - acc: 0.1068 - val_loss: 2.3794 - val_acc: 0.1990
Epoch 4/20
 - 0s - loss: 2.4125 - acc: 0.1581 - val_loss: 2.1676 - val_acc: 0.3383
Epoch 5/20
 - 0s - loss: 2.1001 - acc: 0.3034 - val_loss: 2.0965 - val_acc: 0.2432
Epoch 6/20
 - 0s - loss: 2.0770 - acc: 0.2735 - val_loss: 2.0687 - val_acc: 0.2014
Epoch 7/20
 - 0s - loss: 2.0338 - acc: 0.2821 - val_loss: 1.9785 - val_acc: 0.2763
Epoch 8/20
 - 0s - loss: 1.8820 - acc: 0.3333 - val_loss: 1.9206 - val_acc: 0.3685
Epoch 9/20
 - 0s - loss: 1.8343 - acc: 0.3932 - val_loss: 1.9501 - val_acc: 0.2871
Epoch 10/20
 - 0s - loss: 1.9746 - acc: 0.3205 - val_loss: 1.9810 - val_acc: 0.3178
Epoch 11/20
 - 0s - loss: 1.8251 - acc: 0.3974 - val_loss: 1.7423 - val_acc: 0.4987
Epoch 12/20
 - 0s - loss: 1.6981 - acc: 0.4615 - val_loss: 1.8605 - val_acc: 0.3047
Epoch 13/20
 - 0s - loss: 1.8188 - acc: 0.3333 - val_loss: 1.9918 - val_acc: 0.2866
Epoch 14/20
 - 0s - loss: 1.7574 - acc: 0.3932 - val_loss: 1.8768 - val_acc: 0.3704
Epoch 15/20
 - 0s - loss: 1.6708 - acc: 0.4658 - val_loss: 1.5588 - val_acc: 0.5059
Epoch 16/20
 - 0s - loss: 1.3871 - acc: 0.6154 - val_loss: 1.6355 - val_acc: 0.4445
Epoch 17/20
 - 0s - loss: 1.4986 - acc: 0.5085 - val_loss: 2.0305 - val_acc: 0.3191
Epoch 18/20
 - 0s - loss: 1.7223 - acc: 0.4231 - val_loss: 1.7240 - val_acc: 0.4034
Epoch 19/20
 - 0s - loss: 1.4119 - acc: 0.5299 - val_loss: 1.4317 - val_acc: 0.6180
Epoch 20/20
 - 0s - loss: 1.2280 - acc: 0.6624 - val_loss: 1.9958 - val_acc: 0.3799
Test loss: 1.9953662672042847
Test accuracy: 0.3791
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.2937 - acc: 0.1453 - val_loss: 1.9552 - val_acc: 0.3903
Epoch 2/20
 - 0s - loss: 1.4730 - acc: 0.6581 - val_loss: 1.7492 - val_acc: 0.3961
Epoch 3/20
 - 0s - loss: 1.2246 - acc: 0.6325 - val_loss: 1.9986 - val_acc: 0.3551
Epoch 4/20
 - 0s - loss: 1.1677 - acc: 0.6410 - val_loss: 1.4588 - val_acc: 0.5281
Epoch 5/20
 - 0s - loss: 0.7994 - acc: 0.7863 - val_loss: 1.1761 - val_acc: 0.6411
Epoch 6/20
 - 0s - loss: 0.4301 - acc: 0.9487 - val_loss: 1.1291 - val_acc: 0.6567
Epoch 7/20
 - 0s - loss: 0.2625 - acc: 0.9658 - val_loss: 0.9974 - val_acc: 0.6922
Epoch 8/20
 - 0s - loss: 0.1859 - acc: 0.9829 - val_loss: 1.0663 - val_acc: 0.6720
Epoch 9/20
 - 0s - loss: 0.1540 - acc: 1.0000 - val_loss: 0.9627 - val_acc: 0.7013
Epoch 10/20
 - 0s - loss: 0.1274 - acc: 0.9915 - val_loss: 1.1629 - val_acc: 0.6220
Epoch 11/20
 - 0s - loss: 0.1491 - acc: 0.9658 - val_loss: 1.1502 - val_acc: 0.6709
Epoch 12/20
 - 0s - loss: 0.1804 - acc: 0.9316 - val_loss: 1.3070 - val_acc: 0.5953
Epoch 13/20
 - 0s - loss: 0.1528 - acc: 0.9573 - val_loss: 1.1283 - val_acc: 0.6790
Epoch 14/20
 - 0s - loss: 0.1006 - acc: 0.9829 - val_loss: 0.9595 - val_acc: 0.7122
Epoch 15/20
 - 0s - loss: 0.0367 - acc: 1.0000 - val_loss: 0.9498 - val_acc: 0.7189
Epoch 16/20
 - 0s - loss: 0.0374 - acc: 1.0000 - val_loss: 0.9567 - val_acc: 0.7196
Epoch 17/20
 - 0s - loss: 0.0310 - acc: 1.0000 - val_loss: 0.9554 - val_acc: 0.7259
Epoch 18/20
 - 0s - loss: 0.0283 - acc: 1.0000 - val_loss: 0.9755 - val_acc: 0.7239
Epoch 19/20
 - 0s - loss: 0.0194 - acc: 1.0000 - val_loss: 0.9750 - val_acc: 0.7238
Epoch 20/20
 - 0s - loss: 0.0194 - acc: 1.0000 - val_loss: 1.0068 - val_acc: 0.7211
Test loss: 1.006805503320694
Test accuracy: 0.7211
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5618 - acc: 0.0940 - val_loss: 8.4643 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 8.1668 - acc: 0.1453 - val_loss: 5.8629 - val_acc: 0.0982
Epoch 3/20
 - 0s - loss: 6.3625 - acc: 0.1453 - val_loss: 3.5849 - val_acc: 0.1014
Epoch 4/20
 - 0s - loss: 4.1027 - acc: 0.0855 - val_loss: 2.7514 - val_acc: 0.1890
Epoch 5/20
 - 0s - loss: 2.7465 - acc: 0.1709 - val_loss: 2.2144 - val_acc: 0.1786
Epoch 6/20
 - 0s - loss: 2.2307 - acc: 0.1966 - val_loss: 2.1584 - val_acc: 0.2309
Epoch 7/20
 - 0s - loss: 2.0674 - acc: 0.2906 - val_loss: 2.0941 - val_acc: 0.3678
Epoch 8/20
 - 0s - loss: 2.0040 - acc: 0.3333 - val_loss: 2.0824 - val_acc: 0.2759
Epoch 9/20
 - 0s - loss: 1.9182 - acc: 0.3248 - val_loss: 2.0590 - val_acc: 0.3556
Epoch 10/20
 - 0s - loss: 1.9138 - acc: 0.3419 - val_loss: 2.1992 - val_acc: 0.1659
Epoch 11/20
 - 0s - loss: 1.9417 - acc: 0.2650 - val_loss: 2.2848 - val_acc: 0.2290
Epoch 12/20
 - 0s - loss: 2.2011 - acc: 0.2650 - val_loss: 2.0302 - val_acc: 0.3450
Epoch 13/20
 - 0s - loss: 1.8092 - acc: 0.4017 - val_loss: 2.0539 - val_acc: 0.3067
Epoch 14/20
 - 0s - loss: 1.8247 - acc: 0.3932 - val_loss: 1.9866 - val_acc: 0.4045
Epoch 15/20
 - 0s - loss: 1.6935 - acc: 0.4786 - val_loss: 1.9547 - val_acc: 0.3737
Epoch 16/20
 - 0s - loss: 1.7097 - acc: 0.4444 - val_loss: 2.1242 - val_acc: 0.2774
Epoch 17/20
 - 0s - loss: 1.8900 - acc: 0.4017 - val_loss: 1.9914 - val_acc: 0.3339
Epoch 18/20
 - 0s - loss: 1.7772 - acc: 0.4103 - val_loss: 1.9197 - val_acc: 0.3027
Epoch 19/20
 - 0s - loss: 1.6497 - acc: 0.4786 - val_loss: 1.9129 - val_acc: 0.2987
Epoch 20/20
 - 0s - loss: 1.5534 - acc: 0.4615 - val_loss: 2.1253 - val_acc: 0.2620
Test loss: 2.125375364303589
Test accuracy: 0.262
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2463 - acc: 0.9232 - val_loss: 0.1262 - val_acc: 0.9595
Epoch 2/20
 - 2s - loss: 0.1038 - acc: 0.9689 - val_loss: 0.0827 - val_acc: 0.9736
Epoch 3/20
 - 2s - loss: 0.0743 - acc: 0.9773 - val_loss: 0.0767 - val_acc: 0.9779
Epoch 4/20
 - 3s - loss: 0.0593 - acc: 0.9820 - val_loss: 0.0777 - val_acc: 0.9790
Epoch 5/20
 - 3s - loss: 0.0497 - acc: 0.9848 - val_loss: 0.0715 - val_acc: 0.9815
Epoch 6/20
 - 3s - loss: 0.0449 - acc: 0.9869 - val_loss: 0.0812 - val_acc: 0.9807
Epoch 7/20
 - 2s - loss: 0.0382 - acc: 0.9887 - val_loss: 0.0884 - val_acc: 0.9787
Epoch 8/20
 - 2s - loss: 0.0361 - acc: 0.9893 - val_loss: 0.0893 - val_acc: 0.9811
Epoch 9/20
 - 2s - loss: 0.0326 - acc: 0.9908 - val_loss: 0.0971 - val_acc: 0.9802
Epoch 10/20
 - 2s - loss: 0.0286 - acc: 0.9921 - val_loss: 0.0921 - val_acc: 0.9811
Epoch 11/20
 - 2s - loss: 0.0277 - acc: 0.9922 - val_loss: 0.0980 - val_acc: 0.9801
Epoch 12/20
 - 2s - loss: 0.0285 - acc: 0.9922 - val_loss: 0.0829 - val_acc: 0.9835
Epoch 13/20
 - 2s - loss: 0.0255 - acc: 0.9928 - val_loss: 0.0880 - val_acc: 0.9826
Epoch 14/20
 - 2s - loss: 0.0241 - acc: 0.9935 - val_loss: 0.0980 - val_acc: 0.9832
Epoch 15/20
 - 2s - loss: 0.0240 - acc: 0.9937 - val_loss: 0.1161 - val_acc: 0.9823
Epoch 16/20
 - 2s - loss: 0.0223 - acc: 0.9941 - val_loss: 0.1060 - val_acc: 0.9828
Epoch 17/20
 - 2s - loss: 0.0226 - acc: 0.9940 - val_loss: 0.1129 - val_acc: 0.9828
Epoch 18/20
 - 2s - loss: 0.0197 - acc: 0.9947 - val_loss: 0.1021 - val_acc: 0.9845
Epoch 19/20
 - 2s - loss: 0.0199 - acc: 0.9952 - val_loss: 0.1099 - val_acc: 0.9831
Epoch 20/20
 - 2s - loss: 0.0211 - acc: 0.9948 - val_loss: 0.1174 - val_acc: 0.9828
Test loss: 0.11738049975254514
Test accuracy: 0.9828
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9478 - acc: 0.6933 - val_loss: 0.3340 - val_acc: 0.8923
Epoch 2/20
 - 4s - loss: 0.4341 - acc: 0.8613 - val_loss: 0.3693 - val_acc: 0.8846
Epoch 3/20
 - 4s - loss: 0.3160 - acc: 0.9006 - val_loss: 0.1838 - val_acc: 0.9441
Epoch 4/20
 - 4s - loss: 0.2671 - acc: 0.9162 - val_loss: 0.1818 - val_acc: 0.9416
Epoch 5/20
 - 4s - loss: 0.2356 - acc: 0.9266 - val_loss: 0.1819 - val_acc: 0.9397
Epoch 6/20
 - 4s - loss: 0.2195 - acc: 0.9330 - val_loss: 0.1879 - val_acc: 0.9410
Epoch 7/20
 - 4s - loss: 0.2027 - acc: 0.9371 - val_loss: 0.1920 - val_acc: 0.9406
Epoch 8/20
 - 4s - loss: 0.1904 - acc: 0.9418 - val_loss: 0.1721 - val_acc: 0.9438
Epoch 9/20
 - 4s - loss: 0.1845 - acc: 0.9440 - val_loss: 0.1143 - val_acc: 0.9650
Epoch 10/20
 - 4s - loss: 0.1747 - acc: 0.9478 - val_loss: 0.1205 - val_acc: 0.9655
Epoch 11/20
 - 4s - loss: 0.1745 - acc: 0.9478 - val_loss: 0.1604 - val_acc: 0.9569
Epoch 12/20
 - 4s - loss: 0.1725 - acc: 0.9487 - val_loss: 0.1144 - val_acc: 0.9683
Epoch 13/20
 - 4s - loss: 0.1704 - acc: 0.9504 - val_loss: 0.1079 - val_acc: 0.9660
Epoch 14/20
 - 4s - loss: 0.1719 - acc: 0.9507 - val_loss: 0.1088 - val_acc: 0.9705
Epoch 15/20
 - 4s - loss: 0.1693 - acc: 0.9514 - val_loss: 0.1270 - val_acc: 0.9617
Epoch 16/20
 - 4s - loss: 0.1695 - acc: 0.9527 - val_loss: 0.1103 - val_acc: 0.9701
Epoch 17/20
 - 4s - loss: 0.1674 - acc: 0.9543 - val_loss: 0.1513 - val_acc: 0.9616
Epoch 18/20
 - 4s - loss: 0.1688 - acc: 0.9530 - val_loss: 0.1435 - val_acc: 0.9565
Epoch 19/20
 - 4s - loss: 0.1666 - acc: 0.9536 - val_loss: 0.1214 - val_acc: 0.9641
Epoch 20/20
 - 4s - loss: 0.1648 - acc: 0.9547 - val_loss: 0.1496 - val_acc: 0.9572
Test loss: 0.1491437634855276
Test accuracy: 0.9565
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3322 - acc: 0.8973 - val_loss: 0.1355 - val_acc: 0.9589
Epoch 2/20
 - 1s - loss: 0.1326 - acc: 0.9586 - val_loss: 0.1260 - val_acc: 0.9602
Epoch 3/20
 - 1s - loss: 0.0901 - acc: 0.9724 - val_loss: 0.1415 - val_acc: 0.9560
Epoch 4/20
 - 1s - loss: 0.0657 - acc: 0.9802 - val_loss: 0.1295 - val_acc: 0.9631
Epoch 5/20
 - 1s - loss: 0.0533 - acc: 0.9832 - val_loss: 0.0938 - val_acc: 0.9754
Epoch 6/20
 - 1s - loss: 0.0439 - acc: 0.9858 - val_loss: 0.0979 - val_acc: 0.9734
Epoch 7/20
 - 1s - loss: 0.0382 - acc: 0.9877 - val_loss: 0.0924 - val_acc: 0.9766
Epoch 8/20
 - 1s - loss: 0.0314 - acc: 0.9905 - val_loss: 0.1030 - val_acc: 0.9766
Epoch 9/20
 - 1s - loss: 0.0259 - acc: 0.9917 - val_loss: 0.1050 - val_acc: 0.9777
Epoch 10/20
 - 1s - loss: 0.0246 - acc: 0.9920 - val_loss: 0.1031 - val_acc: 0.9772
Epoch 11/20
 - 1s - loss: 0.0200 - acc: 0.9928 - val_loss: 0.1212 - val_acc: 0.9753
Epoch 12/20
 - 1s - loss: 0.0206 - acc: 0.9937 - val_loss: 0.1433 - val_acc: 0.9727
Epoch 13/20
 - 1s - loss: 0.0185 - acc: 0.9942 - val_loss: 0.1223 - val_acc: 0.9770
Epoch 14/20
 - 1s - loss: 0.0141 - acc: 0.9958 - val_loss: 0.1369 - val_acc: 0.9771
Epoch 15/20
 - 1s - loss: 0.0136 - acc: 0.9955 - val_loss: 0.1442 - val_acc: 0.9758
Epoch 16/20
 - 1s - loss: 0.0157 - acc: 0.9949 - val_loss: 0.1271 - val_acc: 0.9794
Epoch 17/20
 - 1s - loss: 0.0143 - acc: 0.9961 - val_loss: 0.1296 - val_acc: 0.9807
Epoch 18/20
 - 1s - loss: 0.0130 - acc: 0.9963 - val_loss: 0.1392 - val_acc: 0.9790
Epoch 19/20
 - 1s - loss: 0.0140 - acc: 0.9958 - val_loss: 0.1567 - val_acc: 0.9767
Epoch 20/20
 - 1s - loss: 0.0113 - acc: 0.9968 - val_loss: 0.1351 - val_acc: 0.9803
Test loss: 0.13511900009366418
Test accuracy: 0.9803
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2323 - acc: 0.6042 - val_loss: 0.7895 - val_acc: 0.7442
Epoch 2/20
 - 2s - loss: 0.6178 - acc: 0.7991 - val_loss: 0.4155 - val_acc: 0.8710
Epoch 3/20
 - 2s - loss: 0.4603 - acc: 0.8529 - val_loss: 0.4321 - val_acc: 0.8537
Epoch 4/20
 - 2s - loss: 0.3748 - acc: 0.8795 - val_loss: 0.3724 - val_acc: 0.8825
Epoch 5/20
 - 2s - loss: 0.3320 - acc: 0.8951 - val_loss: 0.3783 - val_acc: 0.8768
Epoch 6/20
 - 2s - loss: 0.2914 - acc: 0.9070 - val_loss: 0.2065 - val_acc: 0.9358
Epoch 7/20
 - 2s - loss: 0.2607 - acc: 0.9177 - val_loss: 0.3666 - val_acc: 0.8811
Epoch 8/20
 - 2s - loss: 0.2408 - acc: 0.9248 - val_loss: 0.2037 - val_acc: 0.9347
Epoch 9/20
 - 2s - loss: 0.2182 - acc: 0.9322 - val_loss: 0.2615 - val_acc: 0.9153
Epoch 10/20
 - 2s - loss: 0.2151 - acc: 0.9328 - val_loss: 0.2305 - val_acc: 0.9297
Epoch 11/20
 - 2s - loss: 0.2059 - acc: 0.9350 - val_loss: 0.1405 - val_acc: 0.9577
Epoch 12/20
 - 2s - loss: 0.1893 - acc: 0.9406 - val_loss: 0.2310 - val_acc: 0.9286
Epoch 13/20
 - 2s - loss: 0.1837 - acc: 0.9430 - val_loss: 0.1460 - val_acc: 0.9556
Epoch 14/20
 - 2s - loss: 0.1792 - acc: 0.9453 - val_loss: 0.1743 - val_acc: 0.9395
Epoch 15/20
 - 2s - loss: 0.1669 - acc: 0.9471 - val_loss: 0.1973 - val_acc: 0.9396
Epoch 16/20
 - 3s - loss: 0.1687 - acc: 0.9479 - val_loss: 0.2465 - val_acc: 0.9257
Epoch 17/20
 - 2s - loss: 0.1606 - acc: 0.9506 - val_loss: 0.1931 - val_acc: 0.9423
Epoch 18/20
 - 2s - loss: 0.1573 - acc: 0.9520 - val_loss: 0.1241 - val_acc: 0.9603
Epoch 19/20
 - 2s - loss: 0.1526 - acc: 0.9529 - val_loss: 0.2408 - val_acc: 0.9253
Epoch 20/20
 - 2s - loss: 0.1517 - acc: 0.9540 - val_loss: 0.1303 - val_acc: 0.9619
Test loss: 0.12960820781299845
Test accuracy: 0.9621
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4622 - acc: 0.8563 - val_loss: 0.2981 - val_acc: 0.9045
Epoch 2/20
 - 1s - loss: 0.1850 - acc: 0.9459 - val_loss: 0.1538 - val_acc: 0.9526
Epoch 3/20
 - 1s - loss: 0.1224 - acc: 0.9621 - val_loss: 0.1815 - val_acc: 0.9437
Epoch 4/20
 - 1s - loss: 0.0835 - acc: 0.9745 - val_loss: 0.1551 - val_acc: 0.9541
Epoch 5/20
 - 1s - loss: 0.0605 - acc: 0.9799 - val_loss: 0.1966 - val_acc: 0.9431
Epoch 6/20
 - 1s - loss: 0.0486 - acc: 0.9849 - val_loss: 0.1275 - val_acc: 0.9664
Epoch 7/20
 - 1s - loss: 0.0379 - acc: 0.9871 - val_loss: 0.1306 - val_acc: 0.9659
Epoch 8/20
 - 1s - loss: 0.0278 - acc: 0.9892 - val_loss: 0.1401 - val_acc: 0.9661
Epoch 9/20
 - 1s - loss: 0.0270 - acc: 0.9912 - val_loss: 0.1531 - val_acc: 0.9646
Epoch 10/20
 - 1s - loss: 0.0229 - acc: 0.9917 - val_loss: 0.1532 - val_acc: 0.9687
Epoch 11/20
 - 1s - loss: 0.0175 - acc: 0.9943 - val_loss: 0.1892 - val_acc: 0.9634
Epoch 12/20
 - 1s - loss: 0.0164 - acc: 0.9946 - val_loss: 0.1706 - val_acc: 0.9686
Epoch 13/20
 - 1s - loss: 0.0135 - acc: 0.9959 - val_loss: 0.1788 - val_acc: 0.9653
Epoch 14/20
 - 1s - loss: 0.0136 - acc: 0.9951 - val_loss: 0.2084 - val_acc: 0.9626
Epoch 15/20
 - 1s - loss: 0.0148 - acc: 0.9950 - val_loss: 0.1556 - val_acc: 0.9723
Epoch 16/20
 - 1s - loss: 0.0109 - acc: 0.9967 - val_loss: 0.1709 - val_acc: 0.9707
Epoch 17/20
 - 1s - loss: 0.0117 - acc: 0.9960 - val_loss: 0.1600 - val_acc: 0.9706
Epoch 18/20
 - 1s - loss: 0.0103 - acc: 0.9962 - val_loss: 0.1943 - val_acc: 0.9668
Epoch 19/20
 - 1s - loss: 0.0124 - acc: 0.9962 - val_loss: 0.1822 - val_acc: 0.9700
Epoch 20/20
 - 1s - loss: 0.0113 - acc: 0.9958 - val_loss: 0.1757 - val_acc: 0.9704
Test loss: 0.17572257060323185
Test accuracy: 0.9704
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.5810 - acc: 0.4945 - val_loss: 1.0756 - val_acc: 0.6013
Epoch 2/20
 - 1s - loss: 0.8104 - acc: 0.7367 - val_loss: 0.8621 - val_acc: 0.7015
Epoch 3/20
 - 1s - loss: 0.6645 - acc: 0.7849 - val_loss: 0.8552 - val_acc: 0.7365
Epoch 4/20
 - 1s - loss: 0.5583 - acc: 0.8204 - val_loss: 0.9102 - val_acc: 0.7107
Epoch 5/20
 - 1s - loss: 0.4922 - acc: 0.8461 - val_loss: 0.5677 - val_acc: 0.8055
Epoch 6/20
 - 1s - loss: 0.4202 - acc: 0.8679 - val_loss: 0.3557 - val_acc: 0.8822
Epoch 7/20
 - 1s - loss: 0.3943 - acc: 0.8705 - val_loss: 0.3686 - val_acc: 0.8804
Epoch 8/20
 - 1s - loss: 0.3649 - acc: 0.8849 - val_loss: 0.3739 - val_acc: 0.8744
Epoch 9/20
 - 1s - loss: 0.3363 - acc: 0.8923 - val_loss: 0.2512 - val_acc: 0.9182
Epoch 10/20
 - 1s - loss: 0.3053 - acc: 0.9032 - val_loss: 0.4637 - val_acc: 0.8233
Epoch 11/20
 - 1s - loss: 0.2946 - acc: 0.9068 - val_loss: 0.5441 - val_acc: 0.8165
Epoch 12/20
 - 1s - loss: 0.2644 - acc: 0.9155 - val_loss: 0.7132 - val_acc: 0.7554
Epoch 13/20
 - 1s - loss: 0.2590 - acc: 0.9171 - val_loss: 0.2005 - val_acc: 0.9368
Epoch 14/20
 - 1s - loss: 0.2440 - acc: 0.9225 - val_loss: 0.2598 - val_acc: 0.9151
Epoch 15/20
 - 1s - loss: 0.2378 - acc: 0.9255 - val_loss: 0.2684 - val_acc: 0.9154
Epoch 16/20
 - 1s - loss: 0.2204 - acc: 0.9295 - val_loss: 0.4074 - val_acc: 0.8718
Epoch 17/20
 - 1s - loss: 0.2173 - acc: 0.9295 - val_loss: 0.3398 - val_acc: 0.8891
Epoch 18/20
 - 1s - loss: 0.2102 - acc: 0.9338 - val_loss: 0.1587 - val_acc: 0.9515
Epoch 19/20
 - 1s - loss: 0.1951 - acc: 0.9355 - val_loss: 0.4271 - val_acc: 0.8740
Epoch 20/20
 - 1s - loss: 0.1954 - acc: 0.9356 - val_loss: 0.2746 - val_acc: 0.9154
Test loss: 0.27582932843901214
Test accuracy: 0.9166
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6021 - acc: 0.8131 - val_loss: 0.2966 - val_acc: 0.9116
Epoch 2/20
 - 0s - loss: 0.2423 - acc: 0.9305 - val_loss: 0.2273 - val_acc: 0.9320
Epoch 3/20
 - 0s - loss: 0.1661 - acc: 0.9497 - val_loss: 0.2140 - val_acc: 0.9344
Epoch 4/20
 - 0s - loss: 0.1143 - acc: 0.9649 - val_loss: 0.1926 - val_acc: 0.9422
Epoch 5/20
 - 0s - loss: 0.0869 - acc: 0.9731 - val_loss: 0.2002 - val_acc: 0.9412
Epoch 6/20
 - 0s - loss: 0.0634 - acc: 0.9803 - val_loss: 0.1666 - val_acc: 0.9523
Epoch 7/20
 - 0s - loss: 0.0438 - acc: 0.9871 - val_loss: 0.2017 - val_acc: 0.9475
Epoch 8/20
 - 0s - loss: 0.0358 - acc: 0.9885 - val_loss: 0.1749 - val_acc: 0.9553
Epoch 9/20
 - 0s - loss: 0.0215 - acc: 0.9932 - val_loss: 0.1970 - val_acc: 0.9534
Epoch 10/20
 - 0s - loss: 0.0231 - acc: 0.9932 - val_loss: 0.1985 - val_acc: 0.9549
Epoch 11/20
 - 0s - loss: 0.0167 - acc: 0.9955 - val_loss: 0.2021 - val_acc: 0.9559
Epoch 12/20
 - 0s - loss: 0.0140 - acc: 0.9952 - val_loss: 0.2203 - val_acc: 0.9536
Epoch 13/20
 - 0s - loss: 0.0135 - acc: 0.9957 - val_loss: 0.2224 - val_acc: 0.9544
Epoch 14/20
 - 0s - loss: 0.0144 - acc: 0.9952 - val_loss: 0.2325 - val_acc: 0.9527
Epoch 15/20
 - 0s - loss: 0.0102 - acc: 0.9961 - val_loss: 0.2192 - val_acc: 0.9565
Epoch 16/20
 - 0s - loss: 0.0117 - acc: 0.9963 - val_loss: 0.3192 - val_acc: 0.9448
Epoch 17/20
 - 0s - loss: 0.0092 - acc: 0.9976 - val_loss: 0.2466 - val_acc: 0.9547
Epoch 18/20
 - 0s - loss: 0.0091 - acc: 0.9968 - val_loss: 0.2460 - val_acc: 0.9553
Epoch 19/20
 - 0s - loss: 0.0046 - acc: 0.9984 - val_loss: 0.3263 - val_acc: 0.9452
Epoch 20/20
 - 0s - loss: 0.0075 - acc: 0.9975 - val_loss: 0.2944 - val_acc: 0.9524
Test loss: 0.2944150987274866
Test accuracy: 0.9524
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0701 - acc: 0.3564 - val_loss: 1.6541 - val_acc: 0.3787
Epoch 2/20
 - 1s - loss: 1.1263 - acc: 0.6249 - val_loss: 0.7653 - val_acc: 0.7832
Epoch 3/20
 - 1s - loss: 0.8788 - acc: 0.7172 - val_loss: 0.8900 - val_acc: 0.6971
Epoch 4/20
 - 1s - loss: 0.7383 - acc: 0.7620 - val_loss: 0.6544 - val_acc: 0.7699
Epoch 5/20
 - 1s - loss: 0.6831 - acc: 0.7728 - val_loss: 0.5993 - val_acc: 0.8059
Epoch 6/20
 - 1s - loss: 0.5988 - acc: 0.8081 - val_loss: 0.4848 - val_acc: 0.8380
Epoch 7/20
 - 1s - loss: 0.5223 - acc: 0.8320 - val_loss: 0.7256 - val_acc: 0.7965
Epoch 8/20
 - 1s - loss: 0.4813 - acc: 0.8441 - val_loss: 0.4126 - val_acc: 0.8782
Epoch 9/20
 - 1s - loss: 0.4856 - acc: 0.8437 - val_loss: 0.3136 - val_acc: 0.9035
Epoch 10/20
 - 1s - loss: 0.4337 - acc: 0.8587 - val_loss: 0.4929 - val_acc: 0.8389
Epoch 11/20
 - 1s - loss: 0.4163 - acc: 0.8679 - val_loss: 0.3421 - val_acc: 0.8951
Epoch 12/20
 - 1s - loss: 0.3839 - acc: 0.8796 - val_loss: 0.3531 - val_acc: 0.8900
Epoch 13/20
 - 1s - loss: 0.3508 - acc: 0.8899 - val_loss: 0.2624 - val_acc: 0.9176
Epoch 14/20
 - 1s - loss: 0.3314 - acc: 0.8896 - val_loss: 0.2691 - val_acc: 0.9147
Epoch 15/20
 - 1s - loss: 0.3136 - acc: 0.9004 - val_loss: 0.3453 - val_acc: 0.8865
Epoch 16/20
 - 1s - loss: 0.3140 - acc: 0.9008 - val_loss: 0.2674 - val_acc: 0.9167
Epoch 17/20
 - 1s - loss: 0.2968 - acc: 0.9048 - val_loss: 0.4624 - val_acc: 0.8693
Epoch 18/20
 - 1s - loss: 0.3019 - acc: 0.9064 - val_loss: 0.2772 - val_acc: 0.9131
Epoch 19/20
 - 1s - loss: 0.2529 - acc: 0.9199 - val_loss: 0.2406 - val_acc: 0.9272
Epoch 20/20
 - 1s - loss: 0.2567 - acc: 0.9156 - val_loss: 0.2816 - val_acc: 0.9136
Test loss: 0.2816653921369463
Test accuracy: 0.9134
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.7941 - acc: 0.7555 - val_loss: 0.5192 - val_acc: 0.8284
Epoch 2/20
 - 0s - loss: 0.3427 - acc: 0.8939 - val_loss: 0.3775 - val_acc: 0.8836
Epoch 3/20
 - 0s - loss: 0.2172 - acc: 0.9352 - val_loss: 0.4569 - val_acc: 0.8553
Epoch 4/20
 - 0s - loss: 0.1630 - acc: 0.9520 - val_loss: 0.2690 - val_acc: 0.9199
Epoch 5/20
 - 0s - loss: 0.1242 - acc: 0.9616 - val_loss: 0.2745 - val_acc: 0.9171
Epoch 6/20
 - 0s - loss: 0.0885 - acc: 0.9709 - val_loss: 0.2933 - val_acc: 0.9153
Epoch 7/20
 - 0s - loss: 0.0656 - acc: 0.9805 - val_loss: 0.3153 - val_acc: 0.9118
Epoch 8/20
 - 0s - loss: 0.0549 - acc: 0.9835 - val_loss: 0.2787 - val_acc: 0.9235
Epoch 9/20
 - 0s - loss: 0.0472 - acc: 0.9845 - val_loss: 0.2347 - val_acc: 0.9353
Epoch 10/20
 - 0s - loss: 0.0291 - acc: 0.9915 - val_loss: 0.4101 - val_acc: 0.8998
Epoch 11/20
 - 0s - loss: 0.0250 - acc: 0.9936 - val_loss: 0.2480 - val_acc: 0.9367
Epoch 12/20
 - 0s - loss: 0.0206 - acc: 0.9944 - val_loss: 0.3015 - val_acc: 0.9295
Epoch 13/20
 - 0s - loss: 0.0162 - acc: 0.9949 - val_loss: 0.3038 - val_acc: 0.9304
Epoch 14/20
 - 0s - loss: 0.0111 - acc: 0.9979 - val_loss: 0.2574 - val_acc: 0.9429
Epoch 15/20
 - 0s - loss: 0.0132 - acc: 0.9968 - val_loss: 0.3079 - val_acc: 0.9353
Epoch 16/20
 - 0s - loss: 0.0106 - acc: 0.9965 - val_loss: 0.2795 - val_acc: 0.9414
Epoch 17/20
 - 0s - loss: 0.0028 - acc: 0.9995 - val_loss: 0.2934 - val_acc: 0.9406
Epoch 18/20
 - 0s - loss: 0.0188 - acc: 0.9941 - val_loss: 0.3212 - val_acc: 0.9363
Epoch 19/20
 - 0s - loss: 0.0052 - acc: 0.9987 - val_loss: 0.2656 - val_acc: 0.9448
Epoch 20/20
 - 0s - loss: 0.0092 - acc: 0.9960 - val_loss: 0.3140 - val_acc: 0.9398
Test loss: 0.31395206749872234
Test accuracy: 0.9398
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.4377 - acc: 0.2608 - val_loss: 1.6530 - val_acc: 0.5134
Epoch 2/20
 - 1s - loss: 1.5760 - acc: 0.4749 - val_loss: 1.9486 - val_acc: 0.3432
Epoch 3/20
 - 1s - loss: 1.2681 - acc: 0.5781 - val_loss: 0.8033 - val_acc: 0.7460
Epoch 4/20
 - 1s - loss: 1.0611 - acc: 0.6480 - val_loss: 0.9795 - val_acc: 0.6727
Epoch 5/20
 - 1s - loss: 0.9156 - acc: 0.7027 - val_loss: 0.8006 - val_acc: 0.7437
Epoch 6/20
 - 1s - loss: 0.8276 - acc: 0.7184 - val_loss: 1.1165 - val_acc: 0.6036
Epoch 7/20
 - 1s - loss: 0.7551 - acc: 0.7491 - val_loss: 0.5631 - val_acc: 0.8207
Epoch 8/20
 - 1s - loss: 0.7524 - acc: 0.7507 - val_loss: 0.7830 - val_acc: 0.7390
Epoch 9/20
 - 1s - loss: 0.6707 - acc: 0.7744 - val_loss: 0.8094 - val_acc: 0.7347
Epoch 10/20
 - 1s - loss: 0.6176 - acc: 0.7971 - val_loss: 0.5118 - val_acc: 0.8438
Epoch 11/20
 - 1s - loss: 0.5824 - acc: 0.8043 - val_loss: 0.7469 - val_acc: 0.7766
Epoch 12/20
 - 1s - loss: 0.5518 - acc: 0.8189 - val_loss: 0.6115 - val_acc: 0.8113
Epoch 13/20
 - 1s - loss: 0.5445 - acc: 0.8181 - val_loss: 0.3950 - val_acc: 0.8729
Epoch 14/20
 - 1s - loss: 0.5324 - acc: 0.8349 - val_loss: 0.6346 - val_acc: 0.7990
Epoch 15/20
 - 1s - loss: 0.4532 - acc: 0.8573 - val_loss: 0.3841 - val_acc: 0.8768
Epoch 16/20
 - 1s - loss: 0.4800 - acc: 0.8427 - val_loss: 0.5833 - val_acc: 0.8045
Epoch 17/20
 - 1s - loss: 0.4718 - acc: 0.8432 - val_loss: 0.8478 - val_acc: 0.7313
Epoch 18/20
 - 1s - loss: 0.4345 - acc: 0.8605 - val_loss: 0.5744 - val_acc: 0.8044
Epoch 19/20
 - 1s - loss: 0.3977 - acc: 0.8677 - val_loss: 0.5071 - val_acc: 0.8241
Epoch 20/20
 - 1s - loss: 0.3950 - acc: 0.8677 - val_loss: 0.7118 - val_acc: 0.7777
Test loss: 0.7115190405368805
Test accuracy: 0.7772
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1206 - acc: 0.6480 - val_loss: 0.5937 - val_acc: 0.8146
Epoch 2/20
 - 0s - loss: 0.4816 - acc: 0.8587 - val_loss: 0.4367 - val_acc: 0.8655
Epoch 3/20
 - 0s - loss: 0.3115 - acc: 0.9125 - val_loss: 0.3869 - val_acc: 0.8817
Epoch 4/20
 - 0s - loss: 0.2486 - acc: 0.9221 - val_loss: 0.3511 - val_acc: 0.8933
Epoch 5/20
 - 0s - loss: 0.1791 - acc: 0.9488 - val_loss: 0.3548 - val_acc: 0.8950
Epoch 6/20
 - 0s - loss: 0.1362 - acc: 0.9589 - val_loss: 0.4269 - val_acc: 0.8795
Epoch 7/20
 - 0s - loss: 0.1130 - acc: 0.9680 - val_loss: 0.4376 - val_acc: 0.8644
Epoch 8/20
 - 0s - loss: 0.0973 - acc: 0.9717 - val_loss: 0.3151 - val_acc: 0.9079
Epoch 9/20
 - 0s - loss: 0.0600 - acc: 0.9808 - val_loss: 0.2785 - val_acc: 0.9211
Epoch 10/20
 - 0s - loss: 0.0648 - acc: 0.9840 - val_loss: 0.2941 - val_acc: 0.9176
Epoch 11/20
 - 0s - loss: 0.0284 - acc: 0.9957 - val_loss: 0.3567 - val_acc: 0.9072
Epoch 12/20
 - 0s - loss: 0.0436 - acc: 0.9888 - val_loss: 0.3070 - val_acc: 0.9173
Epoch 13/20
 - 0s - loss: 0.0129 - acc: 0.9973 - val_loss: 0.3004 - val_acc: 0.9252
Epoch 14/20
 - 0s - loss: 0.0095 - acc: 0.9989 - val_loss: 0.5707 - val_acc: 0.8743
Epoch 15/20
 - 0s - loss: 0.0314 - acc: 0.9915 - val_loss: 0.3333 - val_acc: 0.9185
Epoch 16/20
 - 0s - loss: 0.0071 - acc: 0.9989 - val_loss: 0.3344 - val_acc: 0.9228
Epoch 17/20
 - 0s - loss: 0.0025 - acc: 1.0000 - val_loss: 0.3539 - val_acc: 0.9220
Epoch 18/20
 - 0s - loss: 0.0205 - acc: 0.9947 - val_loss: 0.3588 - val_acc: 0.9222
Epoch 19/20
 - 0s - loss: 0.0108 - acc: 0.9984 - val_loss: 0.3546 - val_acc: 0.9215
Epoch 20/20
 - 0s - loss: 0.0244 - acc: 0.9941 - val_loss: 0.3540 - val_acc: 0.9203
Test loss: 0.3539717073509004
Test accuracy: 0.9203
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.3688 - acc: 0.1595 - val_loss: 2.1440 - val_acc: 0.1145
Epoch 2/20
 - 1s - loss: 1.9477 - acc: 0.3269 - val_loss: 1.9464 - val_acc: 0.2939
Epoch 3/20
 - 1s - loss: 1.7098 - acc: 0.4176 - val_loss: 1.7238 - val_acc: 0.4392
Epoch 4/20
 - 1s - loss: 1.4345 - acc: 0.5211 - val_loss: 1.0457 - val_acc: 0.6871
Epoch 5/20
 - 1s - loss: 1.3314 - acc: 0.5579 - val_loss: 1.0093 - val_acc: 0.6759
Epoch 6/20
 - 1s - loss: 1.1206 - acc: 0.6368 - val_loss: 1.3943 - val_acc: 0.5335
Epoch 7/20
 - 1s - loss: 0.9742 - acc: 0.6827 - val_loss: 1.0465 - val_acc: 0.6189
Epoch 8/20
 - 1s - loss: 1.0340 - acc: 0.6635 - val_loss: 1.4184 - val_acc: 0.5702
Epoch 9/20
 - 1s - loss: 0.9116 - acc: 0.7067 - val_loss: 1.1879 - val_acc: 0.5791
Epoch 10/20
 - 1s - loss: 0.8384 - acc: 0.7349 - val_loss: 1.1812 - val_acc: 0.6309
Epoch 11/20
 - 1s - loss: 0.8298 - acc: 0.7355 - val_loss: 0.9621 - val_acc: 0.7028
Epoch 12/20
 - 1s - loss: 0.7867 - acc: 0.7616 - val_loss: 1.1922 - val_acc: 0.5973
Epoch 13/20
 - 1s - loss: 0.8355 - acc: 0.7179 - val_loss: 0.6251 - val_acc: 0.7875
Epoch 14/20
 - 1s - loss: 0.6717 - acc: 0.7840 - val_loss: 0.8889 - val_acc: 0.6933
Epoch 15/20
 - 1s - loss: 0.7472 - acc: 0.7579 - val_loss: 0.7741 - val_acc: 0.7538
Epoch 16/20
 - 1s - loss: 0.6959 - acc: 0.7771 - val_loss: 0.6844 - val_acc: 0.7665
Epoch 17/20
 - 1s - loss: 0.6224 - acc: 0.7872 - val_loss: 0.5268 - val_acc: 0.8266
Epoch 18/20
 - 1s - loss: 0.7127 - acc: 0.7648 - val_loss: 0.7540 - val_acc: 0.7389
Epoch 19/20
 - 1s - loss: 0.5921 - acc: 0.8091 - val_loss: 0.4857 - val_acc: 0.8468
Epoch 20/20
 - 1s - loss: 0.4389 - acc: 0.8608 - val_loss: 0.9760 - val_acc: 0.6928
Test loss: 0.9738763605594635
Test accuracy: 0.6935
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.4295 - acc: 0.5368 - val_loss: 1.0029 - val_acc: 0.6574
Epoch 2/20
 - 0s - loss: 0.6221 - acc: 0.8132 - val_loss: 0.5450 - val_acc: 0.8293
Epoch 3/20
 - 0s - loss: 0.4132 - acc: 0.8719 - val_loss: 0.6500 - val_acc: 0.7818
Epoch 4/20
 - 0s - loss: 0.3008 - acc: 0.9114 - val_loss: 0.4983 - val_acc: 0.8430
Epoch 5/20
 - 0s - loss: 0.2185 - acc: 0.9445 - val_loss: 0.4922 - val_acc: 0.8399
Epoch 6/20
 - 0s - loss: 0.2105 - acc: 0.9338 - val_loss: 0.4113 - val_acc: 0.8717
Epoch 7/20
 - 0s - loss: 0.1352 - acc: 0.9594 - val_loss: 0.4553 - val_acc: 0.8593
Epoch 8/20
 - 0s - loss: 0.0952 - acc: 0.9787 - val_loss: 0.3941 - val_acc: 0.8766
Epoch 9/20
 - 0s - loss: 0.0686 - acc: 0.9840 - val_loss: 0.4269 - val_acc: 0.8695
Epoch 10/20
 - 0s - loss: 0.0849 - acc: 0.9797 - val_loss: 0.5601 - val_acc: 0.8449
Epoch 11/20
 - 0s - loss: 0.0544 - acc: 0.9893 - val_loss: 0.4018 - val_acc: 0.8860
Epoch 12/20
 - 0s - loss: 0.0279 - acc: 0.9936 - val_loss: 0.5054 - val_acc: 0.8658
Epoch 13/20
 - 0s - loss: 0.0246 - acc: 0.9968 - val_loss: 0.4268 - val_acc: 0.8867
Epoch 14/20
 - 0s - loss: 0.0148 - acc: 0.9989 - val_loss: 0.4074 - val_acc: 0.8855
Epoch 15/20
 - 0s - loss: 0.0087 - acc: 1.0000 - val_loss: 0.4406 - val_acc: 0.8863
Epoch 16/20
 - 0s - loss: 0.0675 - acc: 0.9840 - val_loss: 0.6683 - val_acc: 0.8482
Epoch 17/20
 - 0s - loss: 0.0291 - acc: 0.9893 - val_loss: 0.4266 - val_acc: 0.8894
Epoch 18/20
 - 0s - loss: 0.0074 - acc: 0.9989 - val_loss: 0.3973 - val_acc: 0.9011
Epoch 19/20
 - 0s - loss: 0.0052 - acc: 1.0000 - val_loss: 0.4110 - val_acc: 0.8978
Epoch 20/20
 - 0s - loss: 0.0034 - acc: 1.0000 - val_loss: 0.4300 - val_acc: 0.8982
Test loss: 0.43000179307404907
Test accuracy: 0.8982
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.6989 - acc: 0.1227 - val_loss: 2.3438 - val_acc: 0.2497
Epoch 2/20
 - 0s - loss: 2.1713 - acc: 0.2145 - val_loss: 1.8625 - val_acc: 0.3688
Epoch 3/20
 - 0s - loss: 1.9513 - acc: 0.3244 - val_loss: 2.2463 - val_acc: 0.2236
Epoch 4/20
 - 0s - loss: 1.8737 - acc: 0.3842 - val_loss: 1.5969 - val_acc: 0.4532
Epoch 5/20
 - 0s - loss: 1.7222 - acc: 0.4461 - val_loss: 1.6441 - val_acc: 0.4098
Epoch 6/20
 - 0s - loss: 1.6440 - acc: 0.4504 - val_loss: 1.3192 - val_acc: 0.5575
Epoch 7/20
 - 0s - loss: 1.3706 - acc: 0.5550 - val_loss: 1.2868 - val_acc: 0.5684
Epoch 8/20
 - 0s - loss: 1.3511 - acc: 0.5582 - val_loss: 1.4220 - val_acc: 0.5242
Epoch 9/20
 - 0s - loss: 1.2556 - acc: 0.5806 - val_loss: 1.3366 - val_acc: 0.4688
Epoch 10/20
 - 0s - loss: 1.0550 - acc: 0.6596 - val_loss: 1.5378 - val_acc: 0.4732
Epoch 11/20
 - 0s - loss: 1.3046 - acc: 0.6211 - val_loss: 1.5119 - val_acc: 0.5245
Epoch 12/20
 - 0s - loss: 1.0046 - acc: 0.6777 - val_loss: 1.3466 - val_acc: 0.5693
Epoch 13/20
 - 0s - loss: 1.0157 - acc: 0.6873 - val_loss: 1.4540 - val_acc: 0.4914
Epoch 14/20
 - 0s - loss: 1.0019 - acc: 0.6873 - val_loss: 1.0264 - val_acc: 0.6637
Epoch 15/20
 - 0s - loss: 1.1037 - acc: 0.6531 - val_loss: 0.8413 - val_acc: 0.7153
Epoch 16/20
 - 0s - loss: 0.9443 - acc: 0.6884 - val_loss: 0.8764 - val_acc: 0.6974
Epoch 17/20
 - 0s - loss: 0.8759 - acc: 0.7150 - val_loss: 0.7966 - val_acc: 0.7181
Epoch 18/20
 - 0s - loss: 0.7321 - acc: 0.7417 - val_loss: 1.0072 - val_acc: 0.6577
Epoch 19/20
 - 0s - loss: 0.7934 - acc: 0.7417 - val_loss: 1.0466 - val_acc: 0.6842
Epoch 20/20
 - 0s - loss: 0.9017 - acc: 0.7033 - val_loss: 0.9979 - val_acc: 0.6784
Test loss: 0.9979183532714844
Test accuracy: 0.6801
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8572 - acc: 0.3739 - val_loss: 1.1930 - val_acc: 0.6326
Epoch 2/20
 - 0s - loss: 0.9219 - acc: 0.7222 - val_loss: 0.8559 - val_acc: 0.7216
Epoch 3/20
 - 0s - loss: 0.4926 - acc: 0.8654 - val_loss: 0.7990 - val_acc: 0.7432
Epoch 4/20
 - 0s - loss: 0.3120 - acc: 0.9081 - val_loss: 0.7147 - val_acc: 0.7792
Epoch 5/20
 - 0s - loss: 0.2333 - acc: 0.9338 - val_loss: 0.7643 - val_acc: 0.7853
Epoch 6/20
 - 0s - loss: 0.1949 - acc: 0.9487 - val_loss: 0.6950 - val_acc: 0.8029
Epoch 7/20
 - 0s - loss: 0.1345 - acc: 0.9701 - val_loss: 0.6169 - val_acc: 0.8139
Epoch 8/20
 - 0s - loss: 0.1036 - acc: 0.9850 - val_loss: 0.6279 - val_acc: 0.7987
Epoch 9/20
 - 0s - loss: 0.1102 - acc: 0.9701 - val_loss: 0.5501 - val_acc: 0.8330
Epoch 10/20
 - 0s - loss: 0.0542 - acc: 0.9936 - val_loss: 0.5351 - val_acc: 0.8432
Epoch 11/20
 - 0s - loss: 0.0599 - acc: 0.9872 - val_loss: 0.5604 - val_acc: 0.8375
Epoch 12/20
 - 0s - loss: 0.0277 - acc: 1.0000 - val_loss: 0.5309 - val_acc: 0.8451
Epoch 13/20
 - 0s - loss: 0.0289 - acc: 0.9957 - val_loss: 0.6293 - val_acc: 0.8236
Epoch 14/20
 - 0s - loss: 0.0238 - acc: 0.9979 - val_loss: 0.5938 - val_acc: 0.8368
Epoch 15/20
 - 0s - loss: 0.0161 - acc: 1.0000 - val_loss: 0.5446 - val_acc: 0.8554
Epoch 16/20
 - 0s - loss: 0.0096 - acc: 1.0000 - val_loss: 0.5608 - val_acc: 0.8503
Epoch 17/20
 - 0s - loss: 0.0063 - acc: 1.0000 - val_loss: 0.5770 - val_acc: 0.8537
Epoch 18/20
 - 0s - loss: 0.2208 - acc: 0.9316 - val_loss: 1.1791 - val_acc: 0.7437
Epoch 19/20
 - 0s - loss: 0.0953 - acc: 0.9765 - val_loss: 0.5451 - val_acc: 0.8570
Epoch 20/20
 - 0s - loss: 0.0070 - acc: 1.0000 - val_loss: 0.5492 - val_acc: 0.8577
Test loss: 0.5492176094800234
Test accuracy: 0.8577
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.0077 - acc: 0.1111 - val_loss: 2.7976 - val_acc: 0.0980
Epoch 2/20
 - 0s - loss: 2.4519 - acc: 0.1581 - val_loss: 2.1322 - val_acc: 0.2091
Epoch 3/20
 - 0s - loss: 2.1282 - acc: 0.2436 - val_loss: 2.0359 - val_acc: 0.3149
Epoch 4/20
 - 0s - loss: 2.0024 - acc: 0.3226 - val_loss: 1.8711 - val_acc: 0.3521
Epoch 5/20
 - 0s - loss: 1.9190 - acc: 0.3483 - val_loss: 1.9404 - val_acc: 0.3622
Epoch 6/20
 - 0s - loss: 1.8423 - acc: 0.3611 - val_loss: 1.8568 - val_acc: 0.3845
Epoch 7/20
 - 0s - loss: 1.7461 - acc: 0.4145 - val_loss: 1.9846 - val_acc: 0.3519
Epoch 8/20
 - 0s - loss: 1.6566 - acc: 0.4722 - val_loss: 2.2393 - val_acc: 0.1915
Epoch 9/20
 - 0s - loss: 1.6732 - acc: 0.4615 - val_loss: 1.8372 - val_acc: 0.5318
Epoch 10/20
 - 0s - loss: 1.6027 - acc: 0.4402 - val_loss: 1.7871 - val_acc: 0.3651
Epoch 11/20
 - 0s - loss: 1.5533 - acc: 0.5128 - val_loss: 1.5014 - val_acc: 0.4902
Epoch 12/20
 - 0s - loss: 1.2239 - acc: 0.6068 - val_loss: 1.5321 - val_acc: 0.4517
Epoch 13/20
 - 0s - loss: 1.2692 - acc: 0.5684 - val_loss: 1.5914 - val_acc: 0.4823
Epoch 14/20
 - 0s - loss: 1.4209 - acc: 0.5363 - val_loss: 1.2069 - val_acc: 0.6456
Epoch 15/20
 - 0s - loss: 1.1902 - acc: 0.6368 - val_loss: 1.4045 - val_acc: 0.5513
Epoch 16/20
 - 0s - loss: 0.9559 - acc: 0.7009 - val_loss: 1.2580 - val_acc: 0.6000
Epoch 17/20
 - 0s - loss: 1.3658 - acc: 0.5342 - val_loss: 1.6066 - val_acc: 0.4289
Epoch 18/20
 - 0s - loss: 1.0755 - acc: 0.6538 - val_loss: 1.0234 - val_acc: 0.6560
Epoch 19/20
 - 0s - loss: 0.8121 - acc: 0.7457 - val_loss: 1.1242 - val_acc: 0.6107
Epoch 20/20
 - 0s - loss: 1.0858 - acc: 0.6197 - val_loss: 1.2774 - val_acc: 0.6005
Test loss: 1.277496400642395
Test accuracy: 0.6
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1508 - acc: 0.2393 - val_loss: 1.6085 - val_acc: 0.4942
Epoch 2/20
 - 0s - loss: 1.1531 - acc: 0.7265 - val_loss: 1.4108 - val_acc: 0.5012
Epoch 3/20
 - 0s - loss: 0.8482 - acc: 0.7265 - val_loss: 0.9942 - val_acc: 0.6951
Epoch 4/20
 - 0s - loss: 0.5791 - acc: 0.8419 - val_loss: 0.8553 - val_acc: 0.7372
Epoch 5/20
 - 0s - loss: 0.3265 - acc: 0.9402 - val_loss: 0.8261 - val_acc: 0.7316
Epoch 6/20
 - 0s - loss: 0.2694 - acc: 0.9359 - val_loss: 0.8721 - val_acc: 0.7337
Epoch 7/20
 - 0s - loss: 0.1871 - acc: 0.9658 - val_loss: 0.7579 - val_acc: 0.7584
Epoch 8/20
 - 0s - loss: 0.1347 - acc: 0.9829 - val_loss: 0.8176 - val_acc: 0.7605
Epoch 9/20
 - 0s - loss: 0.1279 - acc: 0.9829 - val_loss: 0.8072 - val_acc: 0.7624
Epoch 10/20
 - 0s - loss: 0.0918 - acc: 0.9957 - val_loss: 0.8559 - val_acc: 0.7510
Epoch 11/20
 - 0s - loss: 0.0822 - acc: 0.9872 - val_loss: 0.7448 - val_acc: 0.7725
Epoch 12/20
 - 0s - loss: 0.0507 - acc: 1.0000 - val_loss: 0.7076 - val_acc: 0.7868
Epoch 13/20
 - 0s - loss: 0.0355 - acc: 1.0000 - val_loss: 0.7343 - val_acc: 0.7841
Epoch 14/20
 - 0s - loss: 0.0268 - acc: 1.0000 - val_loss: 0.7296 - val_acc: 0.7870
Epoch 15/20
 - 0s - loss: 0.0233 - acc: 1.0000 - val_loss: 0.7532 - val_acc: 0.7872
Epoch 16/20
 - 0s - loss: 0.0199 - acc: 1.0000 - val_loss: 0.7183 - val_acc: 0.7929
Epoch 17/20
 - 0s - loss: 0.0169 - acc: 1.0000 - val_loss: 0.7633 - val_acc: 0.7855
Epoch 18/20
 - 0s - loss: 0.0134 - acc: 1.0000 - val_loss: 0.7479 - val_acc: 0.7919
Epoch 19/20
 - 0s - loss: 0.0113 - acc: 1.0000 - val_loss: 0.7966 - val_acc: 0.7858
Epoch 20/20
 - 0s - loss: 0.0090 - acc: 1.0000 - val_loss: 0.7987 - val_acc: 0.7846
Test loss: 0.7986906844109297
Test accuracy: 0.7846
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.9684 - acc: 0.0855 - val_loss: 7.0596 - val_acc: 0.0982
Epoch 2/20
 - 0s - loss: 6.3662 - acc: 0.1197 - val_loss: 3.0892 - val_acc: 0.0974
Epoch 3/20
 - 0s - loss: 2.7839 - acc: 0.1453 - val_loss: 2.2525 - val_acc: 0.1905
Epoch 4/20
 - 0s - loss: 2.1712 - acc: 0.2308 - val_loss: 2.0932 - val_acc: 0.3566
Epoch 5/20
 - 0s - loss: 2.0844 - acc: 0.2564 - val_loss: 2.4616 - val_acc: 0.1135
Epoch 6/20
 - 0s - loss: 2.4607 - acc: 0.1667 - val_loss: 2.0685 - val_acc: 0.2385
Epoch 7/20
 - 0s - loss: 1.9799 - acc: 0.3462 - val_loss: 1.9815 - val_acc: 0.3644
Epoch 8/20
 - 0s - loss: 1.8677 - acc: 0.3889 - val_loss: 2.0226 - val_acc: 0.3482
Epoch 9/20
 - 0s - loss: 1.8347 - acc: 0.3547 - val_loss: 2.0199 - val_acc: 0.4040
Epoch 10/20
 - 0s - loss: 1.8978 - acc: 0.3974 - val_loss: 2.0361 - val_acc: 0.1977
Epoch 11/20
 - 0s - loss: 1.7610 - acc: 0.3889 - val_loss: 1.7416 - val_acc: 0.4313
Epoch 12/20
 - 0s - loss: 1.5753 - acc: 0.5427 - val_loss: 1.7689 - val_acc: 0.4616
Epoch 13/20
 - 0s - loss: 1.5265 - acc: 0.5598 - val_loss: 1.9726 - val_acc: 0.3248
Epoch 14/20
 - 0s - loss: 1.7262 - acc: 0.3718 - val_loss: 2.2324 - val_acc: 0.2813
Epoch 15/20
 - 0s - loss: 1.9869 - acc: 0.3803 - val_loss: 1.6860 - val_acc: 0.4321
Epoch 16/20
 - 0s - loss: 1.4271 - acc: 0.6282 - val_loss: 1.5352 - val_acc: 0.5037
Epoch 17/20
 - 0s - loss: 1.4260 - acc: 0.5128 - val_loss: 1.9226 - val_acc: 0.3912
Epoch 18/20
 - 0s - loss: 1.5762 - acc: 0.4915 - val_loss: 1.8990 - val_acc: 0.4016
Epoch 19/20
 - 0s - loss: 1.6009 - acc: 0.5214 - val_loss: 1.3294 - val_acc: 0.6216
Epoch 20/20
 - 0s - loss: 1.1656 - acc: 0.6880 - val_loss: 1.9023 - val_acc: 0.3547
Test loss: 1.9023579704284668
Test accuracy: 0.3544
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3599 - acc: 0.1026 - val_loss: 2.0135 - val_acc: 0.2998
Epoch 2/20
 - 0s - loss: 1.5510 - acc: 0.4701 - val_loss: 1.6848 - val_acc: 0.4893
Epoch 3/20
 - 0s - loss: 1.1702 - acc: 0.7521 - val_loss: 1.6230 - val_acc: 0.4976
Epoch 4/20
 - 0s - loss: 0.9490 - acc: 0.7692 - val_loss: 1.3591 - val_acc: 0.5724
Epoch 5/20
 - 0s - loss: 0.5699 - acc: 0.8547 - val_loss: 1.2328 - val_acc: 0.6092
Epoch 6/20
 - 0s - loss: 0.4561 - acc: 0.8974 - val_loss: 1.2870 - val_acc: 0.5816
Epoch 7/20
 - 0s - loss: 0.3393 - acc: 0.9316 - val_loss: 1.1036 - val_acc: 0.6552
Epoch 8/20
 - 0s - loss: 0.2907 - acc: 0.8974 - val_loss: 1.0678 - val_acc: 0.6476
Epoch 9/20
 - 0s - loss: 0.1728 - acc: 0.9829 - val_loss: 0.9775 - val_acc: 0.7098
Epoch 10/20
 - 0s - loss: 0.1108 - acc: 0.9915 - val_loss: 0.9512 - val_acc: 0.7048
Epoch 11/20
 - 0s - loss: 0.0736 - acc: 1.0000 - val_loss: 0.9502 - val_acc: 0.7159
Epoch 12/20
 - 0s - loss: 0.0595 - acc: 1.0000 - val_loss: 0.9547 - val_acc: 0.7117
Epoch 13/20
 - 0s - loss: 0.0435 - acc: 1.0000 - val_loss: 0.9536 - val_acc: 0.7150
Epoch 14/20
 - 0s - loss: 0.0435 - acc: 1.0000 - val_loss: 0.9492 - val_acc: 0.7194
Epoch 15/20
 - 0s - loss: 0.0331 - acc: 1.0000 - val_loss: 0.9864 - val_acc: 0.7122
Epoch 16/20
 - 0s - loss: 0.0366 - acc: 1.0000 - val_loss: 0.9790 - val_acc: 0.7187
Epoch 17/20
 - 0s - loss: 0.0304 - acc: 1.0000 - val_loss: 0.9803 - val_acc: 0.7137
Epoch 18/20
 - 0s - loss: 0.0217 - acc: 1.0000 - val_loss: 0.9947 - val_acc: 0.7169
Epoch 19/20
 - 0s - loss: 0.0179 - acc: 1.0000 - val_loss: 0.9933 - val_acc: 0.7218
Epoch 20/20
 - 0s - loss: 0.0181 - acc: 1.0000 - val_loss: 1.0097 - val_acc: 0.7212
Test loss: 1.0097380093574524
Test accuracy: 0.7212
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7242 - acc: 0.1111 - val_loss: 5.6016 - val_acc: 0.1239
Epoch 2/20
 - 0s - loss: 5.3299 - acc: 0.1795 - val_loss: 6.5365 - val_acc: 0.0958
Epoch 3/20
 - 0s - loss: 7.2841 - acc: 0.1282 - val_loss: 6.2850 - val_acc: 0.0982
Epoch 4/20
 - 0s - loss: 7.2111 - acc: 0.1282 - val_loss: 5.1259 - val_acc: 0.1930
Epoch 5/20
 - 0s - loss: 6.0546 - acc: 0.1709 - val_loss: 2.7037 - val_acc: 0.1009
Epoch 6/20
 - 0s - loss: 2.9128 - acc: 0.1026 - val_loss: 2.3196 - val_acc: 0.1823
Epoch 7/20
 - 0s - loss: 2.3200 - acc: 0.1880 - val_loss: 2.1865 - val_acc: 0.1657
Epoch 8/20
 - 0s - loss: 2.0784 - acc: 0.2650 - val_loss: 2.1409 - val_acc: 0.2865
Epoch 9/20
 - 0s - loss: 1.9220 - acc: 0.3077 - val_loss: 2.0990 - val_acc: 0.1743
Epoch 10/20
 - 0s - loss: 1.9149 - acc: 0.3675 - val_loss: 2.1707 - val_acc: 0.1251
Epoch 11/20
 - 0s - loss: 1.9707 - acc: 0.2137 - val_loss: 2.2586 - val_acc: 0.2131
Epoch 12/20
 - 0s - loss: 2.1314 - acc: 0.2906 - val_loss: 1.9742 - val_acc: 0.5106
Epoch 13/20
 - 0s - loss: 1.8010 - acc: 0.6068 - val_loss: 2.0225 - val_acc: 0.2740
Epoch 14/20
 - 0s - loss: 1.7355 - acc: 0.4188 - val_loss: 2.1165 - val_acc: 0.2681
Epoch 15/20
 - 0s - loss: 1.9096 - acc: 0.3675 - val_loss: 2.2257 - val_acc: 0.2412
Epoch 16/20
 - 0s - loss: 1.8944 - acc: 0.3761 - val_loss: 2.1234 - val_acc: 0.2028
Epoch 17/20
 - 0s - loss: 1.9966 - acc: 0.3333 - val_loss: 2.2007 - val_acc: 0.1830
Epoch 18/20
 - 0s - loss: 1.9313 - acc: 0.2906 - val_loss: 2.0772 - val_acc: 0.3538
Epoch 19/20
 - 0s - loss: 1.8163 - acc: 0.4615 - val_loss: 2.0478 - val_acc: 0.1697
Epoch 20/20
 - 0s - loss: 1.6758 - acc: 0.3077 - val_loss: 2.1828 - val_acc: 0.2660
Test loss: 2.1827688201904296
Test accuracy: 0.2673
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2472 - acc: 0.9236 - val_loss: 0.1143 - val_acc: 0.9653
Epoch 2/20
 - 2s - loss: 0.1030 - acc: 0.9684 - val_loss: 0.0821 - val_acc: 0.9752
Epoch 3/20
 - 2s - loss: 0.0744 - acc: 0.9779 - val_loss: 0.0864 - val_acc: 0.9750
Epoch 4/20
 - 2s - loss: 0.0604 - acc: 0.9823 - val_loss: 0.0742 - val_acc: 0.9799
Epoch 5/20
 - 2s - loss: 0.0504 - acc: 0.9849 - val_loss: 0.0758 - val_acc: 0.9803
Epoch 6/20
 - 2s - loss: 0.0451 - acc: 0.9866 - val_loss: 0.0807 - val_acc: 0.9810
Epoch 7/20
 - 2s - loss: 0.0391 - acc: 0.9882 - val_loss: 0.0803 - val_acc: 0.9821
Epoch 8/20
 - 2s - loss: 0.0334 - acc: 0.9902 - val_loss: 0.0958 - val_acc: 0.9804
Epoch 9/20
 - 2s - loss: 0.0307 - acc: 0.9910 - val_loss: 0.0767 - val_acc: 0.9831
Epoch 10/20
 - 2s - loss: 0.0285 - acc: 0.9917 - val_loss: 0.0835 - val_acc: 0.9825
Epoch 11/20
 - 2s - loss: 0.0278 - acc: 0.9920 - val_loss: 0.0914 - val_acc: 0.9830
Epoch 12/20
 - 2s - loss: 0.0245 - acc: 0.9931 - val_loss: 0.1045 - val_acc: 0.9824
Epoch 13/20
 - 2s - loss: 0.0226 - acc: 0.9933 - val_loss: 0.0978 - val_acc: 0.9816
Epoch 14/20
 - 2s - loss: 0.0232 - acc: 0.9937 - val_loss: 0.0954 - val_acc: 0.9839
Epoch 15/20
 - 2s - loss: 0.0223 - acc: 0.9940 - val_loss: 0.1026 - val_acc: 0.9819
Epoch 16/20
 - 2s - loss: 0.0214 - acc: 0.9943 - val_loss: 0.1125 - val_acc: 0.9821
Epoch 17/20
 - 2s - loss: 0.0191 - acc: 0.9946 - val_loss: 0.1096 - val_acc: 0.9830
Epoch 18/20
 - 2s - loss: 0.0210 - acc: 0.9947 - val_loss: 0.1116 - val_acc: 0.9837
Epoch 19/20
 - 2s - loss: 0.0204 - acc: 0.9948 - val_loss: 0.1086 - val_acc: 0.9846
Epoch 20/20
 - 2s - loss: 0.0198 - acc: 0.9950 - val_loss: 0.1140 - val_acc: 0.9833
Test loss: 0.11403619405255022
Test accuracy: 0.9833
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9535 - acc: 0.6954 - val_loss: 0.4433 - val_acc: 0.8521
Epoch 2/20
 - 4s - loss: 0.4292 - acc: 0.8621 - val_loss: 0.2944 - val_acc: 0.8979
Epoch 3/20
 - 4s - loss: 0.3264 - acc: 0.8983 - val_loss: 0.2600 - val_acc: 0.9206
Epoch 4/20
 - 4s - loss: 0.2666 - acc: 0.9169 - val_loss: 0.3122 - val_acc: 0.9010
Epoch 5/20
 - 4s - loss: 0.2345 - acc: 0.9279 - val_loss: 0.1986 - val_acc: 0.9358
Epoch 6/20
 - 4s - loss: 0.2230 - acc: 0.9320 - val_loss: 0.1489 - val_acc: 0.9526
Epoch 7/20
 - 4s - loss: 0.2038 - acc: 0.9379 - val_loss: 0.1876 - val_acc: 0.9391
Epoch 8/20
 - 4s - loss: 0.1980 - acc: 0.9410 - val_loss: 0.1184 - val_acc: 0.9625
Epoch 9/20
 - 4s - loss: 0.1851 - acc: 0.9446 - val_loss: 0.1380 - val_acc: 0.9618
Epoch 10/20
 - 4s - loss: 0.1837 - acc: 0.9460 - val_loss: 0.1291 - val_acc: 0.9624
Epoch 11/20
 - 4s - loss: 0.1749 - acc: 0.9477 - val_loss: 0.1252 - val_acc: 0.9611
Epoch 12/20
 - 4s - loss: 0.1735 - acc: 0.9485 - val_loss: 0.1396 - val_acc: 0.9599
Epoch 13/20
 - 4s - loss: 0.1714 - acc: 0.9503 - val_loss: 0.1360 - val_acc: 0.9616
Epoch 14/20
 - 4s - loss: 0.1719 - acc: 0.9501 - val_loss: 0.1146 - val_acc: 0.9683
Epoch 15/20
 - 4s - loss: 0.1699 - acc: 0.9507 - val_loss: 0.1037 - val_acc: 0.9682
Epoch 16/20
 - 4s - loss: 0.1680 - acc: 0.9524 - val_loss: 0.1076 - val_acc: 0.9701
Epoch 17/20
 - 4s - loss: 0.1689 - acc: 0.9518 - val_loss: 0.1212 - val_acc: 0.9664
Epoch 18/20
 - 4s - loss: 0.1689 - acc: 0.9521 - val_loss: 0.1154 - val_acc: 0.9699
Epoch 19/20
 - 4s - loss: 0.1688 - acc: 0.9543 - val_loss: 0.1272 - val_acc: 0.9666
Epoch 20/20
 - 4s - loss: 0.1688 - acc: 0.9533 - val_loss: 0.1186 - val_acc: 0.9686
Test loss: 0.11893952242893356
Test accuracy: 0.9682
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3322 - acc: 0.8980 - val_loss: 0.2102 - val_acc: 0.9346
Epoch 2/20
 - 1s - loss: 0.1332 - acc: 0.9603 - val_loss: 0.1135 - val_acc: 0.9649
Epoch 3/20
 - 1s - loss: 0.0906 - acc: 0.9712 - val_loss: 0.1406 - val_acc: 0.9570
Epoch 4/20
 - 1s - loss: 0.0674 - acc: 0.9791 - val_loss: 0.0854 - val_acc: 0.9743
Epoch 5/20
 - 1s - loss: 0.0519 - acc: 0.9833 - val_loss: 0.0958 - val_acc: 0.9743
Epoch 6/20
 - 1s - loss: 0.0443 - acc: 0.9859 - val_loss: 0.0921 - val_acc: 0.9764
Epoch 7/20
 - 1s - loss: 0.0365 - acc: 0.9876 - val_loss: 0.1003 - val_acc: 0.9766
Epoch 8/20
 - 1s - loss: 0.0303 - acc: 0.9900 - val_loss: 0.0983 - val_acc: 0.9771
Epoch 9/20
 - 1s - loss: 0.0273 - acc: 0.9915 - val_loss: 0.1143 - val_acc: 0.9770
Epoch 10/20
 - 1s - loss: 0.0254 - acc: 0.9912 - val_loss: 0.1105 - val_acc: 0.9752
Epoch 11/20
 - 1s - loss: 0.0226 - acc: 0.9931 - val_loss: 0.1317 - val_acc: 0.9739
Epoch 12/20
 - 1s - loss: 0.0222 - acc: 0.9934 - val_loss: 0.1107 - val_acc: 0.9766
Epoch 13/20
 - 1s - loss: 0.0176 - acc: 0.9946 - val_loss: 0.1272 - val_acc: 0.9776
Epoch 14/20
 - 1s - loss: 0.0176 - acc: 0.9946 - val_loss: 0.1149 - val_acc: 0.9796
Epoch 15/20
 - 1s - loss: 0.0178 - acc: 0.9946 - val_loss: 0.1219 - val_acc: 0.9793
Epoch 16/20
 - 1s - loss: 0.0146 - acc: 0.9957 - val_loss: 0.1148 - val_acc: 0.9801
Epoch 17/20
 - 1s - loss: 0.0167 - acc: 0.9950 - val_loss: 0.1179 - val_acc: 0.9795
Epoch 18/20
 - 1s - loss: 0.0120 - acc: 0.9959 - val_loss: 0.1321 - val_acc: 0.9791
Epoch 19/20
 - 1s - loss: 0.0109 - acc: 0.9966 - val_loss: 0.1461 - val_acc: 0.9774
Epoch 20/20
 - 1s - loss: 0.0147 - acc: 0.9956 - val_loss: 0.1235 - val_acc: 0.9797
Test loss: 0.12346985332776417
Test accuracy: 0.9797
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2531 - acc: 0.5942 - val_loss: 0.7255 - val_acc: 0.7649
Epoch 2/20
 - 2s - loss: 0.6069 - acc: 0.8042 - val_loss: 0.3983 - val_acc: 0.8704
Epoch 3/20
 - 2s - loss: 0.4632 - acc: 0.8532 - val_loss: 0.2716 - val_acc: 0.9135
Epoch 4/20
 - 2s - loss: 0.3788 - acc: 0.8813 - val_loss: 0.3199 - val_acc: 0.8911
Epoch 5/20
 - 2s - loss: 0.3292 - acc: 0.8963 - val_loss: 0.3288 - val_acc: 0.8909
Epoch 6/20
 - 2s - loss: 0.2884 - acc: 0.9087 - val_loss: 0.1968 - val_acc: 0.9359
Epoch 7/20
 - 2s - loss: 0.2665 - acc: 0.9170 - val_loss: 0.1864 - val_acc: 0.9406
Epoch 8/20
 - 2s - loss: 0.2449 - acc: 0.9232 - val_loss: 0.2858 - val_acc: 0.9064
Epoch 9/20
 - 2s - loss: 0.2331 - acc: 0.9269 - val_loss: 0.2632 - val_acc: 0.9114
Epoch 10/20
 - 2s - loss: 0.2138 - acc: 0.9323 - val_loss: 0.2332 - val_acc: 0.9278
Epoch 11/20
 - 2s - loss: 0.2063 - acc: 0.9370 - val_loss: 0.3431 - val_acc: 0.8949
Epoch 12/20
 - 2s - loss: 0.1944 - acc: 0.9396 - val_loss: 0.3197 - val_acc: 0.9076
Epoch 13/20
 - 2s - loss: 0.1855 - acc: 0.9427 - val_loss: 0.2406 - val_acc: 0.9250
Epoch 14/20
 - 2s - loss: 0.1840 - acc: 0.9438 - val_loss: 0.2048 - val_acc: 0.9350
Epoch 15/20
 - 2s - loss: 0.1739 - acc: 0.9462 - val_loss: 0.1605 - val_acc: 0.9506
Epoch 16/20
 - 2s - loss: 0.1707 - acc: 0.9483 - val_loss: 0.1491 - val_acc: 0.9548
Epoch 17/20
 - 2s - loss: 0.1654 - acc: 0.9499 - val_loss: 0.1546 - val_acc: 0.9528
Epoch 18/20
 - 2s - loss: 0.1647 - acc: 0.9490 - val_loss: 0.2015 - val_acc: 0.9368
Epoch 19/20
 - 2s - loss: 0.1606 - acc: 0.9509 - val_loss: 0.1255 - val_acc: 0.9629
Epoch 20/20
 - 2s - loss: 0.1568 - acc: 0.9514 - val_loss: 0.1647 - val_acc: 0.9439
Test loss: 0.16379719771295786
Test accuracy: 0.9436
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4641 - acc: 0.8554 - val_loss: 0.2193 - val_acc: 0.9336
Epoch 2/20
 - 1s - loss: 0.1848 - acc: 0.9434 - val_loss: 0.1722 - val_acc: 0.9462
Epoch 3/20
 - 1s - loss: 0.1174 - acc: 0.9637 - val_loss: 0.2034 - val_acc: 0.9415
Epoch 4/20
 - 1s - loss: 0.0881 - acc: 0.9704 - val_loss: 0.1323 - val_acc: 0.9589
Epoch 5/20
 - 1s - loss: 0.0623 - acc: 0.9793 - val_loss: 0.1388 - val_acc: 0.9625
Epoch 6/20
 - 1s - loss: 0.0485 - acc: 0.9851 - val_loss: 0.1315 - val_acc: 0.9652
Epoch 7/20
 - 1s - loss: 0.0368 - acc: 0.9878 - val_loss: 0.1551 - val_acc: 0.9593
Epoch 8/20
 - 1s - loss: 0.0319 - acc: 0.9891 - val_loss: 0.1569 - val_acc: 0.9603
Epoch 9/20
 - 1s - loss: 0.0266 - acc: 0.9919 - val_loss: 0.1456 - val_acc: 0.9672
Epoch 10/20
 - 1s - loss: 0.0206 - acc: 0.9926 - val_loss: 0.1477 - val_acc: 0.9687
Epoch 11/20
 - 1s - loss: 0.0191 - acc: 0.9935 - val_loss: 0.1852 - val_acc: 0.9619
Epoch 12/20
 - 1s - loss: 0.0181 - acc: 0.9939 - val_loss: 0.1652 - val_acc: 0.9671
Epoch 13/20
 - 1s - loss: 0.0163 - acc: 0.9941 - val_loss: 0.1622 - val_acc: 0.9704
Epoch 14/20
 - 1s - loss: 0.0138 - acc: 0.9957 - val_loss: 0.1702 - val_acc: 0.9674
Epoch 15/20
 - 1s - loss: 0.0122 - acc: 0.9965 - val_loss: 0.1741 - val_acc: 0.9699
Epoch 16/20
 - 1s - loss: 0.0111 - acc: 0.9962 - val_loss: 0.1824 - val_acc: 0.9664
Epoch 17/20
 - 1s - loss: 0.0135 - acc: 0.9957 - val_loss: 0.1910 - val_acc: 0.9669
Epoch 18/20
 - 1s - loss: 0.0079 - acc: 0.9971 - val_loss: 0.1866 - val_acc: 0.9715
Epoch 19/20
 - 1s - loss: 0.0101 - acc: 0.9967 - val_loss: 0.1837 - val_acc: 0.9718
Epoch 20/20
 - 1s - loss: 0.0103 - acc: 0.9965 - val_loss: 0.1938 - val_acc: 0.9686
Test loss: 0.1937836510539328
Test accuracy: 0.9686
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6166 - acc: 0.4838 - val_loss: 0.7947 - val_acc: 0.6993
Epoch 2/20
 - 1s - loss: 0.8316 - acc: 0.7244 - val_loss: 0.7270 - val_acc: 0.7344
Epoch 3/20
 - 1s - loss: 0.6546 - acc: 0.7918 - val_loss: 1.0000 - val_acc: 0.6695
Epoch 4/20
 - 1s - loss: 0.5635 - acc: 0.8207 - val_loss: 0.8030 - val_acc: 0.7306
Epoch 5/20
 - 1s - loss: 0.4846 - acc: 0.8432 - val_loss: 0.4526 - val_acc: 0.8465
Epoch 6/20
 - 1s - loss: 0.4297 - acc: 0.8649 - val_loss: 0.8238 - val_acc: 0.7238
Epoch 7/20
 - 1s - loss: 0.3763 - acc: 0.8800 - val_loss: 0.6229 - val_acc: 0.7974
Epoch 8/20
 - 1s - loss: 0.3414 - acc: 0.8923 - val_loss: 0.2886 - val_acc: 0.9107
Epoch 9/20
 - 1s - loss: 0.3319 - acc: 0.8965 - val_loss: 0.4183 - val_acc: 0.8608
Epoch 10/20
 - 1s - loss: 0.3014 - acc: 0.9059 - val_loss: 0.2594 - val_acc: 0.9166
Epoch 11/20
 - 1s - loss: 0.2824 - acc: 0.9107 - val_loss: 0.2215 - val_acc: 0.9338
Epoch 12/20
 - 1s - loss: 0.2680 - acc: 0.9150 - val_loss: 0.4234 - val_acc: 0.8676
Epoch 13/20
 - 1s - loss: 0.2453 - acc: 0.9199 - val_loss: 0.4047 - val_acc: 0.8768
Epoch 14/20
 - 1s - loss: 0.2371 - acc: 0.9249 - val_loss: 0.2596 - val_acc: 0.9176
Epoch 15/20
 - 1s - loss: 0.2247 - acc: 0.9287 - val_loss: 0.2482 - val_acc: 0.9191
Epoch 16/20
 - 1s - loss: 0.2122 - acc: 0.9329 - val_loss: 0.1732 - val_acc: 0.9479
Epoch 17/20
 - 1s - loss: 0.2064 - acc: 0.9335 - val_loss: 0.1474 - val_acc: 0.9549
Epoch 18/20
 - 1s - loss: 0.2042 - acc: 0.9355 - val_loss: 0.3310 - val_acc: 0.8981
Epoch 19/20
 - 1s - loss: 0.1865 - acc: 0.9418 - val_loss: 0.2080 - val_acc: 0.9368
Epoch 20/20
 - 1s - loss: 0.1858 - acc: 0.9403 - val_loss: 0.2221 - val_acc: 0.9308
Test loss: 0.2226447006595321
Test accuracy: 0.9309
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6156 - acc: 0.8071 - val_loss: 0.3202 - val_acc: 0.9042
Epoch 2/20
 - 0s - loss: 0.2541 - acc: 0.9251 - val_loss: 0.2317 - val_acc: 0.9275
Epoch 3/20
 - 0s - loss: 0.1682 - acc: 0.9503 - val_loss: 0.2564 - val_acc: 0.9177
Epoch 4/20
 - 0s - loss: 0.1156 - acc: 0.9659 - val_loss: 0.1726 - val_acc: 0.9479
Epoch 5/20
 - 0s - loss: 0.0852 - acc: 0.9741 - val_loss: 0.2057 - val_acc: 0.9385
Epoch 6/20
 - 0s - loss: 0.0635 - acc: 0.9791 - val_loss: 0.1866 - val_acc: 0.9463
Epoch 7/20
 - 0s - loss: 0.0479 - acc: 0.9856 - val_loss: 0.1731 - val_acc: 0.9533
Epoch 8/20
 - 0s - loss: 0.0348 - acc: 0.9891 - val_loss: 0.2387 - val_acc: 0.9376
Epoch 9/20
 - 0s - loss: 0.0243 - acc: 0.9931 - val_loss: 0.2138 - val_acc: 0.9494
Epoch 10/20
 - 0s - loss: 0.0262 - acc: 0.9917 - val_loss: 0.1974 - val_acc: 0.9551
Epoch 11/20
 - 0s - loss: 0.0200 - acc: 0.9935 - val_loss: 0.2742 - val_acc: 0.9391
Epoch 12/20
 - 0s - loss: 0.0137 - acc: 0.9959 - val_loss: 0.2428 - val_acc: 0.9459
Epoch 13/20
 - 0s - loss: 0.0148 - acc: 0.9951 - val_loss: 0.1998 - val_acc: 0.9571
Epoch 14/20
 - 0s - loss: 0.0099 - acc: 0.9973 - val_loss: 0.2162 - val_acc: 0.9583
Epoch 15/20
 - 0s - loss: 0.0106 - acc: 0.9968 - val_loss: 0.2214 - val_acc: 0.9585
Epoch 16/20
 - 0s - loss: 0.0125 - acc: 0.9965 - val_loss: 0.2436 - val_acc: 0.9549
Epoch 17/20
 - 0s - loss: 0.0060 - acc: 0.9983 - val_loss: 0.2597 - val_acc: 0.9531
Epoch 18/20
 - 0s - loss: 0.0103 - acc: 0.9969 - val_loss: 0.2201 - val_acc: 0.9593
Epoch 19/20
 - 0s - loss: 0.0046 - acc: 0.9984 - val_loss: 0.2357 - val_acc: 0.9598
Epoch 20/20
 - 0s - loss: 0.0068 - acc: 0.9976 - val_loss: 0.2322 - val_acc: 0.9593
Test loss: 0.232171180683043
Test accuracy: 0.9593
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0589 - acc: 0.3627 - val_loss: 1.5544 - val_acc: 0.4997
Epoch 2/20
 - 1s - loss: 1.1264 - acc: 0.6333 - val_loss: 1.0387 - val_acc: 0.6269
Epoch 3/20
 - 1s - loss: 0.8831 - acc: 0.7041 - val_loss: 0.5149 - val_acc: 0.8443
Epoch 4/20
 - 1s - loss: 0.7469 - acc: 0.7579 - val_loss: 0.4640 - val_acc: 0.8652
Epoch 5/20
 - 1s - loss: 0.6478 - acc: 0.7899 - val_loss: 0.5194 - val_acc: 0.8422
Epoch 6/20
 - 1s - loss: 0.6007 - acc: 0.8059 - val_loss: 0.4546 - val_acc: 0.8510
Epoch 7/20
 - 1s - loss: 0.5370 - acc: 0.8272 - val_loss: 0.5128 - val_acc: 0.8336
Epoch 8/20
 - 1s - loss: 0.5130 - acc: 0.8376 - val_loss: 0.3796 - val_acc: 0.8820
Epoch 9/20
 - 1s - loss: 0.4689 - acc: 0.8511 - val_loss: 0.3730 - val_acc: 0.8853
Epoch 10/20
 - 1s - loss: 0.4320 - acc: 0.8620 - val_loss: 0.4442 - val_acc: 0.8556
Epoch 11/20
 - 1s - loss: 0.4223 - acc: 0.8681 - val_loss: 0.3823 - val_acc: 0.8760
Epoch 12/20
 - 1s - loss: 0.3675 - acc: 0.8856 - val_loss: 0.4004 - val_acc: 0.8719
Epoch 13/20
 - 1s - loss: 0.3605 - acc: 0.8857 - val_loss: 0.3881 - val_acc: 0.8799
Epoch 14/20
 - 1s - loss: 0.3369 - acc: 0.8952 - val_loss: 0.3671 - val_acc: 0.8894
Epoch 15/20
 - 1s - loss: 0.3081 - acc: 0.9024 - val_loss: 0.2950 - val_acc: 0.9106
Epoch 16/20
 - 1s - loss: 0.3309 - acc: 0.8963 - val_loss: 0.3143 - val_acc: 0.9031
Epoch 17/20
 - 1s - loss: 0.2995 - acc: 0.9023 - val_loss: 0.3206 - val_acc: 0.9013
Epoch 18/20
 - 1s - loss: 0.2797 - acc: 0.9091 - val_loss: 0.4282 - val_acc: 0.8624
Epoch 19/20
 - 1s - loss: 0.2747 - acc: 0.9151 - val_loss: 0.3483 - val_acc: 0.8895
Epoch 20/20
 - 1s - loss: 0.2541 - acc: 0.9200 - val_loss: 0.4578 - val_acc: 0.8584
Test loss: 0.4575881621837616
Test accuracy: 0.8591
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8401 - acc: 0.7360 - val_loss: 0.4822 - val_acc: 0.8422
Epoch 2/20
 - 0s - loss: 0.3396 - acc: 0.9008 - val_loss: 0.3463 - val_acc: 0.8940
Epoch 3/20
 - 0s - loss: 0.2345 - acc: 0.9280 - val_loss: 0.3520 - val_acc: 0.8962
Epoch 4/20
 - 0s - loss: 0.1689 - acc: 0.9480 - val_loss: 0.2849 - val_acc: 0.9109
Epoch 5/20
 - 0s - loss: 0.1269 - acc: 0.9653 - val_loss: 0.2734 - val_acc: 0.9170
Epoch 6/20
 - 0s - loss: 0.0864 - acc: 0.9749 - val_loss: 0.3103 - val_acc: 0.9080
Epoch 7/20
 - 0s - loss: 0.0696 - acc: 0.9771 - val_loss: 0.2359 - val_acc: 0.9329
Epoch 8/20
 - 0s - loss: 0.0482 - acc: 0.9832 - val_loss: 0.2526 - val_acc: 0.9323
Epoch 9/20
 - 0s - loss: 0.0472 - acc: 0.9864 - val_loss: 0.2250 - val_acc: 0.9393
Epoch 10/20
 - 0s - loss: 0.0299 - acc: 0.9909 - val_loss: 0.2307 - val_acc: 0.9396
Epoch 11/20
 - 0s - loss: 0.0326 - acc: 0.9880 - val_loss: 0.2313 - val_acc: 0.9409
Epoch 12/20
 - 0s - loss: 0.0175 - acc: 0.9949 - val_loss: 0.2578 - val_acc: 0.9389
Epoch 13/20
 - 0s - loss: 0.0162 - acc: 0.9957 - val_loss: 0.2692 - val_acc: 0.9401
Epoch 14/20
 - 0s - loss: 0.0150 - acc: 0.9941 - val_loss: 0.2819 - val_acc: 0.9381
Epoch 15/20
 - 0s - loss: 0.0100 - acc: 0.9968 - val_loss: 0.2692 - val_acc: 0.9409
Epoch 16/20
 - 0s - loss: 0.0094 - acc: 0.9968 - val_loss: 0.2856 - val_acc: 0.9380
Epoch 17/20
 - 0s - loss: 0.0130 - acc: 0.9957 - val_loss: 0.3086 - val_acc: 0.9354
Epoch 18/20
 - 0s - loss: 0.0081 - acc: 0.9979 - val_loss: 0.2701 - val_acc: 0.9459
Epoch 19/20
 - 0s - loss: 0.0049 - acc: 0.9987 - val_loss: 0.2903 - val_acc: 0.9429
Epoch 20/20
 - 0s - loss: 0.0162 - acc: 0.9952 - val_loss: 0.2708 - val_acc: 0.9456
Test loss: 0.2708497484435546
Test accuracy: 0.9456
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.4559 - acc: 0.2568 - val_loss: 1.6322 - val_acc: 0.4710
Epoch 2/20
 - 1s - loss: 1.5799 - acc: 0.4597 - val_loss: 1.4558 - val_acc: 0.4985
Epoch 3/20
 - 1s - loss: 1.1745 - acc: 0.6037 - val_loss: 1.4087 - val_acc: 0.5091
Epoch 4/20
 - 1s - loss: 1.0387 - acc: 0.6528 - val_loss: 0.9936 - val_acc: 0.6443
Epoch 5/20
 - 1s - loss: 0.8591 - acc: 0.7168 - val_loss: 0.6611 - val_acc: 0.7816
Epoch 6/20
 - 1s - loss: 0.8224 - acc: 0.7315 - val_loss: 0.9734 - val_acc: 0.6817
Epoch 7/20
 - 1s - loss: 0.8124 - acc: 0.7349 - val_loss: 0.8163 - val_acc: 0.7040
Epoch 8/20
 - 1s - loss: 0.6391 - acc: 0.7933 - val_loss: 1.5239 - val_acc: 0.5426
Epoch 9/20
 - 1s - loss: 0.7011 - acc: 0.7720 - val_loss: 1.3044 - val_acc: 0.5949
Epoch 10/20
 - 1s - loss: 0.6186 - acc: 0.7992 - val_loss: 0.5710 - val_acc: 0.8051
Epoch 11/20
 - 1s - loss: 0.5855 - acc: 0.8088 - val_loss: 0.8547 - val_acc: 0.7233
Epoch 12/20
 - 1s - loss: 0.5815 - acc: 0.8117 - val_loss: 0.4436 - val_acc: 0.8542
Epoch 13/20
 - 1s - loss: 0.5086 - acc: 0.8355 - val_loss: 0.5516 - val_acc: 0.8201
Epoch 14/20
 - 1s - loss: 0.4859 - acc: 0.8349 - val_loss: 0.4380 - val_acc: 0.8518
Epoch 15/20
 - 1s - loss: 0.5099 - acc: 0.8411 - val_loss: 0.4070 - val_acc: 0.8736
Epoch 16/20
 - 1s - loss: 0.4661 - acc: 0.8584 - val_loss: 0.5195 - val_acc: 0.8115
Epoch 17/20
 - 1s - loss: 0.4371 - acc: 0.8552 - val_loss: 0.5714 - val_acc: 0.8130
Epoch 18/20
 - 1s - loss: 0.4312 - acc: 0.8579 - val_loss: 0.5135 - val_acc: 0.8291
Epoch 19/20
 - 1s - loss: 0.4305 - acc: 0.8595 - val_loss: 0.4475 - val_acc: 0.8451
Epoch 20/20
 - 1s - loss: 0.3945 - acc: 0.8752 - val_loss: 0.2989 - val_acc: 0.9045
Test loss: 0.29796624250710013
Test accuracy: 0.9047
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1729 - acc: 0.6309 - val_loss: 0.6387 - val_acc: 0.7968
Epoch 2/20
 - 0s - loss: 0.4499 - acc: 0.8779 - val_loss: 0.4885 - val_acc: 0.8499
Epoch 3/20
 - 0s - loss: 0.3351 - acc: 0.8912 - val_loss: 0.4557 - val_acc: 0.8447
Epoch 4/20
 - 0s - loss: 0.2426 - acc: 0.9280 - val_loss: 0.3319 - val_acc: 0.9028
Epoch 5/20
 - 0s - loss: 0.1932 - acc: 0.9467 - val_loss: 0.3248 - val_acc: 0.9010
Epoch 6/20
 - 0s - loss: 0.1352 - acc: 0.9627 - val_loss: 0.2902 - val_acc: 0.9122
Epoch 7/20
 - 0s - loss: 0.1117 - acc: 0.9605 - val_loss: 0.3127 - val_acc: 0.9086
Epoch 8/20
 - 0s - loss: 0.0857 - acc: 0.9749 - val_loss: 0.2956 - val_acc: 0.9135
Epoch 9/20
 - 0s - loss: 0.0770 - acc: 0.9755 - val_loss: 0.3055 - val_acc: 0.9140
Epoch 10/20
 - 0s - loss: 0.0383 - acc: 0.9899 - val_loss: 0.3021 - val_acc: 0.9170
Epoch 11/20
 - 0s - loss: 0.0319 - acc: 0.9963 - val_loss: 0.2947 - val_acc: 0.9218
Epoch 12/20
 - 0s - loss: 0.0217 - acc: 0.9947 - val_loss: 0.4071 - val_acc: 0.8945
Epoch 13/20
 - 0s - loss: 0.0156 - acc: 0.9973 - val_loss: 0.6179 - val_acc: 0.8700
Epoch 14/20
 - 0s - loss: 0.0269 - acc: 0.9936 - val_loss: 0.3158 - val_acc: 0.9247
Epoch 15/20
 - 0s - loss: 0.0091 - acc: 0.9973 - val_loss: 0.3865 - val_acc: 0.9052
Epoch 16/20
 - 0s - loss: 0.0122 - acc: 0.9973 - val_loss: 0.3283 - val_acc: 0.9246
Epoch 17/20
 - 0s - loss: 0.0122 - acc: 0.9973 - val_loss: 0.4512 - val_acc: 0.9035
Epoch 18/20
 - 0s - loss: 0.0080 - acc: 0.9968 - val_loss: 0.4400 - val_acc: 0.9059
Epoch 19/20
 - 0s - loss: 0.0045 - acc: 0.9995 - val_loss: 0.3391 - val_acc: 0.9266
Epoch 20/20
 - 0s - loss: 0.0081 - acc: 0.9979 - val_loss: 0.4284 - val_acc: 0.9130
Test loss: 0.42841160985221505
Test accuracy: 0.913
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.3177 - acc: 0.1701 - val_loss: 1.9529 - val_acc: 0.3920
Epoch 2/20
 - 1s - loss: 1.9641 - acc: 0.3355 - val_loss: 1.7650 - val_acc: 0.4085
Epoch 3/20
 - 1s - loss: 1.6809 - acc: 0.4283 - val_loss: 1.6035 - val_acc: 0.4475
Epoch 4/20
 - 1s - loss: 1.4479 - acc: 0.5072 - val_loss: 1.5070 - val_acc: 0.4184
Epoch 5/20
 - 1s - loss: 1.2601 - acc: 0.5664 - val_loss: 1.1360 - val_acc: 0.6142
Epoch 6/20
 - 1s - loss: 1.1667 - acc: 0.6197 - val_loss: 0.8462 - val_acc: 0.7506
Epoch 7/20
 - 1s - loss: 1.0634 - acc: 0.6571 - val_loss: 1.0655 - val_acc: 0.6430
Epoch 8/20
 - 1s - loss: 0.9361 - acc: 0.6907 - val_loss: 0.9723 - val_acc: 0.6408
Epoch 9/20
 - 1s - loss: 0.8847 - acc: 0.7109 - val_loss: 0.7615 - val_acc: 0.7680
Epoch 10/20
 - 1s - loss: 0.8911 - acc: 0.7163 - val_loss: 0.9547 - val_acc: 0.6816
Epoch 11/20
 - 1s - loss: 0.7373 - acc: 0.7659 - val_loss: 0.7171 - val_acc: 0.7743
Epoch 12/20
 - 1s - loss: 0.8439 - acc: 0.7381 - val_loss: 0.5950 - val_acc: 0.7958
Epoch 13/20
 - 1s - loss: 0.7133 - acc: 0.7680 - val_loss: 0.5867 - val_acc: 0.7914
Epoch 14/20
 - 1s - loss: 0.7332 - acc: 0.7685 - val_loss: 0.6471 - val_acc: 0.7942
Epoch 15/20
 - 1s - loss: 0.6980 - acc: 0.7664 - val_loss: 0.6918 - val_acc: 0.7775
Epoch 16/20
 - 1s - loss: 0.6117 - acc: 0.8075 - val_loss: 1.0489 - val_acc: 0.6885
Epoch 17/20
 - 1s - loss: 0.6758 - acc: 0.7899 - val_loss: 0.7774 - val_acc: 0.7373
Epoch 18/20
 - 1s - loss: 0.6661 - acc: 0.7749 - val_loss: 0.8632 - val_acc: 0.7132
Epoch 19/20
 - 1s - loss: 0.6049 - acc: 0.7952 - val_loss: 0.6130 - val_acc: 0.7992
Epoch 20/20
 - 1s - loss: 0.5860 - acc: 0.8123 - val_loss: 0.5215 - val_acc: 0.8432
Test loss: 0.5213400883555412
Test accuracy: 0.8441
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5117 - acc: 0.4973 - val_loss: 0.7373 - val_acc: 0.8145
Epoch 2/20
 - 0s - loss: 0.6088 - acc: 0.8314 - val_loss: 0.6115 - val_acc: 0.8100
Epoch 3/20
 - 0s - loss: 0.4005 - acc: 0.8773 - val_loss: 0.4802 - val_acc: 0.8526
Epoch 4/20
 - 0s - loss: 0.3421 - acc: 0.8943 - val_loss: 0.4323 - val_acc: 0.8695
Epoch 5/20
 - 0s - loss: 0.2157 - acc: 0.9445 - val_loss: 0.4046 - val_acc: 0.8757
Epoch 6/20
 - 0s - loss: 0.1647 - acc: 0.9680 - val_loss: 0.4415 - val_acc: 0.8674
Epoch 7/20
 - 0s - loss: 0.1423 - acc: 0.9616 - val_loss: 0.5634 - val_acc: 0.8323
Epoch 8/20
 - 0s - loss: 0.1021 - acc: 0.9765 - val_loss: 0.4202 - val_acc: 0.8758
Epoch 9/20
 - 0s - loss: 0.0718 - acc: 0.9861 - val_loss: 0.6798 - val_acc: 0.7972
Epoch 10/20
 - 0s - loss: 0.0960 - acc: 0.9733 - val_loss: 0.3838 - val_acc: 0.8864
Epoch 11/20
 - 0s - loss: 0.0281 - acc: 0.9968 - val_loss: 0.4863 - val_acc: 0.8587
Epoch 12/20
 - 0s - loss: 0.0422 - acc: 0.9904 - val_loss: 0.9166 - val_acc: 0.7822
Epoch 13/20
 - 0s - loss: 0.0609 - acc: 0.9861 - val_loss: 0.3842 - val_acc: 0.8964
Epoch 14/20
 - 0s - loss: 0.0143 - acc: 1.0000 - val_loss: 0.4056 - val_acc: 0.8932
Epoch 15/20
 - 0s - loss: 0.0122 - acc: 0.9989 - val_loss: 0.6255 - val_acc: 0.8449
Epoch 16/20
 - 0s - loss: 0.0306 - acc: 0.9915 - val_loss: 0.4290 - val_acc: 0.8930
Epoch 17/20
 - 0s - loss: 0.0082 - acc: 1.0000 - val_loss: 0.4452 - val_acc: 0.8891
Epoch 18/20
 - 0s - loss: 0.0044 - acc: 1.0000 - val_loss: 0.4531 - val_acc: 0.8930
Epoch 19/20
 - 0s - loss: 0.0916 - acc: 0.9637 - val_loss: 0.4231 - val_acc: 0.8913
Epoch 20/20
 - 0s - loss: 0.0048 - acc: 0.9989 - val_loss: 0.4155 - val_acc: 0.8995
Test loss: 0.4154561263225041
Test accuracy: 0.8995
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.5241 - acc: 0.1377 - val_loss: 2.1435 - val_acc: 0.2504
Epoch 2/20
 - 1s - loss: 2.1047 - acc: 0.2743 - val_loss: 1.9575 - val_acc: 0.3333
Epoch 3/20
 - 0s - loss: 1.9552 - acc: 0.3426 - val_loss: 1.6888 - val_acc: 0.4479
Epoch 4/20
 - 0s - loss: 1.7375 - acc: 0.4194 - val_loss: 1.8944 - val_acc: 0.3348
Epoch 5/20
 - 0s - loss: 1.7663 - acc: 0.3831 - val_loss: 1.7052 - val_acc: 0.3706
Epoch 6/20
 - 0s - loss: 1.4400 - acc: 0.5251 - val_loss: 1.7110 - val_acc: 0.4488
Epoch 7/20
 - 0s - loss: 1.4173 - acc: 0.5507 - val_loss: 1.4855 - val_acc: 0.5089
Epoch 8/20
 - 0s - loss: 1.2685 - acc: 0.5731 - val_loss: 1.2857 - val_acc: 0.5381
Epoch 9/20
 - 0s - loss: 1.1451 - acc: 0.6318 - val_loss: 1.1183 - val_acc: 0.6105
Epoch 10/20
 - 0s - loss: 1.0371 - acc: 0.6788 - val_loss: 1.1065 - val_acc: 0.6414
Epoch 11/20
 - 0s - loss: 1.2233 - acc: 0.5827 - val_loss: 1.1377 - val_acc: 0.5906
Epoch 12/20
 - 0s - loss: 0.9081 - acc: 0.7097 - val_loss: 1.0157 - val_acc: 0.6316
Epoch 13/20
 - 0s - loss: 1.2168 - acc: 0.6158 - val_loss: 1.4707 - val_acc: 0.5166
Epoch 14/20
 - 0s - loss: 0.9744 - acc: 0.6745 - val_loss: 0.6618 - val_acc: 0.7868
Epoch 15/20
 - 0s - loss: 0.7496 - acc: 0.7513 - val_loss: 0.9147 - val_acc: 0.6824
Epoch 16/20
 - 0s - loss: 1.0367 - acc: 0.6649 - val_loss: 0.7005 - val_acc: 0.7788
Epoch 17/20
 - 0s - loss: 0.9478 - acc: 0.7022 - val_loss: 1.1195 - val_acc: 0.6125
Epoch 18/20
 - 0s - loss: 0.7797 - acc: 0.7492 - val_loss: 1.2176 - val_acc: 0.6124
Epoch 19/20
 - 0s - loss: 0.8005 - acc: 0.7311 - val_loss: 1.1457 - val_acc: 0.5996
Epoch 20/20
 - 0s - loss: 0.8002 - acc: 0.7417 - val_loss: 0.9287 - val_acc: 0.6923
Test loss: 0.9294852817535401
Test accuracy: 0.6915
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8613 - acc: 0.3761 - val_loss: 1.2597 - val_acc: 0.5620
Epoch 2/20
 - 0s - loss: 0.8595 - acc: 0.7457 - val_loss: 0.8525 - val_acc: 0.7219
Epoch 3/20
 - 0s - loss: 0.5156 - acc: 0.8654 - val_loss: 0.8208 - val_acc: 0.6925
Epoch 4/20
 - 0s - loss: 0.3804 - acc: 0.8803 - val_loss: 0.6028 - val_acc: 0.8159
Epoch 5/20
 - 0s - loss: 0.2637 - acc: 0.9338 - val_loss: 0.6958 - val_acc: 0.7548
Epoch 6/20
 - 0s - loss: 0.2099 - acc: 0.9338 - val_loss: 0.7176 - val_acc: 0.7867
Epoch 7/20
 - 0s - loss: 0.1431 - acc: 0.9722 - val_loss: 0.5147 - val_acc: 0.8386
Epoch 8/20
 - 0s - loss: 0.1067 - acc: 0.9829 - val_loss: 0.5547 - val_acc: 0.8286
Epoch 9/20
 - 0s - loss: 0.0774 - acc: 0.9872 - val_loss: 0.5557 - val_acc: 0.8277
Epoch 10/20
 - 0s - loss: 0.0564 - acc: 0.9957 - val_loss: 0.6221 - val_acc: 0.8177
Epoch 11/20
 - 0s - loss: 0.0555 - acc: 0.9893 - val_loss: 0.5257 - val_acc: 0.8479
Epoch 12/20
 - 0s - loss: 0.0370 - acc: 0.9979 - val_loss: 0.5729 - val_acc: 0.8303
Epoch 13/20
 - 0s - loss: 0.0385 - acc: 0.9915 - val_loss: 0.5445 - val_acc: 0.8469
Epoch 14/20
 - 0s - loss: 0.0245 - acc: 1.0000 - val_loss: 0.5536 - val_acc: 0.8436
Epoch 15/20
 - 0s - loss: 0.0176 - acc: 1.0000 - val_loss: 0.5656 - val_acc: 0.8468
Epoch 16/20
 - 0s - loss: 0.0706 - acc: 0.9765 - val_loss: 0.8110 - val_acc: 0.8051
Epoch 17/20
 - 0s - loss: 0.0169 - acc: 1.0000 - val_loss: 0.5501 - val_acc: 0.8551
Epoch 18/20
 - 0s - loss: 0.0093 - acc: 1.0000 - val_loss: 0.5835 - val_acc: 0.8507
Epoch 19/20
 - 0s - loss: 0.0061 - acc: 1.0000 - val_loss: 0.5750 - val_acc: 0.8530
Epoch 20/20
 - 0s - loss: 0.0047 - acc: 1.0000 - val_loss: 0.5681 - val_acc: 0.8546
Test loss: 0.568129185076803
Test accuracy: 0.8546
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.2487 - acc: 0.1068 - val_loss: 3.7496 - val_acc: 0.0958
Epoch 2/20
 - 0s - loss: 2.8720 - acc: 0.1410 - val_loss: 2.1618 - val_acc: 0.2050
Epoch 3/20
 - 0s - loss: 2.0770 - acc: 0.2735 - val_loss: 2.0439 - val_acc: 0.2512
Epoch 4/20
 - 0s - loss: 2.0865 - acc: 0.2863 - val_loss: 1.8770 - val_acc: 0.4095
Epoch 5/20
 - 0s - loss: 1.8540 - acc: 0.4081 - val_loss: 2.0820 - val_acc: 0.2226
Epoch 6/20
 - 0s - loss: 1.9713 - acc: 0.3333 - val_loss: 1.8520 - val_acc: 0.2630
Epoch 7/20
 - 0s - loss: 1.6539 - acc: 0.4103 - val_loss: 1.5214 - val_acc: 0.5732
Epoch 8/20
 - 0s - loss: 1.7292 - acc: 0.4530 - val_loss: 1.7724 - val_acc: 0.4700
Epoch 9/20
 - 0s - loss: 1.5826 - acc: 0.5150 - val_loss: 1.6330 - val_acc: 0.5169
Epoch 10/20
 - 0s - loss: 1.6524 - acc: 0.4594 - val_loss: 1.6824 - val_acc: 0.3892
Epoch 11/20
 - 0s - loss: 1.3229 - acc: 0.5769 - val_loss: 1.8522 - val_acc: 0.3936
Epoch 12/20
 - 0s - loss: 1.7692 - acc: 0.4295 - val_loss: 1.5140 - val_acc: 0.4953
Epoch 13/20
 - 0s - loss: 1.1648 - acc: 0.6261 - val_loss: 1.6029 - val_acc: 0.3893
Epoch 14/20
 - 0s - loss: 1.3178 - acc: 0.5641 - val_loss: 1.3199 - val_acc: 0.5704
Epoch 15/20
 - 0s - loss: 1.1488 - acc: 0.6325 - val_loss: 1.2297 - val_acc: 0.6062
Epoch 16/20
 - 0s - loss: 1.1959 - acc: 0.5897 - val_loss: 1.4531 - val_acc: 0.4857
Epoch 17/20
 - 0s - loss: 0.9971 - acc: 0.6859 - val_loss: 1.1120 - val_acc: 0.6033
Epoch 18/20
 - 0s - loss: 1.4226 - acc: 0.5299 - val_loss: 1.0555 - val_acc: 0.6194
Epoch 19/20
 - 0s - loss: 0.9641 - acc: 0.6709 - val_loss: 0.9901 - val_acc: 0.6600
Epoch 20/20
 - 0s - loss: 0.7235 - acc: 0.7735 - val_loss: 0.8344 - val_acc: 0.7219
Test loss: 0.8348953364372254
Test accuracy: 0.7219
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1194 - acc: 0.2564 - val_loss: 1.6694 - val_acc: 0.4690
Epoch 2/20
 - 0s - loss: 1.2769 - acc: 0.6709 - val_loss: 1.3010 - val_acc: 0.5937
Epoch 3/20
 - 0s - loss: 0.7733 - acc: 0.8077 - val_loss: 1.0857 - val_acc: 0.6587
Epoch 4/20
 - 0s - loss: 0.4992 - acc: 0.8974 - val_loss: 1.0455 - val_acc: 0.6566
Epoch 5/20
 - 0s - loss: 0.4727 - acc: 0.8675 - val_loss: 1.0519 - val_acc: 0.6992
Epoch 6/20
 - 0s - loss: 0.3086 - acc: 0.9274 - val_loss: 0.9115 - val_acc: 0.7297
Epoch 7/20
 - 0s - loss: 0.2077 - acc: 0.9530 - val_loss: 0.8417 - val_acc: 0.7372
Epoch 8/20
 - 0s - loss: 0.1501 - acc: 0.9786 - val_loss: 0.7357 - val_acc: 0.7702
Epoch 9/20
 - 0s - loss: 0.1286 - acc: 0.9786 - val_loss: 0.9130 - val_acc: 0.7348
Epoch 10/20
 - 0s - loss: 0.1710 - acc: 0.9487 - val_loss: 0.9841 - val_acc: 0.7305
Epoch 11/20
 - 0s - loss: 0.1430 - acc: 0.9573 - val_loss: 0.7580 - val_acc: 0.7765
Epoch 12/20
 - 0s - loss: 0.0578 - acc: 1.0000 - val_loss: 0.7638 - val_acc: 0.7746
Epoch 13/20
 - 0s - loss: 0.0515 - acc: 0.9957 - val_loss: 0.7336 - val_acc: 0.7804
Epoch 14/20
 - 0s - loss: 0.0365 - acc: 1.0000 - val_loss: 0.7712 - val_acc: 0.7792
Epoch 15/20
 - 0s - loss: 0.0310 - acc: 1.0000 - val_loss: 0.7592 - val_acc: 0.7836
Epoch 16/20
 - 0s - loss: 0.0225 - acc: 1.0000 - val_loss: 0.7733 - val_acc: 0.7841
Epoch 17/20
 - 0s - loss: 0.0209 - acc: 1.0000 - val_loss: 0.7739 - val_acc: 0.7848
Epoch 18/20
 - 0s - loss: 0.0205 - acc: 1.0000 - val_loss: 0.7791 - val_acc: 0.7778
Epoch 19/20
 - 0s - loss: 0.0160 - acc: 1.0000 - val_loss: 0.7768 - val_acc: 0.7886
Epoch 20/20
 - 0s - loss: 0.0131 - acc: 1.0000 - val_loss: 0.7808 - val_acc: 0.7874
Test loss: 0.7807667612731457
Test accuracy: 0.7874
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.4596 - acc: 0.0983 - val_loss: 5.7215 - val_acc: 0.1545
Epoch 2/20
 - 0s - loss: 6.3821 - acc: 0.0940 - val_loss: 3.8344 - val_acc: 0.1028
Epoch 3/20
 - 0s - loss: 3.4252 - acc: 0.1538 - val_loss: 2.2137 - val_acc: 0.1756
Epoch 4/20
 - 0s - loss: 2.1716 - acc: 0.2137 - val_loss: 2.0901 - val_acc: 0.3655
Epoch 5/20
 - 0s - loss: 2.0076 - acc: 0.3333 - val_loss: 2.0885 - val_acc: 0.2020
Epoch 6/20
 - 0s - loss: 2.0386 - acc: 0.2436 - val_loss: 1.9371 - val_acc: 0.3520
Epoch 7/20
 - 0s - loss: 1.9570 - acc: 0.3034 - val_loss: 2.2823 - val_acc: 0.1922
Epoch 8/20
 - 0s - loss: 2.0805 - acc: 0.2778 - val_loss: 1.9315 - val_acc: 0.3587
Epoch 9/20
 - 0s - loss: 1.9119 - acc: 0.3718 - val_loss: 1.9909 - val_acc: 0.3375
Epoch 10/20
 - 0s - loss: 1.8338 - acc: 0.4017 - val_loss: 1.8252 - val_acc: 0.3708
Epoch 11/20
 - 0s - loss: 1.5978 - acc: 0.5000 - val_loss: 2.0426 - val_acc: 0.4071
Epoch 12/20
 - 0s - loss: 2.1369 - acc: 0.2821 - val_loss: 2.2657 - val_acc: 0.2124
Epoch 13/20
 - 0s - loss: 2.0436 - acc: 0.3034 - val_loss: 1.8960 - val_acc: 0.2641
Epoch 14/20
 - 0s - loss: 1.6909 - acc: 0.4658 - val_loss: 1.5583 - val_acc: 0.5607
Epoch 15/20
 - 0s - loss: 1.4660 - acc: 0.5684 - val_loss: 1.9027 - val_acc: 0.3149
Epoch 16/20
 - 0s - loss: 1.5570 - acc: 0.4744 - val_loss: 1.8972 - val_acc: 0.3155
Epoch 17/20
 - 0s - loss: 1.7343 - acc: 0.4359 - val_loss: 1.5606 - val_acc: 0.4903
Epoch 18/20
 - 0s - loss: 1.5728 - acc: 0.4957 - val_loss: 1.8986 - val_acc: 0.4881
Epoch 19/20
 - 0s - loss: 1.4965 - acc: 0.5684 - val_loss: 1.7315 - val_acc: 0.4207
Epoch 20/20
 - 0s - loss: 1.4382 - acc: 0.5128 - val_loss: 1.5952 - val_acc: 0.4301
Test loss: 1.595423621559143
Test accuracy: 0.4297
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3649 - acc: 0.1026 - val_loss: 2.1022 - val_acc: 0.3464
Epoch 2/20
 - 0s - loss: 1.5990 - acc: 0.5556 - val_loss: 1.7194 - val_acc: 0.4211
Epoch 3/20
 - 0s - loss: 1.2631 - acc: 0.6667 - val_loss: 1.5950 - val_acc: 0.4475
Epoch 4/20
 - 0s - loss: 0.9057 - acc: 0.7521 - val_loss: 1.3724 - val_acc: 0.5671
Epoch 5/20
 - 0s - loss: 0.6600 - acc: 0.8547 - val_loss: 1.2747 - val_acc: 0.5985
Epoch 6/20
 - 0s - loss: 0.4655 - acc: 0.9573 - val_loss: 1.2176 - val_acc: 0.6305
Epoch 7/20
 - 0s - loss: 0.3043 - acc: 0.9402 - val_loss: 1.1146 - val_acc: 0.6359
Epoch 8/20
 - 0s - loss: 0.2255 - acc: 0.9829 - val_loss: 1.1383 - val_acc: 0.6447
Epoch 9/20
 - 0s - loss: 0.1688 - acc: 0.9658 - val_loss: 1.0970 - val_acc: 0.6416
Epoch 10/20
 - 0s - loss: 0.1367 - acc: 0.9744 - val_loss: 1.0480 - val_acc: 0.6814
Epoch 11/20
 - 0s - loss: 0.1184 - acc: 0.9915 - val_loss: 1.0378 - val_acc: 0.6749
Epoch 12/20
 - 0s - loss: 0.0907 - acc: 0.9915 - val_loss: 1.0237 - val_acc: 0.6945
Epoch 13/20
 - 0s - loss: 0.0763 - acc: 0.9915 - val_loss: 1.0168 - val_acc: 0.6932
Epoch 14/20
 - 0s - loss: 0.0515 - acc: 1.0000 - val_loss: 1.0007 - val_acc: 0.7133
Epoch 15/20
 - 0s - loss: 0.0360 - acc: 1.0000 - val_loss: 0.9652 - val_acc: 0.7197
Epoch 16/20
 - 0s - loss: 0.0326 - acc: 1.0000 - val_loss: 1.0042 - val_acc: 0.7150
Epoch 17/20
 - 0s - loss: 0.0309 - acc: 1.0000 - val_loss: 0.9968 - val_acc: 0.7204
Epoch 18/20
 - 0s - loss: 0.0249 - acc: 1.0000 - val_loss: 1.0375 - val_acc: 0.7138
Epoch 19/20
 - 0s - loss: 0.0183 - acc: 1.0000 - val_loss: 1.0227 - val_acc: 0.7197
Epoch 20/20
 - 0s - loss: 0.0181 - acc: 1.0000 - val_loss: 1.0187 - val_acc: 0.7188
Test loss: 1.0186667805671692
Test accuracy: 0.7188
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6452 - acc: 0.0940 - val_loss: 6.8637 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 6.2857 - acc: 0.1624 - val_loss: 6.1426 - val_acc: 0.1009
Epoch 3/20
 - 0s - loss: 6.2541 - acc: 0.1368 - val_loss: 7.1033 - val_acc: 0.0980
Epoch 4/20
 - 0s - loss: 7.1593 - acc: 0.1368 - val_loss: 6.9884 - val_acc: 0.0958
Epoch 5/20
 - 0s - loss: 7.3452 - acc: 0.0940 - val_loss: 5.5231 - val_acc: 0.1479
Epoch 6/20
 - 0s - loss: 5.7248 - acc: 0.1795 - val_loss: 3.4424 - val_acc: 0.0981
Epoch 7/20
 - 0s - loss: 3.4626 - acc: 0.1538 - val_loss: 2.5722 - val_acc: 0.1176
Epoch 8/20
 - 0s - loss: 2.4417 - acc: 0.1709 - val_loss: 2.2620 - val_acc: 0.2759
Epoch 9/20
 - 0s - loss: 2.0695 - acc: 0.3248 - val_loss: 2.1614 - val_acc: 0.2760
Epoch 10/20
 - 0s - loss: 1.9815 - acc: 0.3932 - val_loss: 2.1648 - val_acc: 0.3272
Epoch 11/20
 - 0s - loss: 1.9529 - acc: 0.3162 - val_loss: 2.1336 - val_acc: 0.2594
Epoch 12/20
 - 0s - loss: 1.9986 - acc: 0.2735 - val_loss: 2.2899 - val_acc: 0.2464
Epoch 13/20
 - 0s - loss: 2.0865 - acc: 0.2991 - val_loss: 2.1640 - val_acc: 0.1369
Epoch 14/20
 - 0s - loss: 1.9776 - acc: 0.3162 - val_loss: 2.0371 - val_acc: 0.3456
Epoch 15/20
 - 0s - loss: 1.8092 - acc: 0.4701 - val_loss: 1.9994 - val_acc: 0.2457
Epoch 16/20
 - 0s - loss: 1.7133 - acc: 0.4786 - val_loss: 2.0267 - val_acc: 0.2729
Epoch 17/20
 - 0s - loss: 1.8475 - acc: 0.4103 - val_loss: 2.1181 - val_acc: 0.3052
Epoch 18/20
 - 0s - loss: 1.8166 - acc: 0.4359 - val_loss: 1.9102 - val_acc: 0.3260
Epoch 19/20
 - 0s - loss: 1.6413 - acc: 0.4359 - val_loss: 1.9987 - val_acc: 0.3816
Epoch 20/20
 - 0s - loss: 1.7395 - acc: 0.4274 - val_loss: 2.0394 - val_acc: 0.3570
Test loss: 2.039880869102478
Test accuracy: 0.3577
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2487 - acc: 0.9228 - val_loss: 0.1086 - val_acc: 0.9659
Epoch 2/20
 - 2s - loss: 0.1038 - acc: 0.9686 - val_loss: 0.0832 - val_acc: 0.9756
Epoch 3/20
 - 2s - loss: 0.0761 - acc: 0.9771 - val_loss: 0.0798 - val_acc: 0.9771
Epoch 4/20
 - 2s - loss: 0.0615 - acc: 0.9813 - val_loss: 0.0705 - val_acc: 0.9814
Epoch 5/20
 - 3s - loss: 0.0505 - acc: 0.9849 - val_loss: 0.0746 - val_acc: 0.9806
Epoch 6/20
 - 2s - loss: 0.0439 - acc: 0.9874 - val_loss: 0.0806 - val_acc: 0.9809
Epoch 7/20
 - 2s - loss: 0.0399 - acc: 0.9885 - val_loss: 0.0795 - val_acc: 0.9805
Epoch 8/20
 - 2s - loss: 0.0355 - acc: 0.9896 - val_loss: 0.0936 - val_acc: 0.9796
Epoch 9/20
 - 2s - loss: 0.0332 - acc: 0.9901 - val_loss: 0.0997 - val_acc: 0.9807
Epoch 10/20
 - 2s - loss: 0.0303 - acc: 0.9913 - val_loss: 0.0922 - val_acc: 0.9816
Epoch 11/20
 - 2s - loss: 0.0279 - acc: 0.9919 - val_loss: 0.1014 - val_acc: 0.9809
Epoch 12/20
 - 2s - loss: 0.0274 - acc: 0.9923 - val_loss: 0.0948 - val_acc: 0.9813
Epoch 13/20
 - 2s - loss: 0.0227 - acc: 0.9937 - val_loss: 0.1120 - val_acc: 0.9821
Epoch 14/20
 - 2s - loss: 0.0243 - acc: 0.9934 - val_loss: 0.0977 - val_acc: 0.9840
Epoch 15/20
 - 2s - loss: 0.0238 - acc: 0.9935 - val_loss: 0.1080 - val_acc: 0.9825
Epoch 16/20
 - 2s - loss: 0.0254 - acc: 0.9938 - val_loss: 0.1046 - val_acc: 0.9829
Epoch 17/20
 - 2s - loss: 0.0202 - acc: 0.9951 - val_loss: 0.1163 - val_acc: 0.9835
Epoch 18/20
 - 2s - loss: 0.0204 - acc: 0.9944 - val_loss: 0.1093 - val_acc: 0.9834
Epoch 19/20
 - 2s - loss: 0.0204 - acc: 0.9949 - val_loss: 0.1198 - val_acc: 0.9822
Epoch 20/20
 - 2s - loss: 0.0207 - acc: 0.9949 - val_loss: 0.1044 - val_acc: 0.9832
Test loss: 0.10439505052034606
Test accuracy: 0.9832
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9533 - acc: 0.6945 - val_loss: 0.4599 - val_acc: 0.8458
Epoch 2/20
 - 4s - loss: 0.4360 - acc: 0.8623 - val_loss: 0.6583 - val_acc: 0.7975
Epoch 3/20
 - 4s - loss: 0.3281 - acc: 0.8975 - val_loss: 0.2224 - val_acc: 0.9296
Epoch 4/20
 - 4s - loss: 0.2706 - acc: 0.9145 - val_loss: 0.3099 - val_acc: 0.9026
Epoch 5/20
 - 4s - loss: 0.2407 - acc: 0.9260 - val_loss: 0.1371 - val_acc: 0.9579
Epoch 6/20
 - 4s - loss: 0.2164 - acc: 0.9329 - val_loss: 0.1966 - val_acc: 0.9393
Epoch 7/20
 - 4s - loss: 0.2027 - acc: 0.9381 - val_loss: 0.1328 - val_acc: 0.9596
Epoch 8/20
 - 4s - loss: 0.1954 - acc: 0.9414 - val_loss: 0.2054 - val_acc: 0.9352
Epoch 9/20
 - 4s - loss: 0.1851 - acc: 0.9431 - val_loss: 0.1264 - val_acc: 0.9623
Epoch 10/20
 - 4s - loss: 0.1827 - acc: 0.9456 - val_loss: 0.1216 - val_acc: 0.9609
Epoch 11/20
 - 4s - loss: 0.1770 - acc: 0.9473 - val_loss: 0.1041 - val_acc: 0.9700
Epoch 12/20
 - 4s - loss: 0.1762 - acc: 0.9478 - val_loss: 0.1080 - val_acc: 0.9670
Epoch 13/20
 - 4s - loss: 0.1739 - acc: 0.9485 - val_loss: 0.1213 - val_acc: 0.9631
Epoch 14/20
 - 4s - loss: 0.1703 - acc: 0.9505 - val_loss: 0.3609 - val_acc: 0.9032
Epoch 15/20
 - 5s - loss: 0.1678 - acc: 0.9519 - val_loss: 0.1199 - val_acc: 0.9643
Epoch 16/20
 - 5s - loss: 0.1702 - acc: 0.9514 - val_loss: 0.1030 - val_acc: 0.9689
Epoch 17/20
 - 5s - loss: 0.1714 - acc: 0.9516 - val_loss: 0.1147 - val_acc: 0.9674
Epoch 18/20
 - 4s - loss: 0.1639 - acc: 0.9534 - val_loss: 0.1430 - val_acc: 0.9589
Epoch 19/20
 - 4s - loss: 0.1698 - acc: 0.9536 - val_loss: 0.1182 - val_acc: 0.9640
Epoch 20/20
 - 5s - loss: 0.1692 - acc: 0.9544 - val_loss: 0.1032 - val_acc: 0.9710
Test loss: 0.10310387759881559
Test accuracy: 0.9707
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3389 - acc: 0.8957 - val_loss: 0.1492 - val_acc: 0.9531
Epoch 2/20
 - 1s - loss: 0.1327 - acc: 0.9582 - val_loss: 0.1111 - val_acc: 0.9643
Epoch 3/20
 - 1s - loss: 0.0907 - acc: 0.9725 - val_loss: 0.1253 - val_acc: 0.9640
Epoch 4/20
 - 1s - loss: 0.0675 - acc: 0.9791 - val_loss: 0.1115 - val_acc: 0.9704
Epoch 5/20
 - 1s - loss: 0.0534 - acc: 0.9832 - val_loss: 0.0935 - val_acc: 0.9749
Epoch 6/20
 - 1s - loss: 0.0416 - acc: 0.9868 - val_loss: 0.1163 - val_acc: 0.9710
Epoch 7/20
 - 1s - loss: 0.0379 - acc: 0.9881 - val_loss: 0.1048 - val_acc: 0.9748
Epoch 8/20
 - 1s - loss: 0.0322 - acc: 0.9901 - val_loss: 0.0969 - val_acc: 0.9769
Epoch 9/20
 - 1s - loss: 0.0262 - acc: 0.9917 - val_loss: 0.1100 - val_acc: 0.9754
Epoch 10/20
 - 1s - loss: 0.0244 - acc: 0.9919 - val_loss: 0.1067 - val_acc: 0.9777
Epoch 11/20
 - 1s - loss: 0.0210 - acc: 0.9937 - val_loss: 0.1143 - val_acc: 0.9779
Epoch 12/20
 - 1s - loss: 0.0204 - acc: 0.9940 - val_loss: 0.1235 - val_acc: 0.9763
Epoch 13/20
 - 1s - loss: 0.0197 - acc: 0.9934 - val_loss: 0.1283 - val_acc: 0.9771
Epoch 14/20
 - 1s - loss: 0.0191 - acc: 0.9943 - val_loss: 0.1288 - val_acc: 0.9776
Epoch 15/20
 - 1s - loss: 0.0153 - acc: 0.9959 - val_loss: 0.1354 - val_acc: 0.9762
Epoch 16/20
 - 1s - loss: 0.0153 - acc: 0.9952 - val_loss: 0.1293 - val_acc: 0.9776
Epoch 17/20
 - 1s - loss: 0.0175 - acc: 0.9949 - val_loss: 0.1303 - val_acc: 0.9785
Epoch 18/20
 - 1s - loss: 0.0143 - acc: 0.9960 - val_loss: 0.1298 - val_acc: 0.9770
Epoch 19/20
 - 1s - loss: 0.0125 - acc: 0.9964 - val_loss: 0.1322 - val_acc: 0.9794
Epoch 20/20
 - 1s - loss: 0.0147 - acc: 0.9958 - val_loss: 0.1428 - val_acc: 0.9777
Test loss: 0.14283312589494918
Test accuracy: 0.9777
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2612 - acc: 0.5985 - val_loss: 1.3009 - val_acc: 0.6240
Epoch 2/20
 - 2s - loss: 0.6246 - acc: 0.7990 - val_loss: 0.4543 - val_acc: 0.8478
Epoch 3/20
 - 2s - loss: 0.4661 - acc: 0.8509 - val_loss: 0.4139 - val_acc: 0.8636
Epoch 4/20
 - 2s - loss: 0.3800 - acc: 0.8784 - val_loss: 0.3269 - val_acc: 0.8883
Epoch 5/20
 - 2s - loss: 0.3258 - acc: 0.8950 - val_loss: 0.7308 - val_acc: 0.7744
Epoch 6/20
 - 2s - loss: 0.2910 - acc: 0.9077 - val_loss: 0.2022 - val_acc: 0.9344
Epoch 7/20
 - 2s - loss: 0.2632 - acc: 0.9165 - val_loss: 0.3574 - val_acc: 0.8889
Epoch 8/20
 - 2s - loss: 0.2445 - acc: 0.9260 - val_loss: 0.2259 - val_acc: 0.9309
Epoch 9/20
 - 2s - loss: 0.2283 - acc: 0.9284 - val_loss: 0.3733 - val_acc: 0.8918
Epoch 10/20
 - 2s - loss: 0.2121 - acc: 0.9338 - val_loss: 0.2052 - val_acc: 0.9359
Epoch 11/20
 - 2s - loss: 0.2055 - acc: 0.9364 - val_loss: 0.1581 - val_acc: 0.9492
Epoch 12/20
 - 2s - loss: 0.1892 - acc: 0.9405 - val_loss: 0.1968 - val_acc: 0.9398
Epoch 13/20
 - 2s - loss: 0.1839 - acc: 0.9430 - val_loss: 0.2465 - val_acc: 0.9202
Epoch 14/20
 - 2s - loss: 0.1761 - acc: 0.9450 - val_loss: 0.1953 - val_acc: 0.9439
Epoch 15/20
 - 2s - loss: 0.1732 - acc: 0.9467 - val_loss: 0.2717 - val_acc: 0.9187
Epoch 16/20
 - 3s - loss: 0.1691 - acc: 0.9490 - val_loss: 0.1102 - val_acc: 0.9646
Epoch 17/20
 - 2s - loss: 0.1586 - acc: 0.9505 - val_loss: 0.1520 - val_acc: 0.9544
Epoch 18/20
 - 2s - loss: 0.1577 - acc: 0.9510 - val_loss: 0.1256 - val_acc: 0.9620
Epoch 19/20
 - 2s - loss: 0.1556 - acc: 0.9526 - val_loss: 0.1981 - val_acc: 0.9438
Epoch 20/20
 - 2s - loss: 0.1603 - acc: 0.9515 - val_loss: 0.2438 - val_acc: 0.9319
Test loss: 0.24227878279611467
Test accuracy: 0.9322
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4593 - acc: 0.8589 - val_loss: 0.3702 - val_acc: 0.8836
Epoch 2/20
 - 1s - loss: 0.1871 - acc: 0.9433 - val_loss: 0.2322 - val_acc: 0.9276
Epoch 3/20
 - 1s - loss: 0.1206 - acc: 0.9622 - val_loss: 0.1423 - val_acc: 0.9559
Epoch 4/20
 - 1s - loss: 0.0872 - acc: 0.9725 - val_loss: 0.1243 - val_acc: 0.9630
Epoch 5/20
 - 1s - loss: 0.0630 - acc: 0.9790 - val_loss: 0.1454 - val_acc: 0.9576
Epoch 6/20
 - 1s - loss: 0.0493 - acc: 0.9838 - val_loss: 0.1189 - val_acc: 0.9667
Epoch 7/20
 - 1s - loss: 0.0353 - acc: 0.9883 - val_loss: 0.1501 - val_acc: 0.9620
Epoch 8/20
 - 1s - loss: 0.0299 - acc: 0.9909 - val_loss: 0.1524 - val_acc: 0.9650
Epoch 9/20
 - 1s - loss: 0.0257 - acc: 0.9915 - val_loss: 0.1622 - val_acc: 0.9650
Epoch 10/20
 - 1s - loss: 0.0249 - acc: 0.9916 - val_loss: 0.1508 - val_acc: 0.9696
Epoch 11/20
 - 1s - loss: 0.0189 - acc: 0.9939 - val_loss: 0.1838 - val_acc: 0.9647
Epoch 12/20
 - 1s - loss: 0.0165 - acc: 0.9943 - val_loss: 0.1621 - val_acc: 0.9679
Epoch 13/20
 - 1s - loss: 0.0166 - acc: 0.9947 - val_loss: 0.2244 - val_acc: 0.9590
Epoch 14/20
 - 1s - loss: 0.0136 - acc: 0.9955 - val_loss: 0.1621 - val_acc: 0.9703
Epoch 15/20
 - 1s - loss: 0.0108 - acc: 0.9961 - val_loss: 0.1779 - val_acc: 0.9698
Epoch 16/20
 - 1s - loss: 0.0147 - acc: 0.9955 - val_loss: 0.1601 - val_acc: 0.9712
Epoch 17/20
 - 1s - loss: 0.0118 - acc: 0.9961 - val_loss: 0.1662 - val_acc: 0.9710
Epoch 18/20
 - 1s - loss: 0.0090 - acc: 0.9971 - val_loss: 0.1970 - val_acc: 0.9694
Epoch 19/20
 - 1s - loss: 0.0107 - acc: 0.9963 - val_loss: 0.1973 - val_acc: 0.9674
Epoch 20/20
 - 1s - loss: 0.0089 - acc: 0.9969 - val_loss: 0.2029 - val_acc: 0.9683
Test loss: 0.20288274822708358
Test accuracy: 0.9683
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6503 - acc: 0.4833 - val_loss: 1.0408 - val_acc: 0.6453
Epoch 2/20
 - 1s - loss: 0.8706 - acc: 0.7133 - val_loss: 0.9084 - val_acc: 0.6819
Epoch 3/20
 - 1s - loss: 0.6881 - acc: 0.7738 - val_loss: 0.4537 - val_acc: 0.8587
Epoch 4/20
 - 1s - loss: 0.5450 - acc: 0.8241 - val_loss: 1.0051 - val_acc: 0.7059
Epoch 5/20
 - 1s - loss: 0.4831 - acc: 0.8449 - val_loss: 0.6171 - val_acc: 0.7935
Epoch 6/20
 - 1s - loss: 0.4484 - acc: 0.8577 - val_loss: 0.8216 - val_acc: 0.7199
Epoch 7/20
 - 1s - loss: 0.3872 - acc: 0.8765 - val_loss: 0.5015 - val_acc: 0.8284
Epoch 8/20
 - 1s - loss: 0.3503 - acc: 0.8891 - val_loss: 0.6240 - val_acc: 0.8085
Epoch 9/20
 - 1s - loss: 0.3328 - acc: 0.8959 - val_loss: 0.4380 - val_acc: 0.8443
Epoch 10/20
 - 1s - loss: 0.3129 - acc: 0.9026 - val_loss: 0.3691 - val_acc: 0.8857
Epoch 11/20
 - 1s - loss: 0.2886 - acc: 0.9093 - val_loss: 0.1745 - val_acc: 0.9455
Epoch 12/20
 - 1s - loss: 0.2692 - acc: 0.9169 - val_loss: 0.2148 - val_acc: 0.9315
Epoch 13/20
 - 1s - loss: 0.2464 - acc: 0.9232 - val_loss: 0.2901 - val_acc: 0.9106
Epoch 14/20
 - 1s - loss: 0.2363 - acc: 0.9227 - val_loss: 0.3786 - val_acc: 0.8842
Epoch 15/20
 - 1s - loss: 0.2320 - acc: 0.9269 - val_loss: 0.2129 - val_acc: 0.9328
Epoch 16/20
 - 1s - loss: 0.2173 - acc: 0.9324 - val_loss: 0.6410 - val_acc: 0.8308
Epoch 17/20
 - 1s - loss: 0.2111 - acc: 0.9318 - val_loss: 0.1833 - val_acc: 0.9452
Epoch 18/20
 - 1s - loss: 0.2001 - acc: 0.9381 - val_loss: 0.1685 - val_acc: 0.9457
Epoch 19/20
 - 1s - loss: 0.1889 - acc: 0.9403 - val_loss: 0.3126 - val_acc: 0.9089
Epoch 20/20
 - 1s - loss: 0.1933 - acc: 0.9385 - val_loss: 0.1471 - val_acc: 0.9552
Test loss: 0.14757095352145844
Test accuracy: 0.9547
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.6088 - acc: 0.8079 - val_loss: 0.3398 - val_acc: 0.8918
Epoch 2/20
 - 0s - loss: 0.2404 - acc: 0.9264 - val_loss: 0.2689 - val_acc: 0.9151
Epoch 3/20
 - 0s - loss: 0.1653 - acc: 0.9488 - val_loss: 0.2112 - val_acc: 0.9333
Epoch 4/20
 - 0s - loss: 0.1184 - acc: 0.9635 - val_loss: 0.1924 - val_acc: 0.9408
Epoch 5/20
 - 0s - loss: 0.0823 - acc: 0.9733 - val_loss: 0.1911 - val_acc: 0.9455
Epoch 6/20
 - 0s - loss: 0.0618 - acc: 0.9812 - val_loss: 0.2296 - val_acc: 0.9369
Epoch 7/20
 - 0s - loss: 0.0462 - acc: 0.9853 - val_loss: 0.1702 - val_acc: 0.9506
Epoch 8/20
 - 0s - loss: 0.0366 - acc: 0.9877 - val_loss: 0.2017 - val_acc: 0.9502
Epoch 9/20
 - 0s - loss: 0.0276 - acc: 0.9904 - val_loss: 0.2178 - val_acc: 0.9473
Epoch 10/20
 - 0s - loss: 0.0263 - acc: 0.9913 - val_loss: 0.1797 - val_acc: 0.9562
Epoch 11/20
 - 0s - loss: 0.0170 - acc: 0.9941 - val_loss: 0.2079 - val_acc: 0.9541
Epoch 12/20
 - 0s - loss: 0.0159 - acc: 0.9941 - val_loss: 0.2302 - val_acc: 0.9490
Epoch 13/20
 - 0s - loss: 0.0121 - acc: 0.9960 - val_loss: 0.2295 - val_acc: 0.9533
Epoch 14/20
 - 0s - loss: 0.0109 - acc: 0.9960 - val_loss: 0.2351 - val_acc: 0.9555
Epoch 15/20
 - 0s - loss: 0.0098 - acc: 0.9969 - val_loss: 0.2343 - val_acc: 0.9574
Epoch 16/20
 - 0s - loss: 0.0116 - acc: 0.9961 - val_loss: 0.3009 - val_acc: 0.9472
Epoch 17/20
 - 0s - loss: 0.0086 - acc: 0.9973 - val_loss: 0.2717 - val_acc: 0.9521
Epoch 18/20
 - 0s - loss: 0.0102 - acc: 0.9968 - val_loss: 0.2927 - val_acc: 0.9485
Epoch 19/20
 - 0s - loss: 0.0100 - acc: 0.9969 - val_loss: 0.2372 - val_acc: 0.9571
Epoch 20/20
 - 0s - loss: 0.0082 - acc: 0.9975 - val_loss: 0.2517 - val_acc: 0.9548
Test loss: 0.25167228723640467
Test accuracy: 0.9548
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.1759 - acc: 0.3555 - val_loss: 1.4889 - val_acc: 0.4768
Epoch 2/20
 - 1s - loss: 1.1357 - acc: 0.6251 - val_loss: 1.3966 - val_acc: 0.5340
Epoch 3/20
 - 1s - loss: 0.8651 - acc: 0.7189 - val_loss: 0.8534 - val_acc: 0.7118
Epoch 4/20
 - 1s - loss: 0.7338 - acc: 0.7597 - val_loss: 0.4606 - val_acc: 0.8573
Epoch 5/20
 - 1s - loss: 0.6533 - acc: 0.7832 - val_loss: 0.8333 - val_acc: 0.6995
Epoch 6/20
 - 1s - loss: 0.5802 - acc: 0.8111 - val_loss: 0.5673 - val_acc: 0.8119
Epoch 7/20
 - 1s - loss: 0.5309 - acc: 0.8335 - val_loss: 0.4511 - val_acc: 0.8489
Epoch 8/20
 - 1s - loss: 0.4878 - acc: 0.8447 - val_loss: 0.4161 - val_acc: 0.8690
Epoch 9/20
 - 1s - loss: 0.4508 - acc: 0.8523 - val_loss: 0.4341 - val_acc: 0.8486
Epoch 10/20
 - 1s - loss: 0.4212 - acc: 0.8655 - val_loss: 0.5774 - val_acc: 0.8120
Epoch 11/20
 - 1s - loss: 0.4076 - acc: 0.8711 - val_loss: 0.5787 - val_acc: 0.8094
Epoch 12/20
 - 1s - loss: 0.3686 - acc: 0.8837 - val_loss: 0.2889 - val_acc: 0.9121
Epoch 13/20
 - 1s - loss: 0.3501 - acc: 0.8888 - val_loss: 0.4232 - val_acc: 0.8736
Epoch 14/20
 - 1s - loss: 0.3379 - acc: 0.8952 - val_loss: 0.3081 - val_acc: 0.9046
Epoch 15/20
 - 1s - loss: 0.3189 - acc: 0.8989 - val_loss: 0.3014 - val_acc: 0.9015
Epoch 16/20
 - 1s - loss: 0.3084 - acc: 0.9011 - val_loss: 0.2573 - val_acc: 0.9231
Epoch 17/20
 - 1s - loss: 0.2807 - acc: 0.9081 - val_loss: 0.5038 - val_acc: 0.8480
Epoch 18/20
 - 1s - loss: 0.2880 - acc: 0.9112 - val_loss: 0.4074 - val_acc: 0.8670
Epoch 19/20
 - 1s - loss: 0.2750 - acc: 0.9105 - val_loss: 0.2658 - val_acc: 0.9142
Epoch 20/20
 - 1s - loss: 0.2623 - acc: 0.9183 - val_loss: 0.2164 - val_acc: 0.9343
Test loss: 0.21636114182285965
Test accuracy: 0.9345
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8143 - acc: 0.7408 - val_loss: 0.4614 - val_acc: 0.8526
Epoch 2/20
 - 0s - loss: 0.3294 - acc: 0.9037 - val_loss: 0.4989 - val_acc: 0.8370
Epoch 3/20
 - 0s - loss: 0.2328 - acc: 0.9275 - val_loss: 0.3202 - val_acc: 0.9012
Epoch 4/20
 - 0s - loss: 0.1549 - acc: 0.9531 - val_loss: 0.2728 - val_acc: 0.9172
Epoch 5/20
 - 0s - loss: 0.1230 - acc: 0.9611 - val_loss: 0.4141 - val_acc: 0.8792
Epoch 6/20
 - 0s - loss: 0.0820 - acc: 0.9757 - val_loss: 0.3280 - val_acc: 0.9030
Epoch 7/20
 - 0s - loss: 0.0693 - acc: 0.9784 - val_loss: 0.2413 - val_acc: 0.9327
Epoch 8/20
 - 0s - loss: 0.0489 - acc: 0.9824 - val_loss: 0.2654 - val_acc: 0.9289
Epoch 9/20
 - 0s - loss: 0.0356 - acc: 0.9896 - val_loss: 0.2699 - val_acc: 0.9242
Epoch 10/20
 - 0s - loss: 0.0306 - acc: 0.9907 - val_loss: 0.3775 - val_acc: 0.9083
Epoch 11/20
 - 0s - loss: 0.0361 - acc: 0.9891 - val_loss: 0.2168 - val_acc: 0.9461
Epoch 12/20
 - 0s - loss: 0.0145 - acc: 0.9968 - val_loss: 0.2955 - val_acc: 0.9310
Epoch 13/20
 - 0s - loss: 0.0147 - acc: 0.9955 - val_loss: 0.3853 - val_acc: 0.9171
Epoch 14/20
 - 0s - loss: 0.0098 - acc: 0.9979 - val_loss: 0.2703 - val_acc: 0.9405
Epoch 15/20
 - 0s - loss: 0.0147 - acc: 0.9952 - val_loss: 0.3057 - val_acc: 0.9317
Epoch 16/20
 - 0s - loss: 0.0103 - acc: 0.9968 - val_loss: 0.2690 - val_acc: 0.9445
Epoch 17/20
 - 0s - loss: 0.0058 - acc: 0.9984 - val_loss: 0.2709 - val_acc: 0.9445
Epoch 18/20
 - 0s - loss: 0.0041 - acc: 0.9987 - val_loss: 0.3396 - val_acc: 0.9368
Epoch 19/20
 - 0s - loss: 0.0059 - acc: 0.9989 - val_loss: 0.4491 - val_acc: 0.9201
Epoch 20/20
 - 0s - loss: 0.0098 - acc: 0.9963 - val_loss: 0.3160 - val_acc: 0.9442
Test loss: 0.31596784185578874
Test accuracy: 0.9442
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.5415 - acc: 0.2237 - val_loss: 1.7940 - val_acc: 0.4799
Epoch 2/20
 - 1s - loss: 1.5842 - acc: 0.4571 - val_loss: 1.6862 - val_acc: 0.4367
Epoch 3/20
 - 1s - loss: 1.2451 - acc: 0.5944 - val_loss: 1.1042 - val_acc: 0.6333
Epoch 4/20
 - 1s - loss: 1.0269 - acc: 0.6597 - val_loss: 1.2430 - val_acc: 0.6103
Epoch 5/20
 - 1s - loss: 0.9144 - acc: 0.7040 - val_loss: 0.6825 - val_acc: 0.7585
Epoch 6/20
 - 1s - loss: 0.7988 - acc: 0.7328 - val_loss: 0.8621 - val_acc: 0.7154
Epoch 7/20
 - 1s - loss: 0.7770 - acc: 0.7483 - val_loss: 0.8948 - val_acc: 0.7254
Epoch 8/20
 - 1s - loss: 0.7025 - acc: 0.7731 - val_loss: 0.7531 - val_acc: 0.7622
Epoch 9/20
 - 1s - loss: 0.7060 - acc: 0.7720 - val_loss: 0.9503 - val_acc: 0.6559
Epoch 10/20
 - 1s - loss: 0.5750 - acc: 0.8021 - val_loss: 0.6802 - val_acc: 0.7642
Epoch 11/20
 - 1s - loss: 0.6111 - acc: 0.8064 - val_loss: 0.6497 - val_acc: 0.7845
Epoch 12/20
 - 1s - loss: 0.5379 - acc: 0.8227 - val_loss: 0.5001 - val_acc: 0.8308
Epoch 13/20
 - 1s - loss: 0.5244 - acc: 0.8339 - val_loss: 0.4563 - val_acc: 0.8579
Epoch 14/20
 - 1s - loss: 0.5289 - acc: 0.8392 - val_loss: 0.4690 - val_acc: 0.8447
Epoch 15/20
 - 1s - loss: 0.5152 - acc: 0.8307 - val_loss: 0.5201 - val_acc: 0.8367
Epoch 16/20
 - 1s - loss: 0.4827 - acc: 0.8424 - val_loss: 0.4661 - val_acc: 0.8477
Epoch 17/20
 - 1s - loss: 0.4463 - acc: 0.8597 - val_loss: 0.4302 - val_acc: 0.8647
Epoch 18/20
 - 1s - loss: 0.4641 - acc: 0.8507 - val_loss: 0.4199 - val_acc: 0.8674
Epoch 19/20
 - 1s - loss: 0.4009 - acc: 0.8752 - val_loss: 0.5020 - val_acc: 0.8242
Epoch 20/20
 - 1s - loss: 0.3884 - acc: 0.8717 - val_loss: 0.6236 - val_acc: 0.8070
Test loss: 0.6244356358468532
Test accuracy: 0.8083
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1634 - acc: 0.6277 - val_loss: 0.5136 - val_acc: 0.8471
Epoch 2/20
 - 0s - loss: 0.4810 - acc: 0.8603 - val_loss: 0.4390 - val_acc: 0.8647
Epoch 3/20
 - 0s - loss: 0.3180 - acc: 0.9051 - val_loss: 0.3786 - val_acc: 0.8818
Epoch 4/20
 - 0s - loss: 0.2489 - acc: 0.9291 - val_loss: 0.3333 - val_acc: 0.8966
Epoch 5/20
 - 0s - loss: 0.1867 - acc: 0.9483 - val_loss: 0.3806 - val_acc: 0.8865
Epoch 6/20
 - 0s - loss: 0.1477 - acc: 0.9584 - val_loss: 0.3654 - val_acc: 0.8883
Epoch 7/20
 - 0s - loss: 0.1030 - acc: 0.9691 - val_loss: 0.2645 - val_acc: 0.9245
Epoch 8/20
 - 0s - loss: 0.0804 - acc: 0.9771 - val_loss: 0.3458 - val_acc: 0.9014
Epoch 9/20
 - 0s - loss: 0.0873 - acc: 0.9744 - val_loss: 0.3065 - val_acc: 0.9133
Epoch 10/20
 - 0s - loss: 0.0317 - acc: 0.9952 - val_loss: 0.3180 - val_acc: 0.9135
Epoch 11/20
 - 0s - loss: 0.0478 - acc: 0.9867 - val_loss: 0.3472 - val_acc: 0.9028
Epoch 12/20
 - 0s - loss: 0.0252 - acc: 0.9957 - val_loss: 0.3820 - val_acc: 0.9069
Epoch 13/20
 - 0s - loss: 0.0208 - acc: 0.9963 - val_loss: 0.3051 - val_acc: 0.9222
Epoch 14/20
 - 0s - loss: 0.0218 - acc: 0.9936 - val_loss: 0.3097 - val_acc: 0.9240
Epoch 15/20
 - 0s - loss: 0.0075 - acc: 0.9989 - val_loss: 0.3645 - val_acc: 0.9138
Epoch 16/20
 - 0s - loss: 0.0252 - acc: 0.9957 - val_loss: 0.3441 - val_acc: 0.9199
Epoch 17/20
 - 0s - loss: 0.0054 - acc: 0.9995 - val_loss: 0.3622 - val_acc: 0.9199
Epoch 18/20
 - 0s - loss: 0.0384 - acc: 0.9909 - val_loss: 0.3271 - val_acc: 0.9237
Epoch 19/20
 - 0s - loss: 0.0041 - acc: 0.9995 - val_loss: 0.3340 - val_acc: 0.9228
Epoch 20/20
 - 0s - loss: 0.0042 - acc: 0.9989 - val_loss: 0.3716 - val_acc: 0.9174
Test loss: 0.37161348495967106
Test accuracy: 0.9174
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.4221 - acc: 0.1680 - val_loss: 2.0124 - val_acc: 0.2117
Epoch 2/20
 - 1s - loss: 1.9704 - acc: 0.3195 - val_loss: 1.8816 - val_acc: 0.3582
Epoch 3/20
 - 1s - loss: 1.6967 - acc: 0.4411 - val_loss: 2.2270 - val_acc: 0.2751
Epoch 4/20
 - 1s - loss: 1.5409 - acc: 0.5067 - val_loss: 1.9670 - val_acc: 0.3022
Epoch 5/20
 - 1s - loss: 1.3086 - acc: 0.5867 - val_loss: 1.2869 - val_acc: 0.5577
Epoch 6/20
 - 1s - loss: 1.1649 - acc: 0.6219 - val_loss: 0.8634 - val_acc: 0.7129
Epoch 7/20
 - 1s - loss: 1.0945 - acc: 0.6416 - val_loss: 1.0283 - val_acc: 0.6841
Epoch 8/20
 - 1s - loss: 1.0085 - acc: 0.6619 - val_loss: 0.7908 - val_acc: 0.7425
Epoch 9/20
 - 1s - loss: 1.0034 - acc: 0.6533 - val_loss: 0.6915 - val_acc: 0.7696
Epoch 10/20
 - 1s - loss: 0.8741 - acc: 0.7083 - val_loss: 0.7547 - val_acc: 0.7467
Epoch 11/20
 - 1s - loss: 0.8385 - acc: 0.7109 - val_loss: 0.8979 - val_acc: 0.7267
Epoch 12/20
 - 1s - loss: 0.7732 - acc: 0.7467 - val_loss: 0.6688 - val_acc: 0.7739
Epoch 13/20
 - 1s - loss: 0.7753 - acc: 0.7456 - val_loss: 0.8228 - val_acc: 0.7133
Epoch 14/20
 - 1s - loss: 0.7836 - acc: 0.7520 - val_loss: 0.9875 - val_acc: 0.6562
Epoch 15/20
 - 1s - loss: 0.6231 - acc: 0.8053 - val_loss: 0.6893 - val_acc: 0.7475
Epoch 16/20
 - 1s - loss: 0.7077 - acc: 0.7744 - val_loss: 0.7255 - val_acc: 0.7649
Epoch 17/20
 - 1s - loss: 0.6590 - acc: 0.7931 - val_loss: 0.5921 - val_acc: 0.8137
Epoch 18/20
 - 1s - loss: 0.6318 - acc: 0.8016 - val_loss: 0.5572 - val_acc: 0.8173
Epoch 19/20
 - 1s - loss: 0.6065 - acc: 0.8021 - val_loss: 0.7431 - val_acc: 0.7372
Epoch 20/20
 - 1s - loss: 0.5885 - acc: 0.8064 - val_loss: 0.7505 - val_acc: 0.7216
Test loss: 0.750836546754837
Test accuracy: 0.7215
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.4599 - acc: 0.5251 - val_loss: 0.8555 - val_acc: 0.7321
Epoch 2/20
 - 0s - loss: 0.5792 - acc: 0.8207 - val_loss: 0.5557 - val_acc: 0.8374
Epoch 3/20
 - 0s - loss: 0.4114 - acc: 0.8751 - val_loss: 0.4902 - val_acc: 0.8466
Epoch 4/20
 - 0s - loss: 0.2797 - acc: 0.9242 - val_loss: 0.4747 - val_acc: 0.8465
Epoch 5/20
 - 0s - loss: 0.2224 - acc: 0.9413 - val_loss: 0.4607 - val_acc: 0.8478
Epoch 6/20
 - 0s - loss: 0.2128 - acc: 0.9317 - val_loss: 0.4618 - val_acc: 0.8585
Epoch 7/20
 - 0s - loss: 0.1220 - acc: 0.9669 - val_loss: 0.3730 - val_acc: 0.8844
Epoch 8/20
 - 0s - loss: 0.1469 - acc: 0.9637 - val_loss: 0.4184 - val_acc: 0.8747
Epoch 9/20
 - 0s - loss: 0.0688 - acc: 0.9851 - val_loss: 0.4533 - val_acc: 0.8675
Epoch 10/20
 - 0s - loss: 0.0624 - acc: 0.9861 - val_loss: 0.4113 - val_acc: 0.8799
Epoch 11/20
 - 0s - loss: 0.0324 - acc: 0.9979 - val_loss: 0.7405 - val_acc: 0.8049
Epoch 12/20
 - 0s - loss: 0.0766 - acc: 0.9797 - val_loss: 0.4027 - val_acc: 0.8854
Epoch 13/20
 - 0s - loss: 0.0215 - acc: 0.9979 - val_loss: 0.4107 - val_acc: 0.8849
Epoch 14/20
 - 0s - loss: 0.0137 - acc: 1.0000 - val_loss: 0.4200 - val_acc: 0.8879
Epoch 15/20
 - 0s - loss: 0.0123 - acc: 1.0000 - val_loss: 0.4386 - val_acc: 0.8881
Epoch 16/20
 - 0s - loss: 0.0488 - acc: 0.9851 - val_loss: 0.7266 - val_acc: 0.8278
Epoch 17/20
 - 0s - loss: 0.0308 - acc: 0.9925 - val_loss: 0.4066 - val_acc: 0.8948
Epoch 18/20
 - 0s - loss: 0.0053 - acc: 1.0000 - val_loss: 0.4269 - val_acc: 0.8947
Epoch 19/20
 - 0s - loss: 0.0066 - acc: 0.9989 - val_loss: 0.4148 - val_acc: 0.8976
Epoch 20/20
 - 0s - loss: 0.0029 - acc: 1.0000 - val_loss: 0.4778 - val_acc: 0.8892
Test loss: 0.47781569881904873
Test accuracy: 0.8892
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.0979 - acc: 0.1110 - val_loss: 2.1959 - val_acc: 0.2211
Epoch 2/20
 - 1s - loss: 2.1617 - acc: 0.2166 - val_loss: 2.2019 - val_acc: 0.1880
Epoch 3/20
 - 1s - loss: 1.9935 - acc: 0.3191 - val_loss: 2.0294 - val_acc: 0.1889
Epoch 4/20
 - 0s - loss: 1.9836 - acc: 0.3661 - val_loss: 1.8795 - val_acc: 0.3549
Epoch 5/20
 - 1s - loss: 1.7569 - acc: 0.3949 - val_loss: 1.6672 - val_acc: 0.4046
Epoch 6/20
 - 0s - loss: 1.5852 - acc: 0.5037 - val_loss: 1.6185 - val_acc: 0.4605
Epoch 7/20
 - 1s - loss: 1.5015 - acc: 0.5165 - val_loss: 1.2146 - val_acc: 0.6029
Epoch 8/20
 - 1s - loss: 1.2405 - acc: 0.6201 - val_loss: 1.5174 - val_acc: 0.4244
Epoch 9/20
 - 1s - loss: 1.1544 - acc: 0.6233 - val_loss: 1.4118 - val_acc: 0.5289
Epoch 10/20
 - 1s - loss: 1.1438 - acc: 0.6318 - val_loss: 1.9123 - val_acc: 0.3386
Epoch 11/20
 - 0s - loss: 1.2012 - acc: 0.6105 - val_loss: 1.2713 - val_acc: 0.5457
Epoch 12/20
 - 1s - loss: 0.9877 - acc: 0.6852 - val_loss: 1.7248 - val_acc: 0.4787
Epoch 13/20
 - 1s - loss: 1.0013 - acc: 0.6553 - val_loss: 1.2461 - val_acc: 0.5659
Epoch 14/20
 - 1s - loss: 1.0589 - acc: 0.6531 - val_loss: 0.8212 - val_acc: 0.7306
Epoch 15/20
 - 1s - loss: 0.8153 - acc: 0.7225 - val_loss: 1.1547 - val_acc: 0.5945
Epoch 16/20
 - 0s - loss: 0.9832 - acc: 0.6574 - val_loss: 1.1464 - val_acc: 0.6272
Epoch 17/20
 - 0s - loss: 0.9310 - acc: 0.6990 - val_loss: 0.9518 - val_acc: 0.6797
Epoch 18/20
 - 1s - loss: 0.9758 - acc: 0.6638 - val_loss: 0.9934 - val_acc: 0.6623
Epoch 19/20
 - 1s - loss: 0.7649 - acc: 0.7535 - val_loss: 0.6335 - val_acc: 0.7798
Epoch 20/20
 - 1s - loss: 0.8316 - acc: 0.7343 - val_loss: 0.6950 - val_acc: 0.7530
Test loss: 0.6957274532794953
Test accuracy: 0.7532
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.7782 - acc: 0.4380 - val_loss: 1.5726 - val_acc: 0.4651
Epoch 2/20
 - 0s - loss: 0.9966 - acc: 0.6923 - val_loss: 0.8047 - val_acc: 0.7574
Epoch 3/20
 - 0s - loss: 0.4616 - acc: 0.8718 - val_loss: 0.6492 - val_acc: 0.8058
Epoch 4/20
 - 0s - loss: 0.3154 - acc: 0.9167 - val_loss: 0.7278 - val_acc: 0.7726
Epoch 5/20
 - 0s - loss: 0.2840 - acc: 0.9209 - val_loss: 0.5542 - val_acc: 0.8229
Epoch 6/20
 - 0s - loss: 0.1987 - acc: 0.9509 - val_loss: 0.6948 - val_acc: 0.7842
Epoch 7/20
 - 0s - loss: 0.1837 - acc: 0.9466 - val_loss: 0.6264 - val_acc: 0.7974
Epoch 8/20
 - 0s - loss: 0.1062 - acc: 0.9808 - val_loss: 0.5341 - val_acc: 0.8308
Epoch 9/20
 - 0s - loss: 0.0615 - acc: 0.9915 - val_loss: 0.5534 - val_acc: 0.8388
Epoch 10/20
 - 0s - loss: 0.0490 - acc: 0.9979 - val_loss: 0.5603 - val_acc: 0.8372
Epoch 11/20
 - 0s - loss: 0.0360 - acc: 1.0000 - val_loss: 0.5818 - val_acc: 0.8415
Epoch 12/20
 - 0s - loss: 0.0382 - acc: 0.9979 - val_loss: 0.6431 - val_acc: 0.8220
Epoch 13/20
 - 0s - loss: 0.0240 - acc: 1.0000 - val_loss: 0.5714 - val_acc: 0.8397
Epoch 14/20
 - 0s - loss: 0.0159 - acc: 1.0000 - val_loss: 0.6063 - val_acc: 0.8415
Epoch 15/20
 - 0s - loss: 0.0800 - acc: 0.9786 - val_loss: 1.1116 - val_acc: 0.7737
Epoch 16/20
 - 0s - loss: 0.0946 - acc: 0.9701 - val_loss: 0.6100 - val_acc: 0.8348
Epoch 17/20
 - 0s - loss: 0.0143 - acc: 0.9979 - val_loss: 0.5807 - val_acc: 0.8464
Epoch 18/20
 - 0s - loss: 0.0089 - acc: 1.0000 - val_loss: 0.5893 - val_acc: 0.8457
Epoch 19/20
 - 0s - loss: 0.0059 - acc: 1.0000 - val_loss: 0.6165 - val_acc: 0.8394
Epoch 20/20
 - 0s - loss: 0.0055 - acc: 1.0000 - val_loss: 0.6051 - val_acc: 0.8503
Test loss: 0.6051116752974689
Test accuracy: 0.8503
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.2685 - acc: 0.1090 - val_loss: 4.5961 - val_acc: 0.1645
Epoch 2/20
 - 0s - loss: 3.3299 - acc: 0.1474 - val_loss: 2.1677 - val_acc: 0.1244
Epoch 3/20
 - 0s - loss: 2.1010 - acc: 0.2436 - val_loss: 2.0280 - val_acc: 0.2835
Epoch 4/20
 - 0s - loss: 2.0159 - acc: 0.2735 - val_loss: 2.3293 - val_acc: 0.2466
Epoch 5/20
 - 0s - loss: 2.0342 - acc: 0.3141 - val_loss: 1.9184 - val_acc: 0.2034
Epoch 6/20
 - 0s - loss: 1.8800 - acc: 0.3568 - val_loss: 1.8359 - val_acc: 0.3348
Epoch 7/20
 - 0s - loss: 1.7876 - acc: 0.3974 - val_loss: 2.0192 - val_acc: 0.2420
Epoch 8/20
 - 0s - loss: 1.9004 - acc: 0.3526 - val_loss: 1.6570 - val_acc: 0.4443
Epoch 9/20
 - 0s - loss: 1.5193 - acc: 0.4850 - val_loss: 1.7885 - val_acc: 0.4656
Epoch 10/20
 - 0s - loss: 1.6199 - acc: 0.4744 - val_loss: 1.6265 - val_acc: 0.4691
Epoch 11/20
 - 0s - loss: 1.4237 - acc: 0.5427 - val_loss: 1.7649 - val_acc: 0.3947
Epoch 12/20
 - 0s - loss: 1.6750 - acc: 0.3953 - val_loss: 1.5540 - val_acc: 0.4201
Epoch 13/20
 - 0s - loss: 1.2465 - acc: 0.6004 - val_loss: 1.2627 - val_acc: 0.6120
Epoch 14/20
 - 0s - loss: 1.0708 - acc: 0.6987 - val_loss: 1.6001 - val_acc: 0.5209
Epoch 15/20
 - 0s - loss: 1.4082 - acc: 0.5470 - val_loss: 1.9383 - val_acc: 0.2930
Epoch 16/20
 - 0s - loss: 1.4934 - acc: 0.4744 - val_loss: 1.1633 - val_acc: 0.6574
Epoch 17/20
 - 0s - loss: 0.8986 - acc: 0.7479 - val_loss: 1.1034 - val_acc: 0.6243
Epoch 18/20
 - 0s - loss: 1.2453 - acc: 0.5833 - val_loss: 1.1938 - val_acc: 0.5824
Epoch 19/20
 - 0s - loss: 0.8387 - acc: 0.7436 - val_loss: 0.9256 - val_acc: 0.6820
Epoch 20/20
 - 0s - loss: 0.9718 - acc: 0.6688 - val_loss: 1.4803 - val_acc: 0.5765
Test loss: 1.4792152889251708
Test accuracy: 0.577
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.0765 - acc: 0.2821 - val_loss: 1.6908 - val_acc: 0.4567
Epoch 2/20
 - 0s - loss: 1.1413 - acc: 0.6923 - val_loss: 1.3970 - val_acc: 0.5912
Epoch 3/20
 - 0s - loss: 0.7558 - acc: 0.8205 - val_loss: 1.1446 - val_acc: 0.6437
Epoch 4/20
 - 0s - loss: 0.5593 - acc: 0.8675 - val_loss: 1.1860 - val_acc: 0.6085
Epoch 5/20
 - 0s - loss: 0.5496 - acc: 0.8248 - val_loss: 1.0366 - val_acc: 0.6671
Epoch 6/20
 - 0s - loss: 0.3602 - acc: 0.9103 - val_loss: 0.7819 - val_acc: 0.7530
Epoch 7/20
 - 0s - loss: 0.1775 - acc: 0.9701 - val_loss: 0.7977 - val_acc: 0.7562
Epoch 8/20
 - 0s - loss: 0.1424 - acc: 0.9872 - val_loss: 0.8065 - val_acc: 0.7566
Epoch 9/20
 - 0s - loss: 0.1235 - acc: 0.9872 - val_loss: 0.8263 - val_acc: 0.7583
Epoch 10/20
 - 0s - loss: 0.0856 - acc: 0.9915 - val_loss: 0.7856 - val_acc: 0.7616
Epoch 11/20
 - 0s - loss: 0.0844 - acc: 0.9915 - val_loss: 0.8190 - val_acc: 0.7710
Epoch 12/20
 - 0s - loss: 0.0680 - acc: 0.9872 - val_loss: 0.8743 - val_acc: 0.7573
Epoch 13/20
 - 0s - loss: 0.0500 - acc: 1.0000 - val_loss: 0.7872 - val_acc: 0.7747
Epoch 14/20
 - 0s - loss: 0.0346 - acc: 1.0000 - val_loss: 0.7996 - val_acc: 0.7769
Epoch 15/20
 - 0s - loss: 0.0276 - acc: 1.0000 - val_loss: 0.8168 - val_acc: 0.7785
Epoch 16/20
 - 0s - loss: 0.0252 - acc: 1.0000 - val_loss: 0.9030 - val_acc: 0.7679
Epoch 17/20
 - 0s - loss: 0.0303 - acc: 1.0000 - val_loss: 0.9655 - val_acc: 0.7571
Epoch 18/20
 - 0s - loss: 0.0178 - acc: 1.0000 - val_loss: 0.8456 - val_acc: 0.7795
Epoch 19/20
 - 0s - loss: 0.0158 - acc: 1.0000 - val_loss: 0.8704 - val_acc: 0.7785
Epoch 20/20
 - 0s - loss: 0.0123 - acc: 1.0000 - val_loss: 0.8637 - val_acc: 0.7817
Test loss: 0.863708300498128
Test accuracy: 0.7817
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.8853 - acc: 0.0983 - val_loss: 4.2826 - val_acc: 0.1631
Epoch 2/20
 - 0s - loss: 4.6132 - acc: 0.1197 - val_loss: 3.1960 - val_acc: 0.1009
Epoch 3/20
 - 0s - loss: 3.0612 - acc: 0.1154 - val_loss: 2.2932 - val_acc: 0.2775
Epoch 4/20
 - 0s - loss: 2.2613 - acc: 0.2009 - val_loss: 2.2079 - val_acc: 0.2051
Epoch 5/20
 - 0s - loss: 2.2514 - acc: 0.1667 - val_loss: 2.1279 - val_acc: 0.2657
Epoch 6/20
 - 0s - loss: 2.1103 - acc: 0.2949 - val_loss: 2.0561 - val_acc: 0.2735
Epoch 7/20
 - 0s - loss: 2.1319 - acc: 0.2692 - val_loss: 2.2692 - val_acc: 0.1257
Epoch 8/20
 - 0s - loss: 2.1282 - acc: 0.2521 - val_loss: 1.9695 - val_acc: 0.3357
Epoch 9/20
 - 0s - loss: 1.7780 - acc: 0.4658 - val_loss: 1.9461 - val_acc: 0.2450
Epoch 10/20
 - 0s - loss: 1.8817 - acc: 0.3718 - val_loss: 1.8150 - val_acc: 0.4218
Epoch 11/20
 - 0s - loss: 2.0157 - acc: 0.3248 - val_loss: 2.1794 - val_acc: 0.2978
Epoch 12/20
 - 0s - loss: 1.9626 - acc: 0.3291 - val_loss: 1.9037 - val_acc: 0.4014
Epoch 13/20
 - 0s - loss: 1.7357 - acc: 0.4744 - val_loss: 1.7867 - val_acc: 0.3243
Epoch 14/20
 - 0s - loss: 1.4936 - acc: 0.5513 - val_loss: 1.5882 - val_acc: 0.5123
Epoch 15/20
 - 0s - loss: 1.6603 - acc: 0.4872 - val_loss: 2.2093 - val_acc: 0.3295
Epoch 16/20
 - 0s - loss: 1.8314 - acc: 0.3932 - val_loss: 1.8004 - val_acc: 0.4136
Epoch 17/20
 - 0s - loss: 1.4178 - acc: 0.5684 - val_loss: 1.9436 - val_acc: 0.2201
Epoch 18/20
 - 0s - loss: 1.6490 - acc: 0.4103 - val_loss: 1.9182 - val_acc: 0.3450
Epoch 19/20
 - 0s - loss: 1.7162 - acc: 0.4701 - val_loss: 1.7294 - val_acc: 0.4494
Epoch 20/20
 - 0s - loss: 1.3878 - acc: 0.5513 - val_loss: 1.5691 - val_acc: 0.4956
Test loss: 1.5694091945648194
Test accuracy: 0.4947
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3683 - acc: 0.0427 - val_loss: 2.0678 - val_acc: 0.2976
Epoch 2/20
 - 0s - loss: 1.5825 - acc: 0.4872 - val_loss: 1.5625 - val_acc: 0.5512
Epoch 3/20
 - 0s - loss: 1.1042 - acc: 0.8120 - val_loss: 1.5516 - val_acc: 0.4568
Epoch 4/20
 - 0s - loss: 0.7764 - acc: 0.7692 - val_loss: 1.2565 - val_acc: 0.6041
Epoch 5/20
 - 0s - loss: 0.6051 - acc: 0.8974 - val_loss: 1.3061 - val_acc: 0.5631
Epoch 6/20
 - 0s - loss: 0.4081 - acc: 0.8889 - val_loss: 1.2634 - val_acc: 0.6288
Epoch 7/20
 - 0s - loss: 0.4470 - acc: 0.8718 - val_loss: 1.1797 - val_acc: 0.6162
Epoch 8/20
 - 0s - loss: 0.2277 - acc: 0.9658 - val_loss: 1.0057 - val_acc: 0.6910
Epoch 9/20
 - 0s - loss: 0.1624 - acc: 0.9658 - val_loss: 1.1368 - val_acc: 0.6259
Epoch 10/20
 - 0s - loss: 0.1479 - acc: 0.9829 - val_loss: 1.0301 - val_acc: 0.6909
Epoch 11/20
 - 0s - loss: 0.1261 - acc: 0.9744 - val_loss: 1.0515 - val_acc: 0.6574
Epoch 12/20
 - 0s - loss: 0.0765 - acc: 1.0000 - val_loss: 0.9547 - val_acc: 0.7193
Epoch 13/20
 - 0s - loss: 0.0482 - acc: 1.0000 - val_loss: 0.9632 - val_acc: 0.7104
Epoch 14/20
 - 0s - loss: 0.0382 - acc: 1.0000 - val_loss: 0.9476 - val_acc: 0.7169
Epoch 15/20
 - 0s - loss: 0.0349 - acc: 1.0000 - val_loss: 0.9756 - val_acc: 0.7146
Epoch 16/20
 - 0s - loss: 0.0276 - acc: 1.0000 - val_loss: 0.9511 - val_acc: 0.7225
Epoch 17/20
 - 0s - loss: 0.0244 - acc: 1.0000 - val_loss: 0.9737 - val_acc: 0.7185
Epoch 18/20
 - 0s - loss: 0.0222 - acc: 1.0000 - val_loss: 0.9958 - val_acc: 0.7127
Epoch 19/20
 - 0s - loss: 0.0200 - acc: 1.0000 - val_loss: 0.9755 - val_acc: 0.7178
Epoch 20/20
 - 0s - loss: 0.0153 - acc: 1.0000 - val_loss: 1.0011 - val_acc: 0.7161
Test loss: 1.0010599439859391
Test accuracy: 0.7161
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6225 - acc: 0.0598 - val_loss: 6.8314 - val_acc: 0.1944
Epoch 2/20
 - 0s - loss: 5.7663 - acc: 0.1453 - val_loss: 6.2904 - val_acc: 0.1318
Epoch 3/20
 - 0s - loss: 6.8260 - acc: 0.1197 - val_loss: 3.9678 - val_acc: 0.1041
Epoch 4/20
 - 0s - loss: 4.0911 - acc: 0.1111 - val_loss: 2.5618 - val_acc: 0.1388
Epoch 5/20
 - 0s - loss: 2.5385 - acc: 0.1880 - val_loss: 2.1993 - val_acc: 0.2697
Epoch 6/20
 - 0s - loss: 2.1627 - acc: 0.2137 - val_loss: 2.1355 - val_acc: 0.2455
Epoch 7/20
 - 0s - loss: 2.0392 - acc: 0.3333 - val_loss: 2.0972 - val_acc: 0.4089
Epoch 8/20
 - 0s - loss: 1.9437 - acc: 0.3932 - val_loss: 2.1182 - val_acc: 0.1957
Epoch 9/20
 - 0s - loss: 1.8270 - acc: 0.3675 - val_loss: 2.3058 - val_acc: 0.2336
Epoch 10/20
 - 0s - loss: 2.2214 - acc: 0.2650 - val_loss: 2.4828 - val_acc: 0.1151
Epoch 11/20
 - 0s - loss: 2.2798 - acc: 0.1795 - val_loss: 2.0936 - val_acc: 0.3669
Epoch 12/20
 - 0s - loss: 1.9833 - acc: 0.4017 - val_loss: 1.9894 - val_acc: 0.4585
Epoch 13/20
 - 0s - loss: 1.7678 - acc: 0.4872 - val_loss: 1.9486 - val_acc: 0.3531
Epoch 14/20
 - 0s - loss: 1.6617 - acc: 0.5470 - val_loss: 2.1792 - val_acc: 0.2410
Epoch 15/20
 - 0s - loss: 1.8980 - acc: 0.2991 - val_loss: 2.3861 - val_acc: 0.2590
Epoch 16/20
 - 0s - loss: 2.1086 - acc: 0.3248 - val_loss: 1.9677 - val_acc: 0.3735
Epoch 17/20
 - 0s - loss: 1.7731 - acc: 0.4359 - val_loss: 2.0138 - val_acc: 0.2952
Epoch 18/20
 - 0s - loss: 1.6863 - acc: 0.4359 - val_loss: 1.9315 - val_acc: 0.3273
Epoch 19/20
 - 0s - loss: 1.6792 - acc: 0.3675 - val_loss: 2.0055 - val_acc: 0.2340
Epoch 20/20
 - 0s - loss: 1.6516 - acc: 0.4017 - val_loss: 1.8497 - val_acc: 0.4002
Test loss: 1.8496241088867187
Test accuracy: 0.3991
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2465 - acc: 0.9235 - val_loss: 0.1015 - val_acc: 0.9667
Epoch 2/20
 - 2s - loss: 0.1027 - acc: 0.9692 - val_loss: 0.0846 - val_acc: 0.9751
Epoch 3/20
 - 3s - loss: 0.0756 - acc: 0.9767 - val_loss: 0.1098 - val_acc: 0.9683
Epoch 4/20
 - 2s - loss: 0.0603 - acc: 0.9818 - val_loss: 0.0743 - val_acc: 0.9806
Epoch 5/20
 - 2s - loss: 0.0503 - acc: 0.9850 - val_loss: 0.0709 - val_acc: 0.9820
Epoch 6/20
 - 2s - loss: 0.0431 - acc: 0.9870 - val_loss: 0.0887 - val_acc: 0.9778
Epoch 7/20
 - 2s - loss: 0.0379 - acc: 0.9893 - val_loss: 0.0781 - val_acc: 0.9805
Epoch 8/20
 - 2s - loss: 0.0339 - acc: 0.9900 - val_loss: 0.0760 - val_acc: 0.9822
Epoch 9/20
 - 2s - loss: 0.0305 - acc: 0.9912 - val_loss: 0.0905 - val_acc: 0.9801
Epoch 10/20
 - 2s - loss: 0.0281 - acc: 0.9916 - val_loss: 0.0775 - val_acc: 0.9828
Epoch 11/20
 - 2s - loss: 0.0275 - acc: 0.9922 - val_loss: 0.0952 - val_acc: 0.9824
Epoch 12/20
 - 2s - loss: 0.0283 - acc: 0.9924 - val_loss: 0.0853 - val_acc: 0.9836
Epoch 13/20
 - 2s - loss: 0.0261 - acc: 0.9927 - val_loss: 0.0982 - val_acc: 0.9814
Epoch 14/20
 - 2s - loss: 0.0212 - acc: 0.9940 - val_loss: 0.0992 - val_acc: 0.9835
Epoch 15/20
 - 2s - loss: 0.0210 - acc: 0.9946 - val_loss: 0.0925 - val_acc: 0.9841
Epoch 16/20
 - 2s - loss: 0.0221 - acc: 0.9944 - val_loss: 0.1131 - val_acc: 0.9816
Epoch 17/20
 - 2s - loss: 0.0193 - acc: 0.9949 - val_loss: 0.1186 - val_acc: 0.9828
Epoch 18/20
 - 2s - loss: 0.0198 - acc: 0.9950 - val_loss: 0.0964 - val_acc: 0.9836
Epoch 19/20
 - 2s - loss: 0.0199 - acc: 0.9950 - val_loss: 0.1092 - val_acc: 0.9840
Epoch 20/20
 - 2s - loss: 0.0183 - acc: 0.9954 - val_loss: 0.1270 - val_acc: 0.9823
Test loss: 0.1270002276434212
Test accuracy: 0.9823
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9323 - acc: 0.6995 - val_loss: 0.4433 - val_acc: 0.8544
Epoch 2/20
 - 4s - loss: 0.4214 - acc: 0.8655 - val_loss: 0.2782 - val_acc: 0.9118
Epoch 3/20
 - 4s - loss: 0.3149 - acc: 0.9003 - val_loss: 0.1681 - val_acc: 0.9462
Epoch 4/20
 - 4s - loss: 0.2647 - acc: 0.9170 - val_loss: 0.1572 - val_acc: 0.9491
Epoch 5/20
 - 4s - loss: 0.2334 - acc: 0.9286 - val_loss: 0.1461 - val_acc: 0.9528
Epoch 6/20
 - 4s - loss: 0.2126 - acc: 0.9339 - val_loss: 0.2128 - val_acc: 0.9377
Epoch 7/20
 - 4s - loss: 0.2000 - acc: 0.9388 - val_loss: 0.1522 - val_acc: 0.9550
Epoch 8/20
 - 4s - loss: 0.1881 - acc: 0.9425 - val_loss: 0.1081 - val_acc: 0.9680
Epoch 9/20
 - 4s - loss: 0.1843 - acc: 0.9439 - val_loss: 0.1192 - val_acc: 0.9615
Epoch 10/20
 - 4s - loss: 0.1761 - acc: 0.9483 - val_loss: 0.1300 - val_acc: 0.9610
Epoch 11/20
 - 4s - loss: 0.1728 - acc: 0.9500 - val_loss: 0.1400 - val_acc: 0.9610
Epoch 12/20
 - 4s - loss: 0.1702 - acc: 0.9497 - val_loss: 0.1166 - val_acc: 0.9649
Epoch 13/20
 - 4s - loss: 0.1636 - acc: 0.9512 - val_loss: 0.1528 - val_acc: 0.9582
Epoch 14/20
 - 4s - loss: 0.1686 - acc: 0.9512 - val_loss: 0.1174 - val_acc: 0.9648
Epoch 15/20
 - 4s - loss: 0.1633 - acc: 0.9527 - val_loss: 0.1100 - val_acc: 0.9657
Epoch 16/20
 - 4s - loss: 0.1663 - acc: 0.9534 - val_loss: 0.1321 - val_acc: 0.9585
Epoch 17/20
 - 4s - loss: 0.1628 - acc: 0.9549 - val_loss: 0.1031 - val_acc: 0.9734
Epoch 18/20
 - 4s - loss: 0.1645 - acc: 0.9537 - val_loss: 0.1101 - val_acc: 0.9668
Epoch 19/20
 - 4s - loss: 0.1617 - acc: 0.9544 - val_loss: 0.1188 - val_acc: 0.9654
Epoch 20/20
 - 4s - loss: 0.1621 - acc: 0.9538 - val_loss: 0.1057 - val_acc: 0.9710
Test loss: 0.10385031389915093
Test accuracy: 0.9712
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3340 - acc: 0.8985 - val_loss: 0.2687 - val_acc: 0.9170
Epoch 2/20
 - 1s - loss: 0.1336 - acc: 0.9579 - val_loss: 0.1056 - val_acc: 0.9669
Epoch 3/20
 - 1s - loss: 0.0904 - acc: 0.9712 - val_loss: 0.0980 - val_acc: 0.9687
Epoch 4/20
 - 1s - loss: 0.0695 - acc: 0.9777 - val_loss: 0.0955 - val_acc: 0.9713
Epoch 5/20
 - 1s - loss: 0.0533 - acc: 0.9835 - val_loss: 0.0999 - val_acc: 0.9736
Epoch 6/20
 - 1s - loss: 0.0437 - acc: 0.9873 - val_loss: 0.0924 - val_acc: 0.9772
Epoch 7/20
 - 1s - loss: 0.0384 - acc: 0.9878 - val_loss: 0.1042 - val_acc: 0.9736
Epoch 8/20
 - 1s - loss: 0.0317 - acc: 0.9903 - val_loss: 0.0921 - val_acc: 0.9767
Epoch 9/20
 - 1s - loss: 0.0261 - acc: 0.9917 - val_loss: 0.1110 - val_acc: 0.9758
Epoch 10/20
 - 1s - loss: 0.0246 - acc: 0.9927 - val_loss: 0.1159 - val_acc: 0.9759
Epoch 11/20
 - 1s - loss: 0.0207 - acc: 0.9935 - val_loss: 0.1095 - val_acc: 0.9762
Epoch 12/20
 - 1s - loss: 0.0197 - acc: 0.9935 - val_loss: 0.1165 - val_acc: 0.9749
Epoch 13/20
 - 1s - loss: 0.0176 - acc: 0.9942 - val_loss: 0.1269 - val_acc: 0.9765
Epoch 14/20
 - 1s - loss: 0.0180 - acc: 0.9943 - val_loss: 0.1272 - val_acc: 0.9758
Epoch 15/20
 - 1s - loss: 0.0160 - acc: 0.9951 - val_loss: 0.1203 - val_acc: 0.9773
Epoch 16/20
 - 1s - loss: 0.0142 - acc: 0.9959 - val_loss: 0.1404 - val_acc: 0.9772
Epoch 17/20
 - 1s - loss: 0.0163 - acc: 0.9948 - val_loss: 0.1234 - val_acc: 0.9796
Epoch 18/20
 - 1s - loss: 0.0133 - acc: 0.9963 - val_loss: 0.1584 - val_acc: 0.9766
Epoch 19/20
 - 1s - loss: 0.0124 - acc: 0.9963 - val_loss: 0.1335 - val_acc: 0.9796
Epoch 20/20
 - 1s - loss: 0.0125 - acc: 0.9965 - val_loss: 0.1554 - val_acc: 0.9771
Test loss: 0.15544375714762676
Test accuracy: 0.9771
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2685 - acc: 0.6031 - val_loss: 0.6140 - val_acc: 0.7767
Epoch 2/20
 - 2s - loss: 0.6210 - acc: 0.8004 - val_loss: 0.5274 - val_acc: 0.8195
Epoch 3/20
 - 2s - loss: 0.4593 - acc: 0.8517 - val_loss: 0.3575 - val_acc: 0.8842
Epoch 4/20
 - 2s - loss: 0.3858 - acc: 0.8783 - val_loss: 0.2605 - val_acc: 0.9149
Epoch 5/20
 - 2s - loss: 0.3301 - acc: 0.8971 - val_loss: 0.3011 - val_acc: 0.8939
Epoch 6/20
 - 2s - loss: 0.2914 - acc: 0.9078 - val_loss: 0.2516 - val_acc: 0.9196
Epoch 7/20
 - 2s - loss: 0.2678 - acc: 0.9156 - val_loss: 0.2690 - val_acc: 0.9143
Epoch 8/20
 - 2s - loss: 0.2429 - acc: 0.9235 - val_loss: 0.2462 - val_acc: 0.9191
Epoch 9/20
 - 2s - loss: 0.2288 - acc: 0.9296 - val_loss: 0.2505 - val_acc: 0.9249
Epoch 10/20
 - 2s - loss: 0.2195 - acc: 0.9328 - val_loss: 0.2024 - val_acc: 0.9401
Epoch 11/20
 - 2s - loss: 0.2041 - acc: 0.9376 - val_loss: 0.1632 - val_acc: 0.9503
Epoch 12/20
 - 2s - loss: 0.1953 - acc: 0.9389 - val_loss: 0.1349 - val_acc: 0.9593
Epoch 13/20
 - 2s - loss: 0.1886 - acc: 0.9407 - val_loss: 0.1379 - val_acc: 0.9565
Epoch 14/20
 - 2s - loss: 0.1800 - acc: 0.9456 - val_loss: 0.1376 - val_acc: 0.9587
Epoch 15/20
 - 2s - loss: 0.1726 - acc: 0.9461 - val_loss: 0.1159 - val_acc: 0.9649
Epoch 16/20
 - 2s - loss: 0.1705 - acc: 0.9485 - val_loss: 0.1651 - val_acc: 0.9519
Epoch 17/20
 - 2s - loss: 0.1684 - acc: 0.9492 - val_loss: 0.2302 - val_acc: 0.9341
Epoch 18/20
 - 2s - loss: 0.1609 - acc: 0.9512 - val_loss: 0.1255 - val_acc: 0.9615
Epoch 19/20
 - 2s - loss: 0.1577 - acc: 0.9518 - val_loss: 0.1183 - val_acc: 0.9650
Epoch 20/20
 - 2s - loss: 0.1521 - acc: 0.9539 - val_loss: 0.1695 - val_acc: 0.9484
Test loss: 0.17074628877150827
Test accuracy: 0.9477
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4623 - acc: 0.8581 - val_loss: 0.2101 - val_acc: 0.9369
Epoch 2/20
 - 1s - loss: 0.1872 - acc: 0.9435 - val_loss: 0.1888 - val_acc: 0.9400
Epoch 3/20
 - 1s - loss: 0.1190 - acc: 0.9629 - val_loss: 0.1310 - val_acc: 0.9594
Epoch 4/20
 - 1s - loss: 0.0865 - acc: 0.9731 - val_loss: 0.1872 - val_acc: 0.9438
Epoch 5/20
 - 1s - loss: 0.0624 - acc: 0.9794 - val_loss: 0.1152 - val_acc: 0.9667
Epoch 6/20
 - 1s - loss: 0.0465 - acc: 0.9862 - val_loss: 0.1216 - val_acc: 0.9660
Epoch 7/20
 - 1s - loss: 0.0379 - acc: 0.9871 - val_loss: 0.1489 - val_acc: 0.9636
Epoch 8/20
 - 1s - loss: 0.0357 - acc: 0.9881 - val_loss: 0.1408 - val_acc: 0.9665
Epoch 9/20
 - 1s - loss: 0.0251 - acc: 0.9918 - val_loss: 0.1403 - val_acc: 0.9698
Epoch 10/20
 - 1s - loss: 0.0213 - acc: 0.9926 - val_loss: 0.1656 - val_acc: 0.9640
Epoch 11/20
 - 1s - loss: 0.0183 - acc: 0.9934 - val_loss: 0.1624 - val_acc: 0.9685
Epoch 12/20
 - 1s - loss: 0.0178 - acc: 0.9944 - val_loss: 0.1491 - val_acc: 0.9712
Epoch 13/20
 - 1s - loss: 0.0153 - acc: 0.9946 - val_loss: 0.1524 - val_acc: 0.9697
Epoch 14/20
 - 1s - loss: 0.0132 - acc: 0.9953 - val_loss: 0.1620 - val_acc: 0.9704
Epoch 15/20
 - 1s - loss: 0.0119 - acc: 0.9961 - val_loss: 0.1679 - val_acc: 0.9697
Epoch 16/20
 - 1s - loss: 0.0126 - acc: 0.9961 - val_loss: 0.1765 - val_acc: 0.9698
Epoch 17/20
 - 1s - loss: 0.0103 - acc: 0.9965 - val_loss: 0.1777 - val_acc: 0.9706
Epoch 18/20
 - 1s - loss: 0.0082 - acc: 0.9970 - val_loss: 0.1758 - val_acc: 0.9717
Epoch 19/20
 - 1s - loss: 0.0141 - acc: 0.9958 - val_loss: 0.1859 - val_acc: 0.9693
Epoch 20/20
 - 1s - loss: 0.0090 - acc: 0.9975 - val_loss: 0.1924 - val_acc: 0.9716
Test loss: 0.19244716880841412
Test accuracy: 0.9716
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6300 - acc: 0.4863 - val_loss: 0.7943 - val_acc: 0.7069
Epoch 2/20
 - 1s - loss: 0.8516 - acc: 0.7198 - val_loss: 0.9162 - val_acc: 0.6592
Epoch 3/20
 - 1s - loss: 0.6665 - acc: 0.7869 - val_loss: 0.6647 - val_acc: 0.7828
Epoch 4/20
 - 1s - loss: 0.5403 - acc: 0.8264 - val_loss: 0.5293 - val_acc: 0.8233
Epoch 5/20
 - 1s - loss: 0.4770 - acc: 0.8518 - val_loss: 0.3909 - val_acc: 0.8733
Epoch 6/20
 - 1s - loss: 0.4223 - acc: 0.8664 - val_loss: 0.4040 - val_acc: 0.8634
Epoch 7/20
 - 1s - loss: 0.3894 - acc: 0.8772 - val_loss: 0.3140 - val_acc: 0.8944
Epoch 8/20
 - 1s - loss: 0.3480 - acc: 0.8906 - val_loss: 0.4733 - val_acc: 0.8475
Epoch 9/20
 - 1s - loss: 0.3156 - acc: 0.9021 - val_loss: 0.5826 - val_acc: 0.8183
Epoch 10/20
 - 1s - loss: 0.3110 - acc: 0.9017 - val_loss: 0.2297 - val_acc: 0.9286
Epoch 11/20
 - 1s - loss: 0.2670 - acc: 0.9154 - val_loss: 0.3440 - val_acc: 0.8887
Epoch 12/20
 - 1s - loss: 0.2635 - acc: 0.9179 - val_loss: 0.3013 - val_acc: 0.9079
Epoch 13/20
 - 1s - loss: 0.2482 - acc: 0.9199 - val_loss: 0.7842 - val_acc: 0.7765
Epoch 14/20
 - 1s - loss: 0.2365 - acc: 0.9254 - val_loss: 0.2959 - val_acc: 0.9132
Epoch 15/20
 - 1s - loss: 0.2233 - acc: 0.9273 - val_loss: 0.3123 - val_acc: 0.9076
Epoch 16/20
 - 1s - loss: 0.2155 - acc: 0.9325 - val_loss: 0.1988 - val_acc: 0.9385
Epoch 17/20
 - 1s - loss: 0.2057 - acc: 0.9377 - val_loss: 0.3611 - val_acc: 0.8847
Epoch 18/20
 - 1s - loss: 0.2014 - acc: 0.9361 - val_loss: 0.6480 - val_acc: 0.8320
Epoch 19/20
 - 1s - loss: 0.1880 - acc: 0.9399 - val_loss: 0.1961 - val_acc: 0.9410
Epoch 20/20
 - 1s - loss: 0.1910 - acc: 0.9391 - val_loss: 0.2210 - val_acc: 0.9289
Test loss: 0.22109530574046074
Test accuracy: 0.9291
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.5936 - acc: 0.8127 - val_loss: 0.3029 - val_acc: 0.9107
Epoch 2/20
 - 0s - loss: 0.2491 - acc: 0.9263 - val_loss: 0.2776 - val_acc: 0.9161
Epoch 3/20
 - 0s - loss: 0.1645 - acc: 0.9484 - val_loss: 0.1771 - val_acc: 0.9464
Epoch 4/20
 - 0s - loss: 0.1207 - acc: 0.9629 - val_loss: 0.1912 - val_acc: 0.9399
Epoch 5/20
 - 0s - loss: 0.0873 - acc: 0.9717 - val_loss: 0.2218 - val_acc: 0.9365
Epoch 6/20
 - 0s - loss: 0.0602 - acc: 0.9835 - val_loss: 0.1832 - val_acc: 0.9481
Epoch 7/20
 - 0s - loss: 0.0457 - acc: 0.9867 - val_loss: 0.1783 - val_acc: 0.9525
Epoch 8/20
 - 0s - loss: 0.0356 - acc: 0.9877 - val_loss: 0.1947 - val_acc: 0.9488
Epoch 9/20
 - 0s - loss: 0.0276 - acc: 0.9909 - val_loss: 0.1784 - val_acc: 0.9532
Epoch 10/20
 - 0s - loss: 0.0245 - acc: 0.9921 - val_loss: 0.2127 - val_acc: 0.9494
Epoch 11/20
 - 0s - loss: 0.0198 - acc: 0.9940 - val_loss: 0.2082 - val_acc: 0.9517
Epoch 12/20
 - 0s - loss: 0.0148 - acc: 0.9953 - val_loss: 0.2479 - val_acc: 0.9490
Epoch 13/20
 - 0s - loss: 0.0126 - acc: 0.9961 - val_loss: 0.2135 - val_acc: 0.9549
Epoch 14/20
 - 0s - loss: 0.0087 - acc: 0.9972 - val_loss: 0.2575 - val_acc: 0.9511
Epoch 15/20
 - 0s - loss: 0.0091 - acc: 0.9969 - val_loss: 0.2358 - val_acc: 0.9555
Epoch 16/20
 - 0s - loss: 0.0074 - acc: 0.9977 - val_loss: 0.2287 - val_acc: 0.9593
Epoch 17/20
 - 0s - loss: 0.0081 - acc: 0.9980 - val_loss: 0.2344 - val_acc: 0.9574
Epoch 18/20
 - 0s - loss: 0.0087 - acc: 0.9967 - val_loss: 0.2677 - val_acc: 0.9536
Epoch 19/20
 - 0s - loss: 0.0061 - acc: 0.9981 - val_loss: 0.2476 - val_acc: 0.9584
Epoch 20/20
 - 0s - loss: 0.0102 - acc: 0.9965 - val_loss: 0.2919 - val_acc: 0.9532
Test loss: 0.2918702960378602
Test accuracy: 0.9532
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0984 - acc: 0.3635 - val_loss: 0.9880 - val_acc: 0.7607
Epoch 2/20
 - 1s - loss: 1.1325 - acc: 0.6285 - val_loss: 0.8154 - val_acc: 0.7252
Epoch 3/20
 - 1s - loss: 0.8579 - acc: 0.7103 - val_loss: 0.8332 - val_acc: 0.6966
Epoch 4/20
 - 1s - loss: 0.7463 - acc: 0.7575 - val_loss: 0.7747 - val_acc: 0.7455
Epoch 5/20
 - 1s - loss: 0.6868 - acc: 0.7755 - val_loss: 0.5074 - val_acc: 0.8397
Epoch 6/20
 - 1s - loss: 0.5805 - acc: 0.8113 - val_loss: 0.7462 - val_acc: 0.7575
Epoch 7/20
 - 1s - loss: 0.5421 - acc: 0.8233 - val_loss: 0.6130 - val_acc: 0.7879
Epoch 8/20
 - 1s - loss: 0.4871 - acc: 0.8409 - val_loss: 0.5278 - val_acc: 0.8264
Epoch 9/20
 - 1s - loss: 0.4518 - acc: 0.8547 - val_loss: 0.3910 - val_acc: 0.8723
Epoch 10/20
 - 1s - loss: 0.4065 - acc: 0.8748 - val_loss: 0.4460 - val_acc: 0.8505
Epoch 11/20
 - 1s - loss: 0.4106 - acc: 0.8684 - val_loss: 0.3517 - val_acc: 0.8902
Epoch 12/20
 - 1s - loss: 0.3797 - acc: 0.8801 - val_loss: 0.3863 - val_acc: 0.8812
Epoch 13/20
 - 1s - loss: 0.3773 - acc: 0.8839 - val_loss: 0.4050 - val_acc: 0.8744
Epoch 14/20
 - 1s - loss: 0.3466 - acc: 0.8916 - val_loss: 0.3999 - val_acc: 0.8763
Epoch 15/20
 - 1s - loss: 0.3234 - acc: 0.8975 - val_loss: 0.4671 - val_acc: 0.8582
Epoch 16/20
 - 1s - loss: 0.3165 - acc: 0.9016 - val_loss: 0.2581 - val_acc: 0.9202
Epoch 17/20
 - 1s - loss: 0.2996 - acc: 0.9015 - val_loss: 0.5594 - val_acc: 0.8229
Epoch 18/20
 - 1s - loss: 0.2738 - acc: 0.9136 - val_loss: 0.5045 - val_acc: 0.8288
Epoch 19/20
 - 1s - loss: 0.2739 - acc: 0.9109 - val_loss: 0.4035 - val_acc: 0.8826
Epoch 20/20
 - 1s - loss: 0.2685 - acc: 0.9139 - val_loss: 0.3006 - val_acc: 0.9068
Test loss: 0.300377102939412
Test accuracy: 0.9074
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.7765 - acc: 0.7528 - val_loss: 0.4013 - val_acc: 0.8799
Epoch 2/20
 - 0s - loss: 0.3420 - acc: 0.8917 - val_loss: 0.3255 - val_acc: 0.8959
Epoch 3/20
 - 0s - loss: 0.2183 - acc: 0.9363 - val_loss: 0.3158 - val_acc: 0.9005
Epoch 4/20
 - 0s - loss: 0.1686 - acc: 0.9493 - val_loss: 0.2383 - val_acc: 0.9250
Epoch 5/20
 - 0s - loss: 0.1154 - acc: 0.9653 - val_loss: 0.3356 - val_acc: 0.9022
Epoch 6/20
 - 0s - loss: 0.0835 - acc: 0.9755 - val_loss: 0.2657 - val_acc: 0.9216
Epoch 7/20
 - 0s - loss: 0.0706 - acc: 0.9781 - val_loss: 0.2172 - val_acc: 0.9366
Epoch 8/20
 - 0s - loss: 0.0459 - acc: 0.9867 - val_loss: 0.2561 - val_acc: 0.9298
Epoch 9/20
 - 0s - loss: 0.0343 - acc: 0.9888 - val_loss: 0.2434 - val_acc: 0.9332
Epoch 10/20
 - 0s - loss: 0.0272 - acc: 0.9915 - val_loss: 0.2947 - val_acc: 0.9259
Epoch 11/20
 - 0s - loss: 0.0209 - acc: 0.9939 - val_loss: 0.2813 - val_acc: 0.9360
Epoch 12/20
 - 0s - loss: 0.0265 - acc: 0.9928 - val_loss: 0.2539 - val_acc: 0.9396
Epoch 13/20
 - 0s - loss: 0.0103 - acc: 0.9976 - val_loss: 0.3157 - val_acc: 0.9290
Epoch 14/20
 - 0s - loss: 0.0157 - acc: 0.9952 - val_loss: 0.2828 - val_acc: 0.9389
Epoch 15/20
 - 0s - loss: 0.0175 - acc: 0.9933 - val_loss: 0.2527 - val_acc: 0.9403
Epoch 16/20
 - 0s - loss: 0.0166 - acc: 0.9955 - val_loss: 0.2737 - val_acc: 0.9414
Epoch 17/20
 - 0s - loss: 0.0124 - acc: 0.9955 - val_loss: 0.2883 - val_acc: 0.9362
Epoch 18/20
 - 0s - loss: 0.0036 - acc: 0.9995 - val_loss: 0.2911 - val_acc: 0.9410
Epoch 19/20
 - 0s - loss: 0.0050 - acc: 0.9984 - val_loss: 0.2799 - val_acc: 0.9441
Epoch 20/20
 - 0s - loss: 0.0021 - acc: 0.9995 - val_loss: 0.3380 - val_acc: 0.9371
Test loss: 0.33798906035463516
Test accuracy: 0.9371
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6534 - acc: 0.2435 - val_loss: 1.9640 - val_acc: 0.2050
Epoch 2/20
 - 1s - loss: 1.5527 - acc: 0.4899 - val_loss: 1.3646 - val_acc: 0.4998
Epoch 3/20
 - 1s - loss: 1.2778 - acc: 0.5893 - val_loss: 1.3386 - val_acc: 0.4896
Epoch 4/20
 - 1s - loss: 0.9996 - acc: 0.6667 - val_loss: 0.9126 - val_acc: 0.6851
Epoch 5/20
 - 1s - loss: 0.8835 - acc: 0.7112 - val_loss: 0.9181 - val_acc: 0.6982
Epoch 6/20
 - 1s - loss: 0.8526 - acc: 0.7192 - val_loss: 0.7663 - val_acc: 0.7343
Epoch 7/20
 - 1s - loss: 0.7268 - acc: 0.7744 - val_loss: 0.6955 - val_acc: 0.7801
Epoch 8/20
 - 1s - loss: 0.7338 - acc: 0.7565 - val_loss: 0.5029 - val_acc: 0.8424
Epoch 9/20
 - 1s - loss: 0.6119 - acc: 0.8053 - val_loss: 1.5232 - val_acc: 0.5671
Epoch 10/20
 - 1s - loss: 0.5961 - acc: 0.8088 - val_loss: 0.6056 - val_acc: 0.7929
Epoch 11/20
 - 1s - loss: 0.5920 - acc: 0.8165 - val_loss: 0.4929 - val_acc: 0.8338
Epoch 12/20
 - 1s - loss: 0.5825 - acc: 0.8147 - val_loss: 0.8983 - val_acc: 0.7086
Epoch 13/20
 - 1s - loss: 0.5258 - acc: 0.8272 - val_loss: 0.4812 - val_acc: 0.8379
Epoch 14/20
 - 1s - loss: 0.5250 - acc: 0.8368 - val_loss: 0.5684 - val_acc: 0.8106
Epoch 15/20
 - 1s - loss: 0.4629 - acc: 0.8451 - val_loss: 0.6281 - val_acc: 0.7941
Epoch 16/20
 - 1s - loss: 0.4734 - acc: 0.8483 - val_loss: 0.4890 - val_acc: 0.8421
Epoch 17/20
 - 1s - loss: 0.4499 - acc: 0.8523 - val_loss: 0.4051 - val_acc: 0.8646
Epoch 18/20
 - 1s - loss: 0.4002 - acc: 0.8691 - val_loss: 0.4452 - val_acc: 0.8530
Epoch 19/20
 - 1s - loss: 0.4195 - acc: 0.8707 - val_loss: 0.7784 - val_acc: 0.7344
Epoch 20/20
 - 1s - loss: 0.3977 - acc: 0.8685 - val_loss: 0.6387 - val_acc: 0.7814
Test loss: 0.6384889479875565
Test accuracy: 0.7822
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1460 - acc: 0.6368 - val_loss: 0.7155 - val_acc: 0.7422
Epoch 2/20
 - 0s - loss: 0.4639 - acc: 0.8603 - val_loss: 0.4350 - val_acc: 0.8661
Epoch 3/20
 - 0s - loss: 0.3405 - acc: 0.8949 - val_loss: 0.3819 - val_acc: 0.8880
Epoch 4/20
 - 0s - loss: 0.2583 - acc: 0.9269 - val_loss: 0.3795 - val_acc: 0.8787
Epoch 5/20
 - 0s - loss: 0.1961 - acc: 0.9403 - val_loss: 0.3462 - val_acc: 0.8936
Epoch 6/20
 - 0s - loss: 0.1519 - acc: 0.9600 - val_loss: 0.3537 - val_acc: 0.8913
Epoch 7/20
 - 0s - loss: 0.1211 - acc: 0.9653 - val_loss: 0.3250 - val_acc: 0.9032
Epoch 8/20
 - 0s - loss: 0.0776 - acc: 0.9787 - val_loss: 0.2983 - val_acc: 0.9111
Epoch 9/20
 - 0s - loss: 0.0657 - acc: 0.9819 - val_loss: 0.3405 - val_acc: 0.8966
Epoch 10/20
 - 0s - loss: 0.0512 - acc: 0.9877 - val_loss: 0.2855 - val_acc: 0.9204
Epoch 11/20
 - 0s - loss: 0.0383 - acc: 0.9899 - val_loss: 0.3099 - val_acc: 0.9156
Epoch 12/20
 - 0s - loss: 0.0345 - acc: 0.9893 - val_loss: 0.3235 - val_acc: 0.9150
Epoch 13/20
 - 0s - loss: 0.0181 - acc: 0.9957 - val_loss: 0.3736 - val_acc: 0.9072
Epoch 14/20
 - 0s - loss: 0.0096 - acc: 0.9984 - val_loss: 0.3242 - val_acc: 0.9198
Epoch 15/20
 - 0s - loss: 0.0333 - acc: 0.9899 - val_loss: 0.3205 - val_acc: 0.9215
Epoch 16/20
 - 0s - loss: 0.0053 - acc: 0.9989 - val_loss: 0.4428 - val_acc: 0.9016
Epoch 17/20
 - 0s - loss: 0.0170 - acc: 0.9931 - val_loss: 0.3510 - val_acc: 0.9184
Epoch 18/20
 - 0s - loss: 0.0038 - acc: 1.0000 - val_loss: 0.3747 - val_acc: 0.9192
Epoch 19/20
 - 0s - loss: 0.0172 - acc: 0.9952 - val_loss: 0.4462 - val_acc: 0.9042
Epoch 20/20
 - 0s - loss: 0.0096 - acc: 0.9957 - val_loss: 0.3495 - val_acc: 0.9228
Test loss: 0.34949699265331435
Test accuracy: 0.9228
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.0736 - acc: 0.2048 - val_loss: 1.9850 - val_acc: 0.2577
Epoch 2/20
 - 1s - loss: 2.0129 - acc: 0.3099 - val_loss: 1.6762 - val_acc: 0.4591
Epoch 3/20
 - 1s - loss: 1.7289 - acc: 0.4427 - val_loss: 1.2549 - val_acc: 0.6210
Epoch 4/20
 - 1s - loss: 1.4653 - acc: 0.5312 - val_loss: 1.2286 - val_acc: 0.6204
Epoch 5/20
 - 1s - loss: 1.3011 - acc: 0.5781 - val_loss: 1.0787 - val_acc: 0.6447
Epoch 6/20
 - 1s - loss: 1.1427 - acc: 0.6304 - val_loss: 0.9304 - val_acc: 0.7031
Epoch 7/20
 - 1s - loss: 1.0572 - acc: 0.6485 - val_loss: 1.8633 - val_acc: 0.4379
Epoch 8/20
 - 1s - loss: 1.0245 - acc: 0.6747 - val_loss: 0.7963 - val_acc: 0.7325
Epoch 9/20
 - 1s - loss: 0.9184 - acc: 0.6960 - val_loss: 1.4843 - val_acc: 0.5882
Epoch 10/20
 - 1s - loss: 0.9123 - acc: 0.7168 - val_loss: 0.8759 - val_acc: 0.6944
Epoch 11/20
 - 1s - loss: 0.7584 - acc: 0.7563 - val_loss: 0.8285 - val_acc: 0.7218
Epoch 12/20
 - 1s - loss: 0.7754 - acc: 0.7552 - val_loss: 1.1826 - val_acc: 0.5891
Epoch 13/20
 - 1s - loss: 0.7566 - acc: 0.7419 - val_loss: 0.7739 - val_acc: 0.7399
Epoch 14/20
 - 1s - loss: 0.6781 - acc: 0.7744 - val_loss: 0.7814 - val_acc: 0.7576
Epoch 15/20
 - 1s - loss: 0.7654 - acc: 0.7627 - val_loss: 0.6504 - val_acc: 0.7720
Epoch 16/20
 - 1s - loss: 0.7275 - acc: 0.7621 - val_loss: 0.4940 - val_acc: 0.8395
Epoch 17/20
 - 1s - loss: 0.5627 - acc: 0.8155 - val_loss: 0.7151 - val_acc: 0.7626
Epoch 18/20
 - 1s - loss: 0.7009 - acc: 0.7872 - val_loss: 0.6841 - val_acc: 0.7503
Epoch 19/20
 - 1s - loss: 0.5603 - acc: 0.8139 - val_loss: 0.8783 - val_acc: 0.6756
Epoch 20/20
 - 1s - loss: 0.5648 - acc: 0.8128 - val_loss: 0.9017 - val_acc: 0.7076
Test loss: 0.9009645173311234
Test accuracy: 0.7087
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5622 - acc: 0.4888 - val_loss: 0.8777 - val_acc: 0.7117
Epoch 2/20
 - 0s - loss: 0.6229 - acc: 0.8186 - val_loss: 0.5965 - val_acc: 0.8090
Epoch 3/20
 - 0s - loss: 0.4063 - acc: 0.8719 - val_loss: 0.5743 - val_acc: 0.8191
Epoch 4/20
 - 0s - loss: 0.3206 - acc: 0.9039 - val_loss: 0.5283 - val_acc: 0.8315
Epoch 5/20
 - 0s - loss: 0.2668 - acc: 0.9210 - val_loss: 0.7602 - val_acc: 0.7598
Epoch 6/20
 - 0s - loss: 0.2348 - acc: 0.9338 - val_loss: 0.5286 - val_acc: 0.8296
Epoch 7/20
 - 0s - loss: 0.1365 - acc: 0.9573 - val_loss: 0.4306 - val_acc: 0.8662
Epoch 8/20
 - 0s - loss: 0.1005 - acc: 0.9765 - val_loss: 0.4441 - val_acc: 0.8666
Epoch 9/20
 - 0s - loss: 0.1028 - acc: 0.9680 - val_loss: 0.4022 - val_acc: 0.8824
Epoch 10/20
 - 0s - loss: 0.0636 - acc: 0.9840 - val_loss: 0.6346 - val_acc: 0.8193
Epoch 11/20
 - 0s - loss: 0.0574 - acc: 0.9883 - val_loss: 0.4193 - val_acc: 0.8748
Epoch 12/20
 - 0s - loss: 0.0384 - acc: 0.9925 - val_loss: 0.6259 - val_acc: 0.8250
Epoch 13/20
 - 0s - loss: 0.0549 - acc: 0.9840 - val_loss: 0.4556 - val_acc: 0.8775
Epoch 14/20
 - 0s - loss: 0.0144 - acc: 1.0000 - val_loss: 0.4561 - val_acc: 0.8846
Epoch 15/20
 - 0s - loss: 0.0096 - acc: 1.0000 - val_loss: 0.4136 - val_acc: 0.8927
Epoch 16/20
 - 0s - loss: 0.0250 - acc: 0.9957 - val_loss: 0.4824 - val_acc: 0.8806
Epoch 17/20
 - 0s - loss: 0.0121 - acc: 0.9989 - val_loss: 0.4864 - val_acc: 0.8782
Epoch 18/20
 - 0s - loss: 0.0068 - acc: 1.0000 - val_loss: 0.4117 - val_acc: 0.9002
Epoch 19/20
 - 0s - loss: 0.0031 - acc: 1.0000 - val_loss: 0.5012 - val_acc: 0.8832
Epoch 20/20
 - 0s - loss: 0.0694 - acc: 0.9829 - val_loss: 0.4658 - val_acc: 0.8902
Test loss: 0.46575444340053945
Test accuracy: 0.8902
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.8371 - acc: 0.1163 - val_loss: 2.1395 - val_acc: 0.2648
Epoch 2/20
 - 0s - loss: 2.1245 - acc: 0.2455 - val_loss: 2.5840 - val_acc: 0.1322
Epoch 3/20
 - 0s - loss: 2.0756 - acc: 0.2946 - val_loss: 2.2252 - val_acc: 0.1651
Epoch 4/20
 - 0s - loss: 1.9235 - acc: 0.3372 - val_loss: 1.9272 - val_acc: 0.2069
Epoch 5/20
 - 0s - loss: 1.8075 - acc: 0.4013 - val_loss: 1.3923 - val_acc: 0.5594
Epoch 6/20
 - 0s - loss: 1.6364 - acc: 0.4312 - val_loss: 1.4909 - val_acc: 0.4830
Epoch 7/20
 - 1s - loss: 1.5188 - acc: 0.5165 - val_loss: 1.3724 - val_acc: 0.5242
Epoch 8/20
 - 0s - loss: 1.2284 - acc: 0.6041 - val_loss: 1.4801 - val_acc: 0.5267
Epoch 9/20
 - 0s - loss: 1.2595 - acc: 0.5923 - val_loss: 1.4905 - val_acc: 0.5297
Epoch 10/20
 - 0s - loss: 1.2203 - acc: 0.5998 - val_loss: 1.8979 - val_acc: 0.3527
Epoch 11/20
 - 0s - loss: 1.1465 - acc: 0.6158 - val_loss: 1.0950 - val_acc: 0.6231
Epoch 12/20
 - 0s - loss: 1.0581 - acc: 0.6446 - val_loss: 0.9770 - val_acc: 0.6599
Epoch 13/20
 - 0s - loss: 0.9708 - acc: 0.6926 - val_loss: 1.6691 - val_acc: 0.5150
Epoch 14/20
 - 0s - loss: 1.0101 - acc: 0.6830 - val_loss: 1.2185 - val_acc: 0.5365
Epoch 15/20
 - 0s - loss: 1.0161 - acc: 0.6510 - val_loss: 0.9344 - val_acc: 0.6691
Epoch 16/20
 - 0s - loss: 0.7738 - acc: 0.7599 - val_loss: 0.9090 - val_acc: 0.6673
Epoch 17/20
 - 0s - loss: 0.7792 - acc: 0.7375 - val_loss: 1.0930 - val_acc: 0.6102
Epoch 18/20
 - 0s - loss: 0.8101 - acc: 0.7150 - val_loss: 0.8853 - val_acc: 0.6704
Epoch 19/20
 - 0s - loss: 1.1994 - acc: 0.6350 - val_loss: 0.7432 - val_acc: 0.7447
Epoch 20/20
 - 0s - loss: 0.7109 - acc: 0.7631 - val_loss: 0.9470 - val_acc: 0.6783
Test loss: 0.9466224718093872
Test accuracy: 0.6806
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.8245 - acc: 0.3846 - val_loss: 1.1439 - val_acc: 0.6603
Epoch 2/20
 - 0s - loss: 0.8030 - acc: 0.7756 - val_loss: 0.9434 - val_acc: 0.6895
Epoch 3/20
 - 0s - loss: 0.5086 - acc: 0.8291 - val_loss: 0.8106 - val_acc: 0.7206
Epoch 4/20
 - 0s - loss: 0.3194 - acc: 0.9081 - val_loss: 0.5888 - val_acc: 0.8130
Epoch 5/20
 - 0s - loss: 0.2343 - acc: 0.9359 - val_loss: 0.5823 - val_acc: 0.8163
Epoch 6/20
 - 0s - loss: 0.2030 - acc: 0.9359 - val_loss: 0.7847 - val_acc: 0.7379
Epoch 7/20
 - 0s - loss: 0.1822 - acc: 0.9444 - val_loss: 0.6605 - val_acc: 0.8047
Epoch 8/20
 - 0s - loss: 0.1061 - acc: 0.9829 - val_loss: 0.5868 - val_acc: 0.8130
Epoch 9/20
 - 0s - loss: 0.0688 - acc: 0.9915 - val_loss: 0.5066 - val_acc: 0.8442
Epoch 10/20
 - 0s - loss: 0.0586 - acc: 0.9915 - val_loss: 0.5932 - val_acc: 0.8255
Epoch 11/20
 - 0s - loss: 0.0548 - acc: 0.9936 - val_loss: 0.5490 - val_acc: 0.8427
Epoch 12/20
 - 0s - loss: 0.0567 - acc: 0.9872 - val_loss: 0.5897 - val_acc: 0.8230
Epoch 13/20
 - 0s - loss: 0.0624 - acc: 0.9850 - val_loss: 0.5956 - val_acc: 0.8301
Epoch 14/20
 - 0s - loss: 0.0233 - acc: 0.9979 - val_loss: 0.6236 - val_acc: 0.8203
Epoch 15/20
 - 0s - loss: 0.0648 - acc: 0.9765 - val_loss: 0.5328 - val_acc: 0.8542
Epoch 16/20
 - 0s - loss: 0.0105 - acc: 1.0000 - val_loss: 0.5425 - val_acc: 0.8520
Epoch 17/20
 - 0s - loss: 0.0087 - acc: 1.0000 - val_loss: 0.5490 - val_acc: 0.8545
Epoch 18/20
 - 0s - loss: 0.0060 - acc: 1.0000 - val_loss: 0.5586 - val_acc: 0.8551
Epoch 19/20
 - 0s - loss: 0.0087 - acc: 1.0000 - val_loss: 0.5638 - val_acc: 0.8518
Epoch 20/20
 - 0s - loss: 0.0052 - acc: 1.0000 - val_loss: 0.6447 - val_acc: 0.8425
Test loss: 0.6447449169974774
Test accuracy: 0.8425
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 5.1452 - acc: 0.1175 - val_loss: 2.6801 - val_acc: 0.1462
Epoch 2/20
 - 0s - loss: 2.4006 - acc: 0.1752 - val_loss: 2.1515 - val_acc: 0.1409
Epoch 3/20
 - 0s - loss: 2.1484 - acc: 0.2179 - val_loss: 2.1575 - val_acc: 0.2030
Epoch 4/20
 - 0s - loss: 2.0240 - acc: 0.3226 - val_loss: 1.9184 - val_acc: 0.3633
Epoch 5/20
 - 0s - loss: 1.9085 - acc: 0.3355 - val_loss: 2.5015 - val_acc: 0.1142
Epoch 6/20
 - 0s - loss: 2.1522 - acc: 0.2885 - val_loss: 1.6502 - val_acc: 0.5571
Epoch 7/20
 - 0s - loss: 1.7927 - acc: 0.3996 - val_loss: 1.8530 - val_acc: 0.4202
Epoch 8/20
 - 0s - loss: 1.6822 - acc: 0.4209 - val_loss: 1.7472 - val_acc: 0.4429
Epoch 9/20
 - 0s - loss: 1.6453 - acc: 0.4573 - val_loss: 1.6500 - val_acc: 0.4553
Epoch 10/20
 - 0s - loss: 1.4272 - acc: 0.5769 - val_loss: 1.6750 - val_acc: 0.3447
Epoch 11/20
 - 0s - loss: 1.5404 - acc: 0.4594 - val_loss: 1.6108 - val_acc: 0.4451
Epoch 12/20
 - 0s - loss: 1.2052 - acc: 0.6132 - val_loss: 1.3365 - val_acc: 0.4902
Epoch 13/20
 - 0s - loss: 1.2098 - acc: 0.6090 - val_loss: 1.7162 - val_acc: 0.3529
Epoch 14/20
 - 0s - loss: 1.1452 - acc: 0.6282 - val_loss: 1.4229 - val_acc: 0.5281
Epoch 15/20
 - 0s - loss: 1.2720 - acc: 0.5620 - val_loss: 1.2583 - val_acc: 0.5838
Epoch 16/20
 - 0s - loss: 1.1075 - acc: 0.6389 - val_loss: 1.1759 - val_acc: 0.5568
Epoch 17/20
 - 0s - loss: 1.1783 - acc: 0.6026 - val_loss: 1.3340 - val_acc: 0.5869
Epoch 18/20
 - 0s - loss: 0.9612 - acc: 0.6966 - val_loss: 1.4720 - val_acc: 0.5566
Epoch 19/20
 - 0s - loss: 1.0709 - acc: 0.6603 - val_loss: 1.1993 - val_acc: 0.6002
Epoch 20/20
 - 0s - loss: 0.9178 - acc: 0.7179 - val_loss: 1.2034 - val_acc: 0.5601
Test loss: 1.2039658685684205
Test accuracy: 0.5569
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.1500 - acc: 0.2179 - val_loss: 1.8828 - val_acc: 0.4521
Epoch 2/20
 - 0s - loss: 1.4567 - acc: 0.6325 - val_loss: 1.3351 - val_acc: 0.5947
Epoch 3/20
 - 0s - loss: 0.8260 - acc: 0.7991 - val_loss: 1.0516 - val_acc: 0.6785
Epoch 4/20
 - 0s - loss: 0.5823 - acc: 0.8718 - val_loss: 1.0991 - val_acc: 0.6378
Epoch 5/20
 - 0s - loss: 0.4437 - acc: 0.8846 - val_loss: 0.9894 - val_acc: 0.6576
Epoch 6/20
 - 0s - loss: 0.2937 - acc: 0.9359 - val_loss: 0.7841 - val_acc: 0.7542
Epoch 7/20
 - 0s - loss: 0.1784 - acc: 0.9658 - val_loss: 0.8231 - val_acc: 0.7472
Epoch 8/20
 - 0s - loss: 0.1544 - acc: 0.9829 - val_loss: 0.7545 - val_acc: 0.7705
Epoch 9/20
 - 0s - loss: 0.1127 - acc: 0.9957 - val_loss: 0.7888 - val_acc: 0.7589
Epoch 10/20
 - 0s - loss: 0.0849 - acc: 0.9957 - val_loss: 0.7322 - val_acc: 0.7729
Epoch 11/20
 - 0s - loss: 0.0748 - acc: 0.9872 - val_loss: 0.8831 - val_acc: 0.7399
Epoch 12/20
 - 0s - loss: 0.1057 - acc: 0.9786 - val_loss: 0.8602 - val_acc: 0.7537
Epoch 13/20
 - 0s - loss: 0.0498 - acc: 0.9957 - val_loss: 0.7502 - val_acc: 0.7773
Epoch 14/20
 - 0s - loss: 0.0312 - acc: 1.0000 - val_loss: 0.7761 - val_acc: 0.7815
Epoch 15/20
 - 0s - loss: 0.0262 - acc: 1.0000 - val_loss: 0.7844 - val_acc: 0.7827
Epoch 16/20
 - 0s - loss: 0.0225 - acc: 1.0000 - val_loss: 0.8298 - val_acc: 0.7738
Epoch 17/20
 - 0s - loss: 0.0248 - acc: 1.0000 - val_loss: 0.8194 - val_acc: 0.7742
Epoch 18/20
 - 0s - loss: 0.0175 - acc: 1.0000 - val_loss: 0.7986 - val_acc: 0.7877
Epoch 19/20
 - 0s - loss: 0.0111 - acc: 1.0000 - val_loss: 0.8482 - val_acc: 0.7739
Epoch 20/20
 - 0s - loss: 0.0142 - acc: 1.0000 - val_loss: 0.8216 - val_acc: 0.7835
Test loss: 0.8215741483390331
Test accuracy: 0.7835
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.9298 - acc: 0.1111 - val_loss: 6.5562 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 6.2412 - acc: 0.1239 - val_loss: 3.8120 - val_acc: 0.1356
Epoch 3/20
 - 0s - loss: 3.3915 - acc: 0.1154 - val_loss: 2.2718 - val_acc: 0.1973
Epoch 4/20
 - 0s - loss: 2.1430 - acc: 0.2350 - val_loss: 2.1603 - val_acc: 0.2570
Epoch 5/20
 - 0s - loss: 2.0092 - acc: 0.3333 - val_loss: 2.0622 - val_acc: 0.2661
Epoch 6/20
 - 0s - loss: 1.9545 - acc: 0.3034 - val_loss: 2.0118 - val_acc: 0.2407
Epoch 7/20
 - 0s - loss: 1.9145 - acc: 0.3803 - val_loss: 1.9426 - val_acc: 0.3365
Epoch 8/20
 - 0s - loss: 1.8716 - acc: 0.3632 - val_loss: 2.1789 - val_acc: 0.2471
Epoch 9/20
 - 0s - loss: 1.9927 - acc: 0.3077 - val_loss: 2.0763 - val_acc: 0.2207
Epoch 10/20
 - 0s - loss: 2.0738 - acc: 0.2821 - val_loss: 2.1795 - val_acc: 0.1848
Epoch 11/20
 - 0s - loss: 2.0478 - acc: 0.2564 - val_loss: 1.8210 - val_acc: 0.5043
Epoch 12/20
 - 0s - loss: 1.5767 - acc: 0.5641 - val_loss: 1.7293 - val_acc: 0.4428
Epoch 13/20
 - 0s - loss: 1.7968 - acc: 0.4145 - val_loss: 2.1396 - val_acc: 0.3348
Epoch 14/20
 - 0s - loss: 1.8468 - acc: 0.4145 - val_loss: 1.6404 - val_acc: 0.4778
Epoch 15/20
 - 0s - loss: 1.4407 - acc: 0.5855 - val_loss: 1.7318 - val_acc: 0.3617
Epoch 16/20
 - 0s - loss: 1.6609 - acc: 0.4444 - val_loss: 1.7460 - val_acc: 0.4509
Epoch 17/20
 - 0s - loss: 1.5412 - acc: 0.5000 - val_loss: 1.8249 - val_acc: 0.3852
Epoch 18/20
 - 0s - loss: 1.5884 - acc: 0.4744 - val_loss: 1.5320 - val_acc: 0.5270
Epoch 19/20
 - 0s - loss: 1.2611 - acc: 0.6154 - val_loss: 1.3066 - val_acc: 0.6227
Epoch 20/20
 - 0s - loss: 1.0842 - acc: 0.7308 - val_loss: 1.8134 - val_acc: 0.4286
Test loss: 1.812876160621643
Test accuracy: 0.4278
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3741 - acc: 0.1026 - val_loss: 2.0149 - val_acc: 0.4234
Epoch 2/20
 - 0s - loss: 1.5779 - acc: 0.6239 - val_loss: 1.4997 - val_acc: 0.5751
Epoch 3/20
 - 0s - loss: 0.9484 - acc: 0.8803 - val_loss: 1.6260 - val_acc: 0.4498
Epoch 4/20
 - 0s - loss: 0.8219 - acc: 0.7607 - val_loss: 1.5949 - val_acc: 0.5096
Epoch 5/20
 - 0s - loss: 0.8883 - acc: 0.8120 - val_loss: 1.1819 - val_acc: 0.6284
Epoch 6/20
 - 0s - loss: 0.4043 - acc: 0.9573 - val_loss: 1.1826 - val_acc: 0.6110
Epoch 7/20
 - 0s - loss: 0.3170 - acc: 0.9316 - val_loss: 1.0352 - val_acc: 0.6816
Epoch 8/20
 - 0s - loss: 0.2087 - acc: 0.9829 - val_loss: 1.1199 - val_acc: 0.6192
Epoch 9/20
 - 0s - loss: 0.1822 - acc: 0.9658 - val_loss: 1.1203 - val_acc: 0.6699
Epoch 10/20
 - 0s - loss: 0.1812 - acc: 0.9487 - val_loss: 1.0802 - val_acc: 0.6426
Epoch 11/20
 - 0s - loss: 0.1324 - acc: 0.9829 - val_loss: 0.9955 - val_acc: 0.7040
Epoch 12/20
 - 0s - loss: 0.0786 - acc: 1.0000 - val_loss: 0.9691 - val_acc: 0.7070
Epoch 13/20
 - 0s - loss: 0.0511 - acc: 1.0000 - val_loss: 0.9570 - val_acc: 0.7169
Epoch 14/20
 - 0s - loss: 0.0472 - acc: 1.0000 - val_loss: 0.9693 - val_acc: 0.7112
Epoch 15/20
 - 0s - loss: 0.0397 - acc: 1.0000 - val_loss: 0.9679 - val_acc: 0.7173
Epoch 16/20
 - 0s - loss: 0.0322 - acc: 1.0000 - val_loss: 0.9675 - val_acc: 0.7229
Epoch 17/20
 - 0s - loss: 0.0257 - acc: 1.0000 - val_loss: 0.9915 - val_acc: 0.7150
Epoch 18/20
 - 0s - loss: 0.0254 - acc: 1.0000 - val_loss: 0.9975 - val_acc: 0.7138
Epoch 19/20
 - 0s - loss: 0.0229 - acc: 1.0000 - val_loss: 0.9936 - val_acc: 0.7177
Epoch 20/20
 - 0s - loss: 0.0194 - acc: 1.0000 - val_loss: 0.9948 - val_acc: 0.7171
Test loss: 0.9947650251626968
Test accuracy: 0.7171
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.7077 - acc: 0.1538 - val_loss: 6.3646 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 6.2398 - acc: 0.1368 - val_loss: 5.3440 - val_acc: 0.1140
Epoch 3/20
 - 0s - loss: 5.9943 - acc: 0.1197 - val_loss: 4.4622 - val_acc: 0.1873
Epoch 4/20
 - 0s - loss: 4.7996 - acc: 0.1538 - val_loss: 2.5617 - val_acc: 0.1159
Epoch 5/20
 - 0s - loss: 2.6154 - acc: 0.1197 - val_loss: 2.4047 - val_acc: 0.1651
Epoch 6/20
 - 0s - loss: 2.2594 - acc: 0.2393 - val_loss: 2.1501 - val_acc: 0.3095
Epoch 7/20
 - 0s - loss: 2.0803 - acc: 0.2906 - val_loss: 2.0812 - val_acc: 0.2574
Epoch 8/20
 - 0s - loss: 1.9341 - acc: 0.3675 - val_loss: 2.0741 - val_acc: 0.2360
Epoch 9/20
 - 0s - loss: 1.8854 - acc: 0.2991 - val_loss: 2.1743 - val_acc: 0.2185
Epoch 10/20
 - 0s - loss: 1.9383 - acc: 0.3162 - val_loss: 2.0307 - val_acc: 0.2535
Epoch 11/20
 - 0s - loss: 1.8756 - acc: 0.2991 - val_loss: 2.0145 - val_acc: 0.4001
Epoch 12/20
 - 0s - loss: 1.8582 - acc: 0.3675 - val_loss: 2.2863 - val_acc: 0.1000
Epoch 13/20
 - 0s - loss: 2.0963 - acc: 0.2051 - val_loss: 2.5746 - val_acc: 0.1049
Epoch 14/20
 - 0s - loss: 2.4765 - acc: 0.1111 - val_loss: 2.3230 - val_acc: 0.2195
Epoch 15/20
 - 0s - loss: 2.2013 - acc: 0.2479 - val_loss: 2.0073 - val_acc: 0.2502
Epoch 16/20
 - 0s - loss: 1.7954 - acc: 0.3333 - val_loss: 1.8820 - val_acc: 0.4408
Epoch 17/20
 - 0s - loss: 1.6525 - acc: 0.5556 - val_loss: 1.8657 - val_acc: 0.3586
Epoch 18/20
 - 0s - loss: 1.5585 - acc: 0.4786 - val_loss: 1.9053 - val_acc: 0.3853
Epoch 19/20
 - 0s - loss: 1.6474 - acc: 0.4786 - val_loss: 1.8229 - val_acc: 0.3937
Epoch 20/20
 - 0s - loss: 1.5152 - acc: 0.5043 - val_loss: 1.6847 - val_acc: 0.4644
Test loss: 1.6846583499908447
Test accuracy: 0.4649
================
Start of new run
================
60000 train samples
10000 test samples
Normal model
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 6s - loss: 0.2474 - acc: 0.9227 - val_loss: 0.1220 - val_acc: 0.9628
Epoch 2/20
 - 2s - loss: 0.1038 - acc: 0.9677 - val_loss: 0.1098 - val_acc: 0.9689
Epoch 3/20
 - 2s - loss: 0.0744 - acc: 0.9773 - val_loss: 0.0787 - val_acc: 0.9784
Epoch 4/20
 - 2s - loss: 0.0608 - acc: 0.9815 - val_loss: 0.0709 - val_acc: 0.9804
Epoch 5/20
 - 2s - loss: 0.0499 - acc: 0.9848 - val_loss: 0.0880 - val_acc: 0.9787
Epoch 6/20
 - 2s - loss: 0.0441 - acc: 0.9871 - val_loss: 0.0842 - val_acc: 0.9801
Epoch 7/20
 - 2s - loss: 0.0407 - acc: 0.9879 - val_loss: 0.0902 - val_acc: 0.9788
Epoch 8/20
 - 2s - loss: 0.0352 - acc: 0.9895 - val_loss: 0.0859 - val_acc: 0.9803
Epoch 9/20
 - 2s - loss: 0.0331 - acc: 0.9905 - val_loss: 0.0766 - val_acc: 0.9825
Epoch 10/20
 - 2s - loss: 0.0288 - acc: 0.9917 - val_loss: 0.0909 - val_acc: 0.9820
Epoch 11/20
 - 2s - loss: 0.0268 - acc: 0.9922 - val_loss: 0.0950 - val_acc: 0.9830
Epoch 12/20
 - 2s - loss: 0.0270 - acc: 0.9930 - val_loss: 0.0924 - val_acc: 0.9801
Epoch 13/20
 - 2s - loss: 0.0231 - acc: 0.9935 - val_loss: 0.1066 - val_acc: 0.9809
Epoch 14/20
 - 2s - loss: 0.0225 - acc: 0.9938 - val_loss: 0.1083 - val_acc: 0.9810
Epoch 15/20
 - 2s - loss: 0.0239 - acc: 0.9939 - val_loss: 0.0986 - val_acc: 0.9820
Epoch 16/20
 - 2s - loss: 0.0210 - acc: 0.9943 - val_loss: 0.1151 - val_acc: 0.9817
Epoch 17/20
 - 2s - loss: 0.0231 - acc: 0.9939 - val_loss: 0.1300 - val_acc: 0.9805
Epoch 18/20
 - 2s - loss: 0.0207 - acc: 0.9948 - val_loss: 0.1098 - val_acc: 0.9823
Epoch 19/20
 - 2s - loss: 0.0184 - acc: 0.9951 - val_loss: 0.1133 - val_acc: 0.9828
Epoch 20/20
 - 2s - loss: 0.0187 - acc: 0.9955 - val_loss: 0.1113 - val_acc: 0.9828
Test loss: 0.11129689848536145
Test accuracy: 0.9828
Stochastic model
Stochastic layer using a bit size of 32
Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 5s - loss: 0.9168 - acc: 0.7030 - val_loss: 0.6306 - val_acc: 0.7978
Epoch 2/20
 - 4s - loss: 0.4300 - acc: 0.8629 - val_loss: 0.4424 - val_acc: 0.8531
Epoch 3/20
 - 4s - loss: 0.3245 - acc: 0.8982 - val_loss: 0.2269 - val_acc: 0.9303
Epoch 4/20
 - 4s - loss: 0.2749 - acc: 0.9141 - val_loss: 0.2008 - val_acc: 0.9369
Epoch 5/20
 - 4s - loss: 0.2400 - acc: 0.9273 - val_loss: 0.1721 - val_acc: 0.9457
Epoch 6/20
 - 4s - loss: 0.2191 - acc: 0.9319 - val_loss: 0.1585 - val_acc: 0.9503
Epoch 7/20
 - 4s - loss: 0.2029 - acc: 0.9373 - val_loss: 0.1517 - val_acc: 0.9551
Epoch 8/20
 - 4s - loss: 0.1965 - acc: 0.9397 - val_loss: 0.1078 - val_acc: 0.9651
Epoch 9/20
 - 4s - loss: 0.1862 - acc: 0.9434 - val_loss: 0.1160 - val_acc: 0.9660
Epoch 10/20
 - 4s - loss: 0.1860 - acc: 0.9439 - val_loss: 0.1075 - val_acc: 0.9674
Epoch 11/20
 - 4s - loss: 0.1791 - acc: 0.9473 - val_loss: 0.1037 - val_acc: 0.9683
Epoch 12/20
 - 4s - loss: 0.1738 - acc: 0.9487 - val_loss: 0.1107 - val_acc: 0.9662
Epoch 13/20
 - 4s - loss: 0.1667 - acc: 0.9508 - val_loss: 0.1243 - val_acc: 0.9634
Epoch 14/20
 - 4s - loss: 0.1661 - acc: 0.9513 - val_loss: 0.1363 - val_acc: 0.9573
Epoch 15/20
 - 4s - loss: 0.1669 - acc: 0.9512 - val_loss: 0.0996 - val_acc: 0.9703
Epoch 16/20
 - 4s - loss: 0.1656 - acc: 0.9517 - val_loss: 0.1617 - val_acc: 0.9498
Epoch 17/20
 - 4s - loss: 0.1645 - acc: 0.9528 - val_loss: 0.1414 - val_acc: 0.9570
Epoch 18/20
 - 4s - loss: 0.1621 - acc: 0.9538 - val_loss: 0.0974 - val_acc: 0.9723
Epoch 19/20
 - 4s - loss: 0.1619 - acc: 0.9540 - val_loss: 0.0957 - val_acc: 0.9704
Epoch 20/20
 - 4s - loss: 0.1624 - acc: 0.9546 - val_loss: 0.0977 - val_acc: 0.9718
Test loss: 0.09739796266548802
Test accuracy: 0.9718
30000 train samples
10000 test samples
Normal model
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.3353 - acc: 0.8971 - val_loss: 0.2176 - val_acc: 0.9289
Epoch 2/20
 - 1s - loss: 0.1342 - acc: 0.9579 - val_loss: 0.1259 - val_acc: 0.9603
Epoch 3/20
 - 1s - loss: 0.0917 - acc: 0.9714 - val_loss: 0.0998 - val_acc: 0.9693
Epoch 4/20
 - 1s - loss: 0.0672 - acc: 0.9788 - val_loss: 0.1011 - val_acc: 0.9698
Epoch 5/20
 - 1s - loss: 0.0556 - acc: 0.9827 - val_loss: 0.1001 - val_acc: 0.9730
Epoch 6/20
 - 1s - loss: 0.0463 - acc: 0.9853 - val_loss: 0.1028 - val_acc: 0.9754
Epoch 7/20
 - 1s - loss: 0.0373 - acc: 0.9882 - val_loss: 0.1486 - val_acc: 0.9646
Epoch 8/20
 - 1s - loss: 0.0325 - acc: 0.9891 - val_loss: 0.1112 - val_acc: 0.9735
Epoch 9/20
 - 1s - loss: 0.0284 - acc: 0.9915 - val_loss: 0.1081 - val_acc: 0.9751
Epoch 10/20
 - 1s - loss: 0.0269 - acc: 0.9914 - val_loss: 0.1091 - val_acc: 0.9781
Epoch 11/20
 - 1s - loss: 0.0228 - acc: 0.9933 - val_loss: 0.1237 - val_acc: 0.9747
Epoch 12/20
 - 1s - loss: 0.0224 - acc: 0.9932 - val_loss: 0.1264 - val_acc: 0.9755
Epoch 13/20
 - 1s - loss: 0.0172 - acc: 0.9944 - val_loss: 0.1330 - val_acc: 0.9723
Epoch 14/20
 - 1s - loss: 0.0178 - acc: 0.9945 - val_loss: 0.1259 - val_acc: 0.9766
Epoch 15/20
 - 1s - loss: 0.0166 - acc: 0.9953 - val_loss: 0.1175 - val_acc: 0.9787
Epoch 16/20
 - 1s - loss: 0.0131 - acc: 0.9955 - val_loss: 0.1280 - val_acc: 0.9781
Epoch 17/20
 - 1s - loss: 0.0142 - acc: 0.9962 - val_loss: 0.1332 - val_acc: 0.9796
Epoch 18/20
 - 1s - loss: 0.0138 - acc: 0.9954 - val_loss: 0.1493 - val_acc: 0.9758
Epoch 19/20
 - 1s - loss: 0.0103 - acc: 0.9968 - val_loss: 0.1332 - val_acc: 0.9778
Epoch 20/20
 - 1s - loss: 0.0130 - acc: 0.9964 - val_loss: 0.1400 - val_acc: 0.9786
Test loss: 0.13998388094659087
Test accuracy: 0.9786
Stochastic model
Stochastic layer using a bit size of 32
Train on 30000 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.2384 - acc: 0.5937 - val_loss: 0.8389 - val_acc: 0.7345
Epoch 2/20
 - 2s - loss: 0.6118 - acc: 0.8007 - val_loss: 0.4981 - val_acc: 0.8358
Epoch 3/20
 - 2s - loss: 0.4852 - acc: 0.8456 - val_loss: 0.4243 - val_acc: 0.8683
Epoch 4/20
 - 2s - loss: 0.3825 - acc: 0.8791 - val_loss: 0.5955 - val_acc: 0.8109
Epoch 5/20
 - 2s - loss: 0.3310 - acc: 0.8960 - val_loss: 0.3022 - val_acc: 0.9001
Epoch 6/20
 - 2s - loss: 0.2938 - acc: 0.9067 - val_loss: 0.3369 - val_acc: 0.8971
Epoch 7/20
 - 2s - loss: 0.2699 - acc: 0.9155 - val_loss: 0.2496 - val_acc: 0.9144
Epoch 8/20
 - 2s - loss: 0.2452 - acc: 0.9216 - val_loss: 0.2416 - val_acc: 0.9203
Epoch 9/20
 - 2s - loss: 0.2304 - acc: 0.9270 - val_loss: 0.1857 - val_acc: 0.9436
Epoch 10/20
 - 2s - loss: 0.2111 - acc: 0.9352 - val_loss: 0.2932 - val_acc: 0.9066
Epoch 11/20
 - 2s - loss: 0.2097 - acc: 0.9360 - val_loss: 0.1937 - val_acc: 0.9412
Epoch 12/20
 - 2s - loss: 0.1942 - acc: 0.9404 - val_loss: 0.1339 - val_acc: 0.9583
Epoch 13/20
 - 2s - loss: 0.1834 - acc: 0.9425 - val_loss: 0.1824 - val_acc: 0.9460
Epoch 14/20
 - 2s - loss: 0.1814 - acc: 0.9442 - val_loss: 0.1754 - val_acc: 0.9476
Epoch 15/20
 - 2s - loss: 0.1750 - acc: 0.9464 - val_loss: 0.1863 - val_acc: 0.9465
Epoch 16/20
 - 2s - loss: 0.1717 - acc: 0.9475 - val_loss: 0.1768 - val_acc: 0.9463
Epoch 17/20
 - 2s - loss: 0.1720 - acc: 0.9482 - val_loss: 0.1752 - val_acc: 0.9446
Epoch 18/20
 - 2s - loss: 0.1623 - acc: 0.9508 - val_loss: 0.1740 - val_acc: 0.9436
Epoch 19/20
 - 2s - loss: 0.1555 - acc: 0.9524 - val_loss: 0.1391 - val_acc: 0.9593
Epoch 20/20
 - 2s - loss: 0.1580 - acc: 0.9531 - val_loss: 0.1481 - val_acc: 0.9572
Test loss: 0.1476742230707081
Test accuracy: 0.9569
15000 train samples
10000 test samples
Normal model
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.4563 - acc: 0.8561 - val_loss: 0.2299 - val_acc: 0.9264
Epoch 2/20
 - 1s - loss: 0.1861 - acc: 0.9429 - val_loss: 0.2564 - val_acc: 0.9164
Epoch 3/20
 - 1s - loss: 0.1200 - acc: 0.9625 - val_loss: 0.1394 - val_acc: 0.9557
Epoch 4/20
 - 1s - loss: 0.0856 - acc: 0.9731 - val_loss: 0.1300 - val_acc: 0.9599
Epoch 5/20
 - 1s - loss: 0.0637 - acc: 0.9803 - val_loss: 0.1394 - val_acc: 0.9608
Epoch 6/20
 - 1s - loss: 0.0487 - acc: 0.9849 - val_loss: 0.1222 - val_acc: 0.9642
Epoch 7/20
 - 1s - loss: 0.0376 - acc: 0.9874 - val_loss: 0.1456 - val_acc: 0.9656
Epoch 8/20
 - 1s - loss: 0.0315 - acc: 0.9897 - val_loss: 0.1476 - val_acc: 0.9686
Epoch 9/20
 - 1s - loss: 0.0258 - acc: 0.9913 - val_loss: 0.1369 - val_acc: 0.9686
Epoch 10/20
 - 1s - loss: 0.0233 - acc: 0.9922 - val_loss: 0.1480 - val_acc: 0.9669
Epoch 11/20
 - 1s - loss: 0.0164 - acc: 0.9940 - val_loss: 0.1510 - val_acc: 0.9692
Epoch 12/20
 - 1s - loss: 0.0170 - acc: 0.9933 - val_loss: 0.1649 - val_acc: 0.9665
Epoch 13/20
 - 1s - loss: 0.0158 - acc: 0.9941 - val_loss: 0.1775 - val_acc: 0.9687
Epoch 14/20
 - 1s - loss: 0.0121 - acc: 0.9962 - val_loss: 0.1784 - val_acc: 0.9685
Epoch 15/20
 - 1s - loss: 0.0130 - acc: 0.9954 - val_loss: 0.1928 - val_acc: 0.9681
Epoch 16/20
 - 1s - loss: 0.0126 - acc: 0.9959 - val_loss: 0.1636 - val_acc: 0.9728
Epoch 17/20
 - 1s - loss: 0.0125 - acc: 0.9961 - val_loss: 0.1735 - val_acc: 0.9715
Epoch 18/20
 - 1s - loss: 0.0113 - acc: 0.9963 - val_loss: 0.1694 - val_acc: 0.9720
Epoch 19/20
 - 1s - loss: 0.0079 - acc: 0.9975 - val_loss: 0.1795 - val_acc: 0.9704
Epoch 20/20
 - 1s - loss: 0.0097 - acc: 0.9974 - val_loss: 0.2046 - val_acc: 0.9681
Test loss: 0.20463750684896073
Test accuracy: 0.9681
Stochastic model
Stochastic layer using a bit size of 32
Train on 15000 samples, validate on 10000 samples
Epoch 1/20
 - 2s - loss: 1.6267 - acc: 0.4875 - val_loss: 1.3649 - val_acc: 0.5394
Epoch 2/20
 - 1s - loss: 0.8546 - acc: 0.7243 - val_loss: 0.8288 - val_acc: 0.7204
Epoch 3/20
 - 1s - loss: 0.6666 - acc: 0.7802 - val_loss: 0.5905 - val_acc: 0.7997
Epoch 4/20
 - 1s - loss: 0.5611 - acc: 0.8240 - val_loss: 0.4614 - val_acc: 0.8441
Epoch 5/20
 - 1s - loss: 0.4707 - acc: 0.8485 - val_loss: 0.8865 - val_acc: 0.7071
Epoch 6/20
 - 1s - loss: 0.4266 - acc: 0.8638 - val_loss: 0.3660 - val_acc: 0.8764
Epoch 7/20
 - 1s - loss: 0.3832 - acc: 0.8779 - val_loss: 0.3774 - val_acc: 0.8799
Epoch 8/20
 - 1s - loss: 0.3426 - acc: 0.8905 - val_loss: 0.3659 - val_acc: 0.8832
Epoch 9/20
 - 1s - loss: 0.3112 - acc: 0.9013 - val_loss: 0.2551 - val_acc: 0.9152
Epoch 10/20
 - 1s - loss: 0.2924 - acc: 0.9070 - val_loss: 0.4816 - val_acc: 0.8524
Epoch 11/20
 - 1s - loss: 0.2710 - acc: 0.9161 - val_loss: 0.3806 - val_acc: 0.8710
Epoch 12/20
 - 1s - loss: 0.2618 - acc: 0.9147 - val_loss: 0.6844 - val_acc: 0.7830
Epoch 13/20
 - 1s - loss: 0.2442 - acc: 0.9223 - val_loss: 0.4114 - val_acc: 0.8625
Epoch 14/20
 - 1s - loss: 0.2329 - acc: 0.9273 - val_loss: 0.9841 - val_acc: 0.7232
Epoch 15/20
 - 1s - loss: 0.2352 - acc: 0.9269 - val_loss: 0.3010 - val_acc: 0.8996
Epoch 16/20
 - 1s - loss: 0.2123 - acc: 0.9316 - val_loss: 0.2026 - val_acc: 0.9392
Epoch 17/20
 - 1s - loss: 0.1978 - acc: 0.9381 - val_loss: 0.3336 - val_acc: 0.8981
Epoch 18/20
 - 1s - loss: 0.1960 - acc: 0.9390 - val_loss: 0.4516 - val_acc: 0.8495
Epoch 19/20
 - 1s - loss: 0.1915 - acc: 0.9391 - val_loss: 0.2494 - val_acc: 0.9099
Epoch 20/20
 - 1s - loss: 0.1806 - acc: 0.9423 - val_loss: 0.2968 - val_acc: 0.9065
Test loss: 0.296692368099466
Test accuracy: 0.9038
7500 train samples
10000 test samples
Normal model
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 4s - loss: 0.5682 - acc: 0.8229 - val_loss: 0.3628 - val_acc: 0.8862
Epoch 2/20
 - 0s - loss: 0.2451 - acc: 0.9247 - val_loss: 0.2548 - val_acc: 0.9239
Epoch 3/20
 - 0s - loss: 0.1650 - acc: 0.9496 - val_loss: 0.2224 - val_acc: 0.9309
Epoch 4/20
 - 0s - loss: 0.1157 - acc: 0.9647 - val_loss: 0.1840 - val_acc: 0.9428
Epoch 5/20
 - 0s - loss: 0.0871 - acc: 0.9729 - val_loss: 0.2054 - val_acc: 0.9389
Epoch 6/20
 - 0s - loss: 0.0642 - acc: 0.9800 - val_loss: 0.2159 - val_acc: 0.9408
Epoch 7/20
 - 0s - loss: 0.0455 - acc: 0.9853 - val_loss: 0.2072 - val_acc: 0.9438
Epoch 8/20
 - 0s - loss: 0.0332 - acc: 0.9899 - val_loss: 0.1835 - val_acc: 0.9515
Epoch 9/20
 - 0s - loss: 0.0285 - acc: 0.9917 - val_loss: 0.2145 - val_acc: 0.9513
Epoch 10/20
 - 0s - loss: 0.0237 - acc: 0.9923 - val_loss: 0.1972 - val_acc: 0.9547
Epoch 11/20
 - 0s - loss: 0.0197 - acc: 0.9937 - val_loss: 0.2008 - val_acc: 0.9535
Epoch 12/20
 - 0s - loss: 0.0197 - acc: 0.9940 - val_loss: 0.2125 - val_acc: 0.9548
Epoch 13/20
 - 0s - loss: 0.0131 - acc: 0.9960 - val_loss: 0.2287 - val_acc: 0.9550
Epoch 14/20
 - 0s - loss: 0.0123 - acc: 0.9967 - val_loss: 0.2232 - val_acc: 0.9536
Epoch 15/20
 - 0s - loss: 0.0125 - acc: 0.9955 - val_loss: 0.2650 - val_acc: 0.9448
Epoch 16/20
 - 0s - loss: 0.0100 - acc: 0.9967 - val_loss: 0.2297 - val_acc: 0.9566
Epoch 17/20
 - 0s - loss: 0.0065 - acc: 0.9973 - val_loss: 0.2430 - val_acc: 0.9553
Epoch 18/20
 - 0s - loss: 0.0054 - acc: 0.9979 - val_loss: 0.2375 - val_acc: 0.9576
Epoch 19/20
 - 0s - loss: 0.0093 - acc: 0.9972 - val_loss: 0.2787 - val_acc: 0.9552
Epoch 20/20
 - 0s - loss: 0.0072 - acc: 0.9972 - val_loss: 0.2672 - val_acc: 0.9563
Test loss: 0.26722912027405515
Test accuracy: 0.9563
Stochastic model
Stochastic layer using a bit size of 32
Train on 7500 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.0424 - acc: 0.3551 - val_loss: 1.3092 - val_acc: 0.4912
Epoch 2/20
 - 1s - loss: 1.1690 - acc: 0.6128 - val_loss: 0.7478 - val_acc: 0.7981
Epoch 3/20
 - 1s - loss: 0.8643 - acc: 0.7148 - val_loss: 0.7898 - val_acc: 0.7334
Epoch 4/20
 - 1s - loss: 0.7246 - acc: 0.7569 - val_loss: 1.1088 - val_acc: 0.6608
Epoch 5/20
 - 1s - loss: 0.6674 - acc: 0.7825 - val_loss: 0.4767 - val_acc: 0.8435
Epoch 6/20
 - 1s - loss: 0.5707 - acc: 0.8209 - val_loss: 0.5534 - val_acc: 0.8229
Epoch 7/20
 - 1s - loss: 0.5376 - acc: 0.8264 - val_loss: 0.5925 - val_acc: 0.8006
Epoch 8/20
 - 1s - loss: 0.4914 - acc: 0.8424 - val_loss: 0.4853 - val_acc: 0.8457
Epoch 9/20
 - 1s - loss: 0.4583 - acc: 0.8516 - val_loss: 0.4266 - val_acc: 0.8661
Epoch 10/20
 - 1s - loss: 0.4180 - acc: 0.8647 - val_loss: 0.3328 - val_acc: 0.8934
Epoch 11/20
 - 1s - loss: 0.3933 - acc: 0.8743 - val_loss: 0.4026 - val_acc: 0.8670
Epoch 12/20
 - 1s - loss: 0.3644 - acc: 0.8839 - val_loss: 0.3474 - val_acc: 0.8884
Epoch 13/20
 - 1s - loss: 0.3688 - acc: 0.8833 - val_loss: 0.2862 - val_acc: 0.9095
Epoch 14/20
 - 1s - loss: 0.3236 - acc: 0.8980 - val_loss: 0.2936 - val_acc: 0.9067
Epoch 15/20
 - 1s - loss: 0.3199 - acc: 0.8959 - val_loss: 0.2729 - val_acc: 0.9174
Epoch 16/20
 - 1s - loss: 0.3120 - acc: 0.8999 - val_loss: 0.3894 - val_acc: 0.8720
Epoch 17/20
 - 1s - loss: 0.2895 - acc: 0.9125 - val_loss: 0.4148 - val_acc: 0.8635
Epoch 18/20
 - 1s - loss: 0.2823 - acc: 0.9111 - val_loss: 0.4138 - val_acc: 0.8789
Epoch 19/20
 - 1s - loss: 0.2745 - acc: 0.9135 - val_loss: 0.2840 - val_acc: 0.9108
Epoch 20/20
 - 1s - loss: 0.2530 - acc: 0.9149 - val_loss: 0.3720 - val_acc: 0.8868
Test loss: 0.3728400418281555
Test accuracy: 0.8849
3750 train samples
10000 test samples
Normal model
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 0.8409 - acc: 0.7373 - val_loss: 0.4012 - val_acc: 0.8803
Epoch 2/20
 - 0s - loss: 0.3429 - acc: 0.8984 - val_loss: 0.3875 - val_acc: 0.8791
Epoch 3/20
 - 0s - loss: 0.2395 - acc: 0.9328 - val_loss: 0.2555 - val_acc: 0.9235
Epoch 4/20
 - 0s - loss: 0.1650 - acc: 0.9520 - val_loss: 0.2733 - val_acc: 0.9157
Epoch 5/20
 - 0s - loss: 0.1180 - acc: 0.9653 - val_loss: 0.2505 - val_acc: 0.9235
Epoch 6/20
 - 0s - loss: 0.0900 - acc: 0.9712 - val_loss: 0.2963 - val_acc: 0.9134
Epoch 7/20
 - 0s - loss: 0.0625 - acc: 0.9819 - val_loss: 0.2573 - val_acc: 0.9254
Epoch 8/20
 - 0s - loss: 0.0532 - acc: 0.9843 - val_loss: 0.3408 - val_acc: 0.9036
Epoch 9/20
 - 0s - loss: 0.0474 - acc: 0.9872 - val_loss: 0.2473 - val_acc: 0.9353
Epoch 10/20
 - 0s - loss: 0.0231 - acc: 0.9941 - val_loss: 0.2554 - val_acc: 0.9353
Epoch 11/20
 - 0s - loss: 0.0264 - acc: 0.9917 - val_loss: 0.2453 - val_acc: 0.9413
Epoch 12/20
 - 0s - loss: 0.0155 - acc: 0.9963 - val_loss: 0.2449 - val_acc: 0.9368
Epoch 13/20
 - 0s - loss: 0.0274 - acc: 0.9923 - val_loss: 0.2720 - val_acc: 0.9372
Epoch 14/20
 - 0s - loss: 0.0050 - acc: 0.9997 - val_loss: 0.4158 - val_acc: 0.9113
Epoch 15/20
 - 0s - loss: 0.0126 - acc: 0.9965 - val_loss: 0.2571 - val_acc: 0.9426
Epoch 16/20
 - 0s - loss: 0.0100 - acc: 0.9963 - val_loss: 0.3258 - val_acc: 0.9329
Epoch 17/20
 - 0s - loss: 0.0089 - acc: 0.9968 - val_loss: 0.3076 - val_acc: 0.9378
Epoch 18/20
 - 0s - loss: 0.0078 - acc: 0.9979 - val_loss: 0.3071 - val_acc: 0.9409
Epoch 19/20
 - 0s - loss: 0.0110 - acc: 0.9963 - val_loss: 0.2808 - val_acc: 0.9436
Epoch 20/20
 - 0s - loss: 0.0051 - acc: 0.9981 - val_loss: 0.2956 - val_acc: 0.9426
Test loss: 0.2955579556506076
Test accuracy: 0.9426
Stochastic model
Stochastic layer using a bit size of 32
Train on 3750 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6931 - acc: 0.2243 - val_loss: 2.2104 - val_acc: 0.1669
Epoch 2/20
 - 1s - loss: 1.6454 - acc: 0.4571 - val_loss: 1.3807 - val_acc: 0.4727
Epoch 3/20
 - 1s - loss: 1.2566 - acc: 0.5651 - val_loss: 1.3066 - val_acc: 0.5856
Epoch 4/20
 - 1s - loss: 1.0535 - acc: 0.6347 - val_loss: 0.8533 - val_acc: 0.6953
Epoch 5/20
 - 1s - loss: 0.9382 - acc: 0.6856 - val_loss: 1.2474 - val_acc: 0.5761
Epoch 6/20
 - 1s - loss: 0.8679 - acc: 0.7117 - val_loss: 0.9588 - val_acc: 0.6767
Epoch 7/20
 - 1s - loss: 0.7714 - acc: 0.7373 - val_loss: 0.5920 - val_acc: 0.8072
Epoch 8/20
 - 1s - loss: 0.7311 - acc: 0.7592 - val_loss: 0.7401 - val_acc: 0.7364
Epoch 9/20
 - 1s - loss: 0.6413 - acc: 0.7904 - val_loss: 0.5259 - val_acc: 0.8136
Epoch 10/20
 - 1s - loss: 0.6156 - acc: 0.7987 - val_loss: 0.5116 - val_acc: 0.8263
Epoch 11/20
 - 1s - loss: 0.5825 - acc: 0.8077 - val_loss: 0.8350 - val_acc: 0.7107
Epoch 12/20
 - 1s - loss: 0.5527 - acc: 0.8192 - val_loss: 0.9240 - val_acc: 0.7257
Epoch 13/20
 - 1s - loss: 0.5290 - acc: 0.8275 - val_loss: 0.6150 - val_acc: 0.7858
Epoch 14/20
 - 1s - loss: 0.4898 - acc: 0.8421 - val_loss: 0.4299 - val_acc: 0.8589
Epoch 15/20
 - 1s - loss: 0.4857 - acc: 0.8373 - val_loss: 0.4164 - val_acc: 0.8602
Epoch 16/20
 - 1s - loss: 0.4930 - acc: 0.8416 - val_loss: 0.3397 - val_acc: 0.8976
Epoch 17/20
 - 1s - loss: 0.4429 - acc: 0.8587 - val_loss: 0.4709 - val_acc: 0.8568
Epoch 18/20
 - 1s - loss: 0.4310 - acc: 0.8611 - val_loss: 1.4539 - val_acc: 0.5438
Epoch 19/20
 - 1s - loss: 0.4089 - acc: 0.8643 - val_loss: 0.3841 - val_acc: 0.8822
Epoch 20/20
 - 1s - loss: 0.4066 - acc: 0.8595 - val_loss: 0.4147 - val_acc: 0.8724
Test loss: 0.4158793635129929
Test accuracy: 0.8722
1875 train samples
10000 test samples
Normal model
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.1889 - acc: 0.6171 - val_loss: 0.6411 - val_acc: 0.8060
Epoch 2/20
 - 0s - loss: 0.4632 - acc: 0.8688 - val_loss: 0.4906 - val_acc: 0.8392
Epoch 3/20
 - 0s - loss: 0.3188 - acc: 0.9109 - val_loss: 0.4915 - val_acc: 0.8547
Epoch 4/20
 - 0s - loss: 0.2470 - acc: 0.9211 - val_loss: 0.3945 - val_acc: 0.8754
Epoch 5/20
 - 0s - loss: 0.1775 - acc: 0.9536 - val_loss: 0.3169 - val_acc: 0.9057
Epoch 6/20
 - 0s - loss: 0.1491 - acc: 0.9584 - val_loss: 0.3511 - val_acc: 0.8916
Epoch 7/20
 - 0s - loss: 0.1021 - acc: 0.9749 - val_loss: 0.3303 - val_acc: 0.9016
Epoch 8/20
 - 0s - loss: 0.0978 - acc: 0.9707 - val_loss: 0.3347 - val_acc: 0.9055
Epoch 9/20
 - 0s - loss: 0.0560 - acc: 0.9840 - val_loss: 0.4072 - val_acc: 0.8825
Epoch 10/20
 - 0s - loss: 0.0595 - acc: 0.9824 - val_loss: 0.3318 - val_acc: 0.9081
Epoch 11/20
 - 0s - loss: 0.0362 - acc: 0.9915 - val_loss: 0.3925 - val_acc: 0.8992
Epoch 12/20
 - 0s - loss: 0.0359 - acc: 0.9877 - val_loss: 0.3064 - val_acc: 0.9187
Epoch 13/20
 - 0s - loss: 0.0146 - acc: 0.9984 - val_loss: 0.3456 - val_acc: 0.9148
Epoch 14/20
 - 0s - loss: 0.0272 - acc: 0.9925 - val_loss: 0.3324 - val_acc: 0.9179
Epoch 15/20
 - 0s - loss: 0.0108 - acc: 0.9979 - val_loss: 0.3441 - val_acc: 0.9187
Epoch 16/20
 - 0s - loss: 0.0313 - acc: 0.9872 - val_loss: 0.3544 - val_acc: 0.9142
Epoch 17/20
 - 0s - loss: 0.0053 - acc: 0.9995 - val_loss: 0.3663 - val_acc: 0.9108
Epoch 18/20
 - 0s - loss: 0.0378 - acc: 0.9888 - val_loss: 0.3443 - val_acc: 0.9193
Epoch 19/20
 - 0s - loss: 0.0107 - acc: 0.9973 - val_loss: 0.3540 - val_acc: 0.9189
Epoch 20/20
 - 0s - loss: 0.0018 - acc: 1.0000 - val_loss: 0.3509 - val_acc: 0.9220
Test loss: 0.35086104560336095
Test accuracy: 0.922
Stochastic model
Stochastic layer using a bit size of 32
Train on 1875 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.1822 - acc: 0.1936 - val_loss: 2.1691 - val_acc: 0.1292
Epoch 2/20
 - 1s - loss: 2.0201 - acc: 0.3109 - val_loss: 1.8876 - val_acc: 0.2684
Epoch 3/20
 - 1s - loss: 1.7319 - acc: 0.4144 - val_loss: 1.6359 - val_acc: 0.4904
Epoch 4/20
 - 1s - loss: 1.4717 - acc: 0.5291 - val_loss: 1.4145 - val_acc: 0.5273
Epoch 5/20
 - 1s - loss: 1.3281 - acc: 0.5579 - val_loss: 1.0763 - val_acc: 0.6342
Epoch 6/20
 - 1s - loss: 1.1443 - acc: 0.6251 - val_loss: 1.3278 - val_acc: 0.5537
Epoch 7/20
 - 1s - loss: 1.0705 - acc: 0.6416 - val_loss: 1.0338 - val_acc: 0.6670
Epoch 8/20
 - 1s - loss: 0.9173 - acc: 0.7019 - val_loss: 0.9872 - val_acc: 0.6408
Epoch 9/20
 - 1s - loss: 0.9366 - acc: 0.6891 - val_loss: 1.1102 - val_acc: 0.5893
Epoch 10/20
 - 1s - loss: 0.8585 - acc: 0.7168 - val_loss: 0.7378 - val_acc: 0.7616
Epoch 11/20
 - 1s - loss: 0.8313 - acc: 0.7403 - val_loss: 0.6085 - val_acc: 0.7787
Epoch 12/20
 - 1s - loss: 0.8527 - acc: 0.7205 - val_loss: 0.9332 - val_acc: 0.6864
Epoch 13/20
 - 1s - loss: 0.7067 - acc: 0.7712 - val_loss: 0.8097 - val_acc: 0.7392
Epoch 14/20
 - 1s - loss: 0.7160 - acc: 0.7925 - val_loss: 0.5362 - val_acc: 0.8326
Epoch 15/20
 - 1s - loss: 0.7192 - acc: 0.7621 - val_loss: 1.2755 - val_acc: 0.6232
Epoch 16/20
 - 1s - loss: 0.6936 - acc: 0.7819 - val_loss: 0.7411 - val_acc: 0.7445
Epoch 17/20
 - 1s - loss: 0.6443 - acc: 0.7781 - val_loss: 0.5136 - val_acc: 0.8352
Epoch 18/20
 - 1s - loss: 0.6378 - acc: 0.7867 - val_loss: 0.5797 - val_acc: 0.7938
Epoch 19/20
 - 1s - loss: 0.6515 - acc: 0.7941 - val_loss: 0.4605 - val_acc: 0.8561
Epoch 20/20
 - 1s - loss: 0.5531 - acc: 0.8213 - val_loss: 0.4949 - val_acc: 0.8444
Test loss: 0.4955317313790321
Test accuracy: 0.842
937 train samples
10000 test samples
Normal model
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.5327 - acc: 0.4856 - val_loss: 0.8508 - val_acc: 0.7442
Epoch 2/20
 - 0s - loss: 0.6278 - acc: 0.8164 - val_loss: 0.6408 - val_acc: 0.7866
Epoch 3/20
 - 0s - loss: 0.4040 - acc: 0.8805 - val_loss: 0.7355 - val_acc: 0.7810
Epoch 4/20
 - 0s - loss: 0.3661 - acc: 0.8975 - val_loss: 0.5761 - val_acc: 0.8240
Epoch 5/20
 - 0s - loss: 0.2727 - acc: 0.9104 - val_loss: 0.4238 - val_acc: 0.8645
Epoch 6/20
 - 0s - loss: 0.1789 - acc: 0.9573 - val_loss: 0.4613 - val_acc: 0.8566
Epoch 7/20
 - 0s - loss: 0.1306 - acc: 0.9669 - val_loss: 0.4335 - val_acc: 0.8620
Epoch 8/20
 - 0s - loss: 0.1197 - acc: 0.9658 - val_loss: 0.4174 - val_acc: 0.8779
Epoch 9/20
 - 0s - loss: 0.0793 - acc: 0.9829 - val_loss: 0.4524 - val_acc: 0.8702
Epoch 10/20
 - 0s - loss: 0.0475 - acc: 0.9915 - val_loss: 0.4021 - val_acc: 0.8804
Epoch 11/20
 - 0s - loss: 0.0934 - acc: 0.9733 - val_loss: 0.5510 - val_acc: 0.8471
Epoch 12/20
 - 0s - loss: 0.0430 - acc: 0.9925 - val_loss: 0.3939 - val_acc: 0.8905
Epoch 13/20
 - 0s - loss: 0.0230 - acc: 0.9968 - val_loss: 0.4033 - val_acc: 0.8898
Epoch 14/20
 - 0s - loss: 0.0140 - acc: 1.0000 - val_loss: 0.5097 - val_acc: 0.8657
Epoch 15/20
 - 0s - loss: 0.0732 - acc: 0.9851 - val_loss: 0.3944 - val_acc: 0.8954
Epoch 16/20
 - 0s - loss: 0.0096 - acc: 0.9989 - val_loss: 0.4388 - val_acc: 0.8860
Epoch 17/20
 - 0s - loss: 0.0092 - acc: 0.9968 - val_loss: 0.5125 - val_acc: 0.8703
Epoch 18/20
 - 0s - loss: 0.0136 - acc: 0.9968 - val_loss: 0.4772 - val_acc: 0.8835
Epoch 19/20
 - 0s - loss: 0.0153 - acc: 0.9968 - val_loss: 0.3938 - val_acc: 0.9035
Epoch 20/20
 - 0s - loss: 0.0042 - acc: 0.9989 - val_loss: 0.4590 - val_acc: 0.8942
Test loss: 0.45900067272810263
Test accuracy: 0.8942
Stochastic model
Stochastic layer using a bit size of 32
Train on 937 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 3.7485 - acc: 0.1377 - val_loss: 2.4869 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 2.1133 - acc: 0.2647 - val_loss: 2.2679 - val_acc: 0.0985
Epoch 3/20
 - 0s - loss: 2.0259 - acc: 0.2978 - val_loss: 1.9278 - val_acc: 0.2660
Epoch 4/20
 - 0s - loss: 1.9254 - acc: 0.3458 - val_loss: 1.6998 - val_acc: 0.4462
Epoch 5/20
 - 0s - loss: 1.6394 - acc: 0.4696 - val_loss: 2.0037 - val_acc: 0.3903
Epoch 6/20
 - 0s - loss: 1.5247 - acc: 0.5176 - val_loss: 1.4801 - val_acc: 0.4984
Epoch 7/20
 - 1s - loss: 1.3752 - acc: 0.5283 - val_loss: 1.9692 - val_acc: 0.3253
Epoch 8/20
 - 0s - loss: 1.5334 - acc: 0.5080 - val_loss: 1.4134 - val_acc: 0.5787
Epoch 9/20
 - 0s - loss: 1.1327 - acc: 0.6233 - val_loss: 1.2170 - val_acc: 0.6255
Epoch 10/20
 - 0s - loss: 1.2024 - acc: 0.6115 - val_loss: 1.3166 - val_acc: 0.5592
Epoch 11/20
 - 0s - loss: 1.1573 - acc: 0.6094 - val_loss: 1.4726 - val_acc: 0.5000
Epoch 12/20
 - 1s - loss: 0.9519 - acc: 0.6852 - val_loss: 1.2180 - val_acc: 0.5910
Epoch 13/20
 - 0s - loss: 1.1302 - acc: 0.6158 - val_loss: 1.1184 - val_acc: 0.5903
Epoch 14/20
 - 0s - loss: 0.8901 - acc: 0.7022 - val_loss: 1.4988 - val_acc: 0.5029
Epoch 15/20
 - 0s - loss: 0.9497 - acc: 0.7022 - val_loss: 1.3331 - val_acc: 0.5905
Epoch 16/20
 - 0s - loss: 0.8610 - acc: 0.7118 - val_loss: 0.9677 - val_acc: 0.6601
Epoch 17/20
 - 0s - loss: 0.9369 - acc: 0.7012 - val_loss: 0.8025 - val_acc: 0.7419
Epoch 18/20
 - 0s - loss: 0.8107 - acc: 0.7375 - val_loss: 0.9664 - val_acc: 0.6670
Epoch 19/20
 - 0s - loss: 0.8143 - acc: 0.7353 - val_loss: 0.6339 - val_acc: 0.7917
Epoch 20/20
 - 0s - loss: 0.7996 - acc: 0.7321 - val_loss: 0.6711 - val_acc: 0.7723
Test loss: 0.671261557674408
Test accuracy: 0.7722
468 train samples
10000 test samples
Normal model
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 1.6930 - acc: 0.4338 - val_loss: 1.3694 - val_acc: 0.5689
Epoch 2/20
 - 0s - loss: 0.8580 - acc: 0.7692 - val_loss: 0.7817 - val_acc: 0.7443
Epoch 3/20
 - 0s - loss: 0.4536 - acc: 0.8718 - val_loss: 0.8250 - val_acc: 0.7237
Epoch 4/20
 - 0s - loss: 0.3726 - acc: 0.9060 - val_loss: 0.6293 - val_acc: 0.7825
Epoch 5/20
 - 0s - loss: 0.2677 - acc: 0.9231 - val_loss: 0.6208 - val_acc: 0.7927
Epoch 6/20
 - 0s - loss: 0.1810 - acc: 0.9551 - val_loss: 0.6096 - val_acc: 0.7933
Epoch 7/20
 - 0s - loss: 0.1684 - acc: 0.9615 - val_loss: 0.6917 - val_acc: 0.7905
Epoch 8/20
 - 0s - loss: 0.1322 - acc: 0.9701 - val_loss: 0.5855 - val_acc: 0.8192
Epoch 9/20
 - 0s - loss: 0.0744 - acc: 0.9893 - val_loss: 0.5843 - val_acc: 0.8167
Epoch 10/20
 - 0s - loss: 0.0552 - acc: 0.9893 - val_loss: 0.5373 - val_acc: 0.8355
Epoch 11/20
 - 0s - loss: 0.0681 - acc: 0.9850 - val_loss: 0.5504 - val_acc: 0.8361
Epoch 12/20
 - 0s - loss: 0.0369 - acc: 0.9979 - val_loss: 0.5918 - val_acc: 0.8325
Epoch 13/20
 - 0s - loss: 0.0206 - acc: 1.0000 - val_loss: 0.5685 - val_acc: 0.8413
Epoch 14/20
 - 0s - loss: 0.0161 - acc: 1.0000 - val_loss: 0.5844 - val_acc: 0.8435
Epoch 15/20
 - 0s - loss: 0.0126 - acc: 1.0000 - val_loss: 0.5689 - val_acc: 0.8463
Epoch 16/20
 - 0s - loss: 0.0167 - acc: 1.0000 - val_loss: 0.7153 - val_acc: 0.8175
Epoch 17/20
 - 0s - loss: 0.0130 - acc: 1.0000 - val_loss: 0.6644 - val_acc: 0.8393
Epoch 18/20
 - 0s - loss: 0.1966 - acc: 0.9530 - val_loss: 0.6486 - val_acc: 0.8416
Epoch 19/20
 - 0s - loss: 0.0163 - acc: 0.9979 - val_loss: 0.5677 - val_acc: 0.8556
Epoch 20/20
 - 0s - loss: 0.0048 - acc: 1.0000 - val_loss: 0.5719 - val_acc: 0.8562
Test loss: 0.5719451826840639
Test accuracy: 0.8562
Stochastic model
Stochastic layer using a bit size of 32
Train on 468 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.4483 - acc: 0.1175 - val_loss: 2.2358 - val_acc: 0.1973
Epoch 2/20
 - 0s - loss: 2.3016 - acc: 0.1859 - val_loss: 2.2677 - val_acc: 0.2740
Epoch 3/20
 - 0s - loss: 2.0749 - acc: 0.2778 - val_loss: 2.0778 - val_acc: 0.3403
Epoch 4/20
 - 0s - loss: 1.9666 - acc: 0.3120 - val_loss: 2.0833 - val_acc: 0.1639
Epoch 5/20
 - 0s - loss: 1.9455 - acc: 0.3504 - val_loss: 2.0075 - val_acc: 0.2818
Epoch 6/20
 - 0s - loss: 1.8843 - acc: 0.3974 - val_loss: 1.6618 - val_acc: 0.4380
Epoch 7/20
 - 0s - loss: 1.7079 - acc: 0.4103 - val_loss: 1.8716 - val_acc: 0.4009
Epoch 8/20
 - 0s - loss: 1.6799 - acc: 0.4594 - val_loss: 2.1536 - val_acc: 0.2934
Epoch 9/20
 - 0s - loss: 1.6626 - acc: 0.4274 - val_loss: 1.5975 - val_acc: 0.3883
Epoch 10/20
 - 0s - loss: 1.4637 - acc: 0.5342 - val_loss: 1.4537 - val_acc: 0.4974
Epoch 11/20
 - 0s - loss: 1.5726 - acc: 0.4808 - val_loss: 1.5989 - val_acc: 0.4002
Epoch 12/20
 - 0s - loss: 1.2370 - acc: 0.6026 - val_loss: 1.4321 - val_acc: 0.5039
Epoch 13/20
 - 0s - loss: 1.2706 - acc: 0.5919 - val_loss: 1.4662 - val_acc: 0.5473
Epoch 14/20
 - 0s - loss: 1.1044 - acc: 0.6496 - val_loss: 1.0659 - val_acc: 0.6840
Epoch 15/20
 - 0s - loss: 1.0421 - acc: 0.6645 - val_loss: 1.6322 - val_acc: 0.4305
Epoch 16/20
 - 0s - loss: 1.2859 - acc: 0.5769 - val_loss: 1.6489 - val_acc: 0.4207
Epoch 17/20
 - 0s - loss: 1.2793 - acc: 0.6026 - val_loss: 1.1941 - val_acc: 0.6274
Epoch 18/20
 - 0s - loss: 0.8411 - acc: 0.7201 - val_loss: 1.0279 - val_acc: 0.6452
Epoch 19/20
 - 0s - loss: 0.9920 - acc: 0.6902 - val_loss: 1.8560 - val_acc: 0.4455
Epoch 20/20
 - 0s - loss: 1.1009 - acc: 0.6816 - val_loss: 1.0098 - val_acc: 0.6729
Test loss: 1.010236699104309
Test accuracy: 0.6716
234 train samples
10000 test samples
Normal model
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.2294 - acc: 0.2350 - val_loss: 1.7389 - val_acc: 0.4658
Epoch 2/20
 - 0s - loss: 1.3370 - acc: 0.6838 - val_loss: 1.2621 - val_acc: 0.6020
Epoch 3/20
 - 0s - loss: 0.8514 - acc: 0.7821 - val_loss: 1.1315 - val_acc: 0.6343
Epoch 4/20
 - 0s - loss: 0.5656 - acc: 0.8547 - val_loss: 0.9971 - val_acc: 0.6540
Epoch 5/20
 - 0s - loss: 0.4615 - acc: 0.8547 - val_loss: 0.7999 - val_acc: 0.7365
Epoch 6/20
 - 0s - loss: 0.2504 - acc: 0.9444 - val_loss: 0.8318 - val_acc: 0.7332
Epoch 7/20
 - 0s - loss: 0.2153 - acc: 0.9487 - val_loss: 0.8255 - val_acc: 0.7352
Epoch 8/20
 - 0s - loss: 0.1442 - acc: 0.9872 - val_loss: 0.7171 - val_acc: 0.7745
Epoch 9/20
 - 0s - loss: 0.1547 - acc: 0.9573 - val_loss: 0.7857 - val_acc: 0.7556
Epoch 10/20
 - 0s - loss: 0.0975 - acc: 0.9872 - val_loss: 0.7160 - val_acc: 0.7746
Epoch 11/20
 - 0s - loss: 0.0683 - acc: 1.0000 - val_loss: 0.6928 - val_acc: 0.7836
Epoch 12/20
 - 0s - loss: 0.0562 - acc: 0.9957 - val_loss: 0.7118 - val_acc: 0.7833
Epoch 13/20
 - 0s - loss: 0.0403 - acc: 1.0000 - val_loss: 0.7703 - val_acc: 0.7763
Epoch 14/20
 - 0s - loss: 0.0371 - acc: 1.0000 - val_loss: 0.7525 - val_acc: 0.7797
Epoch 15/20
 - 0s - loss: 0.0279 - acc: 1.0000 - val_loss: 0.7535 - val_acc: 0.7846
Epoch 16/20
 - 0s - loss: 0.0341 - acc: 1.0000 - val_loss: 0.8335 - val_acc: 0.7662
Epoch 17/20
 - 0s - loss: 0.0565 - acc: 0.9872 - val_loss: 0.9398 - val_acc: 0.7498
Epoch 18/20
 - 0s - loss: 0.0476 - acc: 0.9957 - val_loss: 0.9099 - val_acc: 0.7700
Epoch 19/20
 - 0s - loss: 0.0190 - acc: 1.0000 - val_loss: 0.7238 - val_acc: 0.7937
Epoch 20/20
 - 0s - loss: 0.0125 - acc: 1.0000 - val_loss: 0.7529 - val_acc: 0.7918
Test loss: 0.7528602588623762
Test accuracy: 0.7918
Stochastic model
Stochastic layer using a bit size of 32
Train on 234 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 4.5756 - acc: 0.0855 - val_loss: 8.8741 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 7.9870 - acc: 0.1496 - val_loss: 4.1343 - val_acc: 0.1035
Epoch 3/20
 - 0s - loss: 3.4399 - acc: 0.1496 - val_loss: 2.2326 - val_acc: 0.3369
Epoch 4/20
 - 0s - loss: 2.2543 - acc: 0.1667 - val_loss: 2.1389 - val_acc: 0.3117
Epoch 5/20
 - 0s - loss: 2.1389 - acc: 0.2094 - val_loss: 2.1708 - val_acc: 0.2263
Epoch 6/20
 - 0s - loss: 2.0460 - acc: 0.3077 - val_loss: 2.0632 - val_acc: 0.3229
Epoch 7/20
 - 0s - loss: 1.9902 - acc: 0.3718 - val_loss: 2.0165 - val_acc: 0.3052
Epoch 8/20
 - 0s - loss: 1.8743 - acc: 0.3462 - val_loss: 2.0690 - val_acc: 0.2151
Epoch 9/20
 - 0s - loss: 2.1028 - acc: 0.2906 - val_loss: 1.9150 - val_acc: 0.3171
Epoch 10/20
 - 0s - loss: 1.9338 - acc: 0.3162 - val_loss: 2.4682 - val_acc: 0.3164
Epoch 11/20
 - 0s - loss: 2.2270 - acc: 0.2650 - val_loss: 1.8562 - val_acc: 0.3633
Epoch 12/20
 - 0s - loss: 1.7622 - acc: 0.4573 - val_loss: 1.9853 - val_acc: 0.2582
Epoch 13/20
 - 0s - loss: 1.8434 - acc: 0.3675 - val_loss: 1.7993 - val_acc: 0.3604
Epoch 14/20
 - 0s - loss: 1.5729 - acc: 0.5128 - val_loss: 1.8001 - val_acc: 0.3617
Epoch 15/20
 - 0s - loss: 1.6473 - acc: 0.4487 - val_loss: 1.8370 - val_acc: 0.4571
Epoch 16/20
 - 0s - loss: 1.6396 - acc: 0.5000 - val_loss: 1.5906 - val_acc: 0.4530
Epoch 17/20
 - 0s - loss: 1.3561 - acc: 0.5470 - val_loss: 1.9485 - val_acc: 0.3860
Epoch 18/20
 - 0s - loss: 1.5065 - acc: 0.5128 - val_loss: 1.6494 - val_acc: 0.4858
Epoch 19/20
 - 0s - loss: 1.5713 - acc: 0.4915 - val_loss: 2.2752 - val_acc: 0.3262
Epoch 20/20
 - 0s - loss: 1.8903 - acc: 0.3932 - val_loss: 1.4949 - val_acc: 0.5303
Test loss: 1.494963631439209
Test accuracy: 0.5294
117 train samples
10000 test samples
Normal model
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 3s - loss: 2.3159 - acc: 0.1026 - val_loss: 2.0572 - val_acc: 0.2848
Epoch 2/20
 - 0s - loss: 1.5425 - acc: 0.4872 - val_loss: 1.7046 - val_acc: 0.5011
Epoch 3/20
 - 0s - loss: 1.2624 - acc: 0.6923 - val_loss: 1.5627 - val_acc: 0.4656
Epoch 4/20
 - 0s - loss: 0.8359 - acc: 0.7863 - val_loss: 1.2497 - val_acc: 0.5748
Epoch 5/20
 - 0s - loss: 0.5718 - acc: 0.8974 - val_loss: 1.2403 - val_acc: 0.5879
Epoch 6/20
 - 0s - loss: 0.4415 - acc: 0.8803 - val_loss: 1.1191 - val_acc: 0.6174
Epoch 7/20
 - 0s - loss: 0.3718 - acc: 0.9316 - val_loss: 1.1476 - val_acc: 0.6281
Epoch 8/20
 - 0s - loss: 0.2610 - acc: 0.9316 - val_loss: 1.0257 - val_acc: 0.6420
Epoch 9/20
 - 0s - loss: 0.1545 - acc: 0.9829 - val_loss: 0.9677 - val_acc: 0.7052
Epoch 10/20
 - 0s - loss: 0.1081 - acc: 1.0000 - val_loss: 0.9878 - val_acc: 0.6792
Epoch 11/20
 - 0s - loss: 0.0943 - acc: 0.9915 - val_loss: 0.9878 - val_acc: 0.7016
Epoch 12/20
 - 0s - loss: 0.0688 - acc: 1.0000 - val_loss: 0.9625 - val_acc: 0.7011
Epoch 13/20
 - 0s - loss: 0.0572 - acc: 1.0000 - val_loss: 0.9511 - val_acc: 0.7168
Epoch 14/20
 - 0s - loss: 0.0393 - acc: 1.0000 - val_loss: 0.9709 - val_acc: 0.7120
Epoch 15/20
 - 0s - loss: 0.0399 - acc: 1.0000 - val_loss: 0.9296 - val_acc: 0.7242
Epoch 16/20
 - 0s - loss: 0.0335 - acc: 1.0000 - val_loss: 0.9757 - val_acc: 0.7151
Epoch 17/20
 - 0s - loss: 0.0251 - acc: 1.0000 - val_loss: 0.9453 - val_acc: 0.7224
Epoch 18/20
 - 0s - loss: 0.0203 - acc: 1.0000 - val_loss: 0.9412 - val_acc: 0.7262
Epoch 19/20
 - 0s - loss: 0.0190 - acc: 1.0000 - val_loss: 0.9717 - val_acc: 0.7196
Epoch 20/20
 - 0s - loss: 0.0157 - acc: 1.0000 - val_loss: 0.9918 - val_acc: 0.7172
Test loss: 0.9918357573986053
Test accuracy: 0.7172
Stochastic model
Stochastic layer using a bit size of 32
Train on 117 samples, validate on 10000 samples
Epoch 1/20
 - 1s - loss: 2.6463 - acc: 0.1026 - val_loss: 8.5248 - val_acc: 0.1135
Epoch 2/20
 - 0s - loss: 7.6533 - acc: 0.1624 - val_loss: 6.9639 - val_acc: 0.1488
Epoch 3/20
 - 0s - loss: 7.2511 - acc: 0.0855 - val_loss: 5.1833 - val_acc: 0.0985
Epoch 4/20
 - 0s - loss: 5.7737 - acc: 0.1538 - val_loss: 3.3938 - val_acc: 0.1035
Epoch 5/20
 - 0s - loss: 4.0310 - acc: 0.1368 - val_loss: 2.5706 - val_acc: 0.1059
Epoch 6/20
 - 0s - loss: 2.5221 - acc: 0.1709 - val_loss: 2.2750 - val_acc: 0.1078
Epoch 7/20
 - 0s - loss: 2.2348 - acc: 0.1795 - val_loss: 2.2319 - val_acc: 0.2365
Epoch 8/20
 - 0s - loss: 2.1364 - acc: 0.2222 - val_loss: 2.1136 - val_acc: 0.3333
Epoch 9/20
 - 0s - loss: 2.0421 - acc: 0.2906 - val_loss: 2.2243 - val_acc: 0.1522
Epoch 10/20
 - 0s - loss: 2.0085 - acc: 0.2821 - val_loss: 2.1220 - val_acc: 0.2552
Epoch 11/20
 - 0s - loss: 2.0363 - acc: 0.3675 - val_loss: 2.1990 - val_acc: 0.1984
Epoch 12/20
 - 0s - loss: 1.9407 - acc: 0.3761 - val_loss: 2.0620 - val_acc: 0.2414
Epoch 13/20
 - 0s - loss: 1.9202 - acc: 0.3590 - val_loss: 2.0549 - val_acc: 0.2703
Epoch 14/20
 - 0s - loss: 1.8317 - acc: 0.4188 - val_loss: 1.9224 - val_acc: 0.3267
Epoch 15/20
 - 0s - loss: 1.7074 - acc: 0.3846 - val_loss: 1.9362 - val_acc: 0.2565
Epoch 16/20
 - 0s - loss: 1.6577 - acc: 0.4872 - val_loss: 1.9586 - val_acc: 0.2840
Epoch 17/20
 - 0s - loss: 1.6988 - acc: 0.3077 - val_loss: 2.1590 - val_acc: 0.3067
Epoch 18/20
 - 0s - loss: 1.9723 - acc: 0.3675 - val_loss: 1.9214 - val_acc: 0.3604
Epoch 19/20
 - 0s - loss: 1.6491 - acc: 0.5128 - val_loss: 2.1237 - val_acc: 0.2537
Epoch 20/20
 - 0s - loss: 1.8103 - acc: 0.3590 - val_loss: 2.1044 - val_acc: 0.2935
Test loss: 2.1044525051116945
Test accuracy: 0.2951
